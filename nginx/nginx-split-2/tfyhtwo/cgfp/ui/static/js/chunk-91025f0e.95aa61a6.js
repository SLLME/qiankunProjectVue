(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-91025f0e"],{"15ae":function(e,t,a){"use strict";a("1bf4")},"1bf4":function(e,t,a){},"38cf":function(e,t,a){"use strict";a("92aa")},5666:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",{directives:[{name:"loading",rawName:"v-loading",value:e.mainLoading,expression:"mainLoading"}]},[a("el-header",{attrs:{height:"40px"}},[a("div",{staticStyle:{display:"flex"}},[a("span",{staticStyle:{display:"inline-block",width:"49px","text-align":"center","line-height":"40px",background:"#fff","border-top":"1px solid #ccc","border-left":"1px solid #ccc"}},[e._v(e._s(e.coordLable))]),a("div",{staticStyle:{flex:"1"}},[a("el-input",{attrs:{placeholder:"请输入内容",disabled:e.input.enabled},model:{value:e.input.text,callback:function(t){e.$set(e.input,"text",t)},expression:"input.text"}},[a("template",{slot:"prepend"},[a("i",{staticClass:"icon font_family icon-formula",attrs:{alt:"公式"}})])],2)],1)])]),a("el-container",[a("el-main",[a("div",{staticClass:"sheet sheet-preview"},[a("hot-table",{ref:"wrapper",attrs:{settings:e.sheet.hotSettings,licenseKey:"dce68-5c723-aade1-cac51-db0f7"}})],1)]),a("el-footer",{staticStyle:{height:"30px",padding:"0"}},[a("div",{staticClass:"footer"},[a("div",{staticClass:"left"},[a("span",[e._v(" 税种："),a("i",[e._v(e._s(e.footer.taxName)+" ")])])]),a("div",{staticClass:"center"},[a("span",[e._v("求和 = "+e._s(e.footer.taxSum))]),e._v(" "),a("span",[e._v("平均值 = "+e._s(e.footer.taxAvg))]),e._v(" "),a("span",[e._v("计数 = "+e._s(e.footer.taxCount))])]),a("div",{staticClass:"right"},[a("span",[e._v("坐标："+e._s(e.rowLable)+" ")]),e._v(","),a("span",[e._v(" "+e._s(e.colLable)+" 区域："+e._s(e.footer.taxRows)+"R ")]),e._v(" X "),a("span",[e._v(" "+e._s(e.footer.taxCols)+"C")])])])])],1)],1)},o=[],n=(a("b0c0"),a("a9e3"),a("e437")),i=a("c24d"),s=(a("c1cf"),a("8033"),a("dfed")),l={name:"sheetPreview",props:{sheet:{type:Object,required:!0}},data:function(){return{mainLoading:!1,hot:null,input:{text:"",enabled:!0},coordIndex:{row:0,col:0},coordLable:"A1",rowLable:1,colLable:1,footer:{taxName:"",taxAreaName:"",taxSum:0,taxAvg:0,taxCount:0,taxRows:0,taxCols:0}}},components:{HotTable:i["a"]},methods:{cellClick:function(e,t,a){var r=this.hot.getSelectedLast();this.coordIndex=t={row:r[0],col:r[1]},this.input.text=this.hot.getSourceData()[t.row][t.col],this.coordLable=this.common.targetCellName(t.row,t.col),this.rowLable=Number(t.row)+1,this.colLable=Number(t.col)+1},afterSelectionEnd:function(e,t,a,r){s["a"].footer(this.hot,this.footer,e,a,t,r)},afterRenderer:function(e,t,a,r,o,n){var i=this.hot.getSourceData()[t][a];!0===this.common.isExpression(i)&&(this.hot.getCell(t,a).innerHTML="")}},created:function(){this.footer.taxAreaName=this.common.targetGetStorage("taskParams").areaCodeBean?this.common.targetGetStorage("taskParams").areaCodeBean.name:"全国",this.footer.taxName=this.common.targetGetStorage("taskParams").taxTypeBean.name},mounted:function(){var e=this;this.mainLoading=!0,this.sheet.sheetHot=this.hot=this.$refs.wrapper.hotInstance;var t=s["a"].dataAnalysis(this.sheet);this.hot.addHook("afterOnCellMouseDown",this.cellClick,this.hot),this.hot.addHook("afterSelectionEnd",this.afterSelectionEnd),this.hot.addHook("afterRenderer",this.afterRenderer),this.hot.loadData(t.datas),setTimeout((function(){s["a"].customLoadData(n["a"],e.common,e.hot,e.sheet,t.cells),e.mainLoading=!1}))}},c=l,h=(a("15ae"),a("2877")),u=Object(h["a"])(c,r,o,!1,null,null,null);t["default"]=u.exports},"92aa":function(e,t,a){},dfed:function(e,t,a){"use strict";var r=a("5530");a("cb29"),a("4de4"),a("13d5"),a("a434"),a("a9e3"),a("f00c"),a("b64b"),a("d3b7"),a("4d63"),a("ac1f"),a("2c3e"),a("25f0"),a("466d"),a("5319"),a("498a");t["a"]={cache:{},localhost:"https://"+window.location.host+"/",regexp:{EXP_RANGE_REGEX:/[A-Z]+\d+:[A-Z]+\d+/g,EXP_CELL_REGEX:/[A-Z]+\d+/g,EXP_REF_REGEX:/[\u4e00-\u9fa5]+![A-Z]+\d+/g},expression:{lable:"xxxx!E4",token:"引用表达式",type:"ref",quote:"!",prefix:"xxxx",coordinate:[{row:4,column:4}]},dataAnalysis:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=[[]],a=[],o=[],n=0;n<e.sheetInfo.sheetRow;n++)if(t[n]=new Array(e.sheetInfo.sheetCol).fill(null),e.sheetDatas[n])for(var i=0;i<e.sheetInfo.sheetCol;i++){var s=e.sheetDatas[n][i];s&&(t[n][i]=s.text||null,a[a.length]={row:n,col:i,cell:s},s.active&&(o[o.length]={row:n,col:i,active:Object(r["a"])({type:s.type},s.active)}))}return{datas:t,cells:{cellInfos:a,actives:o}}},customLoadData:function(e){for(var t,a,o,n,i,s,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},h=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],d=u.cellInfos,f=0;f<d.length;f++){var g;t=d[f],a=t.cell,o=this.handleStyle(a),i=l.targetCellMeta(["type","border","mapp","meta","formula"],a),s=this.handleMeta(a.meta||{}),Object.keys(o).length>0&&c.setCellMetaObject(t.row,t.col,{renderer:function(t,a,r,o,n,i,s){var c;a.innerHTML=i,a.className=s.className+("Y"==(null===s||void 0===s||null===(c=s.meta)||void 0===c?void 0:c.required)?" required-class":""),a.style=l.targetExpansionStyle(s.style),"checkbox"===s.type?e.renderers.CheckboxRenderer.apply(this,arguments):"dropdown"===s.type?e.renderers.DropdownRenderer.apply(this,arguments):"numeric"===s.type?e.renderers.NumericRenderer.apply(this,arguments):"date"===s.type&&e.renderers.DateRenderer.apply(this,arguments),s.readOnly&&(s.readOnly?a.className=l.targetClass(s.className,"htDimmed"):a.className=l.targetDelClass(s.className,"htDimmed"))}}),n=Object(r["a"])(Object(r["a"])(Object(r["a"])({},o),i),s),"Y"==(null===(g=a)||void 0===g||null===(g=g.meta)||void 0===g?void 0:g.required)&&(n.validator=function(e,t){0==e||e&&""!==e.toString().trim()?t(!0):t(!1)}),c.setCellMetaObject(t.row,t.col,n)}for(var p=u.actives,v=0;v<p.length;v++){var m=Object.assign({},p[v]),x=l.targetClearNull(m.active);this.handleActive(l,c,m),c.setCellMetaObject(m.row,m.col,x)}var b={};h.sheetMerges&&(b.mergeCells=h.sheetMerges),h.sheetSize&&(b.colWidths=h.sheetSize.widths,b.rowHeights=h.sheetSize.heights),Object.keys(b).length>0&&c.updateSettings(b)},handleActive:function(e,t,a){if("dropdown"===a.active.type){var r=a.active.source;if(r instanceof Array&&r.length>0)return;if(!a.active.request||!a.active.request.url)return;var o=this;a.active.source=function(t,a){if(o.cache[this.request.url])a(o.cache[this.request.url]);else{var r=this;this.request.tmp||(this.request.tmp=this.request.url,this.request.url=e.targetStringFormat(this.request.url,["-1"])),fetch(o.localhost+this.request.url).then((function(e){return e.json()})).then((function(e){var t=e.data||[];t.unshift("--/--"),o.cache[r.request.url]=t,a(t)}))}}}},handleStyle:function(e){var t={};return e.style&&(t.style=Object(r["a"])({},e.style),e.style.border&&(t.border=e.style.border,t.style.border="outline: 1px solid #;border-right-width:0;border-bottom-width:0;".replace(/#/g,e.style.border)),e.style.indent&&(t.indent=e.style.indent,t.style.indent="text-indent:"+5*Number(e.style.indent)+"px"),e.style.className&&(t.className=e.style.className,delete t.style.className)),t},handleMeta:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={};return e.edit&&(t.readOnly="N"===e.edit),t},autoAllfill:function(e,t,a){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];if(1==r.length&&(0!=t.row||0!=a.row)){var o=r[0].filter((function(e){return e.indexOf(":")>=0||e.indexOf("!")>=0}));if(!(o.length>0)){for(var n=r[0].splice(0),i=[],s=0;s<n.length;s++)if(e.isExpression(n[s])){var l=[],c=this.expRef(e,n[s],l);c=this.expRang(e,c,l),c=this.expCell(e,c,l),i[s]={input:c,coordinates:l}}for(var h=0;h<=a.row-t.row;h++){for(var u=[],d=0;d<n.length;d++){var f=i[d];f?(this.expModifyFill(f.coordinates,1),u[d]=this.expLable(f.input,f.coordinates)):u[d]=n[d]}r[h]=u}}}},footer:function(e,t,a,r,o,n){var i=[];if(a>r){var s=[r,a];a=s[0],r=s[1]}if(o>n){var l=[n,o];o=l[0],n=l[1]}for(var c=a;c<=r;c++)for(var h=o;h<=n;h++){var u=1*e.getSourceData()[c][h];Number.isFinite(u)&&(i[i.length]=u)}t.taxRows=r-a+1,t.taxCols=n-o+1,t.taxCount=i.length,t.taxSum=i.reduce((function(e,t){return e+t}),0),t.taxAvg=i.length>0?t.taxSum/i.length:0},autofill:function(e,t,a,r,o){},sheetMerges:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=t;if(e)for(var r=e.getPlugin("mergeCells").mergedCellsCollection.mergedCells,o=0;o<r.length;o++){var n=r[o];a.push({col:n.col,colspan:n.colspan,row:n.row,rowspan:n.rowspan})}return a},createColumn:function(e,t,a,r,o){if("auto"!==o)for(var n=e.countCols(),i=e.countRows(),s=0;s<i;s++)for(var l=0;l<n;l++){var c=e.getSourceData()[s][l];if(t.isExpression(c)){var h=[],u=this.expRef(t,c,h);u=this.expRang(t,u,h),u=this.expCell(t,u,h),this.expModifyCol(h,a,r),h.length>0&&(e.getSourceData()[s][l]=this.expLable(u,h))}}},createRow:function(e,t,a,r,o){if("auto"!==o)for(var n=e.countCols(),i=e.countRows(),s=0;s<i;s++)for(var l=0;l<n;l++){var c=e.getSourceData()[s][l];if(t.isExpression(c)){var h=[],u=this.expRef(t,c,h);u=this.expRang(t,u,h),u=this.expCell(t,u,h),this.expModifyRow(h,a,r),h.length>0&&(e.getSourceData()[s][l]=this.expLable(u,h))}}},cascade:function(e,t,a,r){if(!("loadData"===r||"internal"===r||a.length>1)){var o=a[0][0],n=a[0][1],i=e.getCellMeta(o,n);if("dropdown"===i.type&&i.request.action){var s=a[0][3],l=t.targetCoordinate(i.request.action);if(l){var c=l.row,h=l.column,u=e.getCellMeta(c,h);"dropdown"===u.type?(s=s.split("|")[0],u.request.url=t.targetStringFormat(u.request.tmp,[s]),e.getSourceData()[c][h]=null):e.getSourceData()[c][h]=s}}}},expRef:function(e,t,a){var r=t.match(this.regexp.EXP_REF_REGEX);if(!r)return t;r.length>1&&(r=e.targetSameArray(r));for(var o=0;o<r.length;o++){var n=r[o].split("!"),i=e.targetCoordinate(n[1]),s={lable:r[o],token:"引用表达式"+o,type:"ref",quote:"!",prefix:n[0],coordinate:[i],toLable:function(){return this.prefix+this.quote+e.targetCellName(this.coordinate[0].row,this.coordinate[0].column)}};a[a.length]=s,t=t.replace(new RegExp(r[o],"g"),s.token)}return t},expRang:function(e,t,a){var r=t.match(this.regexp.EXP_RANGE_REGEX);if(!r)return t;r.length>1&&(r=e.targetSameArray(r));for(var o=0;o<r.length;o++){var n=r[o].split(":"),i=e.targetCoordinate(n[0]),s=e.targetCoordinate(n[1]),l={lable:r[o],token:"范围表达式"+o,type:"rang",quote:":",coordinate:[i,s],toLable:function(){var t=e.targetCellName(this.coordinate[0].row,this.coordinate[0].column),a=e.targetCellName(this.coordinate[1].row,this.coordinate[1].column);return t+this.quote+a}};a[a.length]=l,t=t.replace(new RegExp(r[o],"g"),l.token)}return t},expCell:function(e,t,a){var r=t.match(this.regexp.EXP_CELL_REGEX);if(!r)return t;r.length>1&&(r=e.targetSameArray(r));for(var o=0;o<r.length;o++){var n=e.targetCoordinate(r[o]),i={lable:r[o],token:"单项表达式"+o,type:"cell",quote:"",coordinate:[n],toLable:function(){return e.targetCellName(this.coordinate[0].row,this.coordinate[0].column)}};a[a.length]=i,t=t.replace(new RegExp(r[o],"g"),i.token)}return t},expLable:function(e,t){for(var a=0;a<t.length;a++)e=e.replace(new RegExp(t[a].token,"g"),t[a].toLable());return e},expModifyCol:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=!1,o=0;o<e.length;o++)for(var n=e[o].coordinate,i=0;i<n.length;i++)n[i].column>=t&&(n[i].column=n[i].column+a,r=!0);!1===r&&(e.length=0)},expModifyRow:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=!1,o=0;o<e.length;o++)for(var n=e[o].coordinate,i=0;i<n.length;i++)n[i].row>=t&&(n[i].row=n[i].row+a,r=!0);!1===r&&(e.length=0)},expModifyFill:function(e,t){for(var a=0;a<e.length;a++)for(var r=e[a].coordinate,o=0;o<r.length;o++)r[o].row=r[o].row+t},isCheckDropDate:function(e){return this.isCheck(e)||this.isDrop(e)||this.isDate()},isNumText:function(e){return this.isText(e)||this.isNum(e)},isCheck:function(e){return"checkbox"===e},isText:function(e){return"text"===e},isNum:function(e){return"numeric"===e},isDrop:function(e){return"dropdown"===e},isDate:function(e){return"date"===e}}},ea67:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.mainLoading,expression:"mainLoading"}],staticClass:"report-box"},[a("div",{staticClass:"report-top"},[a("el-tabs",{staticStyle:{flex:"1",width:"90%"},model:{value:e.active,callback:function(t){e.active=t},expression:"active"}},e._l(e.sheets,(function(e,t){return a("el-tab-pane",{key:t,attrs:{label:e.sheetInfo.sheetName,name:e.sheetInfo.sheetKey}})})),1)],1),e._l(e.sheets,(function(t,r){return a("div",{key:r,staticClass:"report-content"},[e.active==t.sheetInfo.sheetKey?a("sheet-view",{attrs:{sheet:t}}):e._e()],1)}))],2)},o=[],n=a("c7eb"),i=a("1da1"),s=(a("c740"),a("b0c0"),a("d3b7"),a("159b"),a("5666")),l=a("148f"),c={name:"report",components:{sheetView:s["default"]},data:function(){return{mainLoading:!1,active:"",dialogpllrVisible:!1,settings:{colHeaders:!0,rowHeaders:!0,height:window.innerHeight-155,stretchH:"all",language:"zh-CN",mergeCells:!0,dropdownMenu:!1,contextMenu:!1,autoWrapRow:!0,outsideClickDeselects:!1,autocomplete:!0,autoColumnSize:!1,readOnlyCellClassName:"htDimmed",comments:{displayDelay:500},trimWhitespace:!1,maxCols:225,maxRows:500,manualColumnResize:!0,manualRowResize:!0,readOnly:!0},sheets:[],router:{}}},methods:{handleClick:function(e,t){this.active=e.name},handleShow:function(){this.dialogpllrVisible=!0}},created:function(){var e=this;return Object(i["a"])(Object(n["a"])().mark((function t(){var a;return Object(n["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.router=e.common.targetGetStorage("declareParams"),t.next=3,Object(l["U"])(e.router);case 3:a=t.sent,e.$vLoading.hide(),a&&(e.sheets=a,e.sheets.length>0&&(e.sheets.forEach((function(t,a){t.hotSettings=e.settings,t.sheetUpdate=!1})),e.router.tableData.forEach((function(t){var a=e.sheets.findIndex((function(e){return e.sheetInfo.sheetKey==t.sheetKey}));t.sheetStatus&&(e.sheets[a].isSave=!1)})),e.active=e.router.currentSheetKey)),setTimeout((function(){e.mainLoading=!1}),1e3);case 7:case"end":return t.stop()}}),t)})))()},mounted:function(){this.$vLoading.show(),this.mainLoading=!0}},h=c,u=(a("38cf"),a("2877")),d=Object(u["a"])(h,r,o,!1,null,"9e59e028",null);t["default"]=d.exports}}]);