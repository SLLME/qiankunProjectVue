(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-465f152a"],{"5c21":function(e,t,a){"use strict";var s=a("5530");a("b64b");t["a"]={sheetModel:{EDIT:"edit",SUBMIT:"submit",VIEW:"view"},sheetInfo:function(e){return{sheetName:e.sheetName,sheetIndex:e.sheetIndex,sheetKey:e.sheetKey,sheetType:e.sheetType,sheetRow:e.sheetRow,sheetCol:e.sheetCol,sheetSave:e.sheetSave}},sheetMerges:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=t;if(e)for(var s=e.getPlugin("mergeCells").mergedCellsCollection.mergedCells,o=0;o<s.length;o++){var r=s[o];a.push({col:r.col,colspan:r.colspan,row:r.row,rowspan:r.rowspan})}return a},sheetWH:function(e){for(var t=e.countRows(),a=e.countCols(),s=[],o=[],r=0;r<t;r++)s[r]=e.getRowHeight(r)||25;for(var n=0;n<a;n++)o[n]=e.getColWidth(n)||50;return{heights:s,widths:o}},sheetDatas:function(e,t,a){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=s;if(t){for(var r=t.countRows(),n=t.countCols(),i=[],l=0;l<r;l++)this.isEmptyRow(t,l)||(i[i.length]=l);for(var c=[],h=0;h<n;h++)this.isEmptyCol(t,h)||(c[c.length]=h);for(var u={},d=0;d<i.length;d++){u={};for(var f=i[d],m={},g=0;g<c.length;g++)m=this.cellPropData(e,t,f,c[g],a),0!=Object.keys(m).length&&(u[c[g]]=m);o[f]=u}return o}},cellPropData:function(e,t,a,o,r){var n=t.getCellMeta(a,o),i=t.getSourceData()[a][o],l=n.type||"text",c=this.cellActiveData(l,n),h={};return h.text=i,e.isExpression(n.formula)&&(h.formula=n.formula),r===this.sheetModel.EDIT&&(h.formula="",n.formula="",e.isExpression(h.text)&&(h.formula=h.text,n.formula=h.text)),"number"===typeof i&&(h.text=String(i)),!1===e.targetIsNull(n.style)&&(h.style=Object(s["a"])({},n.style),n.border&&(h.style.border=n.border),n.indent&&0!==n.indent&&(h.style.indent=n.indent)),n.className&&(h.style||(h.style={}),h.style.className=n.className),"text"!==l&&(h.type=l),!1===e.targetIsNull(n.mapp)&&(h.mapp=n.mapp),!1===e.targetIsNull(c)&&(h.active=c),!1===e.targetIsNull(n.meta)&&(h.meta=n.meta),h},cellActiveData:function(e,t){var a={};return"checkbox"===e?a={checkedTemplate:t.checkedTemplate,uncheckedTemplate:t.uncheckedTemplate,label:{position:t.label.position,value:t.label.value}}:"dropdown"===e?a={source:"function"===typeof t.source?[]:t.source,request:t.request}:"numeric"===e?a={numericFormat:t.numericFormat}:"date"===e&&(a={dateFormat:t.dateFormat}),a},isEmptyRow:function(e,t){var a,s,o,r;for(a=0,s=e.countCols();a<s;a++)if(r=e.getCellMeta(t,a),o=e.getDataAtCell(t,a),o||this.isNULL(r))return!1;return!0},isEmptyCol:function(e,t){var a,s,o,r;for(a=0,s=e.countRows();a<s;a++)if(o=e.getDataAtCell(a,t),r=e.getCellMeta(a,t),o||this.isNULL(r))return!1;return!0},isNULL:function(e){return e.style||"text"!=e.type||e.mapp}}},7399:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",{directives:[{name:"loading",rawName:"v-loading",value:e.mainLoading,expression:"mainLoading"}]},[a("el-header",{attrs:{height:"40px"}},[a("div",{staticStyle:{display:"flex"}},[a("span",{staticStyle:{display:"inline-block",width:"49px","text-align":"center","line-height":"40px",background:"#fff","border-top":"1px solid #ccc","border-left":"1px solid #ccc"}},[e._v(e._s(e.coordLable))]),a("div",{staticStyle:{flex:"1"}},[a("el-input",{attrs:{placeholder:"请输入内容",disabled:e.input.enabled},on:{change:e.cellInput},model:{value:e.input.text,callback:function(t){e.$set(e.input,"text",t)},expression:"input.text"}},[a("template",{slot:"prepend"},[a("i",{staticClass:"icon font_family icon-formula",attrs:{alt:"公式"}})])],2)],1)])]),a("el-container",[a("el-main",[a("div",{staticClass:"sheet"},[a("hot-table",{ref:"wrapper",attrs:{settings:e.sheet.hotSettings,licenseKey:"dce68-5c723-aade1-cac51-db0f7"}})],1)]),a("el-footer",{staticStyle:{height:"30px",padding:"0"}},[a("div",{staticClass:"footer"},[a("div",{staticClass:"left"},[a("span",[e._v(" 税种："),a("i",[e._v(e._s(e.footer.taxName)+" ")])])]),a("div",{staticClass:"center"},[a("span",[e._v("求和 = "+e._s(e.footer.taxSum))]),e._v(" "),a("span",[e._v("平均值 = "+e._s(e.footer.taxAvg))]),e._v(" "),a("span",[e._v("计数 = "+e._s(e.footer.taxCount))])]),a("div",{staticClass:"right"},[a("span",[e._v("坐标："+e._s(e.rowLable)+" ")]),e._v(","),a("span",[e._v(" "+e._s(e.colLable)+" 区域："+e._s(e.footer.taxRows)+"R ")]),e._v(" X "),a("span",[e._v(" "+e._s(e.footer.taxCols)+"C")])])])])],1),a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{title:"调整",visible:e.adjustDialog,width:"420px","show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.adjustDialog=t}}},[a("el-form",{ref:"adjustFormData",staticStyle:{padding:"20px 20px 0"},attrs:{model:e.adjustFormData,size:"mini","label-width":"100px",rules:e.adjustRule}},[a("el-form-item",{attrs:{label:"调整原因：",prop:"reason"}},[a("el-input",{attrs:{placeholder:"请输入调整原因"},model:{value:e.adjustFormData.reason,callback:function(t){e.$set(e.adjustFormData,"reason",t)},expression:"adjustFormData.reason"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.saveAdjustReason}},[e._v("保存")]),a("el-button",{attrs:{size:"mini"},on:{click:e.cancelAdjust}},[e._v("取消")])],1)],1)],1)},o=[],r=a("c7eb"),n=a("b85c"),i=a("1da1"),l=(a("a630"),a("b0c0"),a("a9e3"),a("d3b7"),a("ac1f"),a("6062"),a("3ca3"),a("5319"),a("ddb0"),a("e437")),c=a("c24d"),h=(a("c1cf"),a("8033"),a("dfed")),u=a("c178"),d={name:"SheetPreview",props:{sheet:{type:Object,required:!0},ifAdjustReasonMode:{type:Boolean,required:!1}},data:function(){return{mainLoading:!1,hot:null,input:{text:"",enabled:!0},footer:{taxName:"",taxAreaName:"",taxSum:0,taxAvg:0,taxCount:0,taxRows:0,taxCols:0},coordIndex:{row:0,col:0},coordLable:"A1",rowLable:1,colLable:1,adjustDialog:!1,adjustFormData:{reason:""},adjustRule:{reason:[{required:!0,message:"请输入调整原因!",trigger:"blur"}]},validate:!0}},components:{HotTable:c["a"]},methods:{saveAdjustReason:function(){var e=this;this.$refs.adjustFormData.validate((function(t){if(t){var a={adjustBeforeValue:e.adjustBeforeValue,adjustAfterValue:e.adjustAfterValue,adjustRemark:e.adjustFormData.reason,adjustCoord:e.adjustCoordLable,adjustAttr:e.sheet.sheetName,adjustSheetKey:e.sheet.sheetKey};e.$emit("adjustDataSave",a);var s=e.common.targetCoordinate(e.adjustCoordLable);e.setCellOptColor(s.row,s.column,"rgb(247, 222, 147)")}}))},cancelAdjust:function(){var e=this.common.targetCoordinate(this.adjustCoordLable);this.hot.getSourceData()[e.row][e.column]=this.adjustBeforeValue,this.hot.getData()[e.row][e.column]=this.adjustBeforeValue,this.hot.render(),this.adjustDialog=!1},cellClick:function(e,t,a){var s=this.hot.getSelectedLast();this.coordIndex=t={row:s[0],col:s[1]},this.coordLable=this.common.targetCellName(t.row,t.col),this.rowLable=Number(t.row)+1,this.colLable=Number(t.col)+1;var o=this.hot.getCellMeta(t.row,t.col);this.input.text=o.formula||this.hot.getSourceData()[t.row][t.col]},cellInput:function(){this.hot.getSourceData()[this.coordIndex.row][this.coordIndex.col]=this.input.text;var e=this.input.text;!0===this.common.isExpression(this.input.text)&&(e="公式"),this.hot.getCell(this.coordIndex.row,this.coordIndex.col).innerHTML=e,this.hot.getData()[this.coordIndex.row][this.coordIndex.col]=e},afterRenderer:function(e,t,a,s,o,r){var n=this.hot.getSourceData()[t][a];!0===this.common.isExpression(n)&&(this.hot.getCell(t,a).innerHTML="公式")},afterSelectionEnd:function(e,t,a,s){h["a"].footer(this.hot,this.footer,e,a,t,s)},beforeChange:function(e,t){"edit"!=t||this.common.judgeEqual(e[0][2],e[0][3])||(this.adjustBeforeValue=e[0][2],this.adjustAfterValue=e[0][3],this.adjustCoordLable=this.common.targetCellName(e[0][0],e[0][1]))},beforeValidate:function(e,t,a,s){this.validate=!1},afterValidate:function(e,t,a,s,o){e||this.$message({type:"warning",message:"当前编辑的单元格数据类型校验不通过，请重新编辑!"}),this.validate=e},afterChange:function(e,t){if(this.validate&&"edit"==t&&!this.common.judgeEqual(e[0][2],e[0][3])){var a=this.hot.getCellMeta(e[0][0],e[0][1])||{};if(a.meta&&a.meta.adjust&&"Y"===a.meta.adjust)if(this.ifAdjustReasonMode)this.adjustDialog=!0,this.adjustFormData.reason="",this.$nextTick((function(){this.$refs["adjustFormData"].clearValidate()}));else{this.adjustFormData.reason="系统默认调整";var s={adjustBeforeValue:this.adjustBeforeValue,adjustAfterValue:this.adjustAfterValue,adjustRemark:this.adjustFormData.reason,adjustCoord:this.adjustCoordLable,adjustAttr:this.sheet.sheetName,adjustSheetKey:this.sheet.sheetKey};this.$emit("adjustDataSave",s);var o=this.common.targetCoordinate(this.adjustCoordLable);this.setCellOptColor(o.row,o.column,"rgb(247, 222, 147)")}}},afterLoadData:function(){},beforeKeyDown:function(e){},signAdjustColor:function(){var e=this;return Object(i["a"])(Object(r["a"])().mark((function t(){var a,s,o,i,l,c,h,d;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a={bussKey:e.common.targetGetStorage("declareParams").bussKey,sheetKey:e.sheet.sheetKey},s=Object(u["b"])(a),s){for(i in e.tableRecordData=s,o=[],e.tableRecordData)e.$set(o,i,e.tableRecordData[i].adjustCoord);o=Array.from(new Set(o)),l=Object(n["a"])(o);try{for(l.s();!(c=l.n()).done;)h=c.value,d=e.common.targetCoordinate(h),e.setCellOptColor(d.row,d.column,"rgb(247, 222, 147)")}catch(r){l.e(r)}finally{l.f()}}case 3:case"end":return t.stop()}}),t)})))()},setCellOptColor:function(e,t,a,s){var o=this,r="background:#".replace(/#/g,a),n=this.hot.getCellMeta(e,t);!0!==n.hidden&&(this.hot.setCellMetaObject(e,t,{renderer:function(e,t,a,s,n,i,l){t.style=o.common.targetStyle(l,"background",r),t.className=l.className||"",h["a"].isNumText(l.type)&&(t.innerHTML=i)}}),this.hot.render())}},created:function(){this.footer.taxAreaName=this.common.targetGetStorage("taskParams").areaCodeBean?this.common.targetGetStorage("taskParams").areaCodeBean.name:"全国",this.footer.taxName=this.common.targetGetStorage("taskParams").taxTypeBean.name},mounted:function(){var e=this;this.mainLoading=!0,this.sheet.sheetHot=this.hot=this.$refs.wrapper.hotInstance,this.sheet.sheetUpdate=!0;var t=h["a"].dataAnalysis(this.sheet);this.hot.addHook("afterOnCellMouseDown",this.cellClick,this.hot),this.hot.addHook("afterRenderer",this.afterRenderer),this.hot.addHook("beforeChange",this.beforeChange),this.hot.addHook("afterChange",this.afterChange),this.hot.addHook("afterValidate",this.afterValidate),this.hot.addHook("beforeValidate",this.beforeValidate),this.hot.addHook("afterSelectionEnd",this.afterSelectionEnd),this.hot.loadData(t.datas),setTimeout((function(){h["a"].customLoadData(l["a"],e.common,e.hot,e.sheet,t.cells),e.mainLoading=!1})),this.signAdjustColor()}},f=d,m=(a("e8b8"),a("2877")),g=Object(m["a"])(f,s,o,!1,null,null,null);t["default"]=g.exports},"92e8":function(e,t,a){},"99e1":function(e,t,a){},def4:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.mainLoading,expression:"mainLoading"}],staticClass:"report-box"},[a("div",{staticClass:"report-top"},[a("el-tabs",{staticStyle:{flex:"1",width:"85%"},on:{"tab-click":e.handleClick},model:{value:e.active,callback:function(t){e.active=t},expression:"active"}},e._l(e.sheets,(function(t,s){return a("el-tab-pane",{key:s,attrs:{label:t.sheetInfo.sheetName,name:t.sheetInfo.sheetKey}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v(e._s(t.sheetInfo.sheetName)),a("i",{directives:[{name:"show",rawName:"v-show",value:t.isSave,expression:"item.isSave"}],staticClass:"el-icon-circle-check",staticStyle:{"margin-left":"3px"}})])])})),1),a("div",{staticClass:"right-button"},[e.ifAdjustReasonMode?e._e():a("el-tooltip",{attrs:{effect:"dark",content:"可调整的单元格修改后不会要求输入调整原因,点击按钮后切换成备注模式",placement:"top-start"}},[a("el-button",{staticStyle:{"margin-right":"15px"},attrs:{size:"mini"},on:{click:function(t){return e.adjustMode("changeYes")}}},[e._v("非备注模式")])],1),e.ifAdjustReasonMode?a("el-tooltip",{attrs:{effect:"dark",content:"可调整单元格修改后会要求输入调整原因,点击按钮后切换成非备注模式",placement:"top-start"}},[a("el-button",{staticStyle:{"margin-right":"15px"},attrs:{size:"mini"},on:{click:function(t){return e.adjustMode("changeNo")}}},[e._v("备注模式")])],1):e._e(),e.ifShowError?a("el-tooltip",{attrs:{effect:"dark",content:"错误信息",placement:"top-start","hide-after":1e3}},[a("i",{staticClass:"el-icon-warning-outline",staticStyle:{"font-size":"22px",color:"red","margin-right":"15px","vertical-align":"middle"},on:{click:function(t){return e.warningInfo()}}})]):e._e(),a("el-tooltip",{attrs:{effect:"dark",content:"提交",placement:"top-start","hide-after":1e3}},[a("el-button",{staticStyle:{"margin-right":"15px"},attrs:{size:"mini"},on:{click:function(t){return e.handleSave()}}},[e._v("提交")])],1)],1)],1),e._l(e.sheets,(function(t,s){return a("div",{key:s,staticClass:"report-content"},[e.active==t.sheetInfo.sheetKey?a("sheet-view",{ref:"sheetview",refInFor:!0,attrs:{sheet:t,ifAdjustReasonMode:e.ifAdjustReasonMode},on:{adjustDataSave:e.saveAdjustData}}):e._e()],1)})),a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{title:"错误信息",visible:e.dialogWarningInfo,width:"940px","close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.dialogWarningInfo=t}}},[a("el-table",{staticClass:"table-no-ellipsis",staticStyle:{width:"100%"},attrs:{data:e.warningTableData,height:"300px",border:"",stripe:"","highlight-current-row":""}},[a("el-table-column",{attrs:{type:"index",label:"序号",fixed:"",width:"50"}}),a("el-table-column",{attrs:{prop:"bussType",label:"业务类型",width:"140"}}),a("el-table-column",{attrs:{prop:"bussDesc",label:"业务描述",width:"180"}}),a("el-table-column",{attrs:{prop:"bussLevel",label:"错误级别",width:"120"}}),a("el-table-column",{attrs:{prop:"bussContent",label:"执行内容"}})],1)],1)],2)},o=[],r=a("5530"),n=a("c7eb"),i=a("1da1"),l=(a("7db0"),a("c740"),a("b0c0"),a("d3b7"),a("3ca3"),a("159b"),a("ddb0"),a("e437")),c=a("7399"),h=a("148f"),u=a("5c21"),d=a("dfed"),f={name:"report",components:{sheetView:c["default"]},data:function(){return{mainLoading:!1,active:"",dialogpllrVisible:!1,settings:{colHeaders:!0,rowHeaders:!0,height:window.innerHeight-155,stretchH:"all",language:"zh-CN",mergeCells:!0,dropdownMenu:!1,contextMenu:!1,autoWrapRow:!0,outsideClickDeselects:!1,autocomplete:!0,autoColumnSize:!0,readOnlyCellClassName:"htDimmed",comments:{displayDelay:500},trimWhitespace:!0,maxCols:225,maxRows:500,manualColumnResize:!0,manualRowResize:!0,readOnly:!1},sheets:[],formBase:{name:""},formBaserules:{name:[{required:!0,message:"请填写报表名称",trigger:"blur"}]},router:{},dialogWarningInfo:!1,warningTableData:[],ifShowError:!0,ifAdjustReasonMode:!1}},methods:{handleClick:function(e,t){this.handleLeaveSave(),this.active=e.name},handleLeaveSave:function(){var e=this.sheets.findIndex((function(e){return null!=e.sheetHot}));if(-1!=e){var t=this.sheets[e];t.sheetInfo=u["a"].sheetInfo(t.sheetInfo,e),t.sheetMerges=u["a"].sheetMerges(t.sheetHot),t.sheetDatas=u["a"].sheetDatas(this.common,t.sheetHot,u["a"].sheetModel.SUBMIT),t.sheetSize=u["a"].sheetWH(t.sheetHot),delete t.sheetHot}},handleShow:function(){this.dialogpllrVisible=!0,this.formBase.name=""},handleSetting:function(){},warningInfo:function(){var e=this;return Object(i["a"])(Object(n["a"])().mark((function t(){var a,s;return Object(n["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.dialogWarningInfo=!0,a={bussKey:e.router.bussKey},t.next=4,Object(h["R"])(a);case 4:s=t.sent,s&&(e.warningTableData=s);case 6:case"end":return t.stop()}}),t)})))()},handleSave:function(){var e=this;return Object(i["a"])(Object(n["a"])().mark((function t(){var a,s,o,r;return Object(n["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.$refs.sheetview[0].validate){t.next=10;break}return a=e.sheets.findIndex((function(t){return t.sheetKey==e.active})),s=e.sheets[a],o={bussKey:e.router.bussKey,sheet:{sheetInfo:u["a"].sheetInfo(s.sheetInfo),sheetDatas:u["a"].sheetDatas(e.common,s.sheetHot,u["a"].sheetModel.SUBMIT),sheetMapp:s.sheetMapp,sheetLoad:s.sheetLoad,sheetValids:s.sheetValids},taxUUID:e.router.taxUUID},t.next=6,Object(h["tb"])(o);case 6:r=t.sent,r&&(e.$message({type:"success",message:"当前报表保存成功!"}),s.isSave=!0,e.$set(e.sheets,a,s)),t.next=11;break;case 10:e.$message({type:"warning",message:"存在单元格数据类型校验不通过，请重新编辑!"});case 11:case"end":return t.stop()}}),t)})))()},saveAdjustData:function(e){var t=this;return Object(i["a"])(Object(n["a"])().mark((function a(){var s,o,i,c,f,m,g,p,v,b,x;return Object(n["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:for(s=[],o=0;o<t.sheets.length;o++)s[o]={sheetDatas:t.sheets[o].sheetDatas,sheetMapp:t.sheets[o].sheetMapp,sheetInfo:t.sheets[o].sheetInfo,sheetName:t.sheets[o].sheetName,sheetKey:t.sheets[o].sheetKey},t.sheets[o].sheetKey==t.active&&(s[o].sheetDatas=u["a"].sheetDatas(t.common,t.sheets[o].sheetHot,u["a"].sheetModel.SUBMIT));return i=Object(r["a"])(Object(r["a"])({},e),{},{bussKey:t.router.bussKey,taxUUID:t.router.taxUUID,sheets:s}),t.mainLoading=!0,a.next=6,Object(h["a"])(i);case 6:if(c=a.sent,!c){a.next=25;break}if(f=c.adjusts,m=t.sheets.findIndex((function(e){return e.sheetKey==t.active})),g=t.sheets[m],p=d["a"].dataAnalysis(g),f.forEach((function(e){g.sheetHot.getSourceData()[e.row][e.col]=e.value,g.sheetHot.getData()[e.row][e.col]=e.value,p.datas[e.row][e.col]=e.value})),g.sheetHot.loadData(p.datas),setTimeout((function(){d["a"].customLoadData(l["a"],t.common,g.sheetHot,g,p.cells),t.mainLoading=!1})),v=c.sheets,!(v.length>0)){a.next=24;break}b=Object(n["a"])().mark((function e(){var a,s;return Object(n["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:a=t.sheets[x].sheetKey,s=v.find((function(e){return e.sheetKey===a})),t.sheets[x].sheetDatas=s.sheetDatas||{};case 3:case"end":return e.stop()}}),e)})),x=0;case 19:if(!(x<t.sheets.length)){a.next=24;break}return a.delegateYield(b(),"t0",21);case 21:x++,a.next=19;break;case 24:t.$refs.sheetview[0].adjustDialog=!1;case 25:case"end":return a.stop()}}),a)})))()},adjustMode:function(e){"changeNo"==e?this.ifAdjustReasonMode=!1:"changeYes"==e&&(this.ifAdjustReasonMode=!0)}},created:function(){var e=this;return Object(i["a"])(Object(n["a"])().mark((function t(){var a;return Object(n["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.router=e.common.targetGetStorage("declareParams"),t.next=3,Object(h["S"])(e.router);case 3:a=t.sent,e.$vLoading.hide(),a&&(e.sheets=a,e.sheets.length>0&&(e.sheets.forEach((function(t,a){t.hotSettings=e.settings,t.sheetUpdate=!1})),e.router.tableData.forEach((function(t){var a=e.sheets.findIndex((function(e){return e.sheetInfo.sheetKey==t.sheetKey}));t.sheetStatus&&(e.sheets[a].isSave=!1)})),e.active=e.router.currentSheetKey)),setTimeout((function(){e.mainLoading=!1}),1e3);case 7:case"end":return t.stop()}}),t)})))()},mounted:function(){this.$vLoading.show(),this.mainLoading=!0}},m=f,g=(a("f262"),a("2877")),p=Object(g["a"])(m,s,o,!1,null,"7eec776a",null);t["default"]=p.exports},dfed:function(e,t,a){"use strict";var s=a("5530");a("cb29"),a("4de4"),a("13d5"),a("a434"),a("a9e3"),a("f00c"),a("b64b"),a("d3b7"),a("4d63"),a("ac1f"),a("2c3e"),a("25f0"),a("466d"),a("5319"),a("498a");t["a"]={cache:{},localhost:"https://"+window.location.host+"/",regexp:{EXP_RANGE_REGEX:/[A-Z]+\d+:[A-Z]+\d+/g,EXP_CELL_REGEX:/[A-Z]+\d+/g,EXP_REF_REGEX:/[\u4e00-\u9fa5]+![A-Z]+\d+/g},expression:{lable:"xxxx!E4",token:"引用表达式",type:"ref",quote:"!",prefix:"xxxx",coordinate:[{row:4,column:4}]},dataAnalysis:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=[[]],a=[],o=[],r=0;r<e.sheetInfo.sheetRow;r++)if(t[r]=new Array(e.sheetInfo.sheetCol).fill(null),e.sheetDatas[r])for(var n=0;n<e.sheetInfo.sheetCol;n++){var i=e.sheetDatas[r][n];i&&(t[r][n]=i.text||null,a[a.length]={row:r,col:n,cell:i},i.active&&(o[o.length]={row:r,col:n,active:Object(s["a"])({type:i.type},i.active)}))}return{datas:t,cells:{cellInfos:a,actives:o}}},customLoadData:function(e){for(var t,a,o,r,n,i,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},h=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],d=u.cellInfos,f=0;f<d.length;f++){var m;t=d[f],a=t.cell,o=this.handleStyle(a),n=l.targetCellMeta(["type","border","mapp","meta","formula"],a),i=this.handleMeta(a.meta||{}),Object.keys(o).length>0&&c.setCellMetaObject(t.row,t.col,{renderer:function(t,a,s,o,r,n,i){var c;a.innerHTML=n,a.className=i.className+("Y"==(null===i||void 0===i||null===(c=i.meta)||void 0===c?void 0:c.required)?" required-class":""),a.style=l.targetExpansionStyle(i.style),"checkbox"===i.type?e.renderers.CheckboxRenderer.apply(this,arguments):"dropdown"===i.type?e.renderers.DropdownRenderer.apply(this,arguments):"numeric"===i.type?e.renderers.NumericRenderer.apply(this,arguments):"date"===i.type&&e.renderers.DateRenderer.apply(this,arguments),i.readOnly&&(i.readOnly?a.className=l.targetClass(i.className,"htDimmed"):a.className=l.targetDelClass(i.className,"htDimmed"))}}),r=Object(s["a"])(Object(s["a"])(Object(s["a"])({},o),n),i),"Y"==(null===(m=a)||void 0===m||null===(m=m.meta)||void 0===m?void 0:m.required)&&(r.validator=function(e,t){0==e||e&&""!==e.toString().trim()?t(!0):t(!1)}),c.setCellMetaObject(t.row,t.col,r)}for(var g=u.actives,p=0;p<g.length;p++){var v=Object.assign({},g[p]),b=l.targetClearNull(v.active);this.handleActive(l,c,v),c.setCellMetaObject(v.row,v.col,b)}var x={};h.sheetMerges&&(x.mergeCells=h.sheetMerges),h.sheetSize&&(x.colWidths=h.sheetSize.widths,x.rowHeights=h.sheetSize.heights),Object.keys(x).length>0&&c.updateSettings(x)},handleActive:function(e,t,a){if("dropdown"===a.active.type){var s=a.active.source;if(s instanceof Array&&s.length>0)return;if(!a.active.request||!a.active.request.url)return;var o=this;a.active.source=function(t,a){if(o.cache[this.request.url])a(o.cache[this.request.url]);else{var s=this;this.request.tmp||(this.request.tmp=this.request.url,this.request.url=e.targetStringFormat(this.request.url,["-1"])),fetch(o.localhost+this.request.url).then((function(e){return e.json()})).then((function(e){var t=e.data||[];t.unshift("--/--"),o.cache[s.request.url]=t,a(t)}))}}}},handleStyle:function(e){var t={};return e.style&&(t.style=Object(s["a"])({},e.style),e.style.border&&(t.border=e.style.border,t.style.border="outline: 1px solid #;border-right-width:0;border-bottom-width:0;".replace(/#/g,e.style.border)),e.style.indent&&(t.indent=e.style.indent,t.style.indent="text-indent:"+5*Number(e.style.indent)+"px"),e.style.className&&(t.className=e.style.className,delete t.style.className)),t},handleMeta:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={};return e.edit&&(t.readOnly="N"===e.edit),t},autoAllfill:function(e,t,a){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];if(1==s.length&&(0!=t.row||0!=a.row)){var o=s[0].filter((function(e){return e.indexOf(":")>=0||e.indexOf("!")>=0}));if(!(o.length>0)){for(var r=s[0].splice(0),n=[],i=0;i<r.length;i++)if(e.isExpression(r[i])){var l=[],c=this.expRef(e,r[i],l);c=this.expRang(e,c,l),c=this.expCell(e,c,l),n[i]={input:c,coordinates:l}}for(var h=0;h<=a.row-t.row;h++){for(var u=[],d=0;d<r.length;d++){var f=n[d];f?(this.expModifyFill(f.coordinates,1),u[d]=this.expLable(f.input,f.coordinates)):u[d]=r[d]}s[h]=u}}}},footer:function(e,t,a,s,o,r){var n=[];if(a>s){var i=[s,a];a=i[0],s=i[1]}if(o>r){var l=[r,o];o=l[0],r=l[1]}for(var c=a;c<=s;c++)for(var h=o;h<=r;h++){var u=1*e.getSourceData()[c][h];Number.isFinite(u)&&(n[n.length]=u)}t.taxRows=s-a+1,t.taxCols=r-o+1,t.taxCount=n.length,t.taxSum=n.reduce((function(e,t){return e+t}),0),t.taxAvg=n.length>0?t.taxSum/n.length:0},autofill:function(e,t,a,s,o){},sheetMerges:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=t;if(e)for(var s=e.getPlugin("mergeCells").mergedCellsCollection.mergedCells,o=0;o<s.length;o++){var r=s[o];a.push({col:r.col,colspan:r.colspan,row:r.row,rowspan:r.rowspan})}return a},createColumn:function(e,t,a,s,o){if("auto"!==o)for(var r=e.countCols(),n=e.countRows(),i=0;i<n;i++)for(var l=0;l<r;l++){var c=e.getSourceData()[i][l];if(t.isExpression(c)){var h=[],u=this.expRef(t,c,h);u=this.expRang(t,u,h),u=this.expCell(t,u,h),this.expModifyCol(h,a,s),h.length>0&&(e.getSourceData()[i][l]=this.expLable(u,h))}}},createRow:function(e,t,a,s,o){if("auto"!==o)for(var r=e.countCols(),n=e.countRows(),i=0;i<n;i++)for(var l=0;l<r;l++){var c=e.getSourceData()[i][l];if(t.isExpression(c)){var h=[],u=this.expRef(t,c,h);u=this.expRang(t,u,h),u=this.expCell(t,u,h),this.expModifyRow(h,a,s),h.length>0&&(e.getSourceData()[i][l]=this.expLable(u,h))}}},cascade:function(e,t,a,s){if(!("loadData"===s||"internal"===s||a.length>1)){var o=a[0][0],r=a[0][1],n=e.getCellMeta(o,r);if("dropdown"===n.type&&n.request.action){var i=a[0][3],l=t.targetCoordinate(n.request.action);if(l){var c=l.row,h=l.column,u=e.getCellMeta(c,h);"dropdown"===u.type?(i=i.split("|")[0],u.request.url=t.targetStringFormat(u.request.tmp,[i]),e.getSourceData()[c][h]=null):e.getSourceData()[c][h]=i}}}},expRef:function(e,t,a){var s=t.match(this.regexp.EXP_REF_REGEX);if(!s)return t;s.length>1&&(s=e.targetSameArray(s));for(var o=0;o<s.length;o++){var r=s[o].split("!"),n=e.targetCoordinate(r[1]),i={lable:s[o],token:"引用表达式"+o,type:"ref",quote:"!",prefix:r[0],coordinate:[n],toLable:function(){return this.prefix+this.quote+e.targetCellName(this.coordinate[0].row,this.coordinate[0].column)}};a[a.length]=i,t=t.replace(new RegExp(s[o],"g"),i.token)}return t},expRang:function(e,t,a){var s=t.match(this.regexp.EXP_RANGE_REGEX);if(!s)return t;s.length>1&&(s=e.targetSameArray(s));for(var o=0;o<s.length;o++){var r=s[o].split(":"),n=e.targetCoordinate(r[0]),i=e.targetCoordinate(r[1]),l={lable:s[o],token:"范围表达式"+o,type:"rang",quote:":",coordinate:[n,i],toLable:function(){var t=e.targetCellName(this.coordinate[0].row,this.coordinate[0].column),a=e.targetCellName(this.coordinate[1].row,this.coordinate[1].column);return t+this.quote+a}};a[a.length]=l,t=t.replace(new RegExp(s[o],"g"),l.token)}return t},expCell:function(e,t,a){var s=t.match(this.regexp.EXP_CELL_REGEX);if(!s)return t;s.length>1&&(s=e.targetSameArray(s));for(var o=0;o<s.length;o++){var r=e.targetCoordinate(s[o]),n={lable:s[o],token:"单项表达式"+o,type:"cell",quote:"",coordinate:[r],toLable:function(){return e.targetCellName(this.coordinate[0].row,this.coordinate[0].column)}};a[a.length]=n,t=t.replace(new RegExp(s[o],"g"),n.token)}return t},expLable:function(e,t){for(var a=0;a<t.length;a++)e=e.replace(new RegExp(t[a].token,"g"),t[a].toLable());return e},expModifyCol:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=!1,o=0;o<e.length;o++)for(var r=e[o].coordinate,n=0;n<r.length;n++)r[n].column>=t&&(r[n].column=r[n].column+a,s=!0);!1===s&&(e.length=0)},expModifyRow:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=!1,o=0;o<e.length;o++)for(var r=e[o].coordinate,n=0;n<r.length;n++)r[n].row>=t&&(r[n].row=r[n].row+a,s=!0);!1===s&&(e.length=0)},expModifyFill:function(e,t){for(var a=0;a<e.length;a++)for(var s=e[a].coordinate,o=0;o<s.length;o++)s[o].row=s[o].row+t},isCheckDropDate:function(e){return this.isCheck(e)||this.isDrop(e)||this.isDate()},isNumText:function(e){return this.isText(e)||this.isNum(e)},isCheck:function(e){return"checkbox"===e},isText:function(e){return"text"===e},isNum:function(e){return"numeric"===e},isDrop:function(e){return"dropdown"===e},isDate:function(e){return"date"===e}}},e8b8:function(e,t,a){"use strict";a("99e1")},f262:function(e,t,a){"use strict";a("92e8")}}]);