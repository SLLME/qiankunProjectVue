(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-392fe86d"],{"00fd":function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));n("d06e");var o=n("9f10"),i=n("81ea");class r extends o["a"]{constructor(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];super(t)}getTrimmedIndexes(){return Object(i["arrayReduce"])(this.getValues(),(t,e,n)=>(e&&t.push(n),t),[])}}},"01b5":function(t,e,n){"use strict";var o=n("73fa"),i=n("8793"),r=n("7c2b");t.exports=function(t,e,n){var s,a;return r&&o(s=e.constructor)&&s!==n&&i(a=s.prototype)&&a!==n.prototype&&r(t,a),t}},"0204":function(t,e,n){"use strict";var o=n("48ab"),i=Function.prototype,r=i.apply,s=i.call;t.exports="object"==typeof Reflect&&Reflect.apply||(o?s.bind(r):function(){return s.apply(r,arguments)})},"0227":function(t,e,n){"use strict";var o=n("54ad"),i=n("73fa"),r=function(t){return i(t)?t:void 0};t.exports=function(t,e){return arguments.length<2?r(o[t]):o[t]&&o[t][e]}},"022b":function(t,e,n){"use strict";t.exports=function(t){return null===t||void 0===t}},"0283":function(t,e,n){"use strict";n.r(e),n.d(e,"CONTEXT_MENU_ITEMS_NAMESPACE",(function(){return o})),n.d(e,"CONTEXTMENU_ITEMS_NO_ITEMS",(function(){return r})),n.d(e,"CONTEXTMENU_ITEMS_ROW_ABOVE",(function(){return s})),n.d(e,"CONTEXTMENU_ITEMS_ROW_BELOW",(function(){return a})),n.d(e,"CONTEXTMENU_ITEMS_INSERT_LEFT",(function(){return l})),n.d(e,"CONTEXTMENU_ITEMS_INSERT_RIGHT",(function(){return c})),n.d(e,"CONTEXTMENU_ITEMS_REMOVE_ROW",(function(){return h})),n.d(e,"CONTEXTMENU_ITEMS_REMOVE_COLUMN",(function(){return u})),n.d(e,"CONTEXTMENU_ITEMS_UNDO",(function(){return d})),n.d(e,"CONTEXTMENU_ITEMS_REDO",(function(){return f})),n.d(e,"CONTEXTMENU_ITEMS_READ_ONLY",(function(){return g})),n.d(e,"CONTEXTMENU_ITEMS_CLEAR_COLUMN",(function(){return p})),n.d(e,"CONTEXTMENU_ITEMS_COPY",(function(){return m})),n.d(e,"CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS",(function(){return b})),n.d(e,"CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS",(function(){return w})),n.d(e,"CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY",(function(){return v})),n.d(e,"CONTEXTMENU_ITEMS_CUT",(function(){return y})),n.d(e,"CONTEXTMENU_ITEMS_FREEZE_COLUMN",(function(){return C})),n.d(e,"CONTEXTMENU_ITEMS_UNFREEZE_COLUMN",(function(){return S})),n.d(e,"CONTEXTMENU_ITEMS_MERGE_CELLS",(function(){return O})),n.d(e,"CONTEXTMENU_ITEMS_UNMERGE_CELLS",(function(){return E})),n.d(e,"CONTEXTMENU_ITEMS_ADD_COMMENT",(function(){return R})),n.d(e,"CONTEXTMENU_ITEMS_EDIT_COMMENT",(function(){return T})),n.d(e,"CONTEXTMENU_ITEMS_REMOVE_COMMENT",(function(){return M})),n.d(e,"CONTEXTMENU_ITEMS_READ_ONLY_COMMENT",(function(){return I})),n.d(e,"CONTEXTMENU_ITEMS_ALIGNMENT",(function(){return x})),n.d(e,"CONTEXTMENU_ITEMS_ALIGNMENT_LEFT",(function(){return N})),n.d(e,"CONTEXTMENU_ITEMS_ALIGNMENT_CENTER",(function(){return A})),n.d(e,"CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT",(function(){return H})),n.d(e,"CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY",(function(){return j})),n.d(e,"CONTEXTMENU_ITEMS_ALIGNMENT_TOP",(function(){return _})),n.d(e,"CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE",(function(){return k})),n.d(e,"CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM",(function(){return P})),n.d(e,"CONTEXTMENU_ITEMS_BORDERS",(function(){return D})),n.d(e,"CONTEXTMENU_ITEMS_BORDERS_TOP",(function(){return L})),n.d(e,"CONTEXTMENU_ITEMS_BORDERS_RIGHT",(function(){return F})),n.d(e,"CONTEXTMENU_ITEMS_BORDERS_BOTTOM",(function(){return V})),n.d(e,"CONTEXTMENU_ITEMS_BORDERS_LEFT",(function(){return W})),n.d(e,"CONTEXTMENU_ITEMS_REMOVE_BORDERS",(function(){return B})),n.d(e,"CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD",(function(){return U})),n.d(e,"CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD",(function(){return z})),n.d(e,"CONTEXTMENU_ITEMS_HIDE_COLUMN",(function(){return G})),n.d(e,"CONTEXTMENU_ITEMS_SHOW_COLUMN",(function(){return Y})),n.d(e,"CONTEXTMENU_ITEMS_HIDE_ROW",(function(){return X})),n.d(e,"CONTEXTMENU_ITEMS_SHOW_ROW",(function(){return $})),n.d(e,"FILTERS_NAMESPACE",(function(){return K})),n.d(e,"FILTERS_CONDITIONS_NAMESPACE",(function(){return q})),n.d(e,"FILTERS_CONDITIONS_NONE",(function(){return Q})),n.d(e,"FILTERS_CONDITIONS_EMPTY",(function(){return J})),n.d(e,"FILTERS_CONDITIONS_NOT_EMPTY",(function(){return Z})),n.d(e,"FILTERS_CONDITIONS_EQUAL",(function(){return tt})),n.d(e,"FILTERS_CONDITIONS_NOT_EQUAL",(function(){return et})),n.d(e,"FILTERS_CONDITIONS_BEGINS_WITH",(function(){return nt})),n.d(e,"FILTERS_CONDITIONS_ENDS_WITH",(function(){return ot})),n.d(e,"FILTERS_CONDITIONS_CONTAINS",(function(){return it})),n.d(e,"FILTERS_CONDITIONS_NOT_CONTAIN",(function(){return rt})),n.d(e,"FILTERS_CONDITIONS_BY_VALUE",(function(){return st})),n.d(e,"FILTERS_CONDITIONS_GREATER_THAN",(function(){return at})),n.d(e,"FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL",(function(){return lt})),n.d(e,"FILTERS_CONDITIONS_LESS_THAN",(function(){return ct})),n.d(e,"FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL",(function(){return ht})),n.d(e,"FILTERS_CONDITIONS_BETWEEN",(function(){return ut})),n.d(e,"FILTERS_CONDITIONS_NOT_BETWEEN",(function(){return dt})),n.d(e,"FILTERS_CONDITIONS_AFTER",(function(){return ft})),n.d(e,"FILTERS_CONDITIONS_BEFORE",(function(){return gt})),n.d(e,"FILTERS_CONDITIONS_TODAY",(function(){return pt})),n.d(e,"FILTERS_CONDITIONS_TOMORROW",(function(){return mt})),n.d(e,"FILTERS_CONDITIONS_YESTERDAY",(function(){return bt})),n.d(e,"FILTERS_DIVS_FILTER_BY_CONDITION",(function(){return wt})),n.d(e,"FILTERS_DIVS_FILTER_BY_VALUE",(function(){return vt})),n.d(e,"FILTERS_LABELS_CONJUNCTION",(function(){return yt})),n.d(e,"FILTERS_LABELS_DISJUNCTION",(function(){return Ct})),n.d(e,"FILTERS_VALUES_BLANK_CELLS",(function(){return St})),n.d(e,"FILTERS_BUTTONS_SELECT_ALL",(function(){return Ot})),n.d(e,"FILTERS_BUTTONS_CLEAR",(function(){return Et})),n.d(e,"FILTERS_BUTTONS_OK",(function(){return Rt})),n.d(e,"FILTERS_BUTTONS_CANCEL",(function(){return Tt})),n.d(e,"FILTERS_BUTTONS_PLACEHOLDER_SEARCH",(function(){return Mt})),n.d(e,"FILTERS_BUTTONS_PLACEHOLDER_VALUE",(function(){return It})),n.d(e,"FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE",(function(){return xt})),n.d(e,"CHECKBOX_RENDERER_NAMESPACE",(function(){return Nt})),n.d(e,"CHECKBOX_CHECKED",(function(){return At})),n.d(e,"CHECKBOX_UNCHECKED",(function(){return Ht}));const o="ContextMenu:items",i=o,r=i+".noItems",s=i+".insertRowAbove",a=i+".insertRowBelow",l=i+".insertColumnOnTheLeft",c=i+".insertColumnOnTheRight",h=i+".removeRow",u=i+".removeColumn",d=i+".undo",f=i+".redo",g=i+".readOnly",p=i+".clearColumn",m=i+".copy",b=i+".copyWithHeaders",w=i+".copyWithGroupHeaders",v=i+".copyHeadersOnly",y=i+".cut",C=i+".freezeColumn",S=i+".unfreezeColumn",O=i+".mergeCells",E=i+".unmergeCells",R=i+".addComment",T=i+".editComment",M=i+".removeComment",I=i+".readOnlyComment",x=i+".align",N=i+".align.left",A=i+".align.center",H=i+".align.right",j=i+".align.justify",_=i+".align.top",k=i+".align.middle",P=i+".align.bottom",D=i+".borders",L=i+".borders.top",F=i+".borders.right",V=i+".borders.bottom",W=i+".borders.left",B=i+".borders.remove",U=i+".nestedHeaders.insertChildRow",z=i+".nestedHeaders.detachFromParent",G=i+".hideColumn",Y=i+".showColumn",X=i+".hideRow",$=i+".showRow",K="Filters:",q=K+"conditions",Q=q+".none",J=q+".isEmpty",Z=q+".isNotEmpty",tt=q+".isEqualTo",et=q+".isNotEqualTo",nt=q+".beginsWith",ot=q+".endsWith",it=q+".contains",rt=q+".doesNotContain",st=q+".byValue",at=q+".greaterThan",lt=q+".greaterThanOrEqualTo",ct=q+".lessThan",ht=q+".lessThanOrEqualTo",ut=q+".isBetween",dt=q+".isNotBetween",ft=q+".after",gt=q+".before",pt=q+".today",mt=q+".tomorrow",bt=q+".yesterday",wt=K+"labels.filterByCondition",vt=K+"labels.filterByValue",yt=K+"labels.conjunction",Ct=K+"labels.disjunction",St=K+"values.blankCells",Ot=K+"buttons.selectAll",Et=K+"buttons.clear",Rt=K+"buttons.ok",Tt=K+"buttons.cancel",Mt=K+"buttons.placeholder.search",It=K+"buttons.placeholder.value",xt=K+"buttons.placeholder.secondValue",Nt="CheckboxRenderer:",At=Nt+"checked",Ht=Nt+"unchecked"},"03529":function(t,e,n){"use strict";n.d(e,"a",(function(){return S}));n("7a89");var o=n("13e1"),i=n("87d6"),r=n("63d8"),s=n("5d7f"),a=n("ffec");function l(t,e,n){t.addEventListener(e,n,!1)}function c(t,e,n){t.removeEventListener(e,n,!1)}function h(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function u(t){const e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},n=t.body,o=t.createTextNode(""),i=t.createElement("span");let r;function s(){o.textContent=r.value,i.style.position="absolute",i.style.fontSize=h(r).fontSize,i.style.fontFamily=h(r).fontFamily,i.style.whiteSpace="pre",n.appendChild(i);const t=i.clientWidth+2;n.removeChild(i);const s=r.style;s.height=e.minHeight+"px",e.minWidth>t?s.width=e.minWidth+"px":t>e.maxWidth?s.width=e.maxWidth+"px":s.width=t+"px";const a=r.scrollHeight?r.scrollHeight-1:0;e.minHeight>a?s.height=e.minHeight+"px":e.maxHeight<a?(s.height=e.maxHeight+"px",s.overflowY="visible"):s.height=a+"px"}function a(){t.defaultView.setTimeout(s,0)}function u(t){if(t&&t.minHeight)if("inherit"===t.minHeight)e.minHeight=r.clientHeight;else{const n=parseInt(t.minHeight,10);isNaN(n)||(e.minHeight=n)}if(t&&t.maxHeight)if("inherit"===t.maxHeight)e.maxHeight=r.clientHeight;else{const n=parseInt(t.maxHeight,10);isNaN(n)||(e.maxHeight=n)}if(t&&t.minWidth)if("inherit"===t.minWidth)e.minWidth=r.clientWidth;else{const n=parseInt(t.minWidth,10);isNaN(n)||(e.minWidth=n)}if(t&&t.maxWidth)if("inherit"===t.maxWidth)e.maxWidth=r.clientWidth;else{const n=parseInt(t.maxWidth,10);isNaN(n)||(e.maxWidth=n)}i.firstChild||(i.className="autoResize",i.style.display="inline-block",i.appendChild(o))}function d(t,n){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];r=t,u(n),"TEXTAREA"===r.nodeName&&(r.style.resize="none",r.style.height=e.minHeight+"px",r.style.minWidth=e.minWidth+"px",r.style.maxWidth=e.maxWidth+"px",r.style.overflowY="hidden"),o&&(l(r,"input",s),l(r,"keydown",a)),s()}return{init:d,resize:s,unObserve(){c(r,"input",s),c(r,"keydown",a)}}}var d=n("7b9c");function f(t,e){const n=Object(s["getCaretPosition"])(e),o=e.value.split("\n");let i=n,r=0;for(let s=0;s<o.length;s++){const e=o[s];0!==s&&(r+=o[s-1].length+1);const a=r+e.length;if("home"===t?i=r:"end"===t&&(i=a),n<=a)break}Object(s["setCaretPosition"])(e,i)}var g=n("8828");function p(t,e,n){return(e=m(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function m(t){var e=b(t,"string");return"symbol"==typeof e?e:e+""}function b(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}const w="ht_editor_visible",v="ht_editor_hidden",y="textEditor",C="text";class S extends o["a"]{static get EDITOR_TYPE(){return C}constructor(t){super(t),p(this,"eventManager",new i["a"](this)),p(this,"autoResize",u(this.hot.rootDocument)),p(this,"TEXTAREA",void 0),p(this,"textareaStyle",void 0),p(this,"TEXTAREA_PARENT",void 0),p(this,"textareaParentStyle",void 0),p(this,"layerClass",void 0),this.eventManager=new i["a"](this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(t){this.TEXTAREA.value=t}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),Object(s["isThisHotChild"])(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(t,e,n,i,r,s){const a=this.state;if(super.prepare(t,e,n,i,r,s),!s.readOnly){this.refreshDimensions(!0);const{allowInvalid:t}=s;t&&!this.isOpened()&&(this.TEXTAREA.value=""),a===o["b"].FINISHED||this.isOpened()||this.hideEditableElement()}}beginEditing(t,e){this.state===o["b"].VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(t,e))}focus(){this.TEXTAREA.select(),Object(s["setCaretPosition"])(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:t}=this.hot;this.TEXTAREA=t.createElement("TEXTAREA"),Object(s["setAttribute"])(this.TEXTAREA,[["data-hot-input",""],Object(g["L"])(-1)]),Object(s["addClass"])(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=t.createElement("DIV"),Object(s["addClass"])(this.TEXTAREA_PARENT,"handsontableInputHolder"),Object(s["hasClass"])(this.TEXTAREA_PARENT,this.layerClass)&&Object(s["removeClass"])(this.TEXTAREA_PARENT,this.layerClass),Object(s["addClass"])(this.TEXTAREA_PARENT,v),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){Object(r["isEdge"])()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",Object(s["removeClass"])(this.TEXTAREA_PARENT,this.layerClass),Object(s["addClass"])(this.TEXTAREA_PARENT,v)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const t=this.TEXTAREA_PARENT.childNodes;let e=!1;Object(a["rangeEach"])(t.length-1,n=>{const o=t[n];if(Object(s["hasClass"])(o,"handsontableEditor"))return e=!0,!1}),Object(s["hasClass"])(this.TEXTAREA_PARENT,v)&&Object(s["removeClass"])(this.TEXTAREA_PARENT,v),e?(this.layerClass=w,Object(s["addClass"])(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),Object(s["addClass"])(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const t=this.hot.toPhysicalRow(this.row),e=this.hot.getSourceDataAtCell(t,this.col);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.state!==o["b"].EDITING&&!t)return;if(this.TD=this.getEditedCell(),!this.TD)return void(t||this.close());const{top:e,start:n,width:i,maxWidth:r,height:a,maxHeight:l}=this.getEditedCellRect();this.textareaParentStyle.top=e+"px",this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=n+"px",this.showEditableElement();const c=Object(s["getComputedStyle"])(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=c.fontSize,this.TEXTAREA.style.fontFamily=c.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;const h=Object(s["getComputedStyle"])(this.TEXTAREA),u=parseInt(h.paddingLeft,10)+parseInt(h.paddingRight,10),d=parseInt(h.paddingTop,10)+parseInt(h.paddingBottom,10),f=i-u,g=a-d,p=r-u,m=l-d;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(f,p),minHeight:Math.min(g,m),maxWidth:p,maxHeight:m},!0)}bindEvents(){Object(r["isIOS"])()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===o["b"].EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===o["b"].EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const t=this.hot.getShortcutManager(),e=t.getContext("editor"),n={runOnlyIf:()=>Object(d["isDefined"])(this.hot.getSelected()),group:y},o=()=>{this.hot.rootDocument.execCommand("insertText",!1,"\n")};e.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(o(),!1),runOnlyIf:t=>!this.hot.selection.isMultiple()&&!t.altKey},{keys:[["Meta","Enter"]],callback:()=>(o(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(o(),!1)},{keys:[["Home"]],callback:(t,e)=>{let[n]=e;f(n,this.TEXTAREA)}},{keys:[["End"]],callback:(t,e)=>{let[n]=e;f(n,this.TEXTAREA)}}],n)}unregisterShortcuts(){const t=this.hot.getShortcutManager(),e=t.getContext("editor");e.removeShortcutsByGroup(y)}}},"04c2":function(t,e,n){"use strict";var o=n("5438"),i=n("87ed").has,r=n("ff56"),s=n("0f98"),a=n("6f539"),l=n("bfa7"),c=n("142d");t.exports=function(t){var e=o(this),n=s(t);if(r(e)<=n.size)return!1!==a(e,(function(t){if(n.includes(t))return!1}),!0);var h=n.getIterator();return!1!==l(h,(function(t){if(i(e,t))return c(h,"normal",!1)}))}},"0716":function(t,e,n){"use strict";n("7a89");function o(t,e,n){i(t,e),e.set(t,n)}function i(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function r(t,e,n){return(e=s(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s(t){var e=a(t,"string");return"symbol"==typeof e?e:e+""}function a(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function l(t,e){return t.get(h(t,e))}function c(t,e,n){return t.set(h(t,e),n),n}function h(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var u=new WeakMap;class d{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];r(this,"row",null),r(this,"col",null),o(this,u,!1),c(u,this,n),"undefined"!==typeof t&&"undefined"!==typeof e&&(this.row=t,this.col=e)}isValid(t){const{countRows:e,countCols:n,countRowHeaders:o,countColHeaders:i}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...t};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col))&&(!(this.row<-i||this.col<-o)&&!(this.row>=e||this.col>=n))}isEqual(t){return t===this||this.row===t.row&&this.col===t.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return l(u,this)}isSouthEastOf(t){return this.row>=t.row&&(l(u,this)?this.col<=t.col:this.col>=t.col)}isNorthWestOf(t){return this.row<=t.row&&(l(u,this)?this.col>=t.col:this.col<=t.col)}isSouthWestOf(t){return this.row>=t.row&&(l(u,this)?this.col>=t.col:this.col<=t.col)}isNorthEastOf(t){return this.row<=t.row&&(l(u,this)?this.col<=t.col:this.col>=t.col)}normalize(){return this.row=null===this.row?this.row:Math.max(this.row,0),this.col=null===this.col?this.col:Math.max(this.col,0),this}assign(t){return Number.isInteger(null===t||void 0===t?void 0:t.row)&&(this.row=t.row),Number.isInteger(null===t||void 0===t?void 0:t.col)&&(this.col=t.col),t instanceof d&&c(u,this,t.isRtl()),this}clone(){return new d(this.row,this.col,l(u,this))}toObject(){return{row:this.row,col:this.col}}}e["a"]=d},"0794":function(t,e,n){"use strict";t.exports=function(t){return{iterator:t,next:t.next,done:!1}}},"088f":function(t,e,n){"use strict";var o=n("8793"),i=String,r=TypeError;t.exports=function(t){if(o(t))return t;throw new r(i(t)+" is not an object")}},"09d4":function(t,e,n){"use strict";var o=n("5438"),i=n("87ed").has,r=n("ff56"),s=n("0f98"),a=n("bfa7"),l=n("142d");t.exports=function(t){var e=o(this),n=s(t);if(r(e)<n.size)return!1;var c=n.getIterator();return!1!==a(c,(function(t){if(!i(e,t))return l(c,"normal",!1)}))}},"0a73":function(t,e,n){"use strict";var o=n("d128"),i=n("69ba"),r=Function.prototype,s=o&&Object.getOwnPropertyDescriptor,a=i(r,"name"),l=a&&"something"===function(){}.name,c=a&&(!o||o&&s(r,"name").configurable);t.exports={EXISTS:a,PROPER:l,CONFIGURABLE:c}},"0ad8":function(t,e,n){"use strict";var o,i=n("088f"),r=n("fdba"),s=n("e1c6"),a=n("861e"),l=n("f808"),c=n("2179"),h=n("ab25"),u=">",d="<",f="prototype",g="script",p=h("IE_PROTO"),m=function(){},b=function(t){return d+g+u+t+d+"/"+g+u},w=function(t){t.write(b("")),t.close();var e=t.parentWindow.Object;return t=null,e},v=function(){var t,e=c("iframe"),n="java"+g+":";return e.style.display="none",l.appendChild(e),e.src=String(n),t=e.contentWindow.document,t.open(),t.write(b("document.F=Object")),t.close(),t.F},y=function(){try{o=new ActiveXObject("htmlfile")}catch(e){}y="undefined"!=typeof document?document.domain&&o?w(o):v():w(o);var t=s.length;while(t--)delete y[f][s[t]];return y()};a[p]=!0,t.exports=Object.create||function(t,e){var n;return null!==t?(m[f]=i(t),n=new m,m[f]=null,n[p]=t):n=y(),void 0===e?n:r.f(n,e)}},"0c0f":function(t,e,n){"use strict";var o=n("b343"),i=n("73fa"),r=/#|\.prototype\./,s=function(t,e){var n=l[a(t)];return n===h||n!==c&&(i(e)?o(e):!!e)},a=s.normalize=function(t){return String(t).replace(r,".").toLowerCase()},l=s.data={},c=s.NATIVE="N",h=s.POLYFILL="P";t.exports=s},"0c5c":function(t,e,n){"use strict";var o=n("5438"),i=n("87ed"),r=n("b52d"),s=n("ff56"),a=n("0f98"),l=n("6f539"),c=n("bfa7"),h=i.has,u=i.remove;t.exports=function(t){var e=o(this),n=a(t),i=r(e);return s(e)<=n.size?l(e,(function(t){n.includes(t)&&u(i,t)})):c(n.getIterator(),(function(t){h(e,t)&&u(i,t)})),i}},"0e87":function(t,e,n){"use strict";var o=n("73fa"),i=n("a60d"),r=n("b384"),s=n("3df8");t.exports=function(t,e,n,a){a||(a={});var l=a.enumerable,c=void 0!==a.name?a.name:e;if(o(n)&&r(n,c,a),a.global)l?t[e]=n:s(e,n);else{try{a.unsafe?t[e]&&(l=!0):delete t[e]}catch(h){}l?t[e]=n:i.f(t,e,{value:n,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return t}},"0eec":function(t,e,n){"use strict";var o=n("ac4f"),i=n("54ad"),r=n("d2e4").clear;o({global:!0,bind:!0,enumerable:!0,forced:i.clearImmediate!==r},{clearImmediate:r})},"0f98":function(t,e,n){"use strict";var o=n("2aac"),i=n("088f"),r=n("7b69"),s=n("9e75"),a=n("0794"),l="Invalid size",c=RangeError,h=TypeError,u=Math.max,d=function(t,e){this.set=t,this.size=u(e,0),this.has=o(t.has),this.keys=o(t.keys)};d.prototype={getIterator:function(){return a(i(r(this.keys,this.set)))},includes:function(t){return r(this.has,this.set,t)}},t.exports=function(t){i(t);var e=+t.size;if(e!==e)throw new h(l);var n=s(e);if(n<0)throw new c(l);return new d(t,n)}},1004:function(t,e,n){"use strict";n("7a89"),n("d06e"),n("4cd6");var o=n("81ea"),i=n("351d"),r=n("29b0"),s=n("bd5e"),a=n("67a8"),l=n("97b9");function c(t,e,n){return(e=h(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function h(t){var e=u(t,"string");return"symbol"==typeof e?e:e+""}function u(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}const d=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],f=a["a"]`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`,g=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),p=new Map([[]]),m=new WeakMap;class b{static getSingleton(){return v()}constructor(){c(this,"globalBucket",void 0),this.globalBucket=this.createEmptyBucket()}createEmptyBucket(){const t=Object.create(null);return Object(o["arrayEach"])(d,e=>{t[e]=[],this.initOrderMap(t,e)}),t}getBucket(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return t?(t.pluginHookBucket||(t.pluginHookBucket=this.createEmptyBucket()),t.pluginHookBucket):this.globalBucket}add(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;if(Array.isArray(e))Object(o["arrayEach"])(e,e=>this.add(t,e,n));else{g.has(t)&&Object(s["b"])(Object(r["substitute"])(f,{hookName:t,removedInVersion:g.get(t)})),p.has(t)&&Object(s["b"])(p.get(t));const a=this.getBucket(n);if("undefined"===typeof a[t]&&(this.register(t),a[t]=[],this.initOrderMap(a,t)),e.skip=!1,-1===a[t].indexOf(e)){let n=!1;e.initialHook&&Object(o["arrayEach"])(a[t],(o,i)=>{if(o.initialHook)return a[t][i]=e,n=!0,!1}),n||a[t].push(e)}this.setCallbackOrderIndex(a,t,e,i),this.orderBucketByOrderIndex(a,t)}return this}once(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;Array.isArray(e)?Object(o["arrayEach"])(e,e=>this.once(t,e,n)):(e.runOnce=!0,this.add(t,e,n,i))}remove(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const o=this.getBucket(n);return"undefined"!==typeof o[t]&&o[t].indexOf(e)>=0&&(e.skip=!0,!0)}has(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=this.getBucket(e);return!(void 0===n[t]||!n[t].length)}run(t,e,n,o,i,r,s,a){{const c=this.globalBucket[e],h=c?c.length:0;let u=0;if(h)while(u<h){if(!c[u]||c[u].skip){u+=1;continue}const h=Object(l["fastCall"])(c[u],t,n,o,i,r,s,a);void 0!==h&&(n=h),c[u]&&c[u].runOnce&&this.remove(e,c[u]),u+=1}}{const c=this.getBucket(t)[e],h=c?c.length:0;let u=0;if(h)while(u<h){if(!c[u]||c[u].skip){u+=1;continue}const h=Object(l["fastCall"])(c[u],t,n,o,i,r,s,a);void 0!==h&&(n=h),c[u]&&c[u].runOnce&&this.remove(e,c[u],t),u+=1}}return n}destroy(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Object(i["objectEach"])(this.getBucket(t),(t,e,n)=>n[e].length=0)}register(t){this.isRegistered(t)||d.push(t)}deregister(t){this.isRegistered(t)&&d.splice(d.indexOf(t),1)}isDeprecated(t){return p.has(t)||g.has(t)}isRegistered(t){return d.indexOf(t)>=0}getRegistered(){return d}setCallbackOrderIndex(t,e,n,o){const i=Number.isInteger(o)?o:0,r=this.getCallbackOrderMap(t,e);r.set(i,[...r.get(i)||[],n])}orderBucketByOrderIndex(t,e){const n=this.getCallbackOrderMap(t,e);void 0===n||0===n.size||1===n.size&&n.has(0)||(t[e]=[...n].sort((t,e)=>t[0]-e[0]).flatMap(t=>{let[,e]=t;return e}))}initOrderMap(t,e){m.has(t)||m.set(t,[]),m.get(t)[e]=new Map}getCallbackOrderMap(t,e){return m.get(t)[e]}}const w=new b;function v(){return w}e["a"]=b},1096:function(t,e,n){"use strict";n.d(e,"a",(function(){return h}));n("7a89"),n("d06e");var o=n("ffec"),i=n("351d"),r=n("97b9"),s=n("7ae0");function a(t,e,n){return(e=l(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function l(t){var e=c(t,"string");return"symbol"==typeof e?e:e+""}function c(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class h{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;a(this,"indexedValues",[]),a(this,"initValueOrFn",void 0),this.initValueOrFn=t}getValues(){return this.indexedValues}getValueAtIndex(t){const e=this.indexedValues;if(t<e.length)return e[t]}setValues(t){this.indexedValues=t.slice(),this.runLocalHooks("change")}setValueAtIndex(t,e){return t<this.indexedValues.length&&(this.indexedValues[t]=e,this.runLocalHooks("change"),!0)}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,Object(r["isFunction"])(this.initValueOrFn)?Object(o["rangeEach"])(t-1,t=>this.indexedValues.push(this.initValueOrFn(t))):Object(o["rangeEach"])(t-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(t){return this.setDefaultValues(t),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}Object(i["mixin"])(h,s["a"])},"11b3":function(t,e,n){"use strict";var o=n("8793"),i=n("939b"),r=n("80dd"),s=r("match");t.exports=function(t){var e;return o(t)&&(void 0!==(e=t[s])?!!e:"RegExp"===i(t))}},"12e9":function(t,e,n){"use strict";var o=n("80dd"),i=o("toStringTag"),r={};r[i]="z",t.exports="[object z]"===String(r)},"13e1":function(t,e,n){"use strict";n.d(e,"b",(function(){return g})),n.d(e,"a",(function(){return p}));n("7a89");var o=n("7b9c"),i=n("351d"),r=(n("d06e"),n("81ea"));const s="hooksRefRegisterer",a={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){Object(r["arrayEach"])(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){Object(i["objectEach"])(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};Object(i["defineGetter"])(a,"MIXIN_NAME",s,{writable:!1,enumerable:!1});var l=a,c=n("5d7f");function h(t,e,n){return(e=u(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function u(t){var e=d(t,"string");return"symbol"==typeof e?e:e+""}function d(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}const f="base",g=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class p{static get EDITOR_TYPE(){return f}constructor(t){h(this,"hot",void 0),h(this,"state",g.VIRGIN),h(this,"_opened",!1),h(this,"_fullEditMode",!1),h(this,"_closeCallback",null),h(this,"TD",null),h(this,"row",null),h(this,"col",null),h(this,"prop",null),h(this,"originalValue",null),h(this,"cellProperties",null),this.hot=t,this.init()}_fireCallbacks(t){this._closeCallback&&(this._closeCallback(t),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(t,e,n,o,i,r){this.TD=o,this.row=t,this.col=e,this.prop=n,this.originalValue=i,this.cellProperties=r,this.state=this.isOpened()?this.state:g.VIRGIN}extend(){return class extends this.constructor{}}saveValue(t,e){let n,o,i,r;if(e){const t=this.hot.getSelectedLast();n=Math.max(Math.min(t[0],t[2]),0),o=Math.max(Math.min(t[1],t[3]),0),i=Math.max(t[0],t[2]),r=Math.max(t[1],t[3])}else[n,o,i,r]=[this.row,this.col,null,null];const s=this.hot.runHooks("modifyGetCellCoords",n,o);Array.isArray(s)&&([n,o]=s),this.hot.populateFromArray(n,o,t,i,r,"edit")}beginEditing(t,e){if(this.state!==g.VIRGIN)return;const n=this.hot,i=n.rowIndexMapper.getRenderableFromVisualIndex(this.row),r=n.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(n.view.scrollViewport(n._createCellCoords(i,r)),this.state=g.EDITING,this.isInFullEditMode()){const e="string"===typeof t?t:Object(o["stringify"])(this.originalValue);this.setValue(e)}this.open(e),this._opened=!0,this.focus(),n.view.render(),n.runHooks("afterBeginEditing",this.row,this.col)}finishEditing(t,e,n){let o;if(n){const t=this._closeCallback;this._closeCallback=e=>{t&&t(e),n(e),this.hot.view.render()}}if(!this.isWaiting())if(this.state!==g.VIRGIN){if(this.state===g.EDITING){if(t)return this.cancelChanges(),void this.hot.view.render();const n=this.getValue();o=this.cellProperties.trimWhitespace?[["string"===typeof n?String.prototype.trim.call(n||""):n]]:[[n]],this.state=g.WAITING,this.saveValue(o,e),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",t=>{this.state=g.FINISHED,this.discardEditor(t)}):(this.state=g.FINISHED,this.discardEditor(!0))}}else this.hot._registerTimeout(()=>{this._fireCallbacks(!0)})}cancelChanges(){this.state=g.FINISHED,this.discardEditor()}discardEditor(t){if(this.state===g.FINISHED)if(!1===t&&!0!==this.cellProperties.allowInvalid)this.hot.selectCell(this.row,this.col),this.focus(),this.state=g.EDITING,this._fireCallbacks(!1);else{this.close(),this._opened=!1,this._fullEditMode=!1,this.state=g.VIRGIN,this._fireCallbacks(!0);const t=this.hot.getShortcutManager();t.setActiveContextName("grid")}}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===g.WAITING}getEditedCellRect(){var t;const e=this.getEditedCell();if(!e)return;const{wtOverlays:n,wtViewport:o}=this.hot.view._wt,i=this.hot.rootWindow,r=Object(c["offset"])(e),s=Object(c["outerWidth"])(e),a=Object(c["offset"])(this.hot.rootElement),l=Object(c["outerWidth"])(this.hot.rootElement),h=n.topOverlay.holder,u=n.inlineStartOverlay.holder,d=h!==i?h.scrollTop:0,f=u!==i?u.scrollLeft:0,g=i.innerWidth-a.left-l,{wtTable:p}=null!==(t=n.getParentOverlay(e))&&void 0!==t?t:this.hot.view._wt,m=p.name,b=["master","inline_start"].includes(m)?d:0,w=["master","top","bottom"].includes(m)?f:0,v=r.top===a.top?0:1;let y=r.top-a.top-v-b,C=0;C=this.hot.isRtl()?i.innerWidth-r.left-s-g-1+w:r.left-a.left-1-w,["top","top_inline_start_corner"].includes(m)&&(y+=n.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(m)&&(C+=Math.abs(n.inlineStartOverlay.getOverlayOffset()));const S=this.hot.hasColHeaders(),O=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),E=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),R=this.hot.rowIndexMapper.getRenderableIndexesLength(),T=R-this.hot.view._wt.getSetting("fixedRowsBottom");(S&&O<=0||O===T)&&(y+=1),E<=0&&(C+=1);const M=o.rowsRenderCalculator.startPosition,I=o.columnsRenderCalculator.startPosition,x=Math.abs(n.inlineStartOverlay.getScrollPosition()),N=n.topOverlay.getScrollPosition(),A=Object(c["getScrollbarWidth"])(this.hot.rootDocument);let H=e.offsetTop;if(["inline_start","master"].includes(m)&&(H+=M-N),["bottom","bottom_inline_start_corner"].includes(m)){const{wtViewport:t,wtTable:e}=n.bottomOverlay.clone;H+=t.getWorkspaceHeight()-e.getHeight()-A}let j=e.offsetLeft;this.hot.isRtl()?(j=j>=0?p.getWidth()-e.offsetLeft:Math.abs(j),j+=I-x-s):["top","master","bottom"].includes(m)&&(j+=I-x);const _=Object(c["getComputedStyle"])(this.TD,this.hot.rootWindow),k=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",P=parseInt(_[k],10)>0?0:1,D=parseInt(_.borderTopWidth,10)>0?0:1,L=Object(c["outerWidth"])(e)+P,F=Object(c["outerHeight"])(e)+D,V=Object(c["hasVerticalScrollbar"])(h)?A:0,W=Object(c["hasHorizontalScrollbar"])(u)?A:0,B=this.hot.view.maximumVisibleElementWidth(j)-V+P,U=Math.max(this.hot.view.maximumVisibleElementHeight(H)-W+D,23);return{top:y,start:C,height:F,maxHeight:U,width:L,maxWidth:B}}getEditedCellsLayerClass(){const t=this.checkEditorSection();switch(t){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const t=this.hot.countRows();let e="";return this.row<this.hot.getSettings().fixedRowsTop?e=this.col<this.hot.getSettings().fixedColumnsStart?"top-inline-start-corner":"top":this.hot.getSettings().fixedRowsBottom&&this.row>=t-this.hot.getSettings().fixedRowsBottom?e=this.col<this.hot.getSettings().fixedColumnsStart?"bottom-inline-start-corner":"bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(e="inline-start"),e}}Object(i["mixin"])(p,l)},"142d":function(t,e,n){"use strict";var o=n("7b69"),i=n("088f"),r=n("2471");t.exports=function(t,e,n){var s,a;i(t);try{if(s=r(t,"return"),!s){if("throw"===e)throw n;return n}s=o(s,t)}catch(l){a=!0,s=l}if("throw"===e)throw n;if(a)throw s;return i(s),n}},1587:function(t,e,n){"use strict";var o=n("ac4f"),i=n("7204"),r=n("88c5");o({target:"Set",proto:!0,real:!0,forced:!r("symmetricDifference")},{symmetricDifference:i})},"169f":function(t,e,n){"use strict";n.d(e,"d",(function(){return h})),n.d(e,"b",(function(){return c})),n.d(e,"c",(function(){return s})),n.d(e,"a",(function(){return a}));n("7a89");var o=n("9acd");const{register:i,getItem:r,hasItem:s,getNames:a,getValues:l}=Object(o["a"])("validators");function c(t){if("function"===typeof t)return t;if(!s(t))throw Error(`No registered validator found under "${t}" name`);return r(t)}function h(t,e){"string"!==typeof t&&(e=t,t=e.VALIDATOR_TYPE),i(t,e)}},"170e":function(t,e,n){"use strict";var o=n("0227"),i=n("69ba"),r=n("2d2d"),s=n("1e92"),a=n("7c2b"),l=n("1d07"),c=n("2c35"),h=n("01b5"),u=n("a45f"),d=n("9718"),f=n("2daa"),g=n("d128"),p=n("d62b");t.exports=function(t,e,n,m){var b="stackTraceLimit",w=m?2:1,v=t.split("."),y=v[v.length-1],C=o.apply(null,v);if(C){var S=C.prototype;if(!p&&i(S,"cause")&&delete S.cause,!n)return C;var O=o("Error"),E=e((function(t,e){var n=u(m?e:t,void 0),o=m?new C(t):new C;return void 0!==n&&r(o,"message",n),f(o,E,o.stack,2),this&&s(S,this)&&h(o,this,E),arguments.length>w&&d(o,arguments[w]),o}));if(E.prototype=S,"Error"!==y?a?a(E,O):l(E,O,{name:!0}):g&&b in C&&(c(E,C,b),c(E,C,"prepareStackTrace")),l(E,C),!p)try{S.name!==y&&r(S,"name",y),S.constructor=E}catch(R){}return E}}},"1b1a":function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var o=n("1096"),i=n("3d57"),r=n("a73f");class s extends o["a"]{constructor(){super(t=>t)}insert(t,e){const n=Object(r["b"])(this.indexedValues,e);this.indexedValues=Object(i["a"])(n,t,e),super.insert(t,e)}remove(t){const e=Object(i["b"])(this.indexedValues,t);this.indexedValues=Object(r["a"])(e,t),super.remove(t)}}},"1caf":function(t,e,n){"use strict";t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},"1d07":function(t,e,n){"use strict";var o=n("69ba"),i=n("fb46"),r=n("485c6"),s=n("a60d");t.exports=function(t,e,n){for(var a=i(e),l=s.f,c=r.f,h=0;h<a.length;h++){var u=a[h];o(t,u)||n&&o(n,u)||l(t,u,c(e,u))}}},"1e8c":function(t,e,n){"use strict";n.d(e,"a",(function(){return et}));var o=n("c4fa");const i={name:"editorCloseAndSave",callback(t){const e=t._getEditorManager();e.closeEditorAndSaveChanges()}};var r=n("13e1");const s={name:"editorCloseAndSaveByArrowKeys",callback(t,e,n){const o=t._getEditorManager(),i=o.getActiveEditor();i.isInFullEditMode()&&i.state===r["b"].EDITING||(o.closeEditorAndSaveChanges(),t.getSelected()&&(n.includes("arrowdown")?t.selection.transformStart(1,0):n.includes("arrowup")?t.selection.transformStart(-1,0):n.includes("arrowleft")?t.selection.transformStart(0,-1*t.getDirectionFactor()):n.includes("arrowright")&&t.selection.transformStart(0,t.getDirectionFactor())),e.preventDefault())}},a={name:"editorCloseAndSaveByEnter",callback(t,e){const n=t._getEditorManager();n.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),n.moveSelectionAfterEnter(e)}},l={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},c={name:"editorFastOpen",callback(t,e){const{highlight:n}=t.getSelectedRangeLast();n.isHeader()||t._getEditorManager().openEditor(null,e,!0)}};var h=n("de3b");const u={name:"editorOpen",callback(t,e,n){const o=t._getEditorManager(),i=t.getSelectedRangeLast(),{highlight:r}=i;if(t.selection.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){const o=t.getSettings(),i="function"===typeof o.enterMoves?o.enterMoves(e):o.enterMoves;n.includes("shift")?t.selection.transformFocus(-i.row,-i.col):t.selection.transformFocus(i.row,i.col)}else r.isHeader()||(t.getSettings().enterBeginsEditing?o.cellProperties.readOnly?o.moveSelectionAfterEnter(e):o.openEditor(null,e,!0):o.moveSelectionAfterEnter(e),Object(h["stopImmediatePropagation"])(e))}};function d(){return[i,s,a,l,c,u]}const f={name:"extendCellsSelectionDown",callback(t){const{highlight:e}=t.getSelectedRangeLast();t.selection.isSelectedByColumnHeader()||t.selection.isSelectedByCorner()||!(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())||t.selection.transformEnd(1,0)}},g={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),n=Math.min(e.row+t.countVisibleRows(),t.countRows()-1),o=t.rowIndexMapper.getNearestNotHiddenIndex(n,-1);if(null!==o){const n=t._createCellCoords(o,e.col),i=e.row-t.view.getFirstFullyVisibleRow(),r=Math.min(n.row-i,t.countRows()-1);t.selection.setRangeEnd(n),t.scrollViewportTo({row:r,verticalSnap:"top",horizontalSnap:"start"})}}},p={name:"extendCellsSelectionLeft",callback(t){const{highlight:e}=t.getSelectedRangeLast();t.selection.isSelectedByRowHeader()||t.selection.isSelectedByCorner()||!(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())||t.selection.transformEnd(0,-1*t.getDirectionFactor())}},m={name:"extendCellsSelectionRight",callback(t){const{highlight:e}=t.getSelectedRangeLast();t.selection.isSelectedByRowHeader()||t.selection.isSelectedByCorner()||!(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())||t.selection.transformEnd(0,t.getDirectionFactor())}},b={name:"extendCellsSelectionToColumns",callback(t){const{highlight:e,from:n,to:o}=t.getSelectedRangeLast();t.selection.isSelectedByRowHeader()?t.selection.selectAll(!0,!0):t.selectColumns(n.col,o.col,e)}},w={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:o,from:i,to:r}=t.getSelectedRangeLast(),s=o.isHeader()&&t.selection.isSelectedByRowHeader();if(o.isCell()||s){const a=n.getNearestNotHiddenIndex(t.countRows()-1,-1),l=i.clone();l.row=o.row,e.setRangeStart(l,void 0,!1,o.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,r.col))}}},v={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:o,from:i,to:r}=t.getSelectedRangeLast();if(!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&o.isCell()){const s=n.getNearestNotHiddenIndex(t.countCols()-1,-1),a=i.clone();a.col=o.col,e.setRangeStart(a,void 0,!1,o.clone()),e.setRangeEnd(t._createCellCoords(r.row,s))}}},y={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:o,from:i,to:r}=t.getSelectedRangeLast();if(!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&o.isCell()){const s=parseInt(t.getSettings().fixedColumnsStart,10),a=n.getNearestNotHiddenIndex(s,1),l=i.clone();l.col=o.col,e.setRangeStart(l,void 0,!1,o.clone()),e.setRangeEnd(t._createCellCoords(r.row,a))}}},C={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:o,from:i,to:r}=t.getSelectedRangeLast(),s=o.isHeader()&&t.selection.isSelectedByColumnHeader();if(o.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),l=i.clone();l.col=o.col,e.setRangeStart(l,void 0,!1,o.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(r.row,a))}}},S={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:o,from:i,to:r}=t.getSelectedRangeLast(),s=o.isHeader()&&t.selection.isSelectedByColumnHeader();if(o.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),l=i.clone();l.col=o.col,e.setRangeStart(l,void 0,!1,o.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(r.row,a))}}},O={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:o,from:i,to:r}=t.getSelectedRangeLast(),s=o.isHeader()&&t.selection.isSelectedByRowHeader();if(o.isCell()||s){const a=n.getNearestNotHiddenIndex(0,1),l=i.clone();l.row=o.row,e.setRangeStart(l,void 0,!1,o.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,r.col))}}},E={name:"extendCellsSelectionToRows",callback(t){const{highlight:e,from:n,to:o}=t.getSelectedRangeLast();t.selection.isSelectedByColumnHeader()?t.selection.selectAll(!0,!0):t.selectRows(n.row,o.row,e)}},R={name:"extendCellsSelectionUp",callback(t){const{highlight:e}=t.getSelectedRangeLast();t.selection.isSelectedByColumnHeader()||t.selection.isSelectedByCorner()||!(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())||t.selection.transformEnd(-1,0)}},T={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),n=Math.max(e.row-t.countVisibleRows(),0),o=t.rowIndexMapper.getNearestNotHiddenIndex(n,1);if(null!==o){const n=t._createCellCoords(o,e.col),i=e.row-t.view.getFirstFullyVisibleRow(),r=Math.max(n.row-i,0);t.selection.setRangeEnd(n),t.scrollViewportTo({row:r,verticalSnap:"top",horizontalSnap:"start"})}}};function M(){return[f,g,p,m,b,w,v,y,C,S,O,E,R,T]}const I={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.transformStart(1,0)}},x={name:"moveCellSelectionDownByViewportHeight",callback(t){const{navigableHeaders:e}=t.getSettings(),n=e?t.countColHeaders():0,{row:o}=t.getSelectedRangeLast().highlight;let i=t.countVisibleRows()+n;o===t.countRows()-1?i=1:o+i>t.countRows()&&(i=t.countRows()-o-1),t.selection.transformStart(i,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},N={name:"moveCellSelectionInlineEnd",callback(t,e){const n=t.getSettings(),o=t.getSelectedRangeLast(),i="function"===typeof n.tabMoves?n.tabMoves(e):n.tabMoves;t.selection.isMultiple()&&!o.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?t.selection.transformFocus(-i.row,-i.col):t.selection.transformStart(-i.row,-i.col)}},A={name:"moveCellSelectionInlineStart",callback(t,e){const n=t.getSettings(),o=t.getSelectedRangeLast(),i="function"===typeof n.tabMoves?n.tabMoves(e):n.tabMoves;t.selection.isMultiple()&&!o.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?t.selection.transformFocus(i.row,i.col):t.selection.transformStart(i.row,i.col)}},H={name:"moveCellSelectionLeft",callback(t){t.selection.transformStart(0,-1*t.getDirectionFactor())}},j={name:"moveCellSelectionRight",callback(t){t.selection.transformStart(0,t.getDirectionFactor())}},_={name:"moveCellSelectionToMostBottom",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);null===n&&(n=-1),t.selection.setRangeStart(t._createCellCoords(n,e))}},k={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:o}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),r=n.getNearestNotHiddenIndex(t.countRows()-i-1,-1),s=o.getNearestNotHiddenIndex(t.countCols()-1,-1);e.setRangeStart(t._createCellCoords(r,s))}},P={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t;e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},D={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,o=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeLast().highlight.row,r=n.getNearestNotHiddenIndex(o,1);e.setRangeStart(t._createCellCoords(i,r))}},L={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,o=t.getSelectedRangeLast().highlight.row;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);null===i&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.setRangeStart(t._createCellCoords(o,i))}},F={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{row:o}=t.getSelectedRangeLast().highlight;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);null===i&&(i=t.isRtl()?-t.countRowHeaders():-1),e.setRangeStart(t._createCellCoords(o,i))}},V={name:"moveCellSelectionToMostTop",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);null===n&&(n=-t.countColHeaders()),t.selection.setRangeStart(t._createCellCoords(n,e))}},W={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:o}=t,i=parseInt(t.getSettings().fixedRowsTop,10),r=parseInt(t.getSettings().fixedColumnsStart,10),s=n.getNearestNotHiddenIndex(i,1),a=o.getNearestNotHiddenIndex(r,1);e.setRangeStart(t._createCellCoords(s,a))}},B={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.transformStart(-1,0)}},U={name:"moveCellSelectionUpByViewportHight",callback(t){const{navigableHeaders:e}=t.getSettings(),n=e?t.countColHeaders():0,{row:o}=t.getSelectedRangeLast().highlight;let i=-(t.countVisibleRows()+n);o===-n?i=-1:o+i<n&&(i=-(o+n)),t.selection.transformStart(i,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function z(){return[I,x,N,A,H,j,_,k,P,D,L,F,V,W,B,U]}const G={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},Y={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),n=t.view.getFirstFullyVisibleRow()-1,o=t.view.getFirstFullyVisibleColumn()-1,i=t.view.getLastFullyVisibleRow()+1,r=t.view.getLastFullyVisibleColumn()+1,s=t._createCellCoords(n,o),a=t._createCellCoords(i,r),l=t._createCellRange(s,s,a);if(!l.includes(e)&&(e.row>=0||e.col>=0)){const n={};if(e.col>=0){const o=Math.floor(t.countVisibleCols()/2);n.col=Math.max(e.col-o,0)}if(e.row>=0){const o=Math.floor(t.countVisibleRows()/2);n.row=Math.max(e.row-o,0)}t.scrollViewportTo({...n,verticalSnap:"top",horizontalSnap:"start"})}}},X={name:"selectAllCells",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}},$={name:"selectAllCellsAndHeaders",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!1})}},K={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:n,col:o}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(n,o),r=new Map;for(let s=0;s<e.length;s++)e[s].forAll((e,s)=>{if(e>=0&&s>=0&&(e!==n||s!==o)){const{readOnly:n}=t.getCellMeta(e,s);n||r.set(`${e}x${s}`,[e,s,i])}});t.setDataAtCell(Array.from(r.values()))}},q=[...d(),...M(),...z(),G,Y,X,$,K];function Q(t){const e={};return q.forEach(n=>{let{name:o,callback:i}=n;e[o]=function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return i(t,...n)}}),e}function J(t){const e=t.getShortcutManager().addContext("editor"),n=Q(t),i={group:o["a"]};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(t,e)=>n.editorCloseAndSaveByEnter(t,e)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(t,e)=>n.editorCloseAndSaveByEnter(t,e)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:(t,e)=>n.editorCloseAndSave(t,e)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(t,e)=>n.editorCloseAndSaveByArrowKeys(t,e)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>n.editorCloseWithoutSaving()}],i)}var Z=n("7b9c");function tt(t){const e=t.getShortcutManager().addContext("grid"),n=Q(t),i={runOnlyIf:()=>{const{navigableHeaders:e}=t.getSettings();return Object(Z["isDefined"])(t.getSelected())&&(e||!e&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:o["b"]};e.addShortcuts([{keys:[["F2"]],callback:t=>n.editorFastOpen(t)},{keys:[["Enter"],["Enter","Shift"]],callback:(t,e)=>n.editorOpen(t,e)},{keys:[["Backspace"],["Delete"]],callback:()=>n.emptySelectedCells()}],{group:o["a"],runOnlyIf:()=>Object(Z["isDefined"])(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>n.selectAllCells(),runOnlyIf:()=>{var e;return!(null!==(e=t.getSelectedRangeLast())&&void 0!==e&&e.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var e;return null===(e=t.getSelectedRangeLast())||void 0===e?void 0:e.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>n.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>n.populateSelectedCellsData(),runOnlyIf:()=>{var e,n;return!(null!==(e=t.getSelectedRangeLast())&&void 0!==e&&e.highlight.isHeader())&&(null===(n=t.getSelectedRangeLast())||void 0===n?void 0:n.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>n.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>n.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>n.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>n.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>n.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>n.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>n.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>n.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>n.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>n.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>n.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>n.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>n.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:t=>n.moveCellSelectionInlineStart(t)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:t=>n.moveCellSelectionInlineEnd(t)},{keys:[["Control/Meta","Backspace"]],callback:()=>n.scrollToFocusedCell()}],i)}function et(t){[tt,J].forEach(e=>e(t))}},"1e92":function(t,e,n){"use strict";var o=n("fd18");t.exports=o({}.isPrototypeOf)},"1fc8":function(t,e,n){"use strict";var o=n("5438"),i=n("87ed"),r=n("ff56"),s=n("0f98"),a=n("6f539"),l=n("bfa7"),c=i.Set,h=i.add,u=i.has;t.exports=function(t){var e=o(this),n=s(t),i=new c;return r(e)>n.size?l(n.getIterator(),(function(t){u(e,t)&&h(i,t)})):a(e,(function(t){n.includes(t)&&h(i,t)})),i}},2179:function(t,e,n){"use strict";var o=n("54ad"),i=n("8793"),r=o.document,s=i(r)&&i(r.createElement);t.exports=function(t){return s?r.createElement(t):{}}},2349:function(t,e,n){"use strict";var o=n("d128"),i=n("bdfe"),r=TypeError,s=Object.getOwnPropertyDescriptor,a=o&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}();t.exports=a?function(t,e){if(i(t)&&!s(t,"length").writable)throw new r("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e}},2408:function(t,e,n){"use strict";var o=n("e156"),i=String;t.exports=function(t){if("Symbol"===o(t))throw new TypeError("Cannot convert a Symbol value to a string");return i(t)}},2471:function(t,e,n){"use strict";var o=n("2aac"),i=n("022b");t.exports=function(t,e){var n=t[e];return i(n)?void 0:o(n)}},"24b5":function(t,e,n){"use strict";n.d(e,"b",(function(){return C})),n.d(e,"a",(function(){return S})),n.d(e,"c",(function(){return O})),n.d(e,"d",(function(){return E}));n("7a89");var o=n("29b0"),i=n("ffec"),r=n("97b9");const s="asc",a="desc",l=new Map([[s,[-1,1]],[a,[1,-1]]]),c=t=>`The priority '${t}' is already declared in a map.`,h=t=>`The priority '${t}' is not a number.`;function u(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=new Map;function o(o,r){if(!Object(i["isNumeric"])(o))throw new Error(e(o));if(n.has(o))throw new Error(t(o));n.set(o,r)}function a(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s;const[e,o]=l.get(t)||l.get(s);return[...n].sort((t,n)=>t[0]<n[0]?e:o).map(t=>t[1])}return t=Object(r["isFunction"])(t)?t:c,e=Object(r["isFunction"])(e)?e:h,{addItem:o,getItems:a}}var d=n("6906");n("38b3"),n("f448"),n("66e1"),n("2582"),n("f86b"),n("1587"),n("c5d7");const f=t=>`'${t}' value is already declared in a unique set.`;function g(){let{errorItemExists:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=new Set;function n(n){if(e.has(n))throw new Error(t(n));e.add(n)}function o(){return[...e]}function i(){e.clear()}return t=Object(r["isFunction"])(t)?t:f,{addItem:n,clear:i,getItems:o}}const p=t=>`There is already registered "${t}" plugin.`,m=t=>`There is already registered plugin on priority "${t}".`,b=t=>`The priority "${t}" is not a number.`,w=u({errorPriorityExists:m,errorPriorityNaN:b}),v=g({errorItemExists:p}),y=Object(d["a"])({errorIdExists:p});function C(){return[...w.getItems(),...v.getItems()]}function S(t){const e=Object(o["toUpperCaseFirst"])(t);return y.getItem(e)}function O(t){return!!S(t)}function E(t,e,n){[t,e,n]=T(t,e,n),void 0===S(t)&&R(t,e,n)}function R(t,e,n){const i=Object(o["toUpperCaseFirst"])(t);if(y.hasItem(i))throw new Error(p(i));void 0===n?v.addItem(i):w.addItem(n,i),y.addItem(i,e)}function T(t,e,n){return"function"===typeof t&&(e=t,t=e.PLUGIN_KEY,n=e.PLUGIN_PRIORITY),[t,e,n]}},"24b9":function(t,e,n){"use strict";var o=n("f41c");o("flat")},"24d5":function(t,e,n){"use strict";var o=n("84d8"),i=n("4c54");t.exports=function(t){var e=o(t,"string");return i(e)?e:e+""}},2582:function(t,e,n){"use strict";var o=n("ac4f"),i=n("930d"),r=n("88c5");o({target:"Set",proto:!0,real:!0,forced:!r("isSubsetOf")},{isSubsetOf:i})},"27dc":function(t,e,n){"use strict";var o=n("9394"),i=n("6b27"),r=n("7dcf4"),s=function(t){return function(e,n,s){var a=o(e),l=r(a);if(0===l)return!t&&-1;var c,h=i(s,l);if(t&&n!==n){while(l>h)if(c=a[h++],c!==c)return!0}else for(;l>h;h++)if((t||h in a)&&a[h]===n)return t||h||0;return!t&&-1}};t.exports={includes:s(!0),indexOf:s(!1)}},"29b0":function(t,e,n){"use strict";n.r(e),n.d(e,"toUpperCaseFirst",(function(){return r})),n.d(e,"equalsIgnoreCase",(function(){return s})),n.d(e,"randomString",(function(){return a})),n.d(e,"isPercentValue",(function(){return l})),n.d(e,"substitute",(function(){return c})),n.d(e,"stripTags",(function(){return h})),n.d(e,"sanitize",(function(){return u}));n("d06e");var o=n("c0c4"),i=n("7b9c");function r(t){return t[0].toUpperCase()+t.substr(1)}function s(){const t=[];for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];let r=n.length;while(r){r-=1;const e=Object(i["stringify"])(n[r]).toLowerCase();-1===t.indexOf(e)&&t.push(e)}return 1===t.length}function a(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t()+t()+t()+t()}function l(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function c(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(""+t).replace(/(?:\\)?\[([^[\]]+)]/g,(t,n)=>"\\"===t.charAt(0)?t.substr(1,t.length-1):void 0===e[n]?"":e[n])}function h(t){return u(""+t,{ALLOWED_TAGS:[]})}function u(t,e){return o.sanitize(t,e)}},"2aac":function(t,e,n){"use strict";var o=n("73fa"),i=n("71ca"),r=TypeError;t.exports=function(t){if(o(t))return t;throw new r(i(t)+" is not a function")}},"2b75":function(t,e,n){"use strict";var o=n("d128"),i=n("b343");t.exports=o&&i((function(){return 42!==Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},"2c35":function(t,e,n){"use strict";var o=n("a60d").f;t.exports=function(t,e,n){n in t||o(t,n,{configurable:!0,get:function(){return e[n]},set:function(t){e[n]=t}})}},"2cb8":function(t,e,n){"use strict";var o=n("7b69"),i=n("69ba"),r=n("1e92"),s=n("97dc"),a=RegExp.prototype;t.exports=function(t){var e=t.flags;return void 0!==e||"flags"in a||i(t,"flags")||!r(a,t)?e:o(s,t)}},"2d2d":function(t,e,n){"use strict";var o=n("d128"),i=n("a60d"),r=n("1caf");t.exports=o?function(t,e,n){return i.f(t,e,r(1,n))}:function(t,e,n){return t[e]=n,t}},"2daa":function(t,e,n){"use strict";var o=n("2d2d"),i=n("78e9"),r=n("cf36"),s=Error.captureStackTrace;t.exports=function(t,e,n,a){r&&(s?s(t,e):o(t,"stack",i(n,a)))}},3037:function(t,e,n){"use strict";var o=n("fd18"),i=n("bdfe"),r=n("73fa"),s=n("939b"),a=n("2408"),l=o([].push);t.exports=function(t){if(r(t))return t;if(i(t)){for(var e=t.length,n=[],o=0;o<e;o++){var c=t[o];"string"==typeof c?l(n,c):"number"!=typeof c&&"Number"!==s(c)&&"String"!==s(c)||l(n,a(c))}var h=n.length,u=!0;return function(t,e){if(u)return u=!1,e;if(i(this))return e;for(var o=0;o<h;o++)if(n[o]===t)return e}}}},"351d":function(t,e,n){"use strict";n.r(e),n.d(e,"duckSchema",(function(){return i})),n.d(e,"inherit",(function(){return r})),n.d(e,"extend",(function(){return s})),n.d(e,"deepExtend",(function(){return a})),n.d(e,"deepClone",(function(){return l})),n.d(e,"clone",(function(){return c})),n.d(e,"mixin",(function(){return h})),n.d(e,"isObjectEqual",(function(){return u})),n.d(e,"isObject",(function(){return d})),n.d(e,"defineGetter",(function(){return f})),n.d(e,"objectEach",(function(){return g})),n.d(e,"getProperty",(function(){return p})),n.d(e,"setProperty",(function(){return m})),n.d(e,"deepObjectSize",(function(){return b})),n.d(e,"createObjectPropListener",(function(){return w})),n.d(e,"hasOwnProperty",(function(){return v}));n("7a89"),n("d06e"),n("5b82");var o=n("81ea");function i(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},g(t,(t,n)=>{"__children"!==n&&(t&&"object"===typeof t&&!Array.isArray(t)?e[n]=i(t):Array.isArray(t)?t.length&&"object"===typeof t[0]&&!Array.isArray(t[0])?e[n]=[i(t[0])]:e[n]=[]:e[n]=null)})),e}function r(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function s(t,e,n){const o=Array.isArray(n);return g(e,(e,i)=>{(!1===o||n.includes(i))&&(t[i]=e)}),t}function a(t,e){g(e,(n,o)=>{e[o]&&"object"===typeof e[o]?(t[o]||(Array.isArray(e[o])?t[o]=[]:"[object Date]"===Object.prototype.toString.call(e[o])?t[o]=e[o]:t[o]={}),a(t[o],e[o])):t[o]=e[o]})}function l(t){return"object"===typeof t?JSON.parse(JSON.stringify(t)):t}function c(t){const e={};return g(t,(t,n)=>{e[n]=t}),e}function h(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return Object(o["arrayEach"])(n,e=>{t.MIXINS.push(e.MIXIN_NAME),g(e,(e,n)=>{if(void 0!==t.prototype[n])throw new Error(`Mixin conflict. Property '${n}' already exist and cannot be overwritten.`);if("function"===typeof e)t.prototype[n]=e;else{const o=function(t,e){const n="_"+t,o=t=>{let e=t;return(Array.isArray(e)||d(e))&&(e=l(e)),e};return function(){return void 0===this[n]&&(this[n]=o(e)),this[n]}},i=function(t){const e="_"+t;return function(t){this[e]=t}};Object.defineProperty(t.prototype,n,{get:o(n,e),set:i(n),configurable:!0})}})}),t}function u(t,e){return JSON.stringify(t)===JSON.stringify(e)}function d(t){return"[object Object]"===Object.prototype.toString.call(t)}function f(t,e,n,o){o.value=n,o.writable=!1!==o.writable,o.enumerable=!1!==o.enumerable,o.configurable=!1!==o.configurable,Object.defineProperty(t,e,o)}function g(t,e){for(const n in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,n))&&!1===e(t[n],n,t))break;return t}function p(t,e){const n=e.split(".");let o=t;return g(n,t=>{if(o=o[t],void 0===o)return o=void 0,!1}),o}function m(t,e,n){const o=e.split(".");let i=t;o.forEach((t,e)=>{e!==o.length-1?(v(i,t)||(i[t]={}),i=i[t]):i[t]=n})}function b(t){if(!d(t))return 0;const e=function(t){let n=0;return d(t)?g(t,(t,o)=>{"__children"!==o&&(n+=e(t))}):n+=1,n};return e(t)}function w(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"value";const n="_"+e,o={_touched:!1,[n]:t,isTouched(){return this._touched}};return Object.defineProperty(o,e,{get(){return this[n]},set(t){this._touched=!0,this[n]=t},enumerable:!0,configurable:!0}),o}function v(t,e){return Object.prototype.hasOwnProperty.call(t,e)}},"38b3":function(t,e,n){"use strict";var o=n("ac4f"),i=n("0c5c"),r=n("88c5");o({target:"Set",proto:!0,real:!0,forced:!r("difference")},{difference:i})},"3bc4":function(t,e,n){"use strict";n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return a}));const o=/^(\r\n|\n\r|\r|\n)/,i=/^[^\t\r\n]+/,r=/^\t/;function s(t){const e=[[""]];if(0===t.length)return e;let n,s=0,a=0;while(t.length>0){if(n===t.length)break;if(n=t.length,t.match(r))t=t.replace(r,""),s+=1,e[a][s]="";else if(t.match(o))t=t.replace(o,""),s=0,a+=1,e[a]=[""];else{let n="";if(t.startsWith('"')){let e=0,o=!0;while(o){const i=t.slice(0,1);'"'===i&&(e+=1),n+=i,t=t.slice(1),(0===t.length||t.match(/^[\t\r\n]/)&&e%2===0)&&(o=!1)}n=n.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,t=>new Array(Math.floor(t.length/2)).fill('"').join(""))}else{const e=t.match(i);n=e?e[0]:"",t=t.slice(n.length)}e[a][s]=n}}return e}function a(t){let e,n,o,i,r,s="";for(e=0,n=t.length;e<n;e+=1){for(i=t[e].length,o=0;o<i;o+=1)o>0&&(s+="\t"),r=t[e][o],"string"===typeof r?r.indexOf("\n")>-1?s+=`"${r.replace(/"/g,'""')}"`:s+=r:s+=null===r||void 0===r?"":r;e!==n-1&&(s+="\n")}return s}},"3d57":function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return r}));var o=n("81ea");function i(t,e,n){return[...t.slice(0,e),...n,...t.slice(e)]}function r(t,e){return Object(o["arrayFilter"])(t,t=>!1===e.includes(t))}},"3d76":function(t,e,n){"use strict";n.d(e,"d",(function(){return h})),n.d(e,"b",(function(){return c})),n.d(e,"c",(function(){return s})),n.d(e,"a",(function(){return a}));n("7a89");var o=n("9acd");const{register:i,getItem:r,hasItem:s,getNames:a,getValues:l}=Object(o["a"])("renderers");function c(t){if("function"===typeof t)return t;if(!s(t))throw Error(`No registered renderer found under "${t}" name`);return r(t)}function h(t,e){"string"!==typeof t&&(e=t,t=e.RENDERER_TYPE),i(t,e)}},"3df8":function(t,e,n){"use strict";var o=n("54ad"),i=Object.defineProperty;t.exports=function(t,e){try{i(o,t,{value:e,configurable:!0,writable:!0})}catch(n){o[t]=e}return e}},4127:function(t,e,n){"use strict";var o=n("d233"),i=n("b313"),r={brackets:function(t){return t+"[]"},indices:function(t,e){return t+"["+e+"]"},repeat:function(t){return t}},s=Array.isArray,a=Array.prototype.push,l=function(t,e){a.apply(t,s(e)?e:[e])},c=Date.prototype.toISOString,h={delimiter:"&",encode:!0,encoder:o.encode,encodeValuesOnly:!1,serializeDate:function(t){return c.call(t)},skipNulls:!1,strictNullHandling:!1},u=function t(e,n,i,r,a,c,u,d,f,g,p,m){var b=e;if("function"===typeof u?b=u(n,b):b instanceof Date&&(b=g(b)),null===b){if(r)return c&&!m?c(n,h.encoder):n;b=""}if("string"===typeof b||"number"===typeof b||"boolean"===typeof b||o.isBuffer(b)){if(c){var w=m?n:c(n,h.encoder);return[p(w)+"="+p(c(b,h.encoder))]}return[p(n)+"="+p(String(b))]}var v,y=[];if("undefined"===typeof b)return y;if(s(u))v=u;else{var C=Object.keys(b);v=d?C.sort(d):C}for(var S=0;S<v.length;++S){var O=v[S];a&&null===b[O]||(s(b)?l(y,t(b[O],i(n,O),i,r,a,c,u,d,f,g,p,m)):l(y,t(b[O],n+(f?"."+O:"["+O+"]"),i,r,a,c,u,d,f,g,p,m)))}return y};t.exports=function(t,e){var n=t,a=e?o.assign({},e):{};if(null!==a.encoder&&"undefined"!==typeof a.encoder&&"function"!==typeof a.encoder)throw new TypeError("Encoder has to be a function.");var c="undefined"===typeof a.delimiter?h.delimiter:a.delimiter,d="boolean"===typeof a.strictNullHandling?a.strictNullHandling:h.strictNullHandling,f="boolean"===typeof a.skipNulls?a.skipNulls:h.skipNulls,g="boolean"===typeof a.encode?a.encode:h.encode,p="function"===typeof a.encoder?a.encoder:h.encoder,m="function"===typeof a.sort?a.sort:null,b="undefined"!==typeof a.allowDots&&a.allowDots,w="function"===typeof a.serializeDate?a.serializeDate:h.serializeDate,v="boolean"===typeof a.encodeValuesOnly?a.encodeValuesOnly:h.encodeValuesOnly;if("undefined"===typeof a.format)a.format=i["default"];else if(!Object.prototype.hasOwnProperty.call(i.formatters,a.format))throw new TypeError("Unknown format option provided.");var y,C,S=i.formatters[a.format];"function"===typeof a.filter?(C=a.filter,n=C("",n)):s(a.filter)&&(C=a.filter,y=C);var O,E=[];if("object"!==typeof n||null===n)return"";O=a.arrayFormat in r?a.arrayFormat:"indices"in a?a.indices?"indices":"repeat":"indices";var R=r[O];y||(y=Object.keys(n)),m&&y.sort(m);for(var T=0;T<y.length;++T){var M=y[T];f&&null===n[M]||l(E,u(n[M],M,R,d,f,g?p:null,C,m,b,w,S,v))}var I=E.join(c),x=!0===a.addQueryPrefix?"?":"";return I.length>0?x+I:""}},4328:function(t,e,n){"use strict";var o=n("4127"),i=n("9e6a"),r=n("b313");t.exports={formats:r,parse:i,stringify:o}},"480c":function(t,e,n){"use strict";n.r(e),n.d(e,"spreadsheetColumnLabel",(function(){return s})),n.d(e,"spreadsheetColumnIndex",(function(){return a})),n.d(e,"createSpreadsheetData",(function(){return l})),n.d(e,"createSpreadsheetObjectData",(function(){return c})),n.d(e,"createEmptySpreadsheetData",(function(){return h})),n.d(e,"dataRowToChangesArray",(function(){return u})),n.d(e,"countFirstRowKeys",(function(){return d})),n.d(e,"isArrayOfArrays",(function(){return f})),n.d(e,"isArrayOfObjects",(function(){return g}));n("d06e");var o=n("351d");const i="ABCDEFGHIJKLMNOPQRSTUVWXYZ",r=i.length;function s(t){let e,n=t+1,o="";while(n>0)e=(n-1)%r,o=String.fromCharCode(65+e)+o,n=parseInt((n-e)/r,10);return o}function a(t){let e=0;if(t)for(let n=0,o=t.length-1;n<t.length;n+=1,o-=1)e+=r**o*(i.indexOf(t[n])+1);return e-=1,e}function l(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;const n=[];let o,i;for(o=0;o<t;o++){const t=[];for(i=0;i<e;i++)t.push(s(i)+(o+1));n.push(t)}return n}function c(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;const n=[];let o,i;for(o=0;o<t;o++){const t={};for(i=0;i<e;i++)t["prop"+i]=s(i)+(o+1);n.push(t)}return n}function h(t,e){const n=[];let o;for(let i=0;i<t;i++){o=[];for(let t=0;t<e;t++)o.push("");n.push(o)}return n}function u(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=t;const o=[];return Array.isArray(t)&&Array.isArray(t[0])||(n=[t]),n.forEach((t,n)=>{Array.isArray(t)?t.forEach((t,i)=>{o.push([n+e,i,t])}):Object.keys(t).forEach(i=>{o.push([n+e,i,t[i]])})}),o}function d(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&Object(o["isObject"])(t[0])&&(e=Object(o["deepObjectSize"])(t[0]))),e}function f(t){return!!(Array.isArray(t)&&t.length&&t.every(t=>Array.isArray(t)))}function g(t){return!!(Array.isArray(t)&&t.length&&t.every(t=>"object"===typeof t&&!Array.isArray(t)&&null!==t))}},"485c6":function(t,e,n){"use strict";var o=n("d128"),i=n("7b69"),r=n("ba51"),s=n("1caf"),a=n("9394"),l=n("24d5"),c=n("69ba"),h=n("d435"),u=Object.getOwnPropertyDescriptor;e.f=o?u:function(t,e){if(t=a(t),e=l(e),h)try{return u(t,e)}catch(n){}if(c(t,e))return s(!i(r.f,t,e),t[e])}},"48ab":function(t,e,n){"use strict";var o=n("b343");t.exports=!o((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")}))},"491c":function(t,e,n){"use strict";n.d(e,"e",(function(){return g})),n.d(e,"a",(function(){return f})),n.d(e,"b",(function(){return d})),n.d(e,"d",(function(){return l})),n.d(e,"c",(function(){return c}));n("7a89");var o=n("1004"),i=n("9acd");const r=new WeakMap,{register:s,getItem:a,hasItem:l,getNames:c,getValues:h}=Object(i["a"])("editors");function u(t){const e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(t){return t.guid in e||(e[t.guid]=new n(t)),e[t.guid]},o["a"].getSingleton().add("afterDestroy",(function(){e[this.guid]=null}))}function d(t,e){let n;if("function"===typeof t)r.get(t)||g(null,t),n=r.get(t);else{if("string"!==typeof t)throw Error('Only strings and functions can be passed as "editor" parameter');n=a(t)}if(!n)throw Error(`No editor registered under name "${t}"`);return n.getInstance(e)}function f(t){if("function"===typeof t)return t;if(!l(t))throw Error(`No registered editor found under "${t}" name`);return a(t).getConstructor()}function g(t,e){t&&"string"!==typeof t&&(e=t,t=e.EDITOR_TYPE);const n=new u(e);"string"===typeof t&&s(t,n),r.set(e,n)}},"4aa5":function(t,e,n){"use strict";e.f=Object.getOwnPropertySymbols},"4c54":function(t,e,n){"use strict";var o=n("0227"),i=n("73fa"),r=n("1e92"),s=n("9c76"),a=Object;t.exports=s?function(t){return"symbol"==typeof t}:function(t){var e=o("Symbol");return i(e)&&r(e.prototype,a(t))}},"4cd6":function(t,e,n){"use strict";var o=n("f41c");o("flatMap")},5438:function(t,e,n){"use strict";var o=n("87ed").has;t.exports=function(t){return o(t),t}},"54ad":function(t,e,n){"use strict";(function(e){var n=function(t){return t&&t.Math===Math&&t};t.exports=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof e&&e)||n("object"==typeof this&&this)||function(){return this}()||Function("return this")()}).call(this,n("c8ba"))},"54d7":function(t,e,n){"use strict";var o=n("d62b"),i=n("54ad"),r=n("3df8"),s="__core-js_shared__",a=t.exports=i[s]||r(s,{});(a.versions||(a.versions=[])).push({version:"3.38.1",mode:o?"pure":"global",copyright:" 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.38.1/LICENSE",source:"https://github.com/zloirock/core-js"})},5714:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));n("7a89");function o(t,e,n){return(e=i(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i(t){var e=r(t,"string");return"symbol"==typeof e?e:e+""}function r(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class s{constructor(t){o(this,"calculationTypes",[]),o(this,"calculationResults",new Map),this.calculationTypes=t}_initialize(t){this.calculationTypes.forEach(e=>{let[n,o]=e;this.calculationResults.set(n,o),o.initialize(t)})}_process(t,e){this.calculationTypes.forEach(n=>{let[,o]=n;return o.process(t,e)})}_finalize(t){this.calculationTypes.forEach(e=>{let[,n]=e;return n.finalize(t)})}getResultsFor(t){return this.calculationResults.get(t)}}},"592ab":function(t,e,n){"use strict";var o=n("fd18"),i=0,r=Math.random(),s=o(1..toString);t.exports=function(t){return"Symbol("+(void 0===t?"":t)+")_"+s(++i+r,36)}},"59a2":function(t,e,n){"use strict";var o=n("ac4f"),i=n("54ad"),r=n("d2e4").set,s=n("f6cb"),a=i.setImmediate?s(r,!1):r;o({global:!0,bind:!0,enumerable:!0,forced:i.setImmediate!==a},{setImmediate:a})},"5b82":function(t,e,n){"use strict";var o=n("ac4f"),i=n("0227"),r=n("0204"),s=n("7b69"),a=n("fd18"),l=n("b343"),c=n("73fa"),h=n("4c54"),u=n("9674"),d=n("3037"),f=n("7b7f"),g=String,p=i("JSON","stringify"),m=a(/./.exec),b=a("".charAt),w=a("".charCodeAt),v=a("".replace),y=a(1..toString),C=/[\uD800-\uDFFF]/g,S=/^[\uD800-\uDBFF]$/,O=/^[\uDC00-\uDFFF]$/,E=!f||l((function(){var t=i("Symbol")("stringify detection");return"[null]"!==p([t])||"{}"!==p({a:t})||"{}"!==p(Object(t))})),R=l((function(){return'"\\udf06\\ud834"'!==p("\udf06\ud834")||'"\\udead"'!==p("\udead")})),T=function(t,e){var n=u(arguments),o=d(e);if(c(o)||void 0!==t&&!h(t))return n[1]=function(t,e){if(c(o)&&(e=s(o,this,g(t),e)),!h(e))return e},r(p,null,n)},M=function(t,e,n){var o=b(n,e-1),i=b(n,e+1);return m(S,t)&&!m(O,i)||m(O,t)&&!m(S,o)?"\\u"+y(w(t,0),16):t};p&&o({target:"JSON",stat:!0,arity:3,forced:E||R},{stringify:function(t,e,n){var o=u(arguments),i=r(E?T:p,null,o);return R&&"string"==typeof i?v(i,C,M):i}})},"5d7f":function(t,e,n){"use strict";n.r(e),n.d(e,"getParent",(function(){return r})),n.d(e,"isThisHotChild",(function(){return s})),n.d(e,"getFrameElement",(function(){return a})),n.d(e,"getParentWindow",(function(){return l})),n.d(e,"hasAccessToParentWindow",(function(){return c})),n.d(e,"closest",(function(){return h})),n.d(e,"closestDown",(function(){return u})),n.d(e,"isChildOf",(function(){return d})),n.d(e,"index",(function(){return f})),n.d(e,"overlayContainsElement",(function(){return g})),n.d(e,"hasClass",(function(){return b})),n.d(e,"addClass",(function(){return w})),n.d(e,"removeClass",(function(){return v})),n.d(e,"setAttribute",(function(){return y})),n.d(e,"removeAttribute",(function(){return C})),n.d(e,"removeTextNodes",(function(){return S})),n.d(e,"empty",(function(){return O})),n.d(e,"HTML_CHARACTERS",(function(){return E})),n.d(e,"fastInnerHTML",(function(){return R})),n.d(e,"fastInnerText",(function(){return T})),n.d(e,"isVisible",(function(){return M})),n.d(e,"offset",(function(){return I})),n.d(e,"getWindowScrollTop",(function(){return x})),n.d(e,"getWindowScrollLeft",(function(){return N})),n.d(e,"getScrollTop",(function(){return A})),n.d(e,"getScrollLeft",(function(){return H})),n.d(e,"getScrollableElement",(function(){return j})),n.d(e,"getMaximumScrollTop",(function(){return _})),n.d(e,"getMaximumScrollLeft",(function(){return k})),n.d(e,"getTrimmingContainer",(function(){return P})),n.d(e,"getStyle",(function(){return D})),n.d(e,"matchesCSSRules",(function(){return L})),n.d(e,"getComputedStyle",(function(){return F})),n.d(e,"outerWidth",(function(){return V})),n.d(e,"outerHeight",(function(){return W})),n.d(e,"innerHeight",(function(){return B})),n.d(e,"innerWidth",(function(){return U})),n.d(e,"addEvent",(function(){return z})),n.d(e,"removeEvent",(function(){return G})),n.d(e,"getCaretPosition",(function(){return Y})),n.d(e,"getSelectionEndPosition",(function(){return X})),n.d(e,"getSelectionText",(function(){return $})),n.d(e,"clearTextSelection",(function(){return K})),n.d(e,"setCaretPosition",(function(){return q})),n.d(e,"getScrollbarWidth",(function(){return Z})),n.d(e,"hasVerticalScrollbar",(function(){return tt})),n.d(e,"hasHorizontalScrollbar",(function(){return et})),n.d(e,"setOverlayPosition",(function(){return nt})),n.d(e,"getCssTransform",(function(){return ot})),n.d(e,"resetCssTransform",(function(){return it})),n.d(e,"isInput",(function(){return rt})),n.d(e,"isOutsideInput",(function(){return st})),n.d(e,"selectElementIfAllowed",(function(){return at})),n.d(e,"isDetached",(function(){return lt})),n.d(e,"observeVisibilityChangeOnce",(function(){return ct})),n.d(e,"makeElementContentEditableAndSelectItsContent",(function(){return ht})),n.d(e,"removeContentEditableFromElementAndDeselect",(function(){return ut})),n.d(e,"runWithSelectedContendEditableElement",(function(){return dt}));n("7a89"),n("d06e");var o=n("29b0"),i=n("8828");function r(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=-1,o=null,i=t;while(null!==i){if(n===e){o=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(n+=1,i=i.parentNode)}return o}function s(t,e){const n=t.closest(".handsontable");return!!n&&(n.parentNode===e||n===e)}function a(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function l(t){return a(t)&&t.parent}function c(t){return!!Object.getPrototypeOf(t.parent)}function h(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:o,DOCUMENT_FRAGMENT_NODE:i}=Node;let r=t;while(null!==r&&void 0!==r&&r!==n){const{nodeType:t,nodeName:n}=r;if(t===o&&(e.includes(n)||e.includes(r)))return r;const{host:s}=r;r=s&&t===i?s:r.parentNode}return null}function u(t,e,n){const o=[];let i=t;while(i){if(i=h(i,e,n),!i||n&&!n.contains(i))break;o.push(i),i=i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i.host:i.parentNode}const r=o.length;return r?o[r-1]:null}function d(t,e){let n=t.parentNode,o=[];"string"===typeof e?o=t.defaultView?Array.prototype.slice.call(t.querySelectorAll(e),0):Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):o.push(e);while(null!==n){if(o.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function f(t){let e=0,n=t;if(n.previousSibling)while(n=n.previousSibling)e+=1;return e}function g(t,e,n){const o=n.parentElement.querySelector(".ht_clone_"+t);return o?o.contains(e):null}function p(t){return t&&t.length?t.filter(t=>!!t):[]}function m(t,e){if(!t||!t.length)return e?{regexFree:[],regexes:[]}:[];const n=[],o=[];return o.push(...t.filter(t=>{const o=t instanceof RegExp;return o&&e&&n.push(t),!o})),e?{regexFree:o,regexes:n}:o}function b(t,e){return void 0!==t.classList&&"string"===typeof e&&""!==e&&t.classList.contains(e)}function w(t,e){"string"===typeof e&&(e=e.split(" ")),e=p(e),e.length>0&&t.classList.add(...e)}function v(t,e){"string"===typeof e?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:n,regexes:o}=m(e,!0);n=p(n),n.length>0&&t.classList.remove(...n),o.forEach(e=>{t.classList.forEach(n=>{e.test(n)&&t.classList.remove(n)})})}function y(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,n]]),e.forEach(e=>{Array.isArray(e)&&""!==e[0]&&t.setAttribute(...e)})}function C(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];"string"===typeof e?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:n,regexes:o}=m(e,!0);n.forEach(e=>{""!==e&&t.removeAttribute(e)}),o.forEach(e=>{t.getAttributeNames().forEach(n=>{e.test(n)&&t.removeAttribute(n)})})}function S(t){if(3===t.nodeType)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let t=e.length-1;t>=0;t--)S(e[t])}}function O(t){let e;while(e=t.lastChild)t.removeChild(e)}const E=/(<(.*)>|&(.*);)/;function R(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];E.test(e)?t.innerHTML=n?Object(o["sanitize"])(e):e:T(t,e)}function T(t,e){const n=t.firstChild;n&&3===n.nodeType&&null===n.nextSibling?n.textContent=e:(O(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function M(t){const e=t.ownerDocument.documentElement;let n=t;while(n!==e){if(null===n)return!1;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(n.host){if(n.host.impl)return M(n.host.impl);if(n.host)return M(n.host);throw new Error("Lost in Web Components world")}return!1}if("none"===F(n).display)return!1;n=n.parentNode}return!0}function I(t){const e=t.ownerDocument,n=e.defaultView,o=e.documentElement;let i,r,s,a=t;i=a.offsetLeft,r=a.offsetTop,s=a;while(a=a.offsetParent){if(a===e.body)break;if(!("offsetLeft"in a))break;i+=a.offsetLeft,r+=a.offsetTop,s=a}return s&&"fixed"===s.style.position&&(i+=n.pageXOffset||o.scrollLeft,r+=n.pageYOffset||o.scrollTop),{left:i,top:r}}function x(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;return t.scrollY}function N(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;return t.scrollX}function A(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return t===e?x(e):t.scrollTop}function H(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return t===e?N(e):t.scrollLeft}function j(t){let e=t.ownerDocument,n=e?e.defaultView:void 0;e||(e=t.document?t.document:t,n=e.defaultView);const o=["auto","scroll"];let i=t.parentNode;while(i&&i.style&&e.body!==i){let{overflow:t,overflowX:e,overflowY:r}=i.style;if([t,e,r].includes("scroll"))return i;if(({overflow:t,overflowX:e,overflowY:r}=n.getComputedStyle(i)),o.includes(t)||o.includes(e)||o.includes(r))return i;if(i.clientHeight<=i.scrollHeight+1&&(o.includes(r)||o.includes(t)))return i;if(i.clientWidth<=i.scrollWidth+1&&(o.includes(e)||o.includes(t)))return i;i=i.parentNode}return n}function _(t){return t.scrollHeight-t.clientHeight}function k(t){return t.scrollWidth-t.clientWidth}function P(t){const e=t.ownerDocument,n=e.defaultView;let o=t.parentNode;while(o&&o.style&&e.body!==o){if("visible"!==o.style.overflow&&""!==o.style.overflow)return o;const t=F(o,n),e=["scroll","hidden","auto"],i=t.getPropertyValue("overflow"),r=t.getPropertyValue("overflow-y"),s=t.getPropertyValue("overflow-x");if(e.includes(i)||e.includes(r)||e.includes(s))return o;o=o.parentNode}return n}function D(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;if(!t)return;if(t===n)return"width"===e?n.innerWidth+"px":"height"===e?n.innerHeight+"px":void 0;const o=t.style[e];if(""!==o&&void 0!==o)return o;const i=F(t,n);return""!==i[e]&&void 0!==i[e]?i[e]:void 0}function L(t,e){const{selectorText:n}=e;let o=!1;return e.type===CSSRule.STYLE_RULE&&n&&(t.msMatchesSelector?o=t.msMatchesSelector(n):t.matches&&(o=t.matches(n))),o}function F(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return t.currentStyle||e.getComputedStyle(t)}function V(t){return t.offsetWidth}function W(t){return t.offsetHeight}function B(t){return t.clientHeight||t.innerHeight}function U(t){return t.clientWidth||t.innerWidth}function z(t,e,n){t.addEventListener(e,n,!1)}function G(t,e,n){t.removeEventListener(e,n,!1)}function Y(t){return t.selectionStart?t.selectionStart:0}function X(t){return t.selectionEnd?t.selectionEnd:0}function $(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;const e=t.document;let n="";return t.getSelection?n=t.getSelection().toString():e.selection&&"Control"!==e.selection.type&&(n=e.selection.createRange().text),n}function K(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function q(t,e,n){if(void 0===n&&(n=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,n)}catch(o){const i=t.parentNode,r=i.style.display;i.style.display="block",t.setSelectionRange(e,n),i.style.display=r}}}let Q;function J(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const n=t.createElement("div");n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(e),(t.body||t.documentElement).appendChild(n);const o=e.offsetWidth;n.style.overflow="scroll";let i=e.offsetWidth;return o===i&&(i=n.clientWidth),(t.body||t.documentElement).removeChild(n),o-i}function Z(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return void 0===Q&&(Q=J(t)),Q}function tt(t){return t.offsetWidth!==t.clientWidth}function et(t){return t.offsetHeight!==t.clientHeight}function nt(t,e,n){t.style.transform=`translate3d(${e},${n},0)`}function ot(t){let e;return t.style.transform&&""!==(e=t.style.transform)?["transform",e]:-1}function it(t){t.style.transform&&""!==t.style.transform&&(t.style.transform="")}function rt(t){const e=["INPUT","SELECT","TEXTAREA"];return t&&(e.indexOf(t.nodeName)>-1||"true"===t.contentEditable)}function st(t){return rt(t)&&!1===t.hasAttribute("data-hot-input")}function at(t){const e=t.ownerDocument.activeElement;st(e)||t.select()}function lt(t){return!t.parentNode}function ct(t,e){const n=new IntersectionObserver((n,o)=>{n.forEach(n=>{n.isIntersecting&&null!==t.offsetParent&&(e(),o.unobserve(t))})},{root:t.ownerDocument.body});n.observe(t)}function ht(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const o=t.ownerDocument,r=o.createRange(),s=o.defaultView.getSelection();y(t,"contenteditable",!0),n&&y(t,...Object(i["n"])()),e&&w(t,"invisibleSelection"),r.selectNodeContents(t),s.removeAllRanges(),s.addRange(r)}function ut(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),n.removeAllRanges(),e&&v(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function dt(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];ht(t,n),e(),ut(t,n)}},6038:function(t,e,n){"use strict";var o=TypeError;t.exports=function(t,e){if(t<e)throw new o("Not enough arguments");return t}},"624b":function(t,e,n){"use strict";var o=n("fd18"),i=n("2aac");t.exports=function(t,e,n){try{return o(i(Object.getOwnPropertyDescriptor(t,e)[n]))}catch(r){}}},6269:function(t,e,n){"use strict";var o=n("54ad"),i=n("c9a1"),r=n("939b"),s=function(t){return i.slice(0,t.length)===t};t.exports=function(){return s("Bun/")?"BUN":s("Cloudflare-Workers")?"CLOUDFLARE":s("Deno/")?"DENO":s("Node.js/")?"NODE":o.Bun&&"string"==typeof Bun.version?"BUN":o.Deno&&"object"==typeof Deno.version?"DENO":"process"===r(o.process)?"NODE":o.window&&o.document?"BROWSER":"REST"}()},"63d8":function(t,e,n){"use strict";n.r(e),n.d(e,"setBrowserMeta",(function(){return l})),n.d(e,"setPlatformMeta",(function(){return c})),n.d(e,"isChrome",(function(){return h})),n.d(e,"isChromeWebKit",(function(){return u})),n.d(e,"isFirefox",(function(){return d})),n.d(e,"isFirefoxWebKit",(function(){return f})),n.d(e,"isSafari",(function(){return g})),n.d(e,"isEdge",(function(){return p})),n.d(e,"isEdgeWebKit",(function(){return m})),n.d(e,"isMobileBrowser",(function(){return b})),n.d(e,"isIOS",(function(){return w})),n.d(e,"isIpadOS",(function(){return v})),n.d(e,"isWindowsOS",(function(){return y})),n.d(e,"isMacOS",(function(){return C})),n.d(e,"isLinuxOS",(function(){return S}));var o=n("351d"),i=n("7dd09");const r=t=>{const e={value:!1,test:(n,o)=>{e.value=t(n,o)}};return e},s={chrome:r((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:r(t=>/CriOS/.test(t)),edge:r(t=>/Edge/.test(t)),edgeWebKit:r(t=>/EdgiOS/.test(t)),firefox:r(t=>/Firefox/.test(t)),firefoxWebKit:r(t=>/FxiOS/.test(t)),mobile:r(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:r((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},a={mac:r(t=>/^Mac/.test(t)),win:r(t=>/^Win/.test(t)),linux:r(t=>/^Linux/.test(t)),ios:r(t=>/iPhone|iPad|iPod/i.test(t))};function l(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(o["objectEach"])(s,n=>{let{test:o}=n;o(t,e)})}function c(){let{platform:t=navigator.platform}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(o["objectEach"])(a,e=>{let{test:n}=e;n(t)})}function h(){return s.chrome.value}function u(){return s.chromeWebKit.value}function d(){return s.firefox.value}function f(){return s.firefoxWebKit.value}function g(){return s.safari.value}function p(){return s.edge.value}function m(){return s.edgeWebKit.value}function b(){return s.mobile.value}function w(){return a.ios.value}function v(){let{maxTouchPoints:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator;return t>2&&a.mac.value}function y(){return a.win.value}function C(){return a.mac.value}function S(){return a.linux.value}Object(i["isCSR"])()&&(l(),c())},"652d":function(t,e,n){"use strict";var o=n("fd18"),i=n("69ba"),r=n("9394"),s=n("27dc").indexOf,a=n("861e"),l=o([].push);t.exports=function(t,e){var n,o=r(t),c=0,h=[];for(n in o)!i(a,n)&&i(o,n)&&l(h,n);while(e.length>c)i(o,n=e[c++])&&(~s(h,n)||l(h,n));return h}},"66e1":function(t,e,n){"use strict";var o=n("ac4f"),i=n("04c2"),r=n("88c5");o({target:"Set",proto:!0,real:!0,forced:!r("isDisjointFrom")},{isDisjointFrom:i})},"67a8":function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var o=n("81ea");function i(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];const r=Object(o["arrayReduce"])(t,(t,e,o)=>{const i=e.replace(/\r?\n\s*/g,""),r=n[o]?n[o]:"";return t+i+r},"");return r.trim()}},6906:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));n("7a89");var o=n("97b9");const i=t=>`The id '${t}' is already declared in a map.`;function r(){let{errorIdExists:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=new Map;function n(n,o){if(h(n))throw new Error(t(n));e.set(n,o)}function r(t){return e.delete(t)}function s(){e.clear()}function a(t){const[e]=c().find(e=>{let[n,o]=e;return t===o&&n})||[null];return e}function l(t){return e.get(t)}function c(){return[...e]}function h(t){return e.has(t)}return t=Object(o["isFunction"])(t)?t:i,{addItem:n,clear:s,getId:a,getItem:l,getItems:c,hasItem:h,removeItem:r}}},"69ba":function(t,e,n){"use strict";var o=n("fd18"),i=n("fc2d"),r=o({}.hasOwnProperty);t.exports=Object.hasOwn||function(t,e){return r(i(t),e)}},"6b27":function(t,e,n){"use strict";var o=n("9e75"),i=Math.max,r=Math.min;t.exports=function(t,e){var n=o(t);return n<0?i(n+e,0):r(n,e)}},"6f539":function(t,e,n){"use strict";var o=n("fd18"),i=n("bfa7"),r=n("87ed"),s=r.Set,a=r.proto,l=o(a.forEach),c=o(a.keys),h=c(new s).next;t.exports=function(t,e,n){return n?i({iterator:c(t),next:h},e):l(t,e)}},7064:function(t,e,n){"use strict";var o=n("5438"),i=n("87ed").add,r=n("b52d"),s=n("0f98"),a=n("bfa7");t.exports=function(t){var e=o(this),n=s(t).getIterator(),l=r(e);return a(n,(function(t){i(l,t)})),l}},"70f9":function(t,e,n){"use strict";var o=n("ac4f"),i=n("7b69"),r=n("fd18"),s=n("bf78"),a=n("73fa"),l=n("022b"),c=n("11b3"),h=n("2408"),u=n("2471"),d=n("2cb8"),f=n("aa44"),g=n("80dd"),p=n("d62b"),m=g("replace"),b=TypeError,w=r("".indexOf),v=r("".replace),y=r("".slice),C=Math.max;o({target:"String",proto:!0},{replaceAll:function(t,e){var n,o,r,g,S,O,E,R,T,M,I=s(this),x=0,N="";if(!l(t)){if(n=c(t),n&&(o=h(s(d(t))),!~w(o,"g")))throw new b("`.replaceAll` does not allow non-global regexes");if(r=u(t,m),r)return i(r,t,I,e);if(p&&n)return v(h(I),t,e)}g=h(I),S=h(t),O=a(e),O||(e=h(e)),E=S.length,R=C(1,E),T=w(g,S);while(-1!==T)M=O?h(e(S,T,g)):f(S,g,T,[],void 0,e),N+=y(g,x,T)+M,x=T+E,T=T+R>g.length?-1:w(g,S,T+R);return x<g.length&&(N+=y(g,x)),N}})},"71ca":function(t,e,n){"use strict";var o=String;t.exports=function(t){try{return o(t)}catch(e){return"Object"}}},7204:function(t,e,n){"use strict";var o=n("5438"),i=n("87ed"),r=n("b52d"),s=n("0f98"),a=n("bfa7"),l=i.add,c=i.has,h=i.remove;t.exports=function(t){var e=o(this),n=s(t).getIterator(),i=r(e);return a(n,(function(t){c(e,t)?h(i,t):l(i,t)})),i}},"73d9":function(t,e,n){"use strict";var o=n("b2c9"),i=String,r=TypeError;t.exports=function(t){if(o(t))return t;throw new r("Can't set "+i(t)+" as a prototype")}},"73fa":function(t,e,n){"use strict";var o="object"==typeof document&&document.all;t.exports="undefined"==typeof o&&void 0!==o?function(t){return"function"==typeof t||t===o}:function(t){return"function"==typeof t}},"76ab":function(t,e,n){"use strict";n.d(e,"d",(function(){return f})),n.d(e,"a",(function(){return d})),n.d(e,"c",(function(){return c})),n.d(e,"b",(function(){return h}));n("7a89");var o=n("9acd"),i=n("491c"),r=n("3d76"),s=n("169f");const{register:a,getItem:l,hasItem:c,getNames:h,getValues:u}=Object(o["a"])("cellTypes");function d(t){if(!c(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.\n                 Cell type must be an object or a string mapped to an object registered by\n                 "Handsontable.cellTypes.registerCellType" method`);return l(t)}function f(t,e){"string"!==typeof t&&(e=t,t=e.CELL_TYPE);const{editor:n,renderer:o,validator:l}=e;n&&Object(i["e"])(t,n),o&&Object(r["d"])(t,o),l&&Object(s["d"])(t,l),a(t,e)}},"78e9":function(t,e,n){"use strict";var o=n("fd18"),i=Error,r=o("".replace),s=function(t){return String(new i(t).stack)}("zxcasd"),a=/\n\s*at [^:]*:[^\n]*/,l=a.test(s);t.exports=function(t,e){if(l&&"string"==typeof t&&!i.prepareStackTrace)while(e--)t=r(t,a,"");return t}},"7a89":function(t,e,n){"use strict";var o=n("ac4f"),i=n("54ad"),r=n("0204"),s=n("170e"),a="WebAssembly",l=i[a],c=7!==new Error("e",{cause:7}).cause,h=function(t,e){var n={};n[t]=s(t,e,c),o({global:!0,constructor:!0,arity:1,forced:c},n)},u=function(t,e){if(l&&l[t]){var n={};n[t]=s(a+"."+t,e,c),o({target:a,stat:!0,constructor:!0,arity:1,forced:c},n)}};h("Error",(function(t){return function(e){return r(t,this,arguments)}})),h("EvalError",(function(t){return function(e){return r(t,this,arguments)}})),h("RangeError",(function(t){return function(e){return r(t,this,arguments)}})),h("ReferenceError",(function(t){return function(e){return r(t,this,arguments)}})),h("SyntaxError",(function(t){return function(e){return r(t,this,arguments)}})),h("TypeError",(function(t){return function(e){return r(t,this,arguments)}})),h("URIError",(function(t){return function(e){return r(t,this,arguments)}})),u("CompileError",(function(t){return function(e){return r(t,this,arguments)}})),u("LinkError",(function(t){return function(e){return r(t,this,arguments)}})),u("RuntimeError",(function(t){return function(e){return r(t,this,arguments)}}))},"7ae0":function(t,e,n){"use strict";n("d06e");var o=n("351d"),i=n("97b9");const r="localHooks",s={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,n,o,r,s,a){if(this._localHooks[t]){const l=this._localHooks[t].length;for(let c=0;c<l;c++)Object(i["fastCall"])(this._localHooks[t][c],this,e,n,o,r,s,a)}},clearLocalHooks(){return this._localHooks={},this}};Object(o["defineGetter"])(s,"MIXIN_NAME",r,{writable:!1,enumerable:!1}),e["a"]=s},"7b69":function(t,e,n){"use strict";var o=n("48ab"),i=Function.prototype.call;t.exports=o?i.bind(i):function(){return i.apply(i,arguments)}},"7b7f":function(t,e,n){"use strict";var o=n("b622c"),i=n("b343"),r=n("54ad"),s=r.String;t.exports=!!Object.getOwnPropertySymbols&&!i((function(){var t=Symbol("symbol detection");return!s(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&o&&o<41}))},"7b9c":function(t,e,n){"use strict";n.r(e),n.d(e,"stringify",(function(){return r})),n.d(e,"isDefined",(function(){return s})),n.d(e,"isUndefined",(function(){return a})),n.d(e,"isEmpty",(function(){return l})),n.d(e,"isRegExp",(function(){return c})),n.d(e,"_injectProductInfo",(function(){return C}));var o=n("c1df"),i=n("67a8");function r(t){let e;switch(typeof t){case"string":case"number":e=""+t;break;case"object":e=null===t?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function s(t){return"undefined"!==typeof t}function a(t){return"undefined"===typeof t}function l(t){return null===t||""===t||a(t)}function c(t){return"[object RegExp]"===Object.prototype.toString.call(t)}const h="length",u=t=>parseInt(t,16),d=t=>parseInt(t,10),f=(t,e,n)=>t["substr"](e,n),g=t=>t["codePointAt"](0)-65,p=t=>(""+t).replace(/\-/g,""),m=t=>u(f(p(t),u("12"),g("F")))/(u(f(p(t),g("B"),~~![][h]))||9),b=()=>"undefined"!==typeof location&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let w=!1;const v={invalid:()=>i["a"]`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return i["a"]`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>i["a"]`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},y={invalid:()=>i["a"]`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return i["a"]`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>i["a"]`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function C(t,e){const n=!l(t),i="string"===typeof t&&"non-commercial-and-evaluation"===t.toLowerCase(),r="14.6.1";let s,a="invalid",c="invalid";t=p(t||"");const h=S(t);if(n||i||h)if(h){const e=o("17/10/2024","DD/MM/YYYY"),n=Math.floor(e.toDate().getTime()/864e5),i=m(t);s=o(864e5*(i+1),"x").format("MMMM DD, YYYY"),n>i?(a="expired",c="expired"):(a="valid",c="valid")}else i?(a="non_commercial",c="valid"):(a="invalid",c="invalid");else a="missing",c="missing";if(b()&&(a="valid",c="valid"),!w&&"valid"!==a){const t=v[a]({keyValidityDate:s,hotVersion:r});t&&console["non_commercial"===a?"info":"warn"](v[a]({keyValidityDate:s,hotVersion:r})),w=!0}if("valid"!==c&&e.parentNode){const t=y[c]({keyValidityDate:s,hotVersion:r});if(t){const t=document.createElement("div");t.className="hot-display-license-info",t.innerHTML=y[c]({keyValidityDate:s,hotVersion:r}),e.parentNode.insertBefore(t,e.nextSibling)}}}function S(t){let e=[][h],n=e;if(t[h]!==g("Z"))return!1;for(let o="",i="B<H4P+".split(""),r=g(i.shift());r;r=g(i.shift()||"A"))--r<""[h]?n|=(d(""+d(u(o)+(u(f(t,Math.abs(r),2))+[]).padStart(2,"0")))%97||2)>>1:o=f(t,r,r?1===i[h]?9:8:6);return n===e}},"7c2b":function(t,e,n){"use strict";var o=n("624b"),i=n("8793"),r=n("bf78"),s=n("73d9");t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,n={};try{t=o(Object.prototype,"__proto__","set"),t(n,[]),e=n instanceof Array}catch(a){}return function(n,o){return r(n),s(o),i(n)?(e?t(n,o):n.__proto__=o,n):n}}():void 0)},"7d61":function(t,e,n){"use strict";var o=n("9046"),i=n("2aac"),r=n("48ab"),s=o(o.bind);t.exports=function(t,e){return i(t),void 0===e?t:r?s(t,e):function(){return t.apply(e,arguments)}}},"7dcf4":function(t,e,n){"use strict";var o=n("c5ae");t.exports=function(t){return o(t.length)}},"7dd09":function(t,e,n){"use strict";function o(t){return window.requestAnimationFrame(t)}function i(t){window.cancelAnimationFrame(t)}function r(){return"ontouchstart"in window}function s(){return"undefined"!==typeof window}let a;function l(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return a||(a="object"===typeof Intl?new Intl.Collator(t,e).compare:"function"===typeof String.prototype.localeCompare?(t,e)=>(""+t).localeCompare(e):(t,e)=>t===e?0:t>e?-1:1,a)}n.r(e),n.d(e,"requestAnimationFrame",(function(){return o})),n.d(e,"cancelAnimationFrame",(function(){return i})),n.d(e,"isTouchSupported",(function(){return r})),n.d(e,"isCSR",(function(){return s})),n.d(e,"getComparisonFunction",(function(){return l}))},8033:function(t,e,n){},"80dd":function(t,e,n){"use strict";var o=n("54ad"),i=n("de26"),r=n("69ba"),s=n("592ab"),a=n("7b7f"),l=n("9c76"),c=o.Symbol,h=i("wks"),u=l?c["for"]||c:c&&c.withoutSetter||s;t.exports=function(t){return r(h,t)||(h[t]=a&&r(c,t)?c[t]:u("Symbol."+t)),h[t]}},"81b7":function(t,e,n){"use strict";var o=n("fd18"),i=n("b343"),r=n("939b"),s=Object,a=o("".split);t.exports=i((function(){return!s("z").propertyIsEnumerable(0)}))?function(t){return"String"===r(t)?a(t,""):s(t)}:s},"81d5":function(t,e,n){"use strict";var o=n("7b0b"),i=n("23cb"),r=n("50c4");t.exports=function(t){var e=o(this),n=r(e.length),s=arguments.length,a=i(s>1?arguments[1]:void 0,n),l=s>2?arguments[2]:void 0,c=void 0===l?n:i(l,n);while(c>a)e[a++]=t;return e}},"81ea":function(t,e,n){"use strict";n.r(e),n.d(e,"to2dArray",(function(){return o})),n.d(e,"extendArray",(function(){return i})),n.d(e,"pivot",(function(){return r})),n.d(e,"arrayReduce",(function(){return s})),n.d(e,"arrayFilter",(function(){return a})),n.d(e,"arrayMap",(function(){return l})),n.d(e,"arrayEach",(function(){return c})),n.d(e,"arraySum",(function(){return h})),n.d(e,"arrayMax",(function(){return u})),n.d(e,"arrayMin",(function(){return d})),n.d(e,"arrayAvg",(function(){return f})),n.d(e,"arrayFlatten",(function(){return g})),n.d(e,"arrayUnique",(function(){return p})),n.d(e,"getDifferenceOfArrays",(function(){return m})),n.d(e,"getIntersectionOfArrays",(function(){return b})),n.d(e,"getUnionOfArrays",(function(){return w})),n.d(e,"stringToArray",(function(){return v}));n("d06e"),n("38b3"),n("f448"),n("66e1"),n("2582"),n("f86b"),n("1587"),n("c5d7");function o(t){const e=t.length;let n=0;while(n<e)t[n]=[t[n]],n+=1}function i(t,e){const n=e.length;let o=0;while(o<n)t.push(e[o]),o+=1}function r(t){const e=[];if(!t||0===t.length||!t[0]||0===t[0].length)return e;const n=t.length,o=t[0].length;for(let i=0;i<n;i++)for(let n=0;n<o;n++)e[n]||(e[n]=[]),e[n][i]=t[i][n];return e}function s(t,e,n,o){let i=-1,r=t,s=n;Array.isArray(t)||(r=Array.from(t));const a=r.length;o&&a&&(i+=1,s=r[i]),i+=1;while(i<a)s=e(s,r[i],i,r),i+=1;return s}function a(t,e){let n=0,o=t;Array.isArray(t)||(o=Array.from(t));const i=o.length,r=[];let s=-1;while(n<i){const t=o[n];e(t,n,o)&&(s+=1,r[s]=t),n+=1}return r}function l(t,e){let n=0,o=t;Array.isArray(t)||(o=Array.from(t));const i=o.length,r=[];let s=-1;while(n<i){const t=o[n];s+=1,r[s]=e(t,n,o),n+=1}return r}function c(t,e){let n=0,o=t;Array.isArray(t)||(o=Array.from(t));const i=o.length;while(n<i){if(!1===e(o[n],n,o))break;n+=1}return t}function h(t){return s(t,(t,e)=>t+e,0)}function u(t){return s(t,(t,e)=>t>e?t:e,Array.isArray(t)?t[0]:void 0)}function d(t){return s(t,(t,e)=>t<e?t:e,Array.isArray(t)?t[0]:void 0)}function f(t){return t.length?h(t)/t.length:0}function g(t){return s(t,(t,e)=>t.concat(Array.isArray(e)?g(e):e),[])}function p(t){const e=[];return c(t,t=>{-1===e.indexOf(t)&&e.push(t)}),e}function m(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[o,...i]=[...e];let r=o;return c(i,t=>{r=r.filter(e=>!t.includes(e))}),r}function b(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[o,...i]=[...e];let r=o;return c(i,t=>{r=r.filter(e=>t.includes(e))}),r}function w(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[o,...i]=[...e],r=new Set(o);return c(i,t=>{c(t,t=>{r.has(t)||r.add(t)})}),Array.from(r)}function v(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";return t.split(e)}},"84d8":function(t,e,n){"use strict";var o=n("7b69"),i=n("8793"),r=n("4c54"),s=n("2471"),a=n("86d6"),l=n("80dd"),c=TypeError,h=l("toPrimitive");t.exports=function(t,e){if(!i(t)||r(t))return t;var n,l=s(t,h);if(l){if(void 0===e&&(e="default"),n=o(l,t,e),!i(n)||r(n))return n;throw new c("Can't convert object to primitive value")}return void 0===e&&(e="number"),a(t,e)}},"861dd":function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return l}));n("7a89"),n("d06e");var o=n("5714");function i(t,e,n){return(e=r(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r(t){var e=s(t,"string");return"symbol"==typeof e?e:e+""}function s(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}const a=50;class l extends o["a"]{constructor(t){let{calculationTypes:e,viewportWidth:n,scrollOffset:o,totalColumns:r,columnWidthFn:s,overrideFn:a,inlineStartOffset:l}=t;super(e),i(this,"viewportWidth",0),i(this,"scrollOffset",0),i(this,"zeroBasedScrollOffset",0),i(this,"totalColumns",0),i(this,"columnWidthFn",null),i(this,"columnWidth",0),i(this,"overrideFn",null),i(this,"inlineStartOffset",0),i(this,"totalCalculatedWidth",0),i(this,"startPositions",[]),i(this,"needReverse",!0),this.viewportWidth=n,this.scrollOffset=o,this.zeroBasedScrollOffset=Math.max(o,0),this.totalColumns=r,this.columnWidthFn=s,this.overrideFn=a,this.inlineStartOffset=l,this.calculate()}calculate(){this._initialize(this);for(let t=0;t<this.totalColumns;t++)if(this.columnWidth=this.getColumnWidth(t),this._process(t,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(t){const e=this.columnWidthFn(t);return isNaN(e)?a:e}}},"861e":function(t,e,n){"use strict";t.exports={}},"86d6":function(t,e,n){"use strict";var o=n("7b69"),i=n("73fa"),r=n("8793"),s=TypeError;t.exports=function(t,e){var n,a;if("string"===e&&i(n=t.toString)&&!r(a=o(n,t)))return a;if(i(n=t.valueOf)&&!r(a=o(n,t)))return a;if("string"!==e&&i(n=t.toString)&&!r(a=o(n,t)))return a;throw new s("Can't convert object to primitive value")}},8722:function(t,e,n){var o;!function(e){t.exports=e()}((function(){return function t(e,n,i){function r(a,l){if(!n[a]){if(!e[a]){var c="function"==typeof o&&o;if(!l&&c)return o(a,!0);if(s)return s(a,!0);var h=new Error("Cannot find module '"+a+"'");throw h.code="MODULE_NOT_FOUND",h}var u=n[a]={exports:{}};e[a][0].call(u.exports,(function(t){return r(e[a][1][t]||t)}),u,u.exports,t,e,n,i)}return n[a].exports}for(var s="function"==typeof o&&o,a=0;a<i.length;a++)r(i[a]);return r}({1:[function(t,e,n){!function(t){"use strict";var n,o=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,r=Math.floor,s="[BigNumber Error] ",a=s+"Number primitive has more than 15 significant digits: ",l=1e14,c=14,h=9007199254740991,u=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],d=1e7,f=1e9;function g(t){var e=0|t;return 0<t||t===e?e:e-1}function p(t){for(var e,n,o=1,i=t.length,r=t[0]+"";o<i;){for(e=t[o++]+"",n=c-e.length;n--;e="0"+e);r+=e}for(i=r.length;48===r.charCodeAt(--i););return r.slice(0,i+1||1)}function m(t,e){var n,o,i=t.c,r=e.c,s=t.s,a=e.s,l=t.e,c=e.e;if(!s||!a)return null;if(n=i&&!i[0],o=r&&!r[0],n||o)return n?o?0:-a:s;if(s!=a)return s;if(n=s<0,o=l==c,!i||!r)return o?0:!i^n?1:-1;if(!o)return c<l^n?1:-1;for(a=(l=i.length)<(c=r.length)?l:c,s=0;s<a;s++)if(i[s]!=r[s])return i[s]>r[s]^n?1:-1;return l==c?0:c<l^n?1:-1}function b(t,e,n,o){if(t<e||n<t||t!==(t<0?i(t):r(t)))throw Error(s+(o||"Argument")+("number"==typeof t?t<e||n<t?" out of range: ":" not an integer: ":" not a primitive number: ")+String(t))}function w(t){var e=t.c.length-1;return g(t.e/c)==e&&t.c[e]%2!=0}function v(t,e){return(1<t.length?t.charAt(0)+"."+t.slice(1):t)+(e<0?"e":"e+")+e}function y(t,e,n){var o,i;if(e<0){for(i=n+".";++e;i+=n);t=i+t}else if(++e>(o=t.length)){for(i=n,e-=o;--e;i+=n);t+=i}else e<o&&(t=t.slice(0,e)+"."+t.slice(e));return t}(n=function t(e){var n,C,S,O,E,R,T,M,I,x,N=U.prototype={constructor:U,toString:null,valueOf:null},A=new U(1),H=20,j=4,_=-7,k=21,P=-1e7,D=1e7,L=!1,F=1,V=0,W={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"",suffix:""},B="0123456789abcdefghijklmnopqrstuvwxyz";function U(t,e){var n,i,s,l,u,d,f,g,p=this;if(!(p instanceof U))return new U(t,e);if(null==e){if(t instanceof U)return p.s=t.s,p.e=t.e,void(p.c=(t=t.c)?t.slice():t);if((d="number"==typeof t)&&0*t==0){if(p.s=1/t<0?(t=-t,-1):1,t===~~t){for(l=0,u=t;10<=u;u/=10,l++);return p.e=l,void(p.c=[t])}g=String(t)}else{if(g=String(t),!o.test(g))return S(p,g,d);p.s=45==g.charCodeAt(0)?(g=g.slice(1),-1):1}-1<(l=g.indexOf("."))&&(g=g.replace(".","")),0<(u=g.search(/e/i))?(l<0&&(l=u),l+=+g.slice(u+1),g=g.substring(0,u)):l<0&&(l=g.length)}else{if(b(e,2,B.length,"Base"),g=String(t),10==e)return X(p=new U(t instanceof U?t:g),H+p.e+1,j);if(d="number"==typeof t){if(0*t!=0)return S(p,g,d,e);if(p.s=1/t<0?(g=g.slice(1),-1):1,U.DEBUG&&15<g.replace(/^0\.0*|\./,"").length)throw Error(a+t);d=!1}else p.s=45===g.charCodeAt(0)?(g=g.slice(1),-1):1;for(n=B.slice(0,e),l=u=0,f=g.length;u<f;u++)if(n.indexOf(i=g.charAt(u))<0){if("."==i){if(l<u){l=f;continue}}else if(!s&&(g==g.toUpperCase()&&(g=g.toLowerCase())||g==g.toLowerCase()&&(g=g.toUpperCase()))){s=!0,u=-1,l=0;continue}return S(p,String(t),d,e)}-1<(l=(g=C(g,e,10,p.s)).indexOf("."))?g=g.replace(".",""):l=g.length}for(u=0;48===g.charCodeAt(u);u++);for(f=g.length;48===g.charCodeAt(--f););if(g=g.slice(u,++f)){if(f-=u,d&&U.DEBUG&&15<f&&(h<t||t!==r(t)))throw Error(a+p.s*t);if(D<(l=l-u-1))p.c=p.e=null;else if(l<P)p.c=[p.e=0];else{if(p.e=l,p.c=[],u=(l+1)%c,l<0&&(u+=c),u<f){for(u&&p.c.push(+g.slice(0,u)),f-=c;u<f;)p.c.push(+g.slice(u,u+=c));g=g.slice(u),u=c-g.length}else u-=f;for(;u--;g+="0");p.c.push(+g)}}else p.c=[p.e=0]}function z(t,e,n,o){var i,r,s,a,l;if(null==n?n=j:b(n,0,8),!t.c)return t.toString();if(i=t.c[0],s=t.e,null==e)l=p(t.c),l=1==o||2==o&&(s<=_||k<=s)?v(l,s):y(l,s,"0");else if(r=(t=X(new U(t),e,n)).e,a=(l=p(t.c)).length,1==o||2==o&&(e<=r||r<=_)){for(;a<e;l+="0",a++);l=v(l,r)}else if(e-=s,l=y(l,r,"0"),a<r+1){if(0<--e)for(l+=".";e--;l+="0");}else if(0<(e+=r-a))for(r+1==a&&(l+=".");e--;l+="0");return t.s<0&&i?"-"+l:l}function G(t,e){for(var n,o=1,i=new U(t[0]);o<t.length;o++){if(!(n=new U(t[o])).s){i=n;break}e.call(i,n)&&(i=n)}return i}function Y(t,e,n){for(var o=1,i=e.length;!e[--i];e.pop());for(i=e[0];10<=i;i/=10,o++);return(n=o+n*c-1)>D?t.c=t.e=null:t.c=n<P?[t.e=0]:(t.e=n,e),t}function X(t,e,n,o){var s,a,h,d,f,g,p,m=t.c,b=u;if(m){t:{for(s=1,d=m[0];10<=d;d/=10,s++);if((a=e-s)<0)a+=c,h=e,p=(f=m[g=0])/b[s-h-1]%10|0;else if((g=i((a+1)/c))>=m.length){if(!o)break t;for(;m.length<=g;m.push(0));f=p=0,h=(a%=c)-c+(s=1)}else{for(f=d=m[g],s=1;10<=d;d/=10,s++);p=(h=(a%=c)-c+s)<0?0:f/b[s-h-1]%10|0}if(o=o||e<0||null!=m[g+1]||(h<0?f:f%b[s-h-1]),o=n<4?(p||o)&&(0==n||n==(t.s<0?3:2)):5<p||5==p&&(4==n||o||6==n&&(0<a?0<h?f/b[s-h]:0:m[g-1])%10&1||n==(t.s<0?8:7)),e<1||!m[0])return m.length=0,o?(e-=t.e+1,m[0]=b[(c-e%c)%c],t.e=-e||0):m[0]=t.e=0,t;if(0==a?(m.length=g,d=1,g--):(m.length=g+1,d=b[c-a],m[g]=0<h?r(f/b[s-h]%b[h])*d:0),o)for(;;){if(0==g){for(a=1,h=m[0];10<=h;h/=10,a++);for(h=m[0]+=d,d=1;10<=h;h/=10,d++);a!=d&&(t.e++,m[0]==l&&(m[0]=1));break}if(m[g]+=d,m[g]!=l)break;m[g--]=0,d=1}for(a=m.length;0===m[--a];m.pop());}t.e>D?t.c=t.e=null:t.e<P&&(t.c=[t.e=0])}return t}function $(t){var e,n=t.e;return null===n?t.toString():(e=p(t.c),e=n<=_||k<=n?v(e,n):y(e,n,"0"),t.s<0?"-"+e:e)}return U.clone=t,U.ROUND_UP=0,U.ROUND_DOWN=1,U.ROUND_CEIL=2,U.ROUND_FLOOR=3,U.ROUND_HALF_UP=4,U.ROUND_HALF_DOWN=5,U.ROUND_HALF_EVEN=6,U.ROUND_HALF_CEIL=7,U.ROUND_HALF_FLOOR=8,U.EUCLID=9,U.config=U.set=function(t){var e,n;if(null!=t){if("object"!=typeof t)throw Error(s+"Object expected: "+t);if(t.hasOwnProperty(e="DECIMAL_PLACES")&&(b(n=t[e],0,f,e),H=n),t.hasOwnProperty(e="ROUNDING_MODE")&&(b(n=t[e],0,8,e),j=n),t.hasOwnProperty(e="EXPONENTIAL_AT")&&((n=t[e])&&n.pop?(b(n[0],-f,0,e),b(n[1],0,f,e),_=n[0],k=n[1]):(b(n,-f,f,e),_=-(k=n<0?-n:n))),t.hasOwnProperty(e="RANGE"))if((n=t[e])&&n.pop)b(n[0],-f,-1,e),b(n[1],1,f,e),P=n[0],D=n[1];else{if(b(n,-f,f,e),!n)throw Error(s+e+" cannot be zero: "+n);P=-(D=n<0?-n:n)}if(t.hasOwnProperty(e="CRYPTO")){if((n=t[e])!==!!n)throw Error(s+e+" not true or false: "+n);if(n){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw L=!n,Error(s+"crypto unavailable");L=n}else L=n}if(t.hasOwnProperty(e="MODULO_MODE")&&(b(n=t[e],0,9,e),F=n),t.hasOwnProperty(e="POW_PRECISION")&&(b(n=t[e],0,f,e),V=n),t.hasOwnProperty(e="FORMAT")){if("object"!=typeof(n=t[e]))throw Error(s+e+" not an object: "+n);W=n}if(t.hasOwnProperty(e="ALPHABET")){if("string"!=typeof(n=t[e])||/^.$|[+-.\s]|(.).*\1/.test(n))throw Error(s+e+" invalid: "+n);B=n}}return{DECIMAL_PLACES:H,ROUNDING_MODE:j,EXPONENTIAL_AT:[_,k],RANGE:[P,D],CRYPTO:L,MODULO_MODE:F,POW_PRECISION:V,FORMAT:W,ALPHABET:B}},U.isBigNumber=function(t){return t instanceof U||t&&!0===t._isBigNumber||!1},U.maximum=U.max=function(){return G(arguments,N.lt)},U.minimum=U.min=function(){return G(arguments,N.gt)},U.random=(O=9007199254740992,E=Math.random()*O&2097151?function(){return r(Math.random()*O)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(t){var e,n,o,a,l,h=0,d=[],g=new U(A);if(null==t?t=H:b(t,0,f),a=i(t/c),L)if(crypto.getRandomValues){for(e=crypto.getRandomValues(new Uint32Array(a*=2));h<a;)9e15<=(l=131072*e[h]+(e[h+1]>>>11))?(n=crypto.getRandomValues(new Uint32Array(2)),e[h]=n[0],e[h+1]=n[1]):(d.push(l%1e14),h+=2);h=a/2}else{if(!crypto.randomBytes)throw L=!1,Error(s+"crypto unavailable");for(e=crypto.randomBytes(a*=7);h<a;)9e15<=(l=281474976710656*(31&e[h])+1099511627776*e[h+1]+4294967296*e[h+2]+16777216*e[h+3]+(e[h+4]<<16)+(e[h+5]<<8)+e[h+6])?crypto.randomBytes(7).copy(e,h):(d.push(l%1e14),h+=7);h=a/7}if(!L)for(;h<a;)(l=E())<9e15&&(d[h++]=l%1e14);for(a=d[--h],t%=c,a&&t&&(l=u[c-t],d[h]=r(a/l)*l);0===d[h];d.pop(),h--);if(h<0)d=[o=0];else{for(o=-1;0===d[0];d.splice(0,1),o-=c);for(h=1,l=d[0];10<=l;l/=10,h++);h<c&&(o-=c-h)}return g.e=o,g.c=d,g}),U.sum=function(){for(var t=1,e=arguments,n=new U(e[0]);t<e.length;)n=n.plus(e[t++]);return n},C=function(){var t="0123456789";function e(t,e,n,o){for(var i,r,s=[0],a=0,l=t.length;a<l;){for(r=s.length;r--;s[r]*=e);for(s[0]+=o.indexOf(t.charAt(a++)),i=0;i<s.length;i++)s[i]>n-1&&(null==s[i+1]&&(s[i+1]=0),s[i+1]+=s[i]/n|0,s[i]%=n)}return s.reverse()}return function(o,i,r,s,a){var l,c,h,u,d,f,g,m,b=o.indexOf("."),w=H,v=j;for(0<=b&&(u=V,V=0,o=o.replace(".",""),f=(m=new U(i)).pow(o.length-b),V=u,m.c=e(y(p(f.c),f.e,"0"),10,r,t),m.e=m.c.length),h=u=(g=e(o,i,r,a?(l=B,t):(l=t,B))).length;0==g[--u];g.pop());if(!g[0])return l.charAt(0);if(b<0?--h:(f.c=g,f.e=h,f.s=s,g=(f=n(f,m,w,v,r)).c,d=f.r,h=f.e),b=g[c=h+w+1],u=r/2,d=d||c<0||null!=g[c+1],d=v<4?(null!=b||d)&&(0==v||v==(f.s<0?3:2)):u<b||b==u&&(4==v||d||6==v&&1&g[c-1]||v==(f.s<0?8:7)),c<1||!g[0])o=d?y(l.charAt(1),-w,l.charAt(0)):l.charAt(0);else{if(g.length=c,d)for(--r;++g[--c]>r;)g[c]=0,c||(++h,g=[1].concat(g));for(u=g.length;!g[--u];);for(b=0,o="";b<=u;o+=l.charAt(g[b++]));o=y(o,h,l.charAt(0))}return o}}(),n=function(){function t(t,e,n){var o,i,r,s,a=0,l=t.length,c=e%d,h=e/d|0;for(t=t.slice();l--;)a=((i=c*(r=t[l]%d)+(o=h*r+(s=t[l]/d|0)*c)%d*d+a)/n|0)+(o/d|0)+h*s,t[l]=i%n;return a&&(t=[a].concat(t)),t}function e(t,e,n,o){var i,r;if(n!=o)r=o<n?1:-1;else for(i=r=0;i<n;i++)if(t[i]!=e[i]){r=t[i]>e[i]?1:-1;break}return r}function n(t,e,n,o){for(var i=0;n--;)t[n]-=i,i=t[n]<e[n]?1:0,t[n]=i*o+t[n]-e[n];for(;!t[0]&&1<t.length;t.splice(0,1));}return function(o,i,s,a,h){var u,d,f,p,m,b,w,v,y,C,S,O,E,R,T,M,I,x=o.s==i.s?1:-1,N=o.c,A=i.c;if(!(N&&N[0]&&A&&A[0]))return new U(o.s&&i.s&&(N?!A||N[0]!=A[0]:A)?N&&0==N[0]||!A?0*x:x/0:NaN);for(y=(v=new U(x)).c=[],x=s+(d=o.e-i.e)+1,h||(h=l,d=g(o.e/c)-g(i.e/c),x=x/c|0),f=0;A[f]==(N[f]||0);f++);if(A[f]>(N[f]||0)&&d--,x<0)y.push(1),p=!0;else{for(R=N.length,M=A.length,x+=2,1<(m=r(h/(A[f=0]+1)))&&(A=t(A,m,h),N=t(N,m,h),M=A.length,R=N.length),E=M,S=(C=N.slice(0,M)).length;S<M;C[S++]=0);I=A.slice(),I=[0].concat(I),T=A[0],A[1]>=h/2&&T++;do{if(m=0,(u=e(A,C,M,S))<0){if(O=C[0],M!=S&&(O=O*h+(C[1]||0)),1<(m=r(O/T)))for(h<=m&&(m=h-1),w=(b=t(A,m,h)).length,S=C.length;1==e(b,C,w,S);)m--,n(b,M<w?I:A,w,h),w=b.length,u=1;else 0==m&&(u=m=1),w=(b=A.slice()).length;if(w<S&&(b=[0].concat(b)),n(C,b,S,h),S=C.length,-1==u)for(;e(A,C,M,S)<1;)m++,n(C,M<S?I:A,S,h),S=C.length}else 0===u&&(m++,C=[0]);y[f++]=m,C[0]?C[S++]=N[E]||0:(C=[N[E]],S=1)}while((E++<R||null!=C[0])&&x--);p=null!=C[0],y[0]||y.splice(0,1)}if(h==l){for(f=1,x=y[0];10<=x;x/=10,f++);X(v,s+(v.e=f+d*c-1)+1,a,p)}else v.e=d,v.r=+p;return v}}(),R=/^(-?)0([xbo])(?=\w[\w.]*$)/i,T=/^([^.]+)\.$/,M=/^\.([^.]+)$/,I=/^-?(Infinity|NaN)$/,x=/^\s*\+(?=[\w.])|^\s+|\s+$/g,S=function(t,e,n,o){var i,r=n?e:e.replace(x,"");if(I.test(r))t.s=isNaN(r)?null:r<0?-1:1,t.c=t.e=null;else{if(!n&&(r=r.replace(R,(function(t,e,n){return i="x"==(n=n.toLowerCase())?16:"b"==n?2:8,o&&o!=i?t:e})),o&&(i=o,r=r.replace(T,"$1").replace(M,"0.$1")),e!=r))return new U(r,i);if(U.DEBUG)throw Error(s+"Not a"+(o?" base "+o:"")+" number: "+e);t.c=t.e=t.s=null}},N.absoluteValue=N.abs=function(){var t=new U(this);return t.s<0&&(t.s=1),t},N.comparedTo=function(t,e){return m(this,new U(t,e))},N.decimalPlaces=N.dp=function(t,e){var n,o,i;if(null!=t)return b(t,0,f),null==e?e=j:b(e,0,8),X(new U(this),t+this.e+1,e);if(!(n=this.c))return null;if(o=((i=n.length-1)-g(this.e/c))*c,i=n[i])for(;i%10==0;i/=10,o--);return o<0&&(o=0),o},N.dividedBy=N.div=function(t,e){return n(this,new U(t,e),H,j)},N.dividedToIntegerBy=N.idiv=function(t,e){return n(this,new U(t,e),0,1)},N.exponentiatedBy=N.pow=function(t,e){var n,o,a,l,h,u,d,f,g=this;if((t=new U(t)).c&&!t.isInteger())throw Error(s+"Exponent not an integer: "+$(t));if(null!=e&&(e=new U(e)),h=14<t.e,!g.c||!g.c[0]||1==g.c[0]&&!g.e&&1==g.c.length||!t.c||!t.c[0])return f=new U(Math.pow(+$(g),h?2-w(t):+$(t))),e?f.mod(e):f;if(u=t.s<0,e){if(e.c?!e.c[0]:!e.s)return new U(NaN);(o=!u&&g.isInteger()&&e.isInteger())&&(g=g.mod(e))}else{if(9<t.e&&(0<g.e||g.e<-1||(0==g.e?1<g.c[0]||h&&24e7<=g.c[1]:g.c[0]<8e13||h&&g.c[0]<=9999975e7)))return l=g.s<0&&w(t)?-0:0,-1<g.e&&(l=1/l),new U(u?1/l:l);V&&(l=i(V/c+2))}for(d=h?(n=new U(.5),u&&(t.s=1),w(t)):(a=Math.abs(+$(t)))%2,f=new U(A);;){if(d){if(!(f=f.times(g)).c)break;l?f.c.length>l&&(f.c.length=l):o&&(f=f.mod(e))}if(a){if(0===(a=r(a/2)))break;d=a%2}else if(X(t=t.times(n),t.e+1,1),14<t.e)d=w(t);else{if(0==(a=+$(t)))break;d=a%2}g=g.times(g),l?g.c&&g.c.length>l&&(g.c.length=l):o&&(g=g.mod(e))}return o?f:(u&&(f=A.div(f)),e?f.mod(e):l?X(f,V,j,void 0):f)},N.integerValue=function(t){var e=new U(this);return null==t?t=j:b(t,0,8),X(e,e.e+1,t)},N.isEqualTo=N.eq=function(t,e){return 0===m(this,new U(t,e))},N.isFinite=function(){return!!this.c},N.isGreaterThan=N.gt=function(t,e){return 0<m(this,new U(t,e))},N.isGreaterThanOrEqualTo=N.gte=function(t,e){return 1===(e=m(this,new U(t,e)))||0===e},N.isInteger=function(){return!!this.c&&g(this.e/c)>this.c.length-2},N.isLessThan=N.lt=function(t,e){return m(this,new U(t,e))<0},N.isLessThanOrEqualTo=N.lte=function(t,e){return-1===(e=m(this,new U(t,e)))||0===e},N.isNaN=function(){return!this.s},N.isNegative=function(){return this.s<0},N.isPositive=function(){return 0<this.s},N.isZero=function(){return!!this.c&&0==this.c[0]},N.minus=function(t,e){var n,o,i,r,s=this,a=s.s;if(e=(t=new U(t,e)).s,!a||!e)return new U(NaN);if(a!=e)return t.s=-e,s.plus(t);var h=s.e/c,u=t.e/c,d=s.c,f=t.c;if(!h||!u){if(!d||!f)return d?(t.s=-e,t):new U(f?s:NaN);if(!d[0]||!f[0])return f[0]?(t.s=-e,t):new U(d[0]?s:3==j?-0:0)}if(h=g(h),u=g(u),d=d.slice(),a=h-u){for((i=(r=a<0)?(a=-a,d):(u=h,f)).reverse(),e=a;e--;i.push(0));i.reverse()}else for(o=(r=(a=d.length)<(e=f.length))?a:e,a=e=0;e<o;e++)if(d[e]!=f[e]){r=d[e]<f[e];break}if(r&&(i=d,d=f,f=i,t.s=-t.s),0<(e=(o=f.length)-(n=d.length)))for(;e--;d[n++]=0);for(e=l-1;a<o;){if(d[--o]<f[o]){for(n=o;n&&!d[--n];d[n]=e);--d[n],d[o]+=l}d[o]-=f[o]}for(;0==d[0];d.splice(0,1),--u);return d[0]?Y(t,d,u):(t.s=3==j?-1:1,t.c=[t.e=0],t)},N.modulo=N.mod=function(t,e){var o,i,r=this;return t=new U(t,e),!r.c||!t.s||t.c&&!t.c[0]?new U(NaN):!t.c||r.c&&!r.c[0]?new U(r):(9==F?(i=t.s,t.s=1,o=n(r,t,0,3),t.s=i,o.s*=i):o=n(r,t,0,F),(t=r.minus(o.times(t))).c[0]||1!=F||(t.s=r.s),t)},N.multipliedBy=N.times=function(t,e){var n,o,i,r,s,a,h,u,f,p,m,b,w,v,y,C=this,S=C.c,O=(t=new U(t,e)).c;if(!(S&&O&&S[0]&&O[0]))return!C.s||!t.s||S&&!S[0]&&!O||O&&!O[0]&&!S?t.c=t.e=t.s=null:(t.s*=C.s,S&&O?(t.c=[0],t.e=0):t.c=t.e=null),t;for(o=g(C.e/c)+g(t.e/c),t.s*=C.s,(h=S.length)<(p=O.length)&&(w=S,S=O,O=w,i=h,h=p,p=i),i=h+p,w=[];i--;w.push(0));for(v=l,y=d,i=p;0<=--i;){for(n=0,m=O[i]%y,b=O[i]/y|0,r=i+(s=h);i<r;)n=((u=m*(u=S[--s]%y)+(a=b*u+(f=S[s]/y|0)*m)%y*y+w[r]+n)/v|0)+(a/y|0)+b*f,w[r--]=u%v;w[r]=n}return n?++o:w.splice(0,1),Y(t,w,o)},N.negated=function(){var t=new U(this);return t.s=-t.s||null,t},N.plus=function(t,e){var n,o=this,i=o.s;if(e=(t=new U(t,e)).s,!i||!e)return new U(NaN);if(i!=e)return t.s=-e,o.minus(t);var r=o.e/c,s=t.e/c,a=o.c,h=t.c;if(!r||!s){if(!a||!h)return new U(i/0);if(!a[0]||!h[0])return h[0]?t:new U(a[0]?o:0*i)}if(r=g(r),s=g(s),a=a.slice(),i=r-s){for((n=0<i?(s=r,h):(i=-i,a)).reverse();i--;n.push(0));n.reverse()}for((i=a.length)-(e=h.length)<0&&(n=h,h=a,a=n,e=i),i=0;e;)i=(a[--e]=a[e]+h[e]+i)/l|0,a[e]=l===a[e]?0:a[e]%l;return i&&(a=[i].concat(a),++s),Y(t,a,s)},N.precision=N.sd=function(t,e){var n,o,i;if(null!=t&&t!==!!t)return b(t,1,f),null==e?e=j:b(e,0,8),X(new U(this),t,e);if(!(n=this.c))return null;if(o=(i=n.length-1)*c+1,i=n[i]){for(;i%10==0;i/=10,o--);for(i=n[0];10<=i;i/=10,o++);}return t&&this.e+1>o&&(o=this.e+1),o},N.shiftedBy=function(t){return b(t,-h,h),this.times("1e"+t)},N.squareRoot=N.sqrt=function(){var t,e,o,i,r,s=this,a=s.c,l=s.s,c=s.e,h=H+4,u=new U("0.5");if(1!==l||!a||!a[0])return new U(!l||l<0&&(!a||a[0])?NaN:a?s:1/0);if((o=0==(l=Math.sqrt(+$(s)))||l==1/0?(((e=p(a)).length+c)%2==0&&(e+="0"),l=Math.sqrt(+e),c=g((c+1)/2)-(c<0||c%2),new U(e=l==1/0?"1e"+c:(e=l.toExponential()).slice(0,e.indexOf("e")+1)+c)):new U(l+"")).c[0])for((l=(c=o.e)+h)<3&&(l=0);;)if(r=o,o=u.times(r.plus(n(s,r,h,1))),p(r.c).slice(0,l)===(e=p(o.c)).slice(0,l)){if(o.e<c&&--l,"9999"!=(e=e.slice(l-3,l+1))&&(i||"4999"!=e)){+e&&(+e.slice(1)||"5"!=e.charAt(0))||(X(o,o.e+H+2,1),t=!o.times(o).eq(s));break}if(!i&&(X(r,r.e+H+2,0),r.times(r).eq(s))){o=r;break}h+=4,l+=4,i=1}return X(o,o.e+H+1,j,t)},N.toExponential=function(t,e){return null!=t&&(b(t,0,f),t++),z(this,t,e,1)},N.toFixed=function(t,e){return null!=t&&(b(t,0,f),t=t+this.e+1),z(this,t,e)},N.toFormat=function(t,e,n){var o;if(null==n)null!=t&&e&&"object"==typeof e?(n=e,e=null):t&&"object"==typeof t?(n=t,t=e=null):n=W;else if("object"!=typeof n)throw Error(s+"Argument not an object: "+n);if(o=this.toFixed(t,e),this.c){var i,r=o.split("."),a=+n.groupSize,l=+n.secondaryGroupSize,c=n.groupSeparator||"",h=r[0],u=r[1],d=this.s<0,f=d?h.slice(1):h,g=f.length;if(l&&(i=a,a=l,g-=l=i),0<a&&0<g){for(i=g%a||a,h=f.substr(0,i);i<g;i+=a)h+=c+f.substr(i,a);0<l&&(h+=c+f.slice(i)),d&&(h="-"+h)}o=u?h+(n.decimalSeparator||"")+((l=+n.fractionGroupSize)?u.replace(new RegExp("\\d{"+l+"}\\B","g"),"$&"+(n.fractionGroupSeparator||"")):u):h}return(n.prefix||"")+o+(n.suffix||"")},N.toFraction=function(t){var e,o,i,r,a,l,h,d,f,g,m,b,w=this,v=w.c;if(null!=t&&(!(h=new U(t)).isInteger()&&(h.c||1!==h.s)||h.lt(A)))throw Error(s+"Argument "+(h.isInteger()?"out of range: ":"not an integer: ")+$(h));if(!v)return new U(w);for(e=new U(A),f=o=new U(A),i=d=new U(A),b=p(v),a=e.e=b.length-w.e-1,e.c[0]=u[(l=a%c)<0?c+l:l],t=!t||0<h.comparedTo(e)?0<a?e:f:h,l=D,D=1/0,h=new U(b),d.c[0]=0;g=n(h,e,0,1),1!=(r=o.plus(g.times(i))).comparedTo(t);)o=i,i=r,f=d.plus(g.times(r=f)),d=r,e=h.minus(g.times(r=e)),h=r;return r=n(t.minus(o),i,0,1),d=d.plus(r.times(f)),o=o.plus(r.times(i)),d.s=f.s=w.s,m=n(f,i,a*=2,j).minus(w).abs().comparedTo(n(d,o,a,j).minus(w).abs())<1?[f,i]:[d,o],D=l,m},N.toNumber=function(){return+$(this)},N.toPrecision=function(t,e){return null!=t&&b(t,1,f),z(this,t,e,2)},N.toString=function(t){var e,n=this,o=n.s,i=n.e;return null===i?o?(e="Infinity",o<0&&(e="-"+e)):e="NaN":(e=null==t?i<=_||k<=i?v(p(n.c),i):y(p(n.c),i,"0"):10===t?y(p((n=X(new U(n),H+i+1,j)).c),n.e,"0"):(b(t,2,B.length,"Base"),C(y(p(n.c),i,"0"),10,t,o,!0)),o<0&&n.c[0]&&(e="-"+e)),e},N.valueOf=N.toJSON=function(){return $(this)},N._isBigNumber=!0,"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator&&(N[Symbol.toStringTag]="BigNumber",N[Symbol.for("nodejs.util.inspect.custom")]=N.valueOf),null!=e&&U.set(e),U}()).default=n.BigNumber=n,void 0!==e&&e.exports?e.exports=n:(t||(t="undefined"!=typeof self&&self?self:window),t.BigNumber=n)}(this)},{}],2:[function(t,e,n){"use strict";e.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(t){var e=t%10;return 1==~~(t%100/10)?"th":1===e?"st":2===e?"nd":3===e?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(t,e,n){"use strict";function o(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],o=!0,i=!1,r=void 0;try{for(var s,a=t[Symbol.iterator]();!(o=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);o=!0);}catch(t){i=!0,r=t}finally{try{o||null==a.return||a.return()}finally{if(i)throw r}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var i=t("./globalState"),r=t("./validating"),s=t("./parsing"),a=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],l={general:{scale:1024,suffixes:a,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:a,marker:"d"}},c={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function h(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length?arguments[2]:void 0;if("string"==typeof e&&(e=s.parseFormat(e)),!r.validateFormat(e))return"ERROR: invalid format";var o=e.prefix||"",a=e.postfix||"",h=function(t,e,n){switch(e.output){case"currency":return e=p(e,i.currentCurrencyDefaultFormat()),function(t,e,n){var o=n.currentCurrency(),i=Object.assign({},c,e),r=void 0,s="",a=!!i.totalLength||!!i.forceAverage||i.average,l=e.currencyPosition||o.position,h=e.currencySymbol||o.symbol;i.spaceSeparated&&(s=" "),"infix"===l&&(r=s+h+s);var u=g({instance:t,providedFormat:e,state:n,decimalSeparator:r});return"prefix"===l&&(u=t._value<0&&"sign"===i.negative?"-".concat(s).concat(h).concat(u.slice(1)):h+s+u),l&&"postfix"!==l||(u=u+(s=a?"":s)+h),u}(t,e,i);case"percent":return e=p(e,i.currentPercentageDefaultFormat()),function(t,e,n,o){var i=e.prefixSymbol,r=g({instance:o(100*t._value),providedFormat:e,state:n}),s=Object.assign({},c,e);return i?"%".concat(s.spaceSeparated?" ":"").concat(r):"".concat(r).concat(s.spaceSeparated?" ":"","%")}(t,e,i,n);case"byte":return e=p(e,i.currentByteDefaultFormat()),y=t,S=i,O=n,E=(C=e).base||"binary",R=l[E],T=u(y._value,R.suffixes,R.scale),M=T.value,I=T.suffix,x=g({instance:O(M),providedFormat:C,state:S,defaults:S.currentByteDefaultFormat()}),N=S.currentAbbreviations(),"".concat(x).concat(N.spaced?" ":"").concat(I);case"time":return e=p(e,i.currentTimeDefaultFormat()),m=t,b=Math.floor(m._value/60/60),w=Math.floor((m._value-60*b*60)/60),v=Math.round(m._value-60*b*60-60*w),"".concat(b,":").concat(w<10?"0":"").concat(w,":").concat(v<10?"0":"").concat(v);case"ordinal":return e=p(e,i.currentOrdinalDefaultFormat()),o=t,r=e,a=(s=i).currentOrdinal(),h=Object.assign({},c,r),d=g({instance:o,providedFormat:r,state:s}),f=a(o._value),"".concat(d).concat(h.spaceSeparated?" ":"").concat(f);case"number":default:return g({instance:t,providedFormat:e,numbro:n})}var o,r,s,a,h,d,f,m,b,w,v,y,C,S,O,E,R,T,M,I,x,N}(t,e,n);return(h=o+h)+a}function u(t,e,n){var o=e[0],i=Math.abs(t);if(n<=i){for(var r=1;r<e.length;++r){var s=Math.pow(n,r),a=Math.pow(n,r+1);if(s<=i&&i<a){o=e[r],t/=s;break}}o===e[0]&&(t/=Math.pow(n,e.length-1),o=e[e.length-1])}return{value:t,suffix:o}}function d(t){for(var e="",n=0;n<t;n++)e+="0";return e}function f(t,e){return-1!==t.toString().indexOf("e")?function(t,e){var n=t.toString(),i=o(n.split("e"),2),r=i[0],s=i[1],a=o(r.split("."),2),l=a[0],c=a[1],h=void 0===c?"":c;if(0<+s)n=l+h+d(s-h.length);else{var u=".";u=+l<0?"-0".concat(u):"0".concat(u);var f=(d(-s-1)+Math.abs(l)+h).substr(0,e);f.length<e&&(f+=d(e-f.length)),n=u+f}return 0<+s&&0<e&&(n+=".".concat(d(e))),n}(t,e):(Math.round(+"".concat(t,"e+").concat(e))/Math.pow(10,e)).toFixed(e)}function g(t){var e=t.instance,n=t.providedFormat,r=t.state,s=void 0===r?i:r,a=t.decimalSeparator,l=t.defaults,h=void 0===l?s.currentDefaults():l,u=e._value;if(0===u&&s.hasZeroFormat())return s.getZeroFormat();if(!isFinite(u))return u.toString();var d,g,p,m,b,w,v,y,C=Object.assign({},c,h,n),S=C.totalLength,O=S?0:C.characteristic,E=C.optionalCharacteristic,R=C.forceAverage,T=!!S||!!R||C.average,M=S?-1:T&&void 0===n.mantissa?0:C.mantissa,I=!S&&(void 0===n.optionalMantissa?-1===M:C.optionalMantissa),x=C.trimMantissa,N=C.thousandSeparated,A=C.spaceSeparated,H=C.negative,j=C.forceSign,_=C.exponential,k="";if(T){var P=function(t){var e=t.value,n=t.forceAverage,o=t.abbreviations,i=t.spaceSeparated,r=void 0!==i&&i,s=t.totalLength,a=void 0===s?0:s,l="",c=Math.abs(e),h=-1;if(c>=Math.pow(10,12)&&!n||"trillion"===n?(l=o.trillion,e/=Math.pow(10,12)):c<Math.pow(10,12)&&c>=Math.pow(10,9)&&!n||"billion"===n?(l=o.billion,e/=Math.pow(10,9)):c<Math.pow(10,9)&&c>=Math.pow(10,6)&&!n||"million"===n?(l=o.million,e/=Math.pow(10,6)):(c<Math.pow(10,6)&&c>=Math.pow(10,3)&&!n||"thousand"===n)&&(l=o.thousand,e/=Math.pow(10,3)),l&&(l=(r?" ":"")+l),a){var u=e.toString().split(".")[0];h=Math.max(a-u.length,0)}return{value:e,abbreviation:l,mantissaPrecision:h}}({value:u,forceAverage:R,abbreviations:s.currentAbbreviations(),spaceSeparated:A,totalLength:S});u=P.value,k+=P.abbreviation,S&&(M=P.mantissaPrecision)}if(_){var D=(g=(d={value:u,characteristicPrecision:O}).value,p=d.characteristicPrecision,m=void 0===p?0:p,b=o(g.toExponential().split("e"),2),w=b[0],v=b[1],y=+w,m&&1<m&&(y*=Math.pow(10,m-1),v=0<=(v=+v-(m-1))?"+".concat(v):v),{value:y,abbreviation:"e".concat(v)});u=D.value,k=D.abbreviation+k}var L,F,V,W=function(t,e,n,i,r){if(-1===i)return t;var s=f(e,i),a=o(s.toString().split("."),2),l=a[0],c=a[1],h=void 0===c?"":c;if(h.match(/^0+$/)&&(n||r))return l;var u=h.match(/0+$/);return r&&u?"".concat(l,".").concat(h.toString().slice(0,u.index)):s.toString()}(u.toString(),u,I,M,x);return W=function(t,e,n,o,i){var r=o.currentDelimiters(),s=r.thousands;i=i||r.decimal;var a=r.thousandsSize||3,l=t.toString(),c=l.split(".")[0],h=l.split(".")[1];return n&&(e<0&&(c=c.slice(1)),function(t,e){for(var n=[],o=0,i=t;0<i;i--)o===e&&(n.unshift(i),o=0),o++;return n}(c.length,a).forEach((function(t,e){c=c.slice(0,t+e)+s+c.slice(t+e)})),e<0&&(c="-".concat(c))),h?c+i+h:c}(W=function(t,e,n,i){var r=t,s=o(r.toString().split("."),2),a=s[0],l=s[1];if(a.match(/^-?0$/)&&n)return l?"".concat(a.replace("0",""),".").concat(l):a.replace("0","");if(a.length<i)for(var c=i-a.length,h=0;h<c;h++)r="0".concat(r);return r.toString()}(W,0,E,O),u,N,s,a),(T||_)&&(W+=k),(j||u<0)&&(L=W,V=H,W=0===(F=u)?L:0==+L?L.replace("-",""):0<F?"+".concat(L):"sign"===V?L:"(".concat(L.replace("-",""),")")),W}function p(t,e){if(!t)return e;var n=Object.keys(t);return 1===n.length&&"output"===n[0]?e:t}e.exports=function(t){return{format:function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return h.apply(void 0,n.concat([t]))},getByteUnit:function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return function(t){var e=l.general;return u(t._value,e.suffixes,e.scale).suffix}.apply(void 0,n.concat([t]))},getBinaryByteUnit:function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return function(t){var e=l.binary;return u(t._value,e.suffixes,e.scale).suffix}.apply(void 0,n.concat([t]))},getDecimalByteUnit:function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return function(t){var e=l.decimal;return u(t._value,e.suffixes,e.scale).suffix}.apply(void 0,n.concat([t]))},formatOrDefault:p}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(t,e,n){"use strict";var o=t("./en-US"),i=t("./validating"),r=t("./parsing"),s={},a=void 0,l={},c=null,h={};function u(t){a=t}function d(){return l[a]}s.languages=function(){return Object.assign({},l)},s.currentLanguage=function(){return a},s.currentCurrency=function(){return d().currency},s.currentAbbreviations=function(){return d().abbreviations},s.currentDelimiters=function(){return d().delimiters},s.currentOrdinal=function(){return d().ordinal},s.currentDefaults=function(){return Object.assign({},d().defaults,h)},s.currentOrdinalDefaultFormat=function(){return Object.assign({},s.currentDefaults(),d().ordinalFormat)},s.currentByteDefaultFormat=function(){return Object.assign({},s.currentDefaults(),d().byteFormat)},s.currentPercentageDefaultFormat=function(){return Object.assign({},s.currentDefaults(),d().percentageFormat)},s.currentCurrencyDefaultFormat=function(){return Object.assign({},s.currentDefaults(),d().currencyFormat)},s.currentTimeDefaultFormat=function(){return Object.assign({},s.currentDefaults(),d().timeFormat)},s.setDefaults=function(t){t=r.parseFormat(t),i.validateFormat(t)&&(h=t)},s.getZeroFormat=function(){return c},s.setZeroFormat=function(t){return c="string"==typeof t?t:null},s.hasZeroFormat=function(){return null!==c},s.languageData=function(t){if(t){if(l[t])return l[t];throw new Error('Unknown tag "'.concat(t,'"'))}return d()},s.registerLanguage=function(t){var e=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(!i.validateLanguage(t))throw new Error("Invalid language data");l[t.languageTag]=t,e&&u(t.languageTag)},s.setLanguage=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:o.languageTag;if(!l[t]){var n=t.split("-")[0],i=Object.keys(l).find((function(t){return t.split("-")[0]===n}));return l[i]?void u(i):void u(e)}u(t)},s.registerLanguage(o),a=o.languageTag,e.exports=s},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(t,e,n){"use strict";e.exports=function(e){return{loadLanguagesInNode:function(n){return o=e,void n.forEach((function(e){var n=void 0;try{n=t("../languages/".concat(e))}catch(n){console.error('Unable to load "'.concat(e,'". No matching language file found.'))}n&&o.registerLanguage(n)}));var o}}}},{}],6:[function(t,e,n){"use strict";var o=t("bignumber.js");function i(t,e,n){var i=new o(t._value),r=e;return n.isNumbro(e)&&(r=e._value),r=new o(r),t._value=i.minus(r).toNumber(),t}e.exports=function(t){return{add:function(e,n){return r=n,s=t,a=new o((i=e)._value),l=r,s.isNumbro(r)&&(l=r._value),l=new o(l),i._value=a.plus(l).toNumber(),i;var i,r,s,a,l},subtract:function(e,n){return i(e,n,t)},multiply:function(e,n){return r=n,s=t,a=new o((i=e)._value),l=r,s.isNumbro(r)&&(l=r._value),l=new o(l),i._value=a.times(l).toNumber(),i;var i,r,s,a,l},divide:function(e,n){return r=n,s=t,a=new o((i=e)._value),l=r,s.isNumbro(r)&&(l=r._value),l=new o(l),i._value=a.dividedBy(l).toNumber(),i;var i,r,s,a,l},set:function(e,n){return o=e,r=i=n,t.isNumbro(i)&&(r=i._value),o._value=r,o;var o,i,r},difference:function(e,n){return o=n,i(s=(r=t)(e._value),o,r),Math.abs(s._value);var o,r,s}}}},{"bignumber.js":1}],7:[function(t,e,n){"use strict";function o(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var i=t("./globalState"),r=t("./validating"),s=t("./loading")(f),a=t("./unformatting"),l=t("./formatting")(f),c=t("./manipulating")(f),h=t("./parsing"),u=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._value=e}var e,n,r;return e=t,(n=[{key:"clone",value:function(){return f(this._value)}},{key:"format",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return l.format(this,t)}},{key:"formatCurrency",value:function(t){return"string"==typeof t&&(t=h.parseFormat(t)),(t=l.formatOrDefault(t,i.currentCurrencyDefaultFormat())).output="currency",l.format(this,t)}},{key:"formatTime",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return t.output="time",l.format(this,t)}},{key:"binaryByteUnits",value:function(){return l.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return l.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return l.getByteUnit(this)}},{key:"difference",value:function(t){return c.difference(this,t)}},{key:"add",value:function(t){return c.add(this,t)}},{key:"subtract",value:function(t){return c.subtract(this,t)}},{key:"multiply",value:function(t){return c.multiply(this,t)}},{key:"divide",value:function(t){return c.divide(this,t)}},{key:"set",value:function(t){return c.set(this,d(t))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&o(e.prototype,n),r&&o(e,r),t}();function d(t){var e=t;return f.isNumbro(t)?e=t._value:"string"==typeof t?e=f.unformat(t):isNaN(t)&&(e=NaN),e}function f(t){return new u(d(t))}f.version="2.1.2",f.isNumbro=function(t){return t instanceof u},f.language=i.currentLanguage,f.registerLanguage=i.registerLanguage,f.setLanguage=i.setLanguage,f.languages=i.languages,f.languageData=i.languageData,f.zeroFormat=i.setZeroFormat,f.defaultFormat=i.currentDefaults,f.setDefaults=i.setDefaults,f.defaultCurrencyFormat=i.currentCurrencyDefaultFormat,f.validate=r.validate,f.loadLanguagesInNode=s.loadLanguagesInNode,f.unformat=a.unformat,e.exports=f},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(t,e,n){"use strict";e.exports={parseFormat:function(t){var e,n,o,i,r,s,a,l,c,h,u,d,f,g,p,m,b,w,v,y,C=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return"string"!=typeof t?t:(n=C,t=(o=(e=t).match(/^{([^}]*)}/))?(n.prefix=o[1],e.slice(o[0].length)):e,r=C,function(t,e){if(-1===t.indexOf("$")){if(-1===t.indexOf("%"))return-1!==t.indexOf("bd")?(e.output="byte",e.base="general"):-1!==t.indexOf("b")?(e.output="byte",e.base="binary"):-1!==t.indexOf("d")?(e.output="byte",e.base="decimal"):-1===t.indexOf(":")?-1!==t.indexOf("o")&&(e.output="ordinal"):e.output="time";e.output="percent"}else e.output="currency"}(t=(s=(i=t).match(/{([^}]*)}$/))?(r.postfix=s[1],i.slice(0,-s[0].length)):i,C),a=C,(l=t.match(/[1-9]+[0-9]*/))&&(a.totalLength=+l[0]),c=C,(h=t.split(".")[0].match(/0+/))&&(c.characteristic=h[0].length),function(t,e){if(-1!==t.indexOf(".")){var n=t.split(".")[0];e.optionalCharacteristic=-1===n.indexOf("0")}}(t,C),u=C,-1!==t.indexOf("a")&&(u.average=!0),f=C,-1!==(d=t).indexOf("K")?f.forceAverage="thousand":-1!==d.indexOf("M")?f.forceAverage="million":-1!==d.indexOf("B")?f.forceAverage="billion":-1!==d.indexOf("T")&&(f.forceAverage="trillion"),function(t,e){var n=t.split(".")[1];if(n){var o=n.match(/0+/);o&&(e.mantissa=o[0].length)}}(t,C),p=C,(g=t).match(/\[\.]/)?p.optionalMantissa=!0:g.match(/\./)&&(p.optionalMantissa=!1),m=C,-1!==t.indexOf(",")&&(m.thousandSeparated=!0),b=C,-1!==t.indexOf(" ")&&(b.spaceSeparated=!0),v=C,(w=t).match(/^\+?\([^)]*\)$/)&&(v.negative="parenthesis"),w.match(/^\+?-/)&&(v.negative="sign"),y=C,t.match(/^\+/)&&(y.forceSign=!0),C)}}},{}],9:[function(t,e,n){"use strict";var o=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function i(t){return t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function r(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",r=3<arguments.length?arguments[3]:void 0,s=4<arguments.length?arguments[4]:void 0,a=5<arguments.length?arguments[5]:void 0,l=6<arguments.length?arguments[6]:void 0;if(""!==t)return t===s?0:function t(e,n){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",s=3<arguments.length?arguments[3]:void 0,a=4<arguments.length?arguments[4]:void 0,l=5<arguments.length?arguments[5]:void 0,c=6<arguments.length?arguments[6]:void 0;if(!isNaN(+e))return+e;var h="",u=e.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(u!==e)return-1*t(u,n,r,s,a,l,c);for(var d=0;d<o.length;d++){var f=o[d];if((h=e.replace(f.key,""))!==e)return t(h,n,r,s,a,l,c)*f.factor}if((h=e.replace("%",""))!==e)return t(h,n,r,s,a,l,c)/100;var g=parseFloat(e);if(!isNaN(g)){var p=s(g);if(p&&"."!==p&&(h=e.replace(new RegExp("".concat(i(p),"$")),""))!==e)return t(h,n,r,s,a,l,c);var m={};Object.keys(l).forEach((function(t){m[l[t]]=t}));for(var b=Object.keys(m).sort().reverse(),w=b.length,v=0;v<w;v++){var y=b[v],C=m[y];if((h=e.replace(y,""))!==e){var S=void 0;switch(C){case"thousand":S=Math.pow(10,3);break;case"million":S=Math.pow(10,6);break;case"billion":S=Math.pow(10,9);break;case"trillion":S=Math.pow(10,12)}return t(h,n,r,s,a,l,c)*S}}}}(function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",o=t.replace(n,"");return(o=o.replace(new RegExp("([0-9])".concat(i(e.thousands),"([0-9])"),"g"),"$1$2")).replace(e.decimal,".")}(t,e,n),e,n,r,s,a,l)}e.exports={unformat:function(e,n){var o,i,s,a=t("./globalState"),l=a.currentDelimiters(),c=a.currentCurrency().symbol,h=a.currentOrdinal(),u=a.getZeroFormat(),d=a.currentAbbreviations(),f=void 0;if("string"==typeof e)f=function(t,e){if(!t.indexOf(":")||":"===e.thousands)return!1;var n=t.split(":");if(3!==n.length)return!1;var o=+n[0],i=+n[1],r=+n[2];return!isNaN(o)&&!isNaN(i)&&!isNaN(r)}(e,l)?(o=e.split(":"),i=+o[0],s=+o[1],+o[2]+60*s+3600*i):r(e,l,c,h,u,d,n);else{if("number"!=typeof e)return;f=e}if(void 0!==f)return f}}},{"./globalState":4}],10:[function(t,e,n){"use strict";function o(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var r=t("./unformatting"),s=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,a={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(t,e){return"byte"===e.output},message:"`base` must be provided only when the output is `byte`",mandatory:function(t){return"byte"===t.output}},characteristic:{type:"number",restriction:function(t){return 0<=t},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(t){return 0<=t},message:"value must be positive"},{restriction:function(t,e){return!e.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(t){return 0<=t},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(t,e){return"percent"===e.output},message:"`prefixSymbol` can be provided only when the output is `percent`"}},l={languageTag:{type:"string",mandatory:!0,restriction:function(t){return t.match(s)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function c(t){return!!r.unformat(t)}function h(t,e,n){var r=3<arguments.length&&void 0!==arguments[3]&&arguments[3],s=Object.keys(t).map((function(o){if(!e[o])return console.error("".concat(n," Invalid key: ").concat(o)),!1;var r=t[o],s=e[o];if("string"==typeof s&&(s={type:s}),"format"===s.type){if(!h(r,a,"[Validate ".concat(o,"]"),!0))return!1}else if(i(r)!==s.type)return console.error("".concat(n," ").concat(o,' type mismatched: "').concat(s.type,'" expected, "').concat(i(r),'" provided')),!1;if(s.restrictions&&s.restrictions.length)for(var l=s.restrictions.length,c=0;c<l;c++){var u=s.restrictions[c],d=u.restriction,f=u.message;if(!d(r,t))return console.error("".concat(n," ").concat(o," invalid value: ").concat(f)),!1}return s.restriction&&!s.restriction(r,t)?(console.error("".concat(n," ").concat(o," invalid value: ").concat(s.message)),!1):s.validValues&&-1===s.validValues.indexOf(r)?(console.error("".concat(n," ").concat(o," invalid value: must be among ").concat(JSON.stringify(s.validValues),', "').concat(r,'" provided')),!1):!(s.children&&!h(r,s.children,"[Validate ".concat(o,"]")))}));return r||s.push.apply(s,o(Object.keys(e).map((function(o){var i=e[o];if("string"==typeof i&&(i={type:i}),i.mandatory){var r=i.mandatory;if("function"==typeof r&&(r=r(t)),r&&void 0===t[o])return console.error("".concat(n,' Missing mandatory key "').concat(o,'"')),!1}return!0})))),s.reduce((function(t,e){return t&&e}),!0)}function u(t){return h(t,a,"[Validate format]")}e.exports={validate:function(t,e){var n=c(t),o=u(e);return n&&o},validateFormat:u,validateInput:c,validateLanguage:function(t){return h(t,l,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)}))},8793:function(t,e,n){"use strict";var o=n("73fa");t.exports=function(t){return"object"==typeof t?null!==t:o(t)}},"87d6":function(t,e,n){"use strict";n.d(e,"b",(function(){return h}));n("7a89"),n("d06e");var o=n("de3b");function i(t,e,n){return(e=r(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r(t){var e=s(t,"string");return"symbol"==typeof e?e:e+""}function s(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}let a=0;class l{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;i(this,"context",void 0),this.context=t||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(t,e,n){let o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];function i(t){n.call(this,c(t))}return this.context.eventListeners.push({element:t,event:e,callback:n,callbackProxy:i,options:o,eventManager:this}),t.addEventListener(e,i,o),a+=1,()=>{this.removeEventListener(t,e,n)}}removeEventListener(t,e,n){let o,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=this.context.eventListeners.length;while(r)if(r-=1,o=this.context.eventListeners[r],o.event===e&&o.element===t){if(n&&n!==o.callback)continue;if(i&&o.eventManager!==this)continue;this.context.eventListeners.splice(r,1),o.element.removeEventListener(o.event,o.callbackProxy,o.options),a-=1}}clearEvents(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.context)return;let e=this.context.eventListeners.length;while(e){e-=1;const n=this.context.eventListeners[e];t&&n.eventManager!==this||(this.context.eventListeners.splice(e,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options),a-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(t,e){let n=t.document,o=t;n||(n=t.ownerDocument?t.ownerDocument:t,o=n.defaultView);const i={bubbles:!0,cancelable:"mousemove"!==e,view:o,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};let r;n.createEvent?(r=n.createEvent("MouseEvents"),r.initMouseEvent(e,i.bubbles,i.cancelable,i.view,i.detail,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.button,i.relatedTarget||n.body.parentNode)):r=n.createEventObject(),t.dispatchEvent?t.dispatchEvent(r):t.fireEvent("on"+e,r)}}function c(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),Object(o["stopImmediatePropagation"])(this)},t}function h(){return a}e["a"]=l},"87ed":function(t,e,n){"use strict";var o=n("fd18"),i=Set.prototype;t.exports={Set:Set,add:o(i.add),has:o(i.has),remove:o(i["delete"]),proto:i}},8828:function(t,e,n){"use strict";n.d(e,"L",(function(){return o})),n.d(e,"N",(function(){return i})),n.d(e,"y",(function(){return r})),n.d(e,"l",(function(){return s})),n.d(e,"E",(function(){return a})),n.d(e,"D",(function(){return l})),n.d(e,"g",(function(){return c})),n.d(e,"B",(function(){return h})),n.d(e,"s",(function(){return u})),n.d(e,"t",(function(){return d})),n.d(e,"u",(function(){return f})),n.d(e,"h",(function(){return g})),n.d(e,"q",(function(){return p})),n.d(e,"w",(function(){return m})),n.d(e,"c",(function(){return b})),n.d(e,"G",(function(){return w})),n.d(e,"H",(function(){return v})),n.d(e,"M",(function(){return y})),n.d(e,"p",(function(){return C})),n.d(e,"n",(function(){return S})),n.d(e,"j",(function(){return O})),n.d(e,"v",(function(){return E})),n.d(e,"m",(function(){return R})),n.d(e,"C",(function(){return T})),n.d(e,"e",(function(){return M})),n.d(e,"F",(function(){return I})),n.d(e,"f",(function(){return x})),n.d(e,"k",(function(){return N})),n.d(e,"K",(function(){return A})),n.d(e,"z",(function(){return H})),n.d(e,"o",(function(){return j})),n.d(e,"d",(function(){return _})),n.d(e,"I",(function(){return k})),n.d(e,"b",(function(){return P})),n.d(e,"i",(function(){return D})),n.d(e,"a",(function(){return L})),n.d(e,"r",(function(){return F})),n.d(e,"A",(function(){return V})),n.d(e,"J",(function(){return W})),n.d(e,"x",(function(){return B}));const o=t=>["tabindex",t],i=()=>["role","treegrid"],r=()=>["role","presentation"],s=()=>["role","gridcell"],a=()=>["role","rowheader"],l=()=>["role","rowgroup"],c=()=>["role","columnheader"],h=()=>["role","row"],u=()=>["role","menu"],d=()=>["role","menuitem"],f=()=>["role","menuitemcheckbox"],g=()=>["role","combobox"],p=()=>["role","listbox"],m=()=>["role","option"],b=()=>["role","checkbox"],w=()=>["scope","col"],v=()=>["scope","row"],y=()=>["type","text"],C=t=>["aria-label",t],S=()=>["aria-hidden","true"],O=()=>["aria-disabled","true"],E=()=>["aria-multiselectable","true"],R=t=>["aria-haspopup",t],T=t=>["aria-rowcount",t],M=t=>["aria-colcount",t],I=t=>["aria-rowindex",t],x=t=>["aria-colindex",t],N=t=>["aria-expanded",t],A=t=>["aria-sort",t],H=()=>["aria-readonly","true"],j=()=>["aria-invalid","true"],_=t=>["aria-checked",t],k=()=>["aria-selected","true"],P=()=>["aria-autocomplete","list"],D=t=>["aria-controls",t],L=t=>["aria-activedescendant",t],F=t=>["aria-live",t],V=t=>["aria-relevant",t],W=t=>["aria-setsize",t],B=t=>["aria-posinset",t]},"88c5":function(t,e,n){"use strict";var o=n("0227"),i=function(t){return{size:t,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}};t.exports=function(t){var e=o("Set");try{(new e)[t](i(0));try{return(new e)[t](i(-1)),!1}catch(n){return!0}}catch(r){return!1}}},"8e39":function(t,e,n){"use strict";var o=n("ac4f"),i=n("d3e6"),r=n("cac7");o({target:"Object",stat:!0},{fromEntries:function(t){var e={};return i(t,(function(t,n){r(e,t,n)}),{AS_ENTRIES:!0}),e}})},9046:function(t,e,n){"use strict";var o=n("939b"),i=n("fd18");t.exports=function(t){if("Function"===o(t))return i(t)}},9056:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));n("7a89");var o=n("1096"),i=n("e90f"),r=n("3d57"),s=n("a73f"),a=n("97b9");function l(t,e,n){return(e=c(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function c(t){var e=h(t,"string");return"symbol"==typeof e?e:e+""}function h(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class u extends o["a"]{constructor(){super(...arguments),l(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(t=>this.indexedValues[t])}setValues(t){this.orderOfIndexes=[...Array(t.length).keys()],super.setValues(t)}setValueAtIndex(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.orderOfIndexes.length;return t<this.indexedValues.length&&(this.indexedValues[t]=e,!1===this.orderOfIndexes.includes(t)&&this.orderOfIndexes.splice(n,0,t),this.runLocalHooks("change"),!0)}clearValue(t){this.orderOfIndexes=Object(r["b"])(this.orderOfIndexes,[t]),Object(a["isFunction"])(this.initValueOrFn)?super.setValueAtIndex(t,this.initValueOrFn(t)):super.setValueAtIndex(t,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(t)}insert(t,e){this.indexedValues=Object(i["a"])(this.indexedValues,t,e,this.initValueOrFn),this.orderOfIndexes=Object(s["b"])(this.orderOfIndexes,e),super.insert(t,e)}remove(t){this.indexedValues=Object(i["b"])(this.indexedValues,t),this.orderOfIndexes=Object(r["b"])(this.orderOfIndexes,t),this.orderOfIndexes=Object(s["a"])(this.orderOfIndexes,t),super.remove(t)}getEntries(){return this.orderOfIndexes.map(t=>[t,this.getValueAtIndex(t)])}}},"911c":function(t,e,n){"use strict";var o=n("6269");t.exports="NODE"===o},"930d":function(t,e,n){"use strict";var o=n("5438"),i=n("ff56"),r=n("6f539"),s=n("0f98");t.exports=function(t){var e=o(this),n=s(t);return!(i(e)>n.size)&&!1!==r(e,(function(t){if(!n.includes(t))return!1}),!0)}},9394:function(t,e,n){"use strict";var o=n("81b7"),i=n("bf78");t.exports=function(t){return o(i(t))}},"939b":function(t,e,n){"use strict";var o=n("fd18"),i=o({}.toString),r=o("".slice);t.exports=function(t){return r(i(t),8,-1)}},"956b":function(t,e,n){"use strict";var o=n("ac4f"),i=n("fc2d"),r=n("7dcf4"),s=n("2349"),a=n("bf80"),l=n("ae20"),c=1!==[].unshift(0),h=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}},u=c||!h();o({target:"Array",proto:!0,arity:1,forced:u},{unshift:function(t){var e=i(this),n=r(e),o=arguments.length;if(o){l(n+o);var c=n;while(c--){var h=c+o;c in e?e[h]=e[c]:a(e,h)}for(var u=0;u<o;u++)e[u]=arguments[u]}return s(e,n+o)}})},9582:function(t,e,n){"use strict";var o=n("e156"),i=n("2471"),r=n("022b"),s=n("c272"),a=n("80dd"),l=a("iterator");t.exports=function(t){if(!r(t))return i(t,l)||i(t,"@@iterator")||s[o(t)]}},9674:function(t,e,n){"use strict";var o=n("fd18");t.exports=o([].slice)},9718:function(t,e,n){"use strict";var o=n("8793"),i=n("2d2d");t.exports=function(t,e){o(e)&&"cause"in e&&i(t,"cause",e.cause)}},"97b9":function(t,e,n){"use strict";n.r(e),n.d(e,"isFunction",(function(){return r})),n.d(e,"throttle",(function(){return s})),n.d(e,"throttleAfterHits",(function(){return a})),n.d(e,"debounce",(function(){return l})),n.d(e,"pipe",(function(){return c})),n.d(e,"partial",(function(){return h})),n.d(e,"curry",(function(){return u})),n.d(e,"curryRight",(function(){return d})),n.d(e,"fastCall",(function(){return f}));var o=n("81ea"),i=n("7b9c");function r(t){return"function"===typeof t}function s(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,n=0;const o={lastCallThrottled:!0};let i=null;function r(){for(var r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];const l=Date.now();let c=!1;o.lastCallThrottled=!0,n||(n=l,c=!0);const h=e-(l-n);return c?(o.lastCallThrottled=!1,t.apply(this,s)):(i&&clearTimeout(i),i=setTimeout(()=>{o.lastCallThrottled=!1,t.apply(this,s),n=0,i=void 0},h)),o}return r}function a(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;const o=s(t,e);let i=n;function r(){i=n}function a(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return i?(i-=1,t.apply(this,n)):o.apply(this,n)}return a.clearHits=r,a}function l(t){let e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,o=null;function i(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return o&&clearTimeout(o),o=setTimeout(()=>{e=t.apply(this,r)},n),e}return i}function c(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[i,...r]=e;return function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Object(o["arrayReduce"])(r,(t,e)=>e(t),i.apply(this,e))}}function h(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];return function(){for(var e=arguments.length,o=new Array(e),i=0;i<e;i++)o[i]=arguments[i];return t.apply(this,n.concat(o))}}function u(t){const e=t.length;function n(o){return function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];const a=o.concat(r);let l;return l=a.length>=e?t.apply(this,a):n(a),l}}return n([])}function d(t){const e=t.length;function n(o){return function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];const a=o.concat(r.reverse());let l;return l=a.length>=e?t.apply(this,a):n(a),l}}return n([])}function f(t,e,n,o,r,s,a,l){return Object(i["isDefined"])(l)?t.call(e,n,o,r,s,a,l):Object(i["isDefined"])(a)?t.call(e,n,o,r,s,a):Object(i["isDefined"])(s)?t.call(e,n,o,r,s):Object(i["isDefined"])(r)?t.call(e,n,o,r):Object(i["isDefined"])(o)?t.call(e,n,o):Object(i["isDefined"])(n)?t.call(e,n):t.call(e)}},"97dc":function(t,e,n){"use strict";var o=n("088f");t.exports=function(){var t=o(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e}},"9acd":function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));const o=new Map;function i(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"common";o.has(t)||o.set(t,new Map);const e=o.get(t);function n(t,n){e.set(t,n)}function i(t){return e.get(t)}function r(t){return e.has(t)}function s(){return[...e.keys()]}function a(){return[...e.values()]}return{register:n,getItem:i,hasItem:r,getNames:s,getValues:a}}},"9c76":function(t,e,n){"use strict";var o=n("7b7f");t.exports=o&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},"9e6a":function(t,e,n){"use strict";var o=n("d233"),i=Object.prototype.hasOwnProperty,r={allowDots:!1,allowPrototypes:!1,arrayLimit:20,decoder:o.decode,delimiter:"&",depth:5,parameterLimit:1e3,plainObjects:!1,strictNullHandling:!1},s=function(t,e){for(var n={},o=e.ignoreQueryPrefix?t.replace(/^\?/,""):t,s=e.parameterLimit===1/0?void 0:e.parameterLimit,a=o.split(e.delimiter,s),l=0;l<a.length;++l){var c,h,u=a[l],d=u.indexOf("]="),f=-1===d?u.indexOf("="):d+1;-1===f?(c=e.decoder(u,r.decoder),h=e.strictNullHandling?null:""):(c=e.decoder(u.slice(0,f),r.decoder),h=e.decoder(u.slice(f+1),r.decoder)),i.call(n,c)?n[c]=[].concat(n[c]).concat(h):n[c]=h}return n},a=function(t,e,n){for(var o=e,i=t.length-1;i>=0;--i){var r,s=t[i];if("[]"===s&&n.parseArrays)r=[].concat(o);else{r=n.plainObjects?Object.create(null):{};var a="["===s.charAt(0)&&"]"===s.charAt(s.length-1)?s.slice(1,-1):s,l=parseInt(a,10);n.parseArrays||""!==a?!isNaN(l)&&s!==a&&String(l)===a&&l>=0&&n.parseArrays&&l<=n.arrayLimit?(r=[],r[l]=o):"__proto__"!==a&&(r[a]=o):r={0:o}}o=r}return o},l=function(t,e,n){if(t){var o=n.allowDots?t.replace(/\.([^.[]+)/g,"[$1]"):t,r=/(\[[^[\]]*])/,s=/(\[[^[\]]*])/g,l=r.exec(o),c=l?o.slice(0,l.index):o,h=[];if(c){if(!n.plainObjects&&i.call(Object.prototype,c)&&!n.allowPrototypes)return;h.push(c)}var u=0;while(null!==(l=s.exec(o))&&u<n.depth){if(u+=1,!n.plainObjects&&i.call(Object.prototype,l[1].slice(1,-1))&&!n.allowPrototypes)return;h.push(l[1])}return l&&h.push("["+o.slice(l.index)+"]"),a(h,e,n)}};t.exports=function(t,e){var n=e?o.assign({},e):{};if(null!==n.decoder&&void 0!==n.decoder&&"function"!==typeof n.decoder)throw new TypeError("Decoder has to be a function.");if(n.ignoreQueryPrefix=!0===n.ignoreQueryPrefix,n.delimiter="string"===typeof n.delimiter||o.isRegExp(n.delimiter)?n.delimiter:r.delimiter,n.depth="number"===typeof n.depth?n.depth:r.depth,n.arrayLimit="number"===typeof n.arrayLimit?n.arrayLimit:r.arrayLimit,n.parseArrays=!1!==n.parseArrays,n.decoder="function"===typeof n.decoder?n.decoder:r.decoder,n.allowDots="boolean"===typeof n.allowDots?n.allowDots:r.allowDots,n.plainObjects="boolean"===typeof n.plainObjects?n.plainObjects:r.plainObjects,n.allowPrototypes="boolean"===typeof n.allowPrototypes?n.allowPrototypes:r.allowPrototypes,n.parameterLimit="number"===typeof n.parameterLimit?n.parameterLimit:r.parameterLimit,n.strictNullHandling="boolean"===typeof n.strictNullHandling?n.strictNullHandling:r.strictNullHandling,""===t||null===t||"undefined"===typeof t)return n.plainObjects?Object.create(null):{};for(var i="string"===typeof t?s(t,n):t,a=n.plainObjects?Object.create(null):{},c=Object.keys(i),h=0;h<c.length;++h){var u=c[h],d=l(u,i[u],n);a=o.merge(a,d,n)}return o.compact(a)}},"9e75":function(t,e,n){"use strict";var o=n("b2ae");t.exports=function(t){var e=+t;return e!==e||0===e?0:o(e)}},"9f10":function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var o=n("1096"),i=n("e90f");class r extends o["a"]{insert(t,e){this.indexedValues=Object(i["a"])(this.indexedValues,t,e,this.initValueOrFn),super.insert(t,e)}remove(t){this.indexedValues=Object(i["b"])(this.indexedValues,t),super.remove(t)}}},a309:function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"g",(function(){return i})),n.d(e,"b",(function(){return r})),n.d(e,"f",(function(){return s})),n.d(e,"e",(function(){return a})),n.d(e,"h",(function(){return l})),n.d(e,"c",(function(){return c})),n.d(e,"d",(function(){return h}));const o="active-header",i="header",r="area",s="focus",a="fill",l="row",c="column",h="custom-selection"},a357:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));n("d06e");var o=n("5d7f"),i=n("8828");const r="base";function s(t,e,n,r,s,a,l){const c=l.ariaTags,h=[],u=[],d=[],f=[];l.className&&Object(o["addClass"])(e,l.className),l.readOnly?(h.push(l.readOnlyCellClassName),c&&f.push(Object(i["z"])())):c&&d.push(Object(i["z"])()[0]),!1===l.valid&&l.invalidCellClassName?(h.push(l.invalidCellClassName),c&&f.push(Object(i["o"])())):(u.push(l.invalidCellClassName),c&&d.push(Object(i["o"])()[0])),!1===l.wordWrap&&l.noWordWrapClassName&&h.push(l.noWordWrapClassName),!a&&l.placeholder&&h.push(l.placeholderCellClassName),Object(o["removeClass"])(e,u),Object(o["addClass"])(e,h),Object(o["removeAttribute"])(e,d),Object(o["setAttribute"])(e,f)}s.RENDERER_TYPE=r},a45f:function(t,e,n){"use strict";var o=n("2408");t.exports=function(t,e){return void 0===t?arguments.length<2?"":e:o(t)}},a60d:function(t,e,n){"use strict";var o=n("d128"),i=n("d435"),r=n("2b75"),s=n("088f"),a=n("24d5"),l=TypeError,c=Object.defineProperty,h=Object.getOwnPropertyDescriptor,u="enumerable",d="configurable",f="writable";e.f=o?r?function(t,e,n){if(s(t),e=a(e),s(n),"function"===typeof t&&"prototype"===e&&"value"in n&&f in n&&!n[f]){var o=h(t,e);o&&o[f]&&(t[e]=n.value,n={configurable:d in n?n[d]:o[d],enumerable:u in n?n[u]:o[u],writable:!1})}return c(t,e,n)}:c:function(t,e,n){if(s(t),e=a(e),s(n),i)try{return c(t,e,n)}catch(o){}if("get"in n||"set"in n)throw new l("Accessors not supported");return"value"in n&&(t[e]=n.value),t}},a68d:function(t,e,n){"use strict";var o,i,r,s=n("bbc8"),a=n("54ad"),l=n("8793"),c=n("2d2d"),h=n("69ba"),u=n("54d7"),d=n("ab25"),f=n("861e"),g="Object already initialized",p=a.TypeError,m=a.WeakMap,b=function(t){return r(t)?i(t):o(t,{})},w=function(t){return function(e){var n;if(!l(e)||(n=i(e)).type!==t)throw new p("Incompatible receiver, "+t+" required");return n}};if(s||u.state){var v=u.state||(u.state=new m);v.get=v.get,v.has=v.has,v.set=v.set,o=function(t,e){if(v.has(t))throw new p(g);return e.facade=t,v.set(t,e),e},i=function(t){return v.get(t)||{}},r=function(t){return v.has(t)}}else{var y=d("state");f[y]=!0,o=function(t,e){if(h(t,y))throw new p(g);return e.facade=t,c(t,y,e),e},i=function(t){return h(t,y)?t[y]:{}},r=function(t){return h(t,y)}}t.exports={set:o,get:i,has:r,enforce:b,getterFor:w}},a73f:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return r}));var o=n("81ea");function i(t,e){return Object(o["arrayMap"])(t,t=>t-e.filter(e=>e<t).length)}function r(t,e){const n=e[0],i=e.length;return Object(o["arrayMap"])(t,t=>t>=n?t+i:t)}},a776:function(t,e,n){"use strict";n.r(e),n.d(e,"instanceToHTML",(function(){return a})),n.d(e,"_dataToHTML",(function(){return l})),n.d(e,"htmlToGridSettings",(function(){return c}));n("d06e"),n("70f9");var o=n("7b9c");const i={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},r=new RegExp(Object.keys(i).map(t=>`(${t})`).join("|"),"gi");function s(t){return"TABLE"===(t&&t.nodeName||"")}function a(t){const e=t.hasColHeaders(),n=t.hasRowHeaders(),i=[e?-1:0,n?-1:0,t.countRows()-1,t.countCols()-1],r=t.getData(...i),s=r.length,a=s>0?r[0].length:0,l=["<table>","</table>"],c=e?["<thead>","</thead>"]:[],h=["<tbody>","</tbody>"],u=n?1:0,d=e?1:0;for(let f=0;f<s;f+=1){const i=e&&0===f,s=[];for(let e=0;e<a;e+=1){const a=!i&&n&&0===e;let l="";if(i)l=`<th>${t.getColHeader(e-u)}</th>`;else if(a)l=`<th>${t.getRowHeader(f-d)}</th>`;else{const n=r[f][e],{hidden:i,rowspan:s,colspan:a}=t.getCellMeta(f-d,e-u);if(!i){const t=[];if(s&&t.push(`rowspan="${s}"`),a&&t.push(`colspan="${a}"`),Object(o["isEmpty"])(n))l=`<td ${t.join(" ")}></td>`;else{const e=n.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");l=`<td ${t.join(" ")}>${e}</td>`}}}s.push(l)}const l=["<tr>",...s,"</tr>"].join("");i?c.splice(1,0,l):h.splice(-1,0,l)}return l.splice(1,0,c.join(""),h.join("")),l.join("")}function l(t){const e=t.length,n=["<table>"];for(let i=0;i<e;i+=1){const r=t[i],s=r.length,a=[];0===i&&n.push("<tbody>");for(let t=0;t<s;t+=1){const e=r[t],n=Object(o["isEmpty"])(e)?"":e.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20{2,}/gi,t=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(t.length-1)} </span>`).replace(/\t/gi,"&#9;");a.push(`<td>${n}</td>`)}n.push("<tr>",...a,"</tr>"),i+1===e&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function c(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document;const n={},o=e.createDocumentFragment(),a=e.createElement("div");o.appendChild(a);let l=t;if("string"===typeof l){const t=l.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,t=>{const e=t.match(/<td\b[^>]*?>/g)[0],n=/<p.*?>/g,o=t.substring(e.length,t.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(n,"\n").replace("\n","").replaceAll(/<\/(.*)>\s+$/gm,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/gm,""),i="</td>";return`${e}${o}${i}`});a.insertAdjacentHTML("afterbegin",""+t),l=a.querySelector("table")}if(!l||!s(l))return;const c=a.querySelector('meta[name$="enerator"]'),h=null!==l.querySelector("tbody th"),u=l.querySelector("tr"),d=u?Array.from(u.cells).reduce((t,e)=>t+e.colSpan,0)-(h?1:0):0,f=l.tFoot&&Array.from(l.tFoot.rows)||[],g=[];let p=!1,m=0,b=0;if(l.tHead){const t=Array.from(l.tHead.rows).filter(t=>{const e=null!==t.querySelector("td");return e&&g.push(t),!e});m=t.length,p=m>0,m>1?n.nestedHeaders=Array.from(t).reduce((t,e)=>{const n=Array.from(e.cells).reduce((t,e,n)=>{if(h&&0===n)return t;const{colSpan:o,innerHTML:i}=e,r=o>1?{label:i,colspan:o}:i;return t.push(r),t},[]);return t.push(n),t},[]):p&&(n.colHeaders=Array.from(t[0].children).reduce((t,e,n)=>(h&&0===n||t.push(e.innerHTML),t),[]))}g.length&&(n.fixedRowsTop=g.length),f.length&&(n.fixedRowsBottom=f.length);const w=[...g,...Array.from(l.tBodies).reduce((t,e)=>(t.push(...Array.from(e.rows)),t),[]),...f];b=w.length;const v=new Array(b);for(let i=0;i<b;i++)v[i]=new Array(d);const y=[],C=[];for(let s=0;s<b;s++){const t=w[s],e=Array.from(t.cells),n=e.length;for(let o=0;o<n;o++){const t=e[o],{nodeName:n,innerHTML:a,rowSpan:l,colSpan:h}=t,u=v[s].findIndex(t=>void 0===t);if("TD"===n){if(l>1||h>1){for(let t=s;t<s+l;t++)if(t<b)for(let e=u;e<u+h;e++)v[t][e]=null;const e=t.getAttribute("style"),n=e&&e.includes("mso-ignore:colspan");n||y.push({col:u,row:s,rowspan:l,colspan:h})}let e="";e=c&&/excel/gi.test(c.content)?a.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,"\r\n"):a.replace(/<br(\s*|\/)>[\r\n]?/gim,"\r\n"),v[s][u]=e.replace(r,t=>i[t])}else C.push(a)}}return y.length&&(n.mergeCells=y),C.length&&(n.rowHeaders=C),v.length&&(n.data=v),n}},a952:function(t,e,n){"use strict";n.d(e,"b",(function(){return s})),n.d(e,"a",(function(){return a})),n.d(e,"c",(function(){return g})),n.d(e,"d",(function(){return p})),n.d(e,"e",(function(){return m})),n.d(e,"f",(function(){return b}));n("7a89"),n("d06e"),n("38b3"),n("f448"),n("66e1"),n("2582"),n("f86b"),n("1587"),n("c5d7");var o=n("d852"),i=n("81ea"),r=n("7b9c");const s=0,a=1,l=2,c=3,h=[c,l],u=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],d=Symbol("root"),f=Symbol("child");function g(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:d;if(e!==d&&e!==f)throw new Error("The second argument is used internally only and cannot be overwritten.");const n=Array.isArray(t),i=e===d;let r=s;if(n){const e=t[0];if(0===t.length)r=a;else if(i&&e instanceof o["a"])r=c;else if(i&&Array.isArray(e))r=g(e,f);else if(t.length>=2&&t.length<=4){const e=!t.some((t,e)=>!u[e].includes(typeof t));e&&(r=l)}}return r}function p(t){let{createCellCoords:e,createCellRange:n,keepDirection:o=!1,propToCol:i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!h.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(s){const a=t===c;let l=a?s.from.row:s[0],h=a?s.from.col:s[1],u=a?s.to.row:s[2],d=a?s.to.col:s[3];if("function"===typeof i&&("string"===typeof h&&(h=i(h)),"string"===typeof d&&(d=i(d))),Object(r["isUndefined"])(u)&&(u=l),Object(r["isUndefined"])(d)&&(d=h),!o){const t=l,e=h,n=u,o=d;l=Math.min(t,n),h=Math.min(e,o),u=Math.max(t,n),d=Math.max(e,o)}const f=e(l,h),g=e(u,d);return n(f,f,g)}}function m(t){const e=g(t.getSelected());if(e===s||e===a)return[];const n=p(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),o=new Set;Object(i["arrayEach"])(t.getSelected(),t=>{const{from:e,to:r}=n(t),s=Math.max(e.col,0),a=r.col-s+1;Object(i["arrayEach"])(Array.from(new Array(a),(t,e)=>s+e),t=>{o.has(t)||o.add(t)})});const r=Array.from(o).sort((t,e)=>t-e),l=Object(i["arrayReduce"])(r,(t,e,n,o)=>(0!==n&&e===o[n-1]+1?t[t.length-1][1]+=1:t.push([e,1]),t),[]);return l}function b(t){const e=g(t.getSelected());if(e===s||e===a)return[];const n=p(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),o=new Set;Object(i["arrayEach"])(t.getSelected(),t=>{const{from:e,to:r}=n(t),s=Math.max(e.row,0),a=r.row-s+1;Object(i["arrayEach"])(Array.from(new Array(a),(t,e)=>s+e),t=>{o.has(t)||o.add(t)})});const r=Array.from(o).sort((t,e)=>t-e),l=Object(i["arrayReduce"])(r,(t,e,n,o)=>(0!==n&&e===o[n-1]+1?t[t.length-1][1]+=1:t.push([e,1]),t),[]);return l}},aa44:function(t,e,n){"use strict";var o=n("fd18"),i=n("fc2d"),r=Math.floor,s=o("".charAt),a=o("".replace),l=o("".slice),c=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,h=/\$([$&'`]|\d{1,2})/g;t.exports=function(t,e,n,o,u,d){var f=n+t.length,g=o.length,p=h;return void 0!==u&&(u=i(u),p=c),a(d,p,(function(i,a){var c;switch(s(a,0)){case"$":return"$";case"&":return t;case"`":return l(e,0,n);case"'":return l(e,f);case"<":c=u[l(a,1,-1)];break;default:var h=+a;if(0===h)return i;if(h>g){var d=r(h/10);return 0===d?i:d<=g?void 0===o[d-1]?s(a,1):o[d-1]+s(a,1):i}c=o[h-1]}return void 0===c?"":c}))}},ab25:function(t,e,n){"use strict";var o=n("de26"),i=n("592ab"),r=o("keys");t.exports=function(t){return r[t]||(r[t]=i(t))}},ac4f:function(t,e,n){"use strict";var o=n("54ad"),i=n("485c6").f,r=n("2d2d"),s=n("0e87"),a=n("3df8"),l=n("1d07"),c=n("0c0f");t.exports=function(t,e){var n,h,u,d,f,g,p=t.target,m=t.global,b=t.stat;if(h=m?o:b?o[p]||a(p,{}):o[p]&&o[p].prototype,h)for(u in e){if(f=e[u],t.dontCallGetSet?(g=i(h,u),d=g&&g.value):d=h[u],n=c(m?u:p+(b?".":"#")+u,t.forced),!n&&void 0!==d){if(typeof f==typeof d)continue;l(f,d)}(t.sham||d&&d.sham)&&r(f,"sham",!0),s(h,u,f,t)}}},ae20:function(t,e,n){"use strict";var o=TypeError,i=9007199254740991;t.exports=function(t){if(t>i)throw o("Maximum allowed index exceeded");return t}},b2ae:function(t,e,n){"use strict";var o=Math.ceil,i=Math.floor;t.exports=Math.trunc||function(t){var e=+t;return(e>0?i:o)(e)}},b2c9:function(t,e,n){"use strict";var o=n("8793");t.exports=function(t){return o(t)||null===t}},b313:function(t,e,n){"use strict";var o=String.prototype.replace,i=/%20/g;t.exports={default:"RFC3986",formatters:{RFC1738:function(t){return o.call(t,i,"+")},RFC3986:function(t){return String(t)}},RFC1738:"RFC1738",RFC3986:"RFC3986"}},b343:function(t,e,n){"use strict";t.exports=function(t){try{return!!t()}catch(e){return!0}}},b384:function(t,e,n){"use strict";var o=n("fd18"),i=n("b343"),r=n("73fa"),s=n("69ba"),a=n("d128"),l=n("0a73").CONFIGURABLE,c=n("f072"),h=n("a68d"),u=h.enforce,d=h.get,f=String,g=Object.defineProperty,p=o("".slice),m=o("".replace),b=o([].join),w=a&&!i((function(){return 8!==g((function(){}),"length",{value:8}).length})),v=String(String).split("String"),y=t.exports=function(t,e,n){"Symbol("===p(f(e),0,7)&&(e="["+m(f(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!s(t,"name")||l&&t.name!==e)&&(a?g(t,"name",{value:e,configurable:!0}):t.name=e),w&&n&&s(n,"arity")&&t.length!==n.arity&&g(t,"length",{value:n.arity});try{n&&s(n,"constructor")&&n.constructor?a&&g(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(i){}var o=u(t);return s(o,"source")||(o.source=b(v,"string"==typeof e?e:"")),t};Function.prototype.toString=y((function(){return r(this)&&d(this).source||c(this)}),"toString")},b4f5:function(t,e,n){"use strict";var o=n("c9a1");t.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(o)},b52d:function(t,e,n){"use strict";var o=n("87ed"),i=n("6f539"),r=o.Set,s=o.add;t.exports=function(t){var e=new r;return i(t,(function(t){s(e,t)})),e}},b622c:function(t,e,n){"use strict";var o,i,r=n("54ad"),s=n("c9a1"),a=r.process,l=r.Deno,c=a&&a.versions||l&&l.version,h=c&&c.v8;h&&(o=h.split("."),i=o[0]>0&&o[0]<4?1:+(o[0]+o[1])),!i&&s&&(o=s.match(/Edge\/(\d+)/),(!o||o[1]>=74)&&(o=s.match(/Chrome\/(\d+)/),o&&(i=+o[1]))),t.exports=i},b879:function(t,e,n){"use strict";var o=n("ac4f"),i=n("fc2d"),r=n("7dcf4"),s=n("9e75"),a=n("f41c");o({target:"Array",proto:!0},{at:function(t){var e=i(this),n=r(e),o=s(t),a=o>=0?o:n+o;return a<0||a>=n?void 0:e[a]}}),a("at")},ba51:function(t,e,n){"use strict";var o={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,r=i&&!o.call({1:2},1);e.f=r?function(t){var e=i(this,t);return!!e&&e.enumerable}:o},bb2a:function(t,e,n){"use strict";var o=n("7b69"),i=n("2aac"),r=n("088f"),s=n("71ca"),a=n("9582"),l=TypeError;t.exports=function(t,e){var n=arguments.length<2?a(t):e;if(i(n))return r(o(n,t));throw new l(s(t)+" is not iterable")}},bbc8:function(t,e,n){"use strict";var o=n("54ad"),i=n("73fa"),r=o.WeakMap;t.exports=i(r)&&/native code/.test(String(r))},bd5e:function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return r}));var o=n("7b9c");function i(){Object(o["isDefined"])(console)&&console.warn(...arguments)}function r(){Object(o["isDefined"])(console)&&console.error(...arguments)}},bdd7:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));n("7a89");var o=n("3d57"),i=n("e90f");const r=new Map([["indexesSequence",{getListWithInsertedItems:o["a"],getListWithRemovedItems:o["b"]}],["physicallyIndexed",{getListWithInsertedItems:i["a"],getListWithRemovedItems:i["b"]}]]),s=t=>{if(!1===r.has(t))throw new Error(`Alter strategy with ID '${t}' does not exist.`);return r.get(t)}},bdfe:function(t,e,n){"use strict";var o=n("939b");t.exports=Array.isArray||function(t){return"Array"===o(t)}},bef1:function(t,e,n){"use strict";var o=n("652d"),i=n("e1c6"),r=i.concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return o(t,r)}},bf78:function(t,e,n){"use strict";var o=n("022b"),i=TypeError;t.exports=function(t){if(o(t))throw new i("Can't call method on "+t);return t}},bf80:function(t,e,n){"use strict";var o=n("71ca"),i=TypeError;t.exports=function(t,e){if(!delete t[e])throw new i("Cannot delete property "+o(e)+" of "+o(t))}},bfa7:function(t,e,n){"use strict";var o=n("7b69");t.exports=function(t,e,n){var i,r,s=n?t:t.iterator,a=t.next;while(!(i=o(a,s)).done)if(r=e(i.value),void 0!==r)return r}},c041:function(t,e,n){"use strict";var o=n("652d"),i=n("e1c6");t.exports=Object.keys||function(t){return o(t,i)}},c0c4:function(t,e,n){
/*! @license DOMPurify 2.5.7 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.5.7/LICENSE */
(function(e,n){t.exports=n()})(0,(function(){"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,n){return e=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},e(t,n)}function n(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function o(t,i,r){return o=n()?Reflect.construct:function(t,n,o){var i=[null];i.push.apply(i,n);var r=Function.bind.apply(t,i),s=new r;return o&&e(s,o.prototype),s},o.apply(null,arguments)}function i(t){return r(t)||s(t)||a(t)||c()}function r(t){if(Array.isArray(t))return l(t)}function s(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function a(t,e){if(t){if("string"===typeof t)return l(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(t,e):void 0}}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function c(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var h=Object.hasOwnProperty,u=Object.setPrototypeOf,d=Object.isFrozen,f=Object.getPrototypeOf,g=Object.getOwnPropertyDescriptor,p=Object.freeze,m=Object.seal,b=Object.create,w="undefined"!==typeof Reflect&&Reflect,v=w.apply,y=w.construct;v||(v=function(t,e,n){return t.apply(e,n)}),p||(p=function(t){return t}),m||(m=function(t){return t}),y||(y=function(t,e){return o(t,i(e))});var C=H(Array.prototype.forEach),S=H(Array.prototype.pop),O=H(Array.prototype.push),E=H(String.prototype.toLowerCase),R=H(String.prototype.toString),T=H(String.prototype.match),M=H(String.prototype.replace),I=H(String.prototype.indexOf),x=H(String.prototype.trim),N=H(RegExp.prototype.test),A=j(TypeError);function H(t){return function(e){for(var n=arguments.length,o=new Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];return v(t,e,o)}}function j(t){return function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return y(t,n)}}function _(t,e,n){var o;n=null!==(o=n)&&void 0!==o?o:E,u&&u(t,null);var i=e.length;while(i--){var r=e[i];if("string"===typeof r){var s=n(r);s!==r&&(d(e)||(e[i]=s),r=s)}t[r]=!0}return t}function k(t){var e,n=b(null);for(e in t)!0===v(h,t,[e])&&(n[e]=t[e]);return n}function P(t,e){while(null!==t){var n=g(t,e);if(n){if(n.get)return H(n.get);if("function"===typeof n.value)return H(n.value)}t=f(t)}function o(t){return console.warn("fallback value for",t),null}return o}var D=p(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),L=p(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),F=p(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),V=p(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),W=p(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),B=p(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),U=p(["#text"]),z=p(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),G=p(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Y=p(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),X=p(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),$=m(/\{\{[\w\W]*|[\w\W]*\}\}/gm),K=m(/<%[\w\W]*|[\w\W]*%>/gm),q=m(/\${[\w\W]*}/gm),Q=m(/^data-[\-\w.\u00B7-\uFFFF]/),J=m(/^aria-[\-\w]+$/),Z=m(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),tt=m(/^(?:\w+script|data):/i),et=m(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),nt=m(/^html$/i),ot=m(/^[a-z][.\w]*(-[.\w]+)+$/i),it=function(){return"undefined"===typeof window?null:window},rt=function(e,n){if("object"!==t(e)||"function"!==typeof e.createPolicy)return null;var o=null,i="data-tt-policy-suffix";n.currentScript&&n.currentScript.hasAttribute(i)&&(o=n.currentScript.getAttribute(i));var r="dompurify"+(o?"#"+o:"");try{return e.createPolicy(r,{createHTML:function(t){return t},createScriptURL:function(t){return t}})}catch(s){return console.warn("TrustedTypes policy "+r+" could not be created."),null}};function st(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:it(),n=function(t){return st(t)};if(n.version="2.5.7",n.removed=[],!e||!e.document||9!==e.document.nodeType)return n.isSupported=!1,n;var o=e.document,r=e.document,s=e.DocumentFragment,a=e.HTMLTemplateElement,l=e.Node,c=e.Element,h=e.NodeFilter,u=e.NamedNodeMap,d=void 0===u?e.NamedNodeMap||e.MozNamedAttrMap:u,f=e.HTMLFormElement,g=e.DOMParser,m=e.trustedTypes,b=c.prototype,w=P(b,"cloneNode"),v=P(b,"nextSibling"),y=P(b,"childNodes"),H=P(b,"parentNode");if("function"===typeof a){var j=r.createElement("template");j.content&&j.content.ownerDocument&&(r=j.content.ownerDocument)}var at=rt(m,o),lt=at?at.createHTML(""):"",ct=r,ht=ct.implementation,ut=ct.createNodeIterator,dt=ct.createDocumentFragment,ft=ct.getElementsByTagName,gt=o.importNode,pt={};try{pt=k(r).documentMode?r.documentMode:{}}catch(Pe){}var mt={};n.isSupported="function"===typeof H&&ht&&void 0!==ht.createHTMLDocument&&9!==pt;var bt,wt,vt=$,yt=K,Ct=q,St=Q,Ot=J,Et=tt,Rt=et,Tt=ot,Mt=Z,It=null,xt=_({},[].concat(i(D),i(L),i(F),i(W),i(U))),Nt=null,At=_({},[].concat(i(z),i(G),i(Y),i(X))),Ht=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),jt=null,_t=null,kt=!0,Pt=!0,Dt=!1,Lt=!0,Ft=!1,Vt=!0,Wt=!1,Bt=!1,Ut=!1,zt=!1,Gt=!1,Yt=!1,Xt=!0,$t=!1,Kt="user-content-",qt=!0,Qt=!1,Jt={},Zt=null,te=_({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),ee=null,ne=_({},["audio","video","img","source","image","track"]),oe=null,ie=_({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),re="http://www.w3.org/1998/Math/MathML",se="http://www.w3.org/2000/svg",ae="http://www.w3.org/1999/xhtml",le=ae,ce=!1,he=null,ue=_({},[re,se,ae],R),de=["application/xhtml+xml","text/html"],fe="text/html",ge=null,pe=r.createElement("form"),me=function(t){return t instanceof RegExp||t instanceof Function},be=function(e){ge&&ge===e||(e&&"object"===t(e)||(e={}),e=k(e),bt=bt=-1===de.indexOf(e.PARSER_MEDIA_TYPE)?fe:e.PARSER_MEDIA_TYPE,wt="application/xhtml+xml"===bt?R:E,It="ALLOWED_TAGS"in e?_({},e.ALLOWED_TAGS,wt):xt,Nt="ALLOWED_ATTR"in e?_({},e.ALLOWED_ATTR,wt):At,he="ALLOWED_NAMESPACES"in e?_({},e.ALLOWED_NAMESPACES,R):ue,oe="ADD_URI_SAFE_ATTR"in e?_(k(ie),e.ADD_URI_SAFE_ATTR,wt):ie,ee="ADD_DATA_URI_TAGS"in e?_(k(ne),e.ADD_DATA_URI_TAGS,wt):ne,Zt="FORBID_CONTENTS"in e?_({},e.FORBID_CONTENTS,wt):te,jt="FORBID_TAGS"in e?_({},e.FORBID_TAGS,wt):{},_t="FORBID_ATTR"in e?_({},e.FORBID_ATTR,wt):{},Jt="USE_PROFILES"in e&&e.USE_PROFILES,kt=!1!==e.ALLOW_ARIA_ATTR,Pt=!1!==e.ALLOW_DATA_ATTR,Dt=e.ALLOW_UNKNOWN_PROTOCOLS||!1,Lt=!1!==e.ALLOW_SELF_CLOSE_IN_ATTR,Ft=e.SAFE_FOR_TEMPLATES||!1,Vt=!1!==e.SAFE_FOR_XML,Wt=e.WHOLE_DOCUMENT||!1,zt=e.RETURN_DOM||!1,Gt=e.RETURN_DOM_FRAGMENT||!1,Yt=e.RETURN_TRUSTED_TYPE||!1,Ut=e.FORCE_BODY||!1,Xt=!1!==e.SANITIZE_DOM,$t=e.SANITIZE_NAMED_PROPS||!1,qt=!1!==e.KEEP_CONTENT,Qt=e.IN_PLACE||!1,Mt=e.ALLOWED_URI_REGEXP||Mt,le=e.NAMESPACE||ae,Ht=e.CUSTOM_ELEMENT_HANDLING||{},e.CUSTOM_ELEMENT_HANDLING&&me(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Ht.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&me(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Ht.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"===typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(Ht.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Ft&&(Pt=!1),Gt&&(zt=!0),Jt&&(It=_({},i(U)),Nt=[],!0===Jt.html&&(_(It,D),_(Nt,z)),!0===Jt.svg&&(_(It,L),_(Nt,G),_(Nt,X)),!0===Jt.svgFilters&&(_(It,F),_(Nt,G),_(Nt,X)),!0===Jt.mathMl&&(_(It,W),_(Nt,Y),_(Nt,X))),e.ADD_TAGS&&(It===xt&&(It=k(It)),_(It,e.ADD_TAGS,wt)),e.ADD_ATTR&&(Nt===At&&(Nt=k(Nt)),_(Nt,e.ADD_ATTR,wt)),e.ADD_URI_SAFE_ATTR&&_(oe,e.ADD_URI_SAFE_ATTR,wt),e.FORBID_CONTENTS&&(Zt===te&&(Zt=k(Zt)),_(Zt,e.FORBID_CONTENTS,wt)),qt&&(It["#text"]=!0),Wt&&_(It,["html","head","body"]),It.table&&(_(It,["tbody"]),delete jt.tbody),p&&p(e),ge=e)},we=_({},["mi","mo","mn","ms","mtext"]),ve=_({},["annotation-xml"]),ye=_({},["title","style","font","a","script"]),Ce=_({},L);_(Ce,F),_(Ce,V);var Se=_({},W);_(Se,B);var Oe=function(t){var e=H(t);e&&e.tagName||(e={namespaceURI:le,tagName:"template"});var n=E(t.tagName),o=E(e.tagName);return!!he[t.namespaceURI]&&(t.namespaceURI===se?e.namespaceURI===ae?"svg"===n:e.namespaceURI===re?"svg"===n&&("annotation-xml"===o||we[o]):Boolean(Ce[n]):t.namespaceURI===re?e.namespaceURI===ae?"math"===n:e.namespaceURI===se?"math"===n&&ve[o]:Boolean(Se[n]):t.namespaceURI===ae?!(e.namespaceURI===se&&!ve[o])&&(!(e.namespaceURI===re&&!we[o])&&(!Se[n]&&(ye[n]||!Ce[n]))):!("application/xhtml+xml"!==bt||!he[t.namespaceURI]))},Ee=function(t){O(n.removed,{element:t});try{t.parentNode.removeChild(t)}catch(Pe){try{t.outerHTML=lt}catch(Pe){t.remove()}}},Re=function(t,e){try{O(n.removed,{attribute:e.getAttributeNode(t),from:e})}catch(Pe){O(n.removed,{attribute:null,from:e})}if(e.removeAttribute(t),"is"===t&&!Nt[t])if(zt||Gt)try{Ee(e)}catch(Pe){}else try{e.setAttribute(t,"")}catch(Pe){}},Te=function(t){var e,n;if(Ut)t="<remove></remove>"+t;else{var o=T(t,/^[\r\n\t ]+/);n=o&&o[0]}"application/xhtml+xml"===bt&&le===ae&&(t='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+t+"</body></html>");var i=at?at.createHTML(t):t;if(le===ae)try{e=(new g).parseFromString(i,bt)}catch(Pe){}if(!e||!e.documentElement){e=ht.createDocument(le,"template",null);try{e.documentElement.innerHTML=ce?lt:i}catch(Pe){}}var s=e.body||e.documentElement;return t&&n&&s.insertBefore(r.createTextNode(n),s.childNodes[0]||null),le===ae?ft.call(e,Wt?"html":"body")[0]:Wt?e.documentElement:s},Me=function(t){return ut.call(t.ownerDocument||t,t,h.SHOW_ELEMENT|h.SHOW_COMMENT|h.SHOW_TEXT|h.SHOW_PROCESSING_INSTRUCTION|h.SHOW_CDATA_SECTION,null,!1)},Ie=function(t){return t instanceof f&&("string"!==typeof t.nodeName||"string"!==typeof t.textContent||"function"!==typeof t.removeChild||!(t.attributes instanceof d)||"function"!==typeof t.removeAttribute||"function"!==typeof t.setAttribute||"string"!==typeof t.namespaceURI||"function"!==typeof t.insertBefore||"function"!==typeof t.hasChildNodes)},xe=function(e){return"object"===t(l)?e instanceof l:e&&"object"===t(e)&&"number"===typeof e.nodeType&&"string"===typeof e.nodeName},Ne=function(t,e,o){mt[t]&&C(mt[t],(function(t){t.call(n,e,o,ge)}))},Ae=function(t){var e;if(Ne("beforeSanitizeElements",t,null),Ie(t))return Ee(t),!0;if(N(/[\u0080-\uFFFF]/,t.nodeName))return Ee(t),!0;var o=wt(t.nodeName);if(Ne("uponSanitizeElement",t,{tagName:o,allowedTags:It}),t.hasChildNodes()&&!xe(t.firstElementChild)&&(!xe(t.content)||!xe(t.content.firstElementChild))&&N(/<[/\w]/g,t.innerHTML)&&N(/<[/\w]/g,t.textContent))return Ee(t),!0;if("select"===o&&N(/<template/i,t.innerHTML))return Ee(t),!0;if(7===t.nodeType)return Ee(t),!0;if(Vt&&8===t.nodeType&&N(/<[/\w]/g,t.data))return Ee(t),!0;if(!It[o]||jt[o]){if(!jt[o]&&je(o)){if(Ht.tagNameCheck instanceof RegExp&&N(Ht.tagNameCheck,o))return!1;if(Ht.tagNameCheck instanceof Function&&Ht.tagNameCheck(o))return!1}if(qt&&!Zt[o]){var i=H(t)||t.parentNode,r=y(t)||t.childNodes;if(r&&i)for(var s=r.length,a=s-1;a>=0;--a){var l=w(r[a],!0);l.__removalCount=(t.__removalCount||0)+1,i.insertBefore(l,v(t))}}return Ee(t),!0}return t instanceof c&&!Oe(t)?(Ee(t),!0):"noscript"!==o&&"noembed"!==o&&"noframes"!==o||!N(/<\/no(script|embed|frames)/i,t.innerHTML)?(Ft&&3===t.nodeType&&(e=t.textContent,e=M(e,vt," "),e=M(e,yt," "),e=M(e,Ct," "),t.textContent!==e&&(O(n.removed,{element:t.cloneNode()}),t.textContent=e)),Ne("afterSanitizeElements",t,null),!1):(Ee(t),!0)},He=function(t,e,n){if(Xt&&("id"===e||"name"===e)&&(n in r||n in pe))return!1;if(Pt&&!_t[e]&&N(St,e));else if(kt&&N(Ot,e));else if(!Nt[e]||_t[e]){if(!(je(t)&&(Ht.tagNameCheck instanceof RegExp&&N(Ht.tagNameCheck,t)||Ht.tagNameCheck instanceof Function&&Ht.tagNameCheck(t))&&(Ht.attributeNameCheck instanceof RegExp&&N(Ht.attributeNameCheck,e)||Ht.attributeNameCheck instanceof Function&&Ht.attributeNameCheck(e))||"is"===e&&Ht.allowCustomizedBuiltInElements&&(Ht.tagNameCheck instanceof RegExp&&N(Ht.tagNameCheck,n)||Ht.tagNameCheck instanceof Function&&Ht.tagNameCheck(n))))return!1}else if(oe[e]);else if(N(Mt,M(n,Rt,"")));else if("src"!==e&&"xlink:href"!==e&&"href"!==e||"script"===t||0!==I(n,"data:")||!ee[t]){if(Dt&&!N(Et,M(n,Rt,"")));else if(n)return!1}else;return!0},je=function(t){return"annotation-xml"!==t&&T(t,Tt)},_e=function(e){var o,i,r,s;Ne("beforeSanitizeAttributes",e,null);var a=e.attributes;if(a){var l={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Nt};s=a.length;while(s--){o=a[s];var c=o,h=c.name,u=c.namespaceURI;if(i="value"===h?o.value:x(o.value),r=wt(h),l.attrName=r,l.attrValue=i,l.keepAttr=!0,l.forceKeepAttr=void 0,Ne("uponSanitizeAttribute",e,l),i=l.attrValue,!l.forceKeepAttr&&(Re(h,e),l.keepAttr))if(Lt||!N(/\/>/i,i)){Ft&&(i=M(i,vt," "),i=M(i,yt," "),i=M(i,Ct," "));var d=wt(e.nodeName);if(He(d,r,i))if(!$t||"id"!==r&&"name"!==r||(Re(h,e),i=Kt+i),Vt&&N(/((--!?|])>)|<\/(style|title)/i,i))Re(h,e);else{if(at&&"object"===t(m)&&"function"===typeof m.getAttributeType)if(u);else switch(m.getAttributeType(d,r)){case"TrustedHTML":i=at.createHTML(i);break;case"TrustedScriptURL":i=at.createScriptURL(i);break}try{u?e.setAttributeNS(u,h,i):e.setAttribute(h,i),Ie(e)?Ee(e):S(n.removed)}catch(Pe){}}}else Re(h,e)}Ne("afterSanitizeAttributes",e,null)}},ke=function t(e){var n,o=Me(e);Ne("beforeSanitizeShadowDOM",e,null);while(n=o.nextNode())Ne("uponSanitizeShadowNode",n,null),Ae(n)||(n.content instanceof s&&t(n.content),_e(n));Ne("afterSanitizeShadowDOM",e,null)};return n.sanitize=function(i){var r,a,c,h,u,d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(ce=!i,ce&&(i="\x3c!--\x3e"),"string"!==typeof i&&!xe(i)){if("function"!==typeof i.toString)throw A("toString is not a function");if(i=i.toString(),"string"!==typeof i)throw A("dirty is not a string, aborting")}if(!n.isSupported){if("object"===t(e.toStaticHTML)||"function"===typeof e.toStaticHTML){if("string"===typeof i)return e.toStaticHTML(i);if(xe(i))return e.toStaticHTML(i.outerHTML)}return i}if(Bt||be(d),n.removed=[],"string"===typeof i&&(Qt=!1),Qt){if(i.nodeName){var f=wt(i.nodeName);if(!It[f]||jt[f])throw A("root node is forbidden and cannot be sanitized in-place")}}else if(i instanceof l)r=Te("\x3c!----\x3e"),a=r.ownerDocument.importNode(i,!0),1===a.nodeType&&"BODY"===a.nodeName||"HTML"===a.nodeName?r=a:r.appendChild(a);else{if(!zt&&!Ft&&!Wt&&-1===i.indexOf("<"))return at&&Yt?at.createHTML(i):i;if(r=Te(i),!r)return zt?null:Yt?lt:""}r&&Ut&&Ee(r.firstChild);var g=Me(Qt?i:r);while(c=g.nextNode())3===c.nodeType&&c===h||Ae(c)||(c.content instanceof s&&ke(c.content),_e(c),h=c);if(h=null,Qt)return i;if(zt){if(Gt){u=dt.call(r.ownerDocument);while(r.firstChild)u.appendChild(r.firstChild)}else u=r;return(Nt.shadowroot||Nt.shadowrootmod)&&(u=gt.call(o,u,!0)),u}var p=Wt?r.outerHTML:r.innerHTML;return Wt&&It["!doctype"]&&r.ownerDocument&&r.ownerDocument.doctype&&r.ownerDocument.doctype.name&&N(nt,r.ownerDocument.doctype.name)&&(p="<!DOCTYPE "+r.ownerDocument.doctype.name+">\n"+p),Ft&&(p=M(p,vt," "),p=M(p,yt," "),p=M(p,Ct," ")),at&&Yt?at.createHTML(p):p},n.setConfig=function(t){be(t),Bt=!0},n.clearConfig=function(){ge=null,Bt=!1},n.isValidAttribute=function(t,e,n){ge||be({});var o=wt(t),i=wt(e);return He(o,i,n)},n.addHook=function(t,e){"function"===typeof e&&(mt[t]=mt[t]||[],O(mt[t],e))},n.removeHook=function(t){if(mt[t])return S(mt[t])},n.removeHooks=function(t){mt[t]&&(mt[t]=[])},n.removeAllHooks=function(){mt={}},n}var at=st();return at}))},c0d8:function(t,e,n){"use strict";n("7a89"),n("d06e"),n("38b3"),n("f448"),n("66e1"),n("2582"),n("f86b"),n("1587"),n("c5d7"),n("f4db");var o=n("5d7f"),i=n("97b9"),r=n("7b9c"),s=n("63d8"),a=n("f938"),l=n("de3b"),c=n("491c"),h=n("87d6");function u(t,e){d(t,e),e.add(t)}function d(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function f(t,e,n){return(e=g(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function g(t){var e=p(t,"string");return"symbol"==typeof e?e:e+""}function p(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function m(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var b=new WeakSet;class w{constructor(t,e,n){u(this,b),f(this,"hot",void 0),f(this,"tableMeta",void 0),f(this,"selection",void 0),f(this,"eventManager",void 0),f(this,"destroyed",!1),f(this,"activeEditor",void 0),f(this,"cellProperties",void 0),this.hot=t,this.tableMeta=e,this.selection=n,this.eventManager=new h["a"](t),this.hot.addHook("afterDocumentKeyDown",t=>m(b,this,v).call(this,t)),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"compositionstart",t=>{!this.destroyed&&this.hot.isListening()&&this.openEditor("",t)}),this.hot.view._wt.update("onCellDblClick",(t,e,n)=>m(b,this,y).call(this,t,e,n))}getActiveEditor(){return this.activeEditor}prepareEditor(){var t;if(this.activeEditor&&this.activeEditor.isWaiting())return void this.closeEditor(!1,!1,t=>{t&&this.prepareEditor()});const e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;if(!e||e.isHeader())return;const{row:n,col:o}=e,i=this.hot.runHooks("modifyGetCellCoords",n,o);let r=n,s=o;if(Array.isArray(i)&&([r,s]=i),this.cellProperties=this.hot.getCellMeta(r,s),!this.isCellEditable())return void this.clearActiveEditor();const a=this.hot.getCell(n,o,!0);if(a){const t=this.hot.getCellEditor(this.cellProperties),e=this.hot.colToProp(s),i=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(r),s);this.activeEditor=Object(c["b"])(t,this.hot),this.activeEditor.prepare(n,o,e,a,i,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!this.isCellEditable())return void this.clearActiveEditor();const o=this.hot.getSelectedRangeLast();let i=this.hot.runHooks("beforeBeginEditing",o.highlight.row,o.highlight.col,t,e,n);e instanceof MouseEvent&&"boolean"!==typeof i&&(i=0===this.hot.selection.getLayerLevel()&&o.isSingle()),!1!==i?(this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(n&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(t,e))):this.clearActiveEditor()}closeEditor(t,e,n){this.activeEditor?this.activeEditor.finishEditing(t,e,n):n&&n(!1)}closeEditorAndSaveChanges(t){this.closeEditor(!1,t)}closeEditorAndRestoreOriginalValue(t){this.closeEditor(!0,t)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const t=this.hot.getSelectedRangeLast();if(!t)return!1;const e=this.hot.getCellEditor(this.cellProperties),{row:n,col:o}=t.highlight,{rowIndexMapper:i,columnIndexMapper:r}=this.hot,s=i.isHidden(this.hot.toPhysicalRow(n))||r.isHidden(this.hot.toPhysicalColumn(o));return!(this.cellProperties.readOnly||!e||s)}moveSelectionAfterEnter(t){const e={..."function"===typeof this.tableMeta.enterMoves?this.tableMeta.enterMoves(t):this.tableMeta.enterMoves};t.shiftKey&&(e.row=-e.row,e.col=-e.col),this.hot.selection.isMultiple()?this.selection.transformFocus(e.row,e.col):this.selection.transformStart(e.row,e.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function v(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||Object(l["isImmediatePropagationStopped"])(t))return;const{keyCode:n}=t,o=(t.ctrlKey||t.metaKey)&&!t.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&(Object(a["isFunctionKey"])(n)||Object(a["isCtrlMetaKey"])(n)||o||this.isEditorOpened()||this.openEditor("",t))}function y(t,e){e.isCell()&&this.openEditor(null,t,!0)}const C=new WeakMap;w.getInstance=function(t,e,n){let o=C.get(t);return o||(o=new w(t,e,n),C.set(t,o)),o};var S=w,O=n("351d"),E=n("bd5e");function R(t,e){M(t,e),e.add(t)}function T(t,e,n){M(t,e),e.set(t,n)}function M(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function I(t,e){return t.get(N(t,e))}function x(t,e,n){return t.set(N(t,e),n),n}function N(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const A=Object.freeze({CELL:"cell",MIXED:"mixed"});var H=new WeakMap,j=new WeakMap,_=new WeakMap,k=new WeakMap,P=new WeakMap,D=new WeakSet;class L{constructor(t){var e=this;R(this,D),T(this,H,void 0),T(this,j,void 0),T(this,_,1),T(this,k,null),T(this,P,new Map);const n=t.getSettings();x(H,this,t),x(j,this,n.imeFastEdit?A.MIXED:A.CELL),I(H,this).addHook("afterUpdateSettings",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return N(D,e,B).call(e,...n)})),I(H,this).addHook("afterSelection",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return N(D,e,V).call(e,...n)})),I(H,this).addHook("afterSelectionFocusSet",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return N(D,e,V).call(e,...n)})),I(H,this).addHook("afterSelectionEnd",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return N(D,e,W).call(e,...n)}))}getFocusMode(){return I(j,this)}setFocusMode(t){Object.values(A).includes(t)?x(j,this,t):Object(E["b"])(`"${t}" is not a valid focus mode.`)}getRefocusDelay(){return I(_,this)}setRefocusDelay(t){x(_,this,t)}setRefocusElementGetter(t){x(k,this,t)}getRefocusElement(){return"function"===typeof I(k,this)?I(k,this).call(this):null===(t=I(H,this).getActiveEditor())||void 0===t?void 0:t.TEXTAREA;var t}focusOnHighlightedCell(t){const e=t=>{var e,n;const o=null===(e=I(H,this).getSelectedRangeLast())||void 0===e?void 0:e.highlight;if(!o)return;let i=I(H,this).runHooks("modifyFocusedElement",o.row,o.col,t);i instanceof HTMLElement||(i=t),!i||null!==(n=I(H,this).getActiveEditor())&&void 0!==n&&n.isOpened()||i.focus({preventScroll:!0})};t?e(t):N(D,this,F).call(this,t=>e(t))}refocusToEditorTextarea(){var t;let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:I(_,this);const n=this.getRefocusElement();!I(H,this).getSettings().imeFastEdit||null!==(t=I(H,this).getActiveEditor())&&void 0!==t&&t.isOpened()||!n||(I(P,this).has(e)||I(P,this).set(e,Object(i["debounce"])(()=>{n.select()},e)),I(P,this).get(e)())}}function F(t){var e;const n=null===(e=I(H,this).getSelectedRangeLast())||void 0===e?void 0:e.highlight;if(!n||!I(H,this).selection.isCellVisible(n))return void t(null);const o=I(H,this).getCell(n.row,n.col,!0);null===o?I(H,this).addHookOnce("afterScroll",()=>{t(I(H,this).getCell(n.row,n.col,!0))}):t(o)}function V(){N(D,this,F).call(this,t=>{const{activeElement:e}=I(H,this).rootDocument;e&&Object(o["isOutsideInput"])(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function W(){N(D,this,F).call(this,t=>{this.getFocusMode()===A.MIXED&&"TD"===t.nodeName&&this.refocusToEditorTextarea()})}function B(t){"boolean"===typeof t.imeFastEdit&&this.setFocusMode(t.imeFastEdit?A.MIXED:A.CELL)}var U=n("81ea"),z=n("a776"),G=n("24b5"),Y=n("3d76"),X=n("169f"),$=n("29b0"),K=n("ffec"),q=n("7dd09");function Q(t,e,n){J(t,e),e.set(t,n)}function J(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Z(t,e){return t.get(et(t,e))}function tt(t,e,n){return t.set(et(t,e),n),n}function et(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var nt=new WeakMap,ot=new WeakMap,it=new WeakMap,rt=new WeakMap,st=new WeakMap,at=new WeakMap,lt=new WeakMap,ct=new WeakMap,ht=new WeakMap,ut=new WeakMap;class dt{constructor(t,e,n,o,i,r){let s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;Q(this,nt,void 0),Q(this,ot,void 0),Q(this,it,void 0),Q(this,rt,void 0),Q(this,st,void 0),Q(this,at,void 0),Q(this,lt,void 0),Q(this,ct,void 0),Q(this,ht,[null,null]),Q(this,ut,[null,null]),tt(nt,this,n),tt(ot,this,e),tt(it,this,i),tt(rt,this,r),tt(st,this,s),tt(at,this,o),tt(lt,this,t),this.registerEvents()}registerEvents(){Z(at,this).addEventListener(Z(it,this).holder,"contextmenu",t=>this.onContextMenu(t)),Z(at,this).addEventListener(Z(it,this).TABLE,"mouseover",t=>this.onMouseOver(t)),Z(at,this).addEventListener(Z(it,this).TABLE,"mouseout",t=>this.onMouseOut(t));const t=()=>{Z(at,this).addEventListener(Z(it,this).holder,"touchstart",t=>this.onTouchStart(t)),Z(at,this).addEventListener(Z(it,this).holder,"touchend",t=>this.onTouchEnd(t)),this.momentumScrolling||(this.momentumScrolling={}),Z(at,this).addEventListener(Z(it,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||Z(nt,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,Z(nt,this).getSetting("onAfterMomentumScroll"))},200)})},e=()=>{Z(at,this).addEventListener(Z(it,this).holder,"mouseup",t=>this.onMouseUp(t)),Z(at,this).addEventListener(Z(it,this).holder,"mousedown",t=>this.onMouseDown(t))};Object(s["isMobileBrowser"])()?t():(Object(q["isTouchSupported"])()&&t(),e())}selectedCellWasTouched(t){const e=this.parentCell(t),n=e.coords;if(Z(ct,this)&&n){const[t,e]=[n.row,Z(ct,this).from.row],[o,i]=[n.col,Z(ct,this).from.col];return t===e&&o===i}return!1}parentCell(t){const e={},n=Z(it,this).TABLE,i=Object(o["closestDown"])(t,["TD","TH"],n);return i?(e.coords=Z(it,this).getCoords(i),e.TD=i):Object(o["hasClass"])(t,"wtBorder")&&Object(o["hasClass"])(t,"current")?(e.coords=Z(rt,this).getFocusSelection().cellRange.highlight,e.TD=Z(it,this).getCell(e.coords)):Object(o["hasClass"])(t,"wtBorder")&&Object(o["hasClass"])(t,"area")&&Z(rt,this).getAreaSelection().cellRange&&(e.coords=Z(rt,this).getAreaSelection().cellRange.to,e.TD=Z(it,this).getCell(e.coords)),e}onMouseDown(t){const e=Z(ot,this).rootDocument.activeElement,n=Object(i["partial"])(o["getParent"],t.target),r=t.target;if(!["TD","TH"].includes(e.nodeName)&&(r===e||n(0)===e||n(1)===e))return;const s=this.parentCell(r);Object(o["hasClass"])(r,"corner")?Z(nt,this).getSetting("onCellCornerMouseDown",t,r):s.TD&&Z(nt,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",t,s.coords,s.TD),(0===t.button||this.touchApplied)&&s.TD&&(Z(ut,this)[0]=s.TD,clearTimeout(Z(ht,this)[0]),Z(ht,this)[0]=setTimeout(()=>{Z(ut,this)[0]=null},1e3))}onContextMenu(t){if(Z(nt,this).has("onCellContextMenu")){const e=this.parentCell(t.target);e.TD&&this.callListener("onCellContextMenu",t,e.coords,e.TD)}}onMouseOver(t){if(!Z(nt,this).has("onCellMouseOver"))return;const e=Z(it,this).TABLE,n=Object(o["closestDown"])(t.target,["TD","TH"],e),i=Z(st,this)||this;n&&n!==i.lastMouseOver&&Object(o["isChildOf"])(n,e)&&(i.lastMouseOver=n,this.callListener("onCellMouseOver",t,Z(it,this).getCoords(n),n))}onMouseOut(t){if(!Z(nt,this).has("onCellMouseOut"))return;const e=Z(it,this).TABLE,n=Object(o["closestDown"])(t.target,["TD","TH"],e),i=Object(o["closestDown"])(t.relatedTarget,["TD","TH"],e),r=Z(st,this)||this;n&&n!==i&&Object(o["isChildOf"])(n,e)&&(this.callListener("onCellMouseOut",t,Z(it,this).getCoords(n),n),null===i&&(r.lastMouseOver=null))}onMouseUp(t){const e=this.parentCell(t.target);e.TD&&Z(nt,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",t,e.coords,e.TD),(0===t.button||this.touchApplied)&&(e.TD===Z(ut,this)[0]&&e.TD===Z(ut,this)[1]?(Object(o["hasClass"])(t.target,"corner")?this.callListener("onCellCornerDblClick",t,e.coords,e.TD):this.callListener("onCellDblClick",t,e.coords,e.TD),Z(ut,this)[0]=null,Z(ut,this)[1]=null):e.TD===Z(ut,this)[0]&&(Z(ut,this)[1]=e.TD,clearTimeout(Z(ht,this)[1]),Z(ht,this)[1]=setTimeout(()=>{Z(ut,this)[1]=null},500)))}onTouchStart(t){tt(ct,this,Z(rt,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(t)}onTouchEnd(t){var e;const n=t.target,o=null===(e=this.parentCell(n))||void 0===e?void 0:e.coords,i=Object(r["isDefined"])(o)&&o.row>=0&&o.col>=0,a=t.cancelable&&i&&Z(nt,this).getSetting("isDataViewInstance");if(a){const e=["A","BUTTON","INPUT"];Object(s["isIOS"])()&&(Object(s["isChromeWebKit"])()||Object(s["isFirefoxWebKit"])())&&this.selectedCellWasTouched(n)&&!e.includes(n.tagName)?t.preventDefault():this.selectedCellWasTouched(n)||t.preventDefault()}this.onMouseUp(t),this.touchApplied=!1}callListener(t,e,n,o){const i=Z(nt,this).getSettingPure(t);i&&i(e,n,o,Z(lt,this).call(this))}destroy(){clearTimeout(Z(ht,this)[0]),clearTimeout(Z(ht,this)[1]),Z(at,this).destroy()}}var ft=dt;function gt(t,e,n){return(e=pt(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pt(t){var e=mt(t,"string");return"symbol"==typeof e?e:e+""}function mt(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class bt{constructor(t,e,n){gt(this,"offset",void 0),gt(this,"total",void 0),gt(this,"countTH",void 0),this.offset=t,this.total=e,this.countTH=n}offsetted(t){return t+this.offset}unOffsetted(t){return t-this.offset}renderedToSource(t){return this.offsetted(t)}sourceToRendered(t){return this.unOffsetted(t)}offsettedTH(t){return t-this.countTH}unOffsettedTH(t){return t+this.countTH}visibleRowHeadedColumnToSourceColumn(t){return this.renderedToSource(this.offsettedTH(t))}sourceColumnToVisibleRowHeadedColumn(t){return this.unOffsettedTH(this.sourceToRendered(t))}}var wt=bt;function vt(t,e,n){return(e=yt(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yt(t){var e=Ct(t,"string");return"symbol"==typeof e?e:e+""}function Ct(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class St{constructor(t,e,n){vt(this,"offset",void 0),vt(this,"total",void 0),vt(this,"countTH",void 0),this.offset=t,this.total=e,this.countTH=n}offsetted(t){return t+this.offset}unOffsetted(t){return t-this.offset}renderedToSource(t){return this.offsetted(t)}sourceToRendered(t){return this.unOffsetted(t)}offsettedTH(t){return t-this.countTH}unOffsettedTH(t){return t+this.countTH}visibleColHeadedRowToSourceRow(t){return this.renderedToSource(this.offsettedTH(t))}sourceRowToVisibleColHeadedRow(t){return this.unOffsettedTH(this.sourceToRendered(t))}}var Ot=St;const Et=0,Rt=1,Tt=2;function Mt(t,e,n){return(e=It(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function It(t){var e=xt(t,"string");return"symbol"==typeof e?e:e+""}function xt(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Nt{constructor(){Mt(this,"currentSize",0),Mt(this,"nextSize",0),Mt(this,"currentOffset",0),Mt(this,"nextOffset",0)}setSize(t){this.currentSize=this.nextSize,this.nextSize=t}setOffset(t){this.currentOffset=this.nextOffset,this.nextOffset=t}}function At(t,e,n){return(e=Ht(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ht(t){var e=jt(t,"string");return"symbol"==typeof e?e:e+""}function jt(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class _t{constructor(){At(this,"size",new Nt),At(this,"workingSpace",Et),At(this,"sharedSize",null)}setSize(t){this.size.setSize(t)}setOffset(t){this.size.setOffset(t)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof Nt}isPlaceOn(t){return this.workingSpace===t}append(t){this.workingSpace=Rt,t.workingSpace=Tt,this.sharedSize=t.getViewSize()}prepend(t){this.workingSpace=Tt,t.workingSpace=Rt,this.sharedSize=t.getViewSize()}}function kt(t,e,n){return(e=Pt(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pt(t){var e=Dt(t,"string");return"symbol"==typeof e?e:e+""}function Dt(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Lt{constructor(t,e,n){kt(this,"rootNode",void 0),kt(this,"nodesPool",void 0),kt(this,"sizeSet",new _t),kt(this,"childNodeType",void 0),kt(this,"visualIndex",0),kt(this,"collectedNodes",[]),this.rootNode=t,this.nodesPool=e,this.childNodeType=n.toUpperCase()}setSize(t){return this.sizeSet.setSize(t),this}setOffset(t){return this.sizeSet.setOffset(t),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(t){return t<this.collectedNodes.length?this.collectedNodes[t]:null}getCurrentNode(){const t=this.collectedNodes.length;return t>0?this.collectedNodes[t-1]:null}getRenderedChildCount(){const{rootNode:t,sizeSet:e}=this;let n=0;if(this.isSharedViewSet()){let o=t.firstElementChild;while(o){if(o.tagName===this.childNodeType)n+=1;else if(e.isPlaceOn(Rt))break;o=o.nextElementSibling}}else n=t.childElementCount;return n}start(){this.collectedNodes.length=0,this.visualIndex=0;const{rootNode:t,sizeSet:e}=this,n=this.isSharedViewSet(),{nextSize:o}=e.getViewSize();let i=this.getRenderedChildCount();while(i<o){const o=this.nodesPool();!n||n&&e.isPlaceOn(Tt)?t.appendChild(o):t.insertBefore(o,t.firstChild),i+=1}const r=n&&e.isPlaceOn(Rt);while(i>o)t.removeChild(r?t.firstChild:t.lastChild),i-=1}render(){const{rootNode:t,sizeSet:e}=this;let n=this.visualIndex;this.isSharedViewSet()&&e.isPlaceOn(Tt)&&(n+=e.sharedSize.nextSize);let o=t.childNodes[n];if(o.tagName!==this.childNodeType){const e=this.nodesPool();t.replaceChild(e,o),o=e}this.collectedNodes.push(o),this.visualIndex+=1}end(){}}class Ft extends Lt{prependView(t){return this.sizeSet.prepend(t.sizeSet),t.sizeSet.append(this.sizeSet),this}appendView(t){return this.sizeSet.append(t.sizeSet),t.sizeSet.prepend(this.sizeSet),this}}function Vt(t,e,n){return(e=Wt(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wt(t){var e=Bt(t,"string");return"symbol"==typeof e?e:e+""}function Bt(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Ut{constructor(t){Vt(this,"nodeType",void 0),this.nodeType=t.toUpperCase()}setRootDocument(t){this.rootDocument=t}obtain(){return this.rootDocument.createElement(this.nodeType)}}function zt(t,e,n){return(e=Gt(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gt(t){var e=Yt(t,"string");return"symbol"==typeof e?e:e+""}function Yt(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Xt{constructor(t,e){zt(this,"nodesPool",null),zt(this,"nodeType",void 0),zt(this,"rootNode",void 0),zt(this,"table",null),zt(this,"renderedNodes",0),this.nodesPool="string"===typeof t?new Ut(t):null,this.nodeType=t,this.rootNode=e}setTable(t){this.nodesPool&&this.nodesPool.setRootDocument(t.rootDocument),this.table=t}adjust(){}render(){}}var $t=n("8828");function Kt(t,e,n){return(e=qt(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qt(t){var e=Qt(t,"string");return"symbol"==typeof e?e:e+""}function Qt(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Jt extends Xt{constructor(){super("TH"),Kt(this,"orderViews",new WeakMap),Kt(this,"sourceRowIndex",0)}obtainOrderView(t){let e;return this.orderViews.has(t)?e=this.orderViews.get(t):(e=new Ft(t,t=>this.nodesPool.obtain(this.sourceRowIndex,t),this.nodeType),this.orderViews.set(t,e)),e}render(){const{rowsToRender:t,rowHeaderFunctions:e,rowHeadersCount:n,rows:i,cells:r}=this.table;for(let s=0;s<t;s++){const t=this.table.renderedRowToSource(s),a=i.getRenderedNode(s);this.sourceRowIndex=t;const l=this.obtainOrderView(a),c=r.obtainOrderView(a);l.appendView(c).setSize(n).setOffset(this.table.renderedColumnToSource(0)).start();for(let i=0;i<n;i++){l.render();const n=l.getCurrentNode();n.className="",n.removeAttribute("style"),Object(o["removeAttribute"])(n,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Object(o["setAttribute"])(n,[Object($t["E"])(),Object($t["H"])(),Object($t["f"])(i+1),Object($t["L"])(-1)]),e[i](t,n,i)}l.end()}}}class Zt extends Xt{constructor(t){super(null,t)}adjust(){const{columnHeadersCount:t,rowHeadersCount:e}=this.table;let n=this.rootNode.firstChild;if(t){const{columnsToRender:o}=this.table,i=o+e;for(let e=0,s=t;e<s;e++){n=this.rootNode.childNodes[e],n||(n=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(n)),this.renderedNodes=n.childNodes.length;while(this.renderedNodes<i)n.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;while(this.renderedNodes>i)n.removeChild(n.lastChild),this.renderedNodes-=1}const r=this.rootNode.childNodes.length;if(r>t)for(let e=t;e<r;e++)this.rootNode.removeChild(this.rootNode.lastChild)}else n&&Object(o["empty"])(n)}render(){const{columnHeadersCount:t}=this.table;this.table.isAriaEnabled()&&Object(o["setAttribute"])(this.rootNode,[Object($t["D"])()]);for(let e=0;e<t;e+=1){const{columnHeaderFunctions:t,columnsToRender:n,rowHeadersCount:i}=this.table,r=this.rootNode.childNodes[e];this.table.isAriaEnabled()&&Object(o["setAttribute"])(r,[Object($t["B"])(),Object($t["F"])(e+1)]);for(let s=-1*i;s<n;s+=1){const n=this.table.renderedColumnToSource(s),a=r.childNodes[s+i];a.className="",a.removeAttribute("style"),Object(o["removeAttribute"])(a,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Object(o["setAttribute"])(a,[Object($t["f"])(s+1+this.table.rowHeadersCount),Object($t["L"])(-1),Object($t["g"])(),...s>=0?[Object($t["G"])()]:[Object($t["B"])()]]),t[e](n,a,e)}}}}var te=n("67a8");let ee=!1;class ne extends Xt{constructor(t){super(null,t)}adjust(){const{columnsToRender:t,rowHeadersCount:e}=this.table,n=t+e;while(this.renderedNodes<n)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;while(this.renderedNodes>n)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:t,rowHeadersCount:e}=this.table;!ee&&t>1e3&&(ee=!0,Object(E["b"])(te["a"]`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let o=0;o<e;o++){const t=this.table.renderedColumnToSource(o),e=this.table.columnUtils.getHeaderWidth(t);this.rootNode.childNodes[o].style.width=e+"px"}for(let o=0;o<t;o++){const t=this.table.renderedColumnToSource(o),n=this.table.columnUtils.getStretchedColumnWidth(t);this.rootNode.childNodes[o+e].style.width=n+"px"}const n=this.rootNode.firstChild;n&&Object(o["addClass"])(n,"rowHeader")}}function oe(t,e,n){return(e=ie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ie(t){var e=re(t,"string");return"symbol"==typeof e?e:e+""}function re(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}const se={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let ae=!1;class le extends Xt{constructor(t){super("TR",t),oe(this,"orderView",void 0),this.orderView=new Lt(t,t=>this.nodesPool.obtain(t),this.nodeType)}getRenderedNode(t){return this.orderView.getNode(t)}render(){const{rowsToRender:t}=this.table;!ae&&t>1e3&&(ae=!0,Object(E["b"])(te["a"]`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&Object(o["setAttribute"])(this.rootNode,[Object($t["D"])()]),this.orderView.setSize(t).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<t;i++){this.orderView.render();const t=this.orderView.getCurrentNode(),r=this.table.renderedRowToSource(i);var e,n;if(this.table.isAriaEnabled())Object(o["setAttribute"])(t,[Object($t["B"])(),Object($t["F"])(r+(null!==(e=null===(n=this.table.rowUtils)||void 0===n||null===(n=n.dataAccessObject)||void 0===n?void 0:n.columnHeaders.length)&&void 0!==e?e:0)+1)]);Object(o["removeClass"])(t,[se.rowEven,se.rowOdd]),(r+1)%2===0?Object(o["addClass"])(t,se.rowEven):Object(o["addClass"])(t,se.rowOdd)}this.orderView.end()}}function ce(t,e,n){return(e=he(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function he(t){var e=ue(t,"string");return"symbol"==typeof e?e:e+""}function ue(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class de extends Xt{constructor(){super("TD"),ce(this,"orderViews",new WeakMap),ce(this,"sourceRowIndex",0)}obtainOrderView(t){let e;return this.orderViews.has(t)?e=this.orderViews.get(t):(e=new Ft(t,t=>this.nodesPool.obtain(this.sourceRowIndex,t),this.nodeType),this.orderViews.set(t,e)),e}render(){const{rowsToRender:t,columnsToRender:e,rows:n,rowHeaders:i}=this.table;for(let a=0;a<t;a++){const t=this.table.renderedRowToSource(a),l=n.getRenderedNode(a);this.sourceRowIndex=t;const c=this.obtainOrderView(l),h=i.obtainOrderView(l);c.prependView(h).setSize(e).setOffset(this.table.renderedColumnToSource(0)).start();for(let n=0;n<e;n++){c.render();const e=c.getCurrentNode(),i=this.table.renderedColumnToSource(n);var r,s;if(Object(o["hasClass"])(e,"hide")||(e.className=""),e.removeAttribute("style"),e.removeAttribute("dir"),Object(o["removeAttribute"])(e,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(t,i,e),this.table.isAriaEnabled())Object(o["setAttribute"])(e,[...e.hasAttribute("role")?[]:[Object($t["l"])()],Object($t["L"])(-1),Object($t["f"])(i+(null!==(r=null===(s=this.table.rowUtils)||void 0===s||null===(s=s.dataAccessObject)||void 0===s?void 0:s.rowHeaders.length)&&void 0!==r?r:0)+1)])}c.end()}}}function fe(t,e,n){return(e=ge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ge(t){var e=pe(t,"string");return"symbol"==typeof e?e:e+""}function pe(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class me{constructor(t){let{cellRenderer:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};fe(this,"rootNode",void 0),fe(this,"rootDocument",void 0),fe(this,"rowHeaders",null),fe(this,"columnHeaders",null),fe(this,"colGroup",null),fe(this,"rows",null),fe(this,"cells",null),fe(this,"rowFilter",null),fe(this,"columnFilter",null),fe(this,"rowUtils",null),fe(this,"columnUtils",null),fe(this,"rowsToRender",0),fe(this,"columnsToRender",0),fe(this,"rowHeaderFunctions",[]),fe(this,"rowHeadersCount",0),fe(this,"columnHeaderFunctions",[]),fe(this,"columnHeadersCount",0),fe(this,"cellRenderer",void 0),fe(this,"activeOverlayName",void 0),this.rootNode=t,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=e}setActiveOverlayName(t){this.activeOverlayName=t}setAxisUtils(t,e){this.rowUtils=t,this.columnUtils=e}setViewportSize(t,e){this.rowsToRender=t,this.columnsToRender=e}setFilters(t,e){this.rowFilter=t,this.columnFilter=e}setHeaderContentRenderers(t,e){this.rowHeaderFunctions=t,this.rowHeadersCount=t.length,this.columnHeaderFunctions=e,this.columnHeadersCount=e.length}setRenderers(){let{rowHeaders:t,columnHeaders:e,colGroup:n,rows:o,cells:i}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.setTable(this),e.setTable(this),n.setTable(this),o.setTable(this),i.setTable(this),this.rowHeaders=t,this.columnHeaders=e,this.colGroup=n,this.rows=o,this.cells=i}renderedRowToSource(t){return this.rowFilter.renderedToSource(t)}renderedColumnToSource(t){return this.columnFilter.renderedToSource(t)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:t,rows:e}=this;for(let n=0;n<t;n++){const t=e.getRenderedNode(n);if(t.firstChild){const e=this.renderedRowToSource(n),o=this.rowUtils.getHeightByOverlayName(e,this.activeOverlayName);t.firstChild.style.height=o?o-1+"px":""}}}}class be{constructor(){let{TABLE:t,THEAD:e,COLGROUP:n,TBODY:o,rowUtils:i,columnUtils:r,cellRenderer:s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.renderer=new me(t,{cellRenderer:s}),this.renderer.setRenderers({rowHeaders:new Jt,columnHeaders:new Zt(e),colGroup:new ne(n),rows:new le(o),cells:new de}),this.renderer.setAxisUtils(i,r)}setActiveOverlayName(t){return this.renderer.setActiveOverlayName(t),this}setFilters(t,e){return this.renderer.setFilters(t,e),this}setViewportSize(t,e){return this.renderer.setViewportSize(t,e),this}setHeaderContentRenderers(t,e){return this.renderer.setHeaderContentRenderers(t,e),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}var we=n("861dd");function ve(t,e,n){ye(t,e),e.set(t,n)}function ye(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ce(t,e,n){return(e=Se(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Se(t){var e=Oe(t,"string");return"symbol"==typeof e?e:e+""}function Oe(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Ee(t,e){return t.get(Te(t,e))}function Re(t,e,n){return t.set(Te(t,e),n),n}function Te(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Me=new WeakMap,Ie=new WeakMap,xe=new WeakMap,Ne=new WeakMap,Ae=new WeakMap;class He{constructor(t){let{totalColumns:e,stretchMode:n,stretchingColumnWidthFn:o,columnWidthFn:i}=t;Ce(this,"stretchAllRatio",0),Ce(this,"stretchLastWidth",0),Ce(this,"stretchAllColumnsWidth",[]),ve(this,Me,0),Ce(this,"needVerifyLastColumnWidth",!0),ve(this,Ie,()=>0),ve(this,xe,t=>t),ve(this,Ne,t=>t),ve(this,Ae,()=>"none"),Re(Ie,this,e),Re(Ae,this,n),Re(xe,this,null!==o&&void 0!==o?o:Ee(xe,this)),Re(Ne,this,null!==i&&void 0!==i?i:Ee(Ne,this))}refreshStretching(t){if("none"===Ee(Ae,this).call(this))return;this.stretchAllRatio=0,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0,this.stretchLastWidth=0,Re(Me,this,t);let e=0;for(let o=0;o<Ee(Ie,this).call(this);o++){const n=this._getColumnWidth(o),i=Ee(xe,this).call(this,void 0,o);"number"===typeof i?t-=i:e+=n}const n=t-e;if("all"===Ee(Ae,this).call(this)&&n>0)this.stretchAllRatio=t/e,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if("last"===Ee(Ae,this).call(this)&&t!==1/0){const t=this._getColumnWidth(Ee(Ie,this).call(this)-1),e=n+t;this.stretchLastWidth=e>=0?e:t}}getStretchedColumnWidth(t,e){let n=null;return"all"===Ee(Ae,this).call(this)&&0!==this.stretchAllRatio?n=this._getStretchedAllColumnWidth(t,e):"last"===Ee(Ae,this).call(this)&&0!==this.stretchLastWidth&&(n=this._getStretchedLastColumnWidth(t)),n}_getStretchedAllColumnWidth(t,e){let n=0;if(!this.stretchAllColumnsWidth[t]){const n=Math.round(e*this.stretchAllRatio),o=Ee(xe,this).call(this,n,t);this.stretchAllColumnsWidth[t]=void 0===o?n:isNaN(o)?this._getColumnWidth(t):o}if(this.stretchAllColumnsWidth.length===Ee(Ie,this).call(this)&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(let t=0;t<this.stretchAllColumnsWidth.length;t++)n+=this.stretchAllColumnsWidth[t];n!==Ee(Me,this)&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=Ee(Me,this)-n)}return this.stretchAllColumnsWidth[t]}_getStretchedLastColumnWidth(t){return t===Ee(Ie,this).call(this)-1?this.stretchLastWidth:null}_getColumnWidth(t){let e=Ee(Ne,this).call(this,t);return isNaN(e)&&(e=we["a"]),e}}function je(t,e,n){return(e=_e(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _e(t){var e=ke(t,"string");return"symbol"==typeof e?e:e+""}function ke(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Pe{constructor(t,e){je(this,"dataAccessObject",void 0),je(this,"wtSettings",void 0),je(this,"headerWidths",new Map),je(this,"stretching",void 0),this.dataAccessObject=t,this.wtSettings=e,this.stretching=new He({totalColumns:()=>this.wtSettings.getSetting("totalColumns"),stretchMode:()=>this.wtSettings.getSetting("stretchH"),stretchingColumnWidthFn:(t,e)=>this.wtSettings.getSetting("onBeforeStretchingColumnWidth",t,e),columnWidthFn:t=>this.dataAccessObject.wtTable.getColumnWidth(t)})}getWidth(t){const e=this.wtSettings.getSetting("columnWidth",t)||this.wtSettings.getSetting("defaultColumnWidth");return e}getStretchedColumnWidth(t){let e=this.getWidth(t);const n=this.stretching.getStretchedColumnWidth(t,e);return n&&(e=n),e}getHeaderHeight(t){let e=this.wtSettings.getSetting("defaultRowHeight");const n=this.dataAccessObject.wtViewport.oversizedColumnHeaders[t];return void 0!==n&&(e=e?Math.max(e,n):n),e}getHeaderWidth(t){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(t))}refreshStretching(){const{wtTable:t,wtViewport:e,cloneSource:n}=this.dataAccessObject,i=n?n.wtTable.holder:t.holder,r=i.offsetHeight<i.scrollHeight?Object(o["getScrollbarWidth"])():0;this.stretching.refreshStretching(e.getViewportWidth()-r)}calculateWidths(){const{wtSettings:t}=this;let e=t.getSetting("rowHeaderWidth");if(this.refreshStretching(),e=t.getSetting("onModifyRowHeaderWidth",e),null!==e&&void 0!==e){const n=t.getSetting("rowHeaders").length,o=t.getSetting("defaultColumnWidth");for(let t=0;t<n;t++){let n=Array.isArray(e)?e[t]:e;n=null===n||void 0===n?o:n,this.headerWidths.set(t,n)}}}}function De(t,e,n){return(e=Le(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Le(t){var e=Fe(t,"string");return"symbol"==typeof e?e:e+""}function Fe(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Ve{constructor(t,e){De(this,"dataAccessObject",void 0),De(this,"wtSettings",void 0),this.dataAccessObject=t,this.wtSettings=e}getHeight(t){let e=this.wtSettings.getSetting("rowHeight",t);const n=this.dataAccessObject.wtViewport.oversizedRows[t];return void 0!==n&&(e=void 0===e?n:Math.max(e,n)),e}getHeightByOverlayName(t,e){let n=this.wtSettings.getSetting("rowHeightByOverlayName",t,e);const o=this.dataAccessObject.wtViewport.oversizedRows[t];return void 0!==o&&(n=void 0===n?o:Math.max(n,o)),n}}const We="top",Be="bottom",Ue="inline_start",ze="top_inline_start_corner",Ge="bottom_inline_start_corner",Ye=[We,Be,Ue,ze,Ge],Xe=new Map([[We,"ht_clone_"+We],[Be,"ht_clone_"+Be],[Ue,`ht_clone_${Ue} ht_clone_left`],[ze,`ht_clone_${ze} ht_clone_top_left_corner`],[Ge,`ht_clone_${Ge} ht_clone_bottom_left_corner`]]);function $e(t,e,n){return(e=Ke(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ke(t){var e=qe(t,"string");return"symbol"==typeof e?e:e+""}function qe(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Qe{constructor(t,e,n,i,r){$e(this,"wtSettings",null),$e(this,"domBindings",void 0),$e(this,"TBODY",null),$e(this,"THEAD",null),$e(this,"COLGROUP",null),$e(this,"hasTableHeight",!0),$e(this,"hasTableWidth",!0),$e(this,"isTableVisible",!1),$e(this,"tableOffset",0),$e(this,"holderOffset",0),this.domBindings=n,this.isMaster="master"===r,this.name=r,this.dataAccessObject=t,this.facadeGetter=e,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,Object(o["removeTextNodes"])(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new Ve(this.dataAccessObject,this.wtSettings),this.columnUtils=new Pe(this.dataAccessObject,this.wtSettings),this.tableRenderer=new be({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}is(t){return this.name===t}fixTableDomTree(){const t=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=t.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=t.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=t.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(t){const e=t.parentNode;let n;return e&&e.nodeType===Node.ELEMENT_NODE&&Object(o["hasClass"])(e,"wtHolder")||(n=this.domBindings.rootDocument.createElement("div"),n.className="wtSpreader",e&&e.insertBefore(n,t),n.appendChild(t)),n.style.position="relative",this.wtSettings.getSetting("ariaTags")&&Object(o["setAttribute"])(n,[Object($t["y"])()]),n}createHider(t){const e=t.parentNode;let n;return e&&e.nodeType===Node.ELEMENT_NODE&&Object(o["hasClass"])(e,"wtHolder")||(n=this.domBindings.rootDocument.createElement("div"),n.className="wtHider",e&&e.insertBefore(n,t),n.appendChild(t)),this.wtSettings.getSetting("ariaTags")&&Object(o["setAttribute"])(n,[Object($t["y"])()]),n}createHolder(t){const e=t.parentNode;let n;return e&&e.nodeType===Node.ELEMENT_NODE&&Object(o["hasClass"])(e,"wtHolder")||(n=this.domBindings.rootDocument.createElement("div"),n.style.position="relative",n.className="wtHolder",e&&e.insertBefore(n,t),this.isMaster&&(n.parentNode.className+="ht_master handsontable",n.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&Object(o["setAttribute"])(n.parentNode,[Object($t["y"])()])),n.appendChild(t)),this.wtSettings.getSetting("ariaTags")&&Object(o["setAttribute"])(n,[Object($t["y"])()]),n}draw(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{wtSettings:e}=this,{wtOverlays:n,wtViewport:i}=this.dataAccessObject,r=e.getSetting("totalRows"),s=e.getSetting("totalColumns"),a=e.getSetting("rowHeaders"),l=a.length,c=e.getSetting("columnHeaders"),h=c.length;let u=t;if(this.isMaster&&(n.beforeDraw(),this.holderOffset=Object(o["offset"])(this.holder),u=i.createCalculators(u),l&&!e.getSetting("fixedColumnsStart"))){const t=n.inlineStartOverlay.getScrollPosition(),e=this.correctHeaderWidth;this.correctHeaderWidth=0!==t,e!==this.correctHeaderWidth&&(u=!1)}if(u)this.isMaster&&n.refresh(!0);else{this.isMaster?this.tableOffset=Object(o["offset"])(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const t=r>0?this.getFirstRenderedRow():0,e=s>0?this.getFirstRenderedColumn():0;this.rowFilter=new Ot(t,r,h),this.columnFilter=new wt(e,s,l);let u=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const t={};this.wtSettings.getSetting("beforeDraw",!0,t),u=!0!==t.skipRender}if(u){let t;if(this.tableRenderer.setHeaderContentRenderers(a,c),(this.is(Be)||this.is(Ge))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&(t=this.dataAccessObject.workspaceWidth,i.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Be))&&this.markOversizedRows(),this.isMaster){this.wtSettings.getSetting("externalRowCalculator")||i.createVisibleCalculators(),n.refresh(!1),n.applyToDOM();const e=Object(o["outerWidth"])(this.hider),r=Object(o["outerWidth"])(this.TABLE);0!==e&&r!==e&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),t!==i.getWorkspaceWidth()&&(i.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(Be)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}let d=!1;return this.isMaster&&(d=n.topOverlay.resetFixedPosition(),n.bottomOverlay.clone&&(d=n.bottomOverlay.resetFixedPosition()||d),d=n.inlineStartOverlay.resetFixedPosition()||d,n.topInlineStartCornerOverlay&&n.topInlineStartCornerOverlay.resetFixedPosition(),n.bottomInlineStartCornerOverlay&&n.bottomInlineStartCornerOverlay.clone&&n.bottomInlineStartCornerOverlay.resetFixedPosition()),d?(n.refreshAll(),n.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(u),this.isMaster&&n.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(t){const e=this.columnFilter.renderedToSource(t);let n=this.wtSettings.getSetting("columnHeaders").length;const i=this.wtSettings.getSetting("defaultRowHeight");let r,s,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];while(n)n-=1,r=this.getColumnHeaderHeight(n),s=this.getColumnHeader(e,n),s&&(a=Object(o["innerHeight"])(s),(!r&&i<a||r<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=a),Array.isArray(l)?null!==l[n]&&void 0!==l[n]&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l[n]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]<(l[n]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l[n]||l))}adjustColumnHeaderHeights(){const{wtSettings:t}=this,e=this.THEAD.childNodes,n=this.dataAccessObject.wtViewport.oversizedColumnHeaders,o=t.getSetting("columnHeaders");for(let i=0,r=o.length;i<r;i++)if(n[i]){if(!e[i]||0===e[i].childNodes.length)return;e[i].childNodes[0].style.height=n[i]+"px"}}resetOversizedRows(){const{wtSettings:t}=this,{wtViewport:e}=this.dataAccessObject;if((this.isMaster||this.is(Be))&&!t.getSetting("externalRowCalculator")){const t=this.getRenderedRowsCount();for(let n=0;n<t;n++){const t=this.rowFilter.renderedToSource(n);e.oversizedRows&&e.oversizedRows[t]&&(e.oversizedRows[t]=void 0)}}}getCell(t){let e=t.row,n=t.col;const o=this.wtSettings.getSetting("onModifyGetCellCoords",e,n);if(o&&Array.isArray(o)&&([e,n]=o),this.isRowBeforeRenderedRows(e))return-1;if(this.isRowAfterRenderedRows(e))return-2;if(this.isColumnBeforeRenderedColumns(n))return-3;if(this.isColumnAfterRenderedColumns(n))return-4;const i=this.getRow(e);if(!i&&e>=0)throw new Error("TR was expected to be rendered but is not");const r=i.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(n)];if(!r&&n>=0)throw new Error("TD or TH was expected to be rendered but is not");return r}getRow(t){let e=null,n=null;var o,i;t<0?(e=null===(o=this.rowFilter)||void 0===o?void 0:o.sourceRowToVisibleColHeadedRow(t),n=this.THEAD):(e=null===(i=this.rowFilter)||void 0===i?void 0:i.sourceToRendered(t),n=this.TBODY);return void 0!==e&&void 0!==n&&(!(n.childNodes.length<e+1)&&n.childNodes[e])}getColumnHeader(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.THEAD.childNodes[e];return null===n||void 0===n?void 0:n.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(t)]}getColumnHeaders(t){const e=[],n=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(t);return this.THEAD.childNodes.forEach(t=>{const o=t.childNodes[n];o&&e.push(o)}),e}getRowHeader(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.wtSettings.getSetting("rowHeaders").length;if(e>=n)return;const o=this.rowFilter.sourceToRendered(t),i=o<0?this.rowFilter.sourceRowToVisibleColHeadedRow(t):o,r=o<0?this.THEAD:this.TBODY,s=r.childNodes[i];return null===s||void 0===s?void 0:s.childNodes[e]}getRowHeaders(t){const e=[],n=this.wtSettings.getSetting("rowHeaders").length;for(let o=0;o<n;o++){const n=this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)],i=null===n||void 0===n?void 0:n.childNodes[o];i&&e.push(i)}return e}getCoords(t){let e=t;if("TD"!==e.nodeName&&"TH"!==e.nodeName&&(e=Object(o["closest"])(e,["TD","TH"])),null===e)return null;const n=e.parentNode,i=n.parentNode;let r=Object(o["index"])(n),s=e.cellIndex;if(Object(o["overlayContainsElement"])(ze,e,this.wtRootElement)||Object(o["overlayContainsElement"])(We,e,this.wtRootElement))"THEAD"===i.nodeName&&(r-=i.childNodes.length);else if(Object(o["overlayContainsElement"])(Ge,e,this.wtRootElement)||Object(o["overlayContainsElement"])(Be,e,this.wtRootElement)){const t=this.wtSettings.getSetting("totalRows");r=t-i.childNodes.length+r}else r=i===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(r):this.rowFilter.renderedToSource(r);return s=Object(o["overlayContainsElement"])(ze,e,this.wtRootElement)||Object(o["overlayContainsElement"])(Ue,e,this.wtRootElement)||Object(o["overlayContainsElement"])(Ge,e,this.wtRootElement)?this.columnFilter.offsettedTH(s):this.columnFilter.visibleRowHeadedColumnToSourceColumn(s),this.wot.createCellCoords(r,s)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let t=this.TBODY.childNodes.length;const e=t*this.wtSettings.getSetting("defaultRowHeight"),n=Object(o["innerHeight"])(this.TBODY)-1;let i,r,s,a,l;if(e!==n||this.wtSettings.getSetting("fixedRowsBottom"))while(t)t-=1,s=this.rowFilter.renderedToSource(t),i=this.getRowHeight(s),a=this.getTrForRow(s),l=a.querySelector("th"),r=l?Object(o["innerHeight"])(l):Object(o["innerHeight"])(a)-1,(!i&&this.wtSettings.getSetting("defaultRowHeight")<r||i<r)&&(r+=1,this.dataAccessObject.wtViewport.oversizedRows[s]=r)}getTrForRow(t){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)]}isColumnHeaderRendered(t){if(t>=0)return!1;const e=this.wtSettings.getSetting("rowHeaders"),n=e.length;return Math.abs(t)<=n}isRowHeaderRendered(t){if(t>=0)return!1;const e=this.wtSettings.getSetting("columnHeaders"),n=e.length;return Math.abs(t)<=n}isRowBeforeRenderedRows(t){const e=this.getFirstRenderedRow();return t<0&&e<=0?!this.isRowHeaderRendered(t):t<e}isRowAfterRenderedRows(t){return t>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(t){const e=this.getFirstRenderedColumn();return t<0&&e<=0?!this.isColumnHeaderRendered(t):t<e}isColumnAfterRenderedColumns(t){return this.columnFilter&&t>this.getLastRenderedColumn()}isColumnAfterViewport(t){return this.columnFilter&&t>this.getLastVisibleColumn()}isRowAfterViewport(t){return this.rowFilter&&t>this.getLastVisibleRow()}isColumnBeforeViewport(t){return this.columnFilter&&this.columnFilter.sourceToRendered(t)<0&&t>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(t){return this.rowUtils.getHeight(t)}getColumnHeaderHeight(t){return this.columnUtils.getHeaderHeight(t)}getColumnWidth(t){return this.columnUtils.getWidth(t)}getStretchedColumnWidth(t){return this.columnUtils.getStretchedColumnWidth(t)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return Object(o["outerWidth"])(this.TABLE)}getHeight(){return Object(o["outerHeight"])(this.TABLE)}getTotalWidth(){const t=Object(o["outerWidth"])(this.hider);return 0!==t?t:this.getWidth()}getTotalHeight(){const t=Object(o["outerHeight"])(this.hider);return 0!==t?t:this.getHeight()}isVisible(){return Object(o["isVisible"])(this.TABLE)}_modifyRowHeaderWidth(t){let e=Object(i["isFunction"])(t)?t():null;return Array.isArray(e)?(e=[...e],e[e.length-1]=this._correctRowHeaderWidth(e[e.length-1])):e=this._correctRowHeaderWidth(e),e}_correctRowHeaderWidth(t){let e=t;return"number"!==typeof t&&(e=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(e+=1),e}}var Je=Qe;const Ze="stickyRowsTop",tn={getFirstRenderedRow(){const t=this.wtSettings.getSetting("totalRows");return 0===t?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Object(O["defineGetter"])(tn,"MIXIN_NAME",Ze,{writable:!1,enumerable:!1});var en=tn;const nn="calculatedColumns",on={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return null===t?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return null===t?-1:t},getFirstPartiallyVisibleColumn(){const t=this.dataAccessObject.startColumnPartiallyVisible;return null===t?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return null===t?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return null===t?-1:t},getLastPartiallyVisibleColumn(){const t=this.dataAccessObject.endColumnPartiallyVisible;return null===t?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Object(O["defineGetter"])(on,"MIXIN_NAME",nn,{writable:!1,enumerable:!1});var rn=on;class sn extends Je{constructor(t,e,n,o){super(t,e,n,o,We)}}Object(O["mixin"])(sn,en),Object(O["mixin"])(sn,rn);var an=sn;function ln(t,e){cn(t,e),e.add(t)}function cn(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hn(t,e,n){return(e=un(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function un(t){var e=dn(t,"string");return"symbol"==typeof e?e:e+""}function dn(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function fn(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var gn=new WeakSet;class pn{constructor(t){ln(this,gn),hn(this,"dataAccessObject",void 0),this.dataAccessObject=t}scrollViewport(t,e,n,o,i){const r=this.scrollViewportHorizontally(t.col,n,i),s=this.scrollViewportVertically(t.row,e,o);return r||s}scrollViewportHorizontally(t,e,n){const{drawn:o,totalColumns:i}=this.dataAccessObject;if(!o||!Number.isInteger(t)||t<0||t>i)return!1;const r=void 0===e&&void 0===n,{fixedColumnsStart:s,inlineStartOverlay:a}=this.dataAccessObject;if(r&&t<s)return!1;if(t=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",t),!Number.isInteger(t)||t<0||t>i)return!1;const l=this.getFirstVisibleColumn(),c=this.getLastVisibleColumn();let h=!1;return(r&&(t<l||t>c)||!r)&&(h=a.scrollTo(t,r?t>=this.getLastPartiallyVisibleColumn():e)),h}scrollViewportVertically(t,e,n){const{drawn:o,totalRows:i}=this.dataAccessObject;if(!o||!Number.isInteger(t)||t<0||t>i)return!1;const r=void 0===e&&void 0===n,{fixedRowsBottom:s,fixedRowsTop:a,topOverlay:l}=this.dataAccessObject;if(r&&(t<a||t>i-s-1))return!1;if(t=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",t),!Number.isInteger(t)||t<0||t>i)return!1;const c=this.getFirstVisibleRow(),h=this.getLastVisibleRow();let u=!1;return(r&&(t<c||t>h)||!r)&&(u=l.scrollTo(t,r?t>=this.getLastPartiallyVisibleRow():n)),u}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return fn(gn,this,bn).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return fn(gn,this,bn).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return fn(gn,this,mn).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return fn(gn,this,mn).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function mn(t){const{wtSettings:e,inlineStartOverlay:n,wtTable:i,wtViewport:r,totalColumns:s,rootWindow:a}=this.dataAccessObject;if(n.mainTableScrollableElement===a){const l=e.getSetting("rtlMode");let c=null;if(l){const t=i.TABLE.getBoundingClientRect(),e=this.dataAccessObject.rootWindow.document,n=e.documentElement.offsetWidth;c=Math.abs(t.right-n)}else{const t=Object(o["offset"])(i.wtRootElement);c=t.left}const h=Math.abs(Object(o["getScrollLeft"])(a,a));if(c>h){const e=Object(o["innerWidth"])(a);let i=r.getRowHeaderWidth();for(let o=1;o<=s;o++)if(i+=n.sumCellSizes(o-1,o),c+i-h>=e){t=o-2;break}}}return t}function bn(t){const{topOverlay:e,wtTable:n,wtViewport:i,totalRows:r,rootWindow:s}=this.dataAccessObject;if(e.mainTableScrollableElement===s){const a=Object(o["offset"])(n.wtRootElement),l=Object(o["getScrollTop"])(s,s);if(a.top>l){const n=Object(o["innerHeight"])(s);let c=i.getColumnHeaderHeight();for(let o=1;o<=r;o++)if(c+=e.sumCellSizes(o-1,o),a.top+c-l>=n){t=o-2;break}}}return t}var wn=pn,vn=n("0716"),yn=n("d852");function Cn(t,e,n){return(e=Sn(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Sn(t){var e=On(t,"string");return"symbol"==typeof e?e:e+""}function On(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class En{get eventManager(){return new h["a"](this)}constructor(t,e){Cn(this,"wtTable",void 0),Cn(this,"wtScroll",void 0),Cn(this,"wtViewport",void 0),Cn(this,"wtOverlays",void 0),Cn(this,"selectionManager",void 0),Cn(this,"wtEvent",void 0),Cn(this,"guid","wt_"+Object($["randomString"])()),Cn(this,"drawInterrupted",!1),Cn(this,"drawn",!1),Cn(this,"domBindings",void 0),Cn(this,"wtSettings",void 0),this.domBindings={rootTable:t,rootDocument:t.ownerDocument,rootWindow:t.ownerDocument.defaultView},this.wtSettings=e,this.wtScroll=new wn(this.createScrollDao())}findOriginalHeaders(){const t=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let e=0,n=this.wtTable.THEAD.childNodes[0].childNodes.length;e<n;e++)t.push(this.wtTable.THEAD.childNodes[0].childNodes[e].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(e,n){Object(o["fastInnerText"])(n,t[e])}])}}createCellCoords(t,e){return new vn["a"](t,e,this.wtSettings.getSetting("rtlMode"))}createCellRange(t,e,n){return new yn["a"](t,e,n,this.wtSettings.getSetting("rtlMode"))}draw(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.drawInterrupted=!1,this.wtTable.isVisible()?this.wtTable.draw(t):this.drawInterrupted=!0,this}getCell(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return this.wtTable.getCell(t);const n=this.wtSettings.getSetting("totalRows"),o=this.wtSettings.getSetting("fixedRowsTop"),i=this.wtSettings.getSetting("fixedRowsBottom"),r=this.wtSettings.getSetting("fixedColumnsStart");if(t.row<o&&t.col<r)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(t);if(t.row<o)return this.wtOverlays.topOverlay.clone.wtTable.getCell(t);if(t.col<r&&t.row>=n-i){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(t)}else{if(t.col<r)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(t);if(t.row<n&&t.row>=n-i&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(t)}return this.wtTable.getCell(t)}scrollViewport(t,e,n,o,i){return!(t.col<0||t.row<0)&&this.wtScroll.scrollViewport(t,e,n,o,i)}scrollViewportHorizontally(t,e,n){return!(t<0)&&this.wtScroll.scrollViewportHorizontally(t,e,n)}scrollViewportVertically(t,e,n){return!(t<0)&&this.wtScroll.scrollViewportVertically(t,e,n)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const t=this;return{get drawn(){return t.drawn},get topOverlay(){return t.wtOverlays.topOverlay},get inlineStartOverlay(){return t.wtOverlays.inlineStartOverlay},get wtTable(){return t.wtTable},get wtViewport(){return t.wtViewport},get wtSettings(){return t.wtSettings},get rootWindow(){return t.domBindings.rootWindow},get totalRows(){return t.wtSettings.getSetting("totalRows")},get totalColumns(){return t.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return t.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return t.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return t.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const t=this;return{get wot(){return t},get parentTableOffset(){return t.cloneSource.wtTable.tableOffset},get cloneSource(){return t.cloneSource},get workspaceWidth(){return t.wtViewport.getWorkspaceWidth()},get wtViewport(){return t.wtViewport},get wtOverlays(){return t.wtOverlays},get selectionManager(){return t.selectionManager},get drawn(){return t.drawn},set drawn(e){t.drawn=e},get wtTable(){return t.wtTable},get startColumnRendered(){return t.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return t.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return t.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return t.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return t.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return t.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return t.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return t.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return t.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return t.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return t.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return t.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return t.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return t.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return t.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return t.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return t.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return t.wtSettings.getSetting("rowHeaders")}}}}function Rn(t,e,n){return(e=Tn(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tn(t){var e=Mn(t,"string");return"symbol"==typeof e?e:e+""}function Mn(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class In extends En{constructor(t,e,n){super(t,e),Rn(this,"cloneSource",void 0),Rn(this,"cloneOverlay",void 0);const o=this.wtSettings.getSetting("facade",this);this.cloneSource=n.source,this.cloneOverlay=n.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),o,this.domBindings,this.wtSettings),this.wtViewport=n.viewport,this.selectionManager=n.selectionManager,this.wtEvent=new ft(o,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,n.event),this.findOriginalHeaders()}}function xn(t,e,n){return(e=Nn(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nn(t){var e=An(t,"string");return"symbol"==typeof e?e:e+""}function An(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Hn{constructor(t,e,n,i,r){xn(this,"wtSettings",null),Object(O["defineGetter"])(this,"wot",t,{writable:!1}),this.domBindings=r,this.facadeGetter=e,this.wtSettings=i;const{TABLE:s,hider:a,spreader:l,holder:c,wtRootElement:h}=this.wot.wtTable;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=a,this.spreader=l,this.holder=c,this.wtRootElement=h,this.trimmingContainer=Object(o["getTrimmingContainer"])(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(t){"before"===t&&this.shouldBeRendered()?this.needFullRender=!0:"after"!==t||this.shouldBeRendered()||(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=Object(o["getTrimmingContainer"])(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:t}=this.wot,{rootWindow:e}=this.domBindings;"hidden"===e.getComputedStyle(t.wtRootElement.parentNode).getPropertyValue("overflow")?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Object(o["getScrollableElement"])(t.TABLE)}getRelativeCellPosition(t,e,n){if(!1===this.clone.wtTable.holder.contains(t))return void Object(E["b"])(`The provided element is not a child of the ${this.type} overlay`);const o=this.mainTableScrollableElement===this.domBindings.rootWindow,i=n<this.wtSettings.getSetting("fixedColumnsStart"),r=e<this.wtSettings.getSetting("fixedRowsTop"),s=e>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),a=this.clone.wtTable.spreader,l={start:this.getRelativeStartPosition(a),top:a.offsetTop},c={start:this.getRelativeStartPosition(t),top:t.offsetTop};let h=null;return h=o?this.getRelativeCellPositionWithinWindow(r,i,c,l):this.getRelativeCellPositionWithinHolder(r,s,i,c,l),h}getRelativeStartPosition(t){return this.isRtl()?t.offsetParent.offsetWidth-t.offsetLeft-t.offsetWidth:t.offsetLeft}getRelativeCellPositionWithinWindow(t,e,n,i){const r=this.wot.wtTable.wtRootElement.getBoundingClientRect();let s=0,a=0;if(e){let t=r.left;this.isRtl()&&(t=this.domBindings.rootWindow.innerWidth-(r.left+r.width+Object(o["getScrollbarWidth"])())),s=t<=0?-1*t:0}else s=i.start;if(t){const t=this.clone.wtTable.TABLE.getBoundingClientRect();a=t.top-r.top}else a=i.top;return{start:n.start+s,top:n.top+a}}getRelativeCellPositionWithinHolder(t,e,n,o,i){const r={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let s=0,a=0;if(n||(s=r.horizontal-i.start),e){const t=this.wot.wtTable.wtRootElement.getBoundingClientRect(),e=this.clone.wtTable.TABLE.getBoundingClientRect();a=-1*e.top+t.top}else t||(a=r.vertical-i.top);return{start:o.start-s,top:o.top-a}}makeClone(){if(-1===Ye.indexOf(this.type))throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:t,wtSettings:e}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,r=n.createElement("div"),s=n.createElement("table"),a=t.wtRootElement.parentNode;r.className=Xe.get(this.type)+" handsontable",r.setAttribute("dir",this.isRtl()?"rtl":"ltr"),r.style.position="absolute",r.style.top=0,r.style.overflow="visible",this.isRtl()?r.style.right=0:r.style.left=0,e.getSetting("ariaTags")&&Object(o["setAttribute"])(r,[Object($t["y"])()]),s.className=t.TABLE.className;const l=t.TABLE.getAttribute("role");l&&s.setAttribute("role",t.TABLE.getAttribute("role")),r.appendChild(s),a.appendChild(r);const c=this.wtSettings.getSetting("preventOverflow");return!0===c||"horizontal"===c&&this.type===We||"vertical"===c&&this.type===Ue?this.mainTableScrollableElement=i:"hidden"===i.getComputedStyle(a).getPropertyValue("overflow")?this.mainTableScrollableElement=t.holder:this.mainTableScrollableElement=Object(o["getScrollableElement"])(t.TABLE),new In(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.needFullRender&&this.clone.draw(t)}reset(){const t=this.clone.wtTable.holder,e=this.clone.wtTable.hider,n=t.style,o=e.style,i=t.parentNode.style;[n,o,i].forEach(t=>{t.width="",t.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}const jn=Object.freeze({width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"});function _n(t,e,n){return(e=kn(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kn(t){var e=Pn(t,"string");return"symbol"==typeof e?e:e+""}function Pn(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Dn extends Hn{constructor(t,e,n,o){super(t,e,We,n,o),_n(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new an(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const t=this.clone.wtTable.holder.parentNode,{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let i=0,r=!1;if(this.trimmingContainer!==e||n&&"vertical"===n)i=this.getScrollPosition(),Object(o["resetCssTransform"])(t);else{const{wtTable:e}=this.wot,n=e.hider.getBoundingClientRect(),s=Math.ceil(n.bottom),a=t.offsetHeight;r=s===a,i=this.getOverlayOffset(),Object(o["setOverlayPosition"])(t,"0px",i+"px")}const s=this.adjustHeaderBordersPosition(i,r);return this.adjustElementsSize(),s}setScrollPosition(t){const e=this.domBindings.rootWindow;let n=!1;return this.mainTableScrollableElement===e&&e.scrollY!==t?(e.scrollTo(Object(o["getWindowScrollLeft"])(e),t),n=!0):this.mainTableScrollableElement.scrollTop!==t&&(this.mainTableScrollableElement.scrollTop=t,n=!0),n}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(t,e){const n=this.wtSettings.getSetting("defaultRowHeight");let o=t,i=0;while(o<e){const t=this.wot.wtTable.getRowHeight(o);i+=void 0===t?n:t,o+=1}return i}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:t}=this.wot,{rootDocument:e,rootWindow:n}=this.domBindings,i=Object(o["getScrollbarWidth"])(e),r=this.clone.wtTable.holder.parentNode,s=r.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==n||"horizontal"===a){let e=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(e-=i),e=Math.min(e,t.wtRootElement.scrollWidth),s.width=e+"px"}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=Object(o["outerHeight"])(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(l=0),s.height=l+"px"}adjustRootChildrenSize(){const{holder:t}=this.clone.wtTable,e=this.wot.selectionManager.getFocusSelection()?parseInt(jn.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,t.style.width=t.parentNode.style.width,t.style.height=parseInt(t.parentNode.style.height,10)+e+"px"}applyToDOM(){const t=this.wtSettings.getSetting("totalRows");if("number"===typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=this.wot.wtViewport.rowsRenderCalculator.startPosition+"px";else{if(0!==t)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const t=this.isRtl()?"right":"left",{spreader:e}=this.clone.wtTable;"number"===typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?e.style[t]=this.wot.wtViewport.columnsRenderCalculator.startPosition+"px":e.style[t]=""}scrollTo(t,e){const{wot:n,wtSettings:i}=this,r=n.cloneSource?n.cloneSource:n,s=r.wtTable.holder,a=i.getSetting("columnHeaders"),l=i.getSetting("fixedRowsTop"),c=0===l&&a.length>0&&!Object(o["hasClass"])(s.parentNode,"innerBorderTop")?1:0;let h=this.getTableParentOffset(),u=0;if(e){const n=this.wot.wtTable.getRowHeight(t),o=this.wot.wtViewport.getViewportHeight();n>o&&(e=!1)}if(e&&s.offsetHeight!==s.clientHeight&&(u=Object(o["getScrollbarWidth"])(this.domBindings.rootDocument)),e){const e=i.getSetting("fixedRowsBottom"),o=i.getSetting("totalRows");h+=this.sumCellSizes(0,t+1),h-=n.wtViewport.getViewportHeight()-this.sumCellSizes(o-e,o),h+=1,h+=c}else h+=this.sumCellSizes(i.getSetting("fixedRowsTop"),t);return h+=u,Object(o["getMaximumScrollTop"])(this.mainTableScrollableElement)===h-c&&c>0&&this.wot.wtOverlays.expandHiderVerticallyBy(c),this.setScrollPosition(h)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Object(o["getScrollTop"])(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:t}=this.domBindings,e=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===t&&(!e||"vertical"!==e)){const t=this.wot.wtTable.getTotalHeight(),e=this.clone.wtTable.getTotalHeight(),o=t-e;n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),n>o&&(n=0)}return n}adjustHeaderBordersPosition(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{wtSettings:n}=this,i=this.wot.wtTable.holder.parentNode,r=n.getSetting("totalColumns"),s="horizontal"===n.getSetting("preventOverflow");r?Object(o["removeClass"])(i,"emptyColumns"):Object(o["addClass"])(i,"emptyColumns");let a=!1;if(!e&&!s){const e=n.getSetting("fixedRowsTop"),r=this.cachedFixedRowsTop!==e,s=n.getSetting("columnHeaders");if((r||0===e)&&s.length>0){const e=Object(o["hasClass"])(i,"innerBorderTop");this.cachedFixedRowsTop=n.getSetting("fixedRowsTop"),t||0===n.getSetting("totalRows")?(Object(o["addClass"])(i,"innerBorderTop"),a=!e):(Object(o["removeClass"])(i,"innerBorderTop"),a=e)}}return a}}const Ln="stickyRowsBottom",Fn={getFirstRenderedRow(){const t=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),n=t-e;return 0===t||0===e?-1:n<0?0:n},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};Object(O["defineGetter"])(Fn,"MIXIN_NAME",Ln,{writable:!1,enumerable:!1});var Vn=Fn;class Wn extends Je{constructor(t,e,n,o){super(t,e,n,o,Be)}}Object(O["mixin"])(Wn,Vn),Object(O["mixin"])(Wn,rn);var Bn=Wn;function Un(t,e,n){return(e=zn(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zn(t){var e=Gn(t,"string");return"symbol"==typeof e?e:e+""}function Gn(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Yn extends Hn{constructor(t,e,n,o){super(t,e,Be,n,o),Un(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new Bn(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:t}=this.domBindings,e=this.clone.wtTable.holder.parentNode;e.style.top="";let n=0;const o=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer!==t||o&&"vertical"===o?(n=this.getScrollPosition(),this.repositionOverlay()):(n=this.getOverlayOffset(),e.style.bottom=n+"px");const i=this.adjustHeaderBordersPosition(n);return this.adjustElementsSize(),i}repositionOverlay(){const{wtTable:t,wtViewport:e}=this.wot,{rootDocument:n}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let r=0;e.hasVerticalScroll()||(r+=e.getWorkspaceHeight()-t.getTotalHeight()),e.hasVerticalScroll()&&e.hasHorizontalScroll()&&(r+=Object(o["getScrollbarWidth"])(n)),i.style.bottom=r+"px"}setScrollPosition(t){const{rootWindow:e}=this.domBindings;let n=!1;return this.mainTableScrollableElement===e?(e.scrollTo(Object(o["getWindowScrollLeft"])(e),t),n=!0):this.mainTableScrollableElement.scrollTop!==t&&(this.mainTableScrollableElement.scrollTop=t,n=!0),n}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(t,e){const{wtTable:n,wtSettings:o}=this.wot,i=o.getSetting("defaultRowHeight");let r=t,s=0;while(r<e){const t=n.getRowHeight(r);s+=void 0===t?i:t,r+=1}return s}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:t,wtViewport:e}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,r=Object(o["getScrollbarWidth"])(n),s=this.clone.wtTable.holder.parentNode,a=s.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||"horizontal"===l){let n=e.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(n-=r),n=Math.min(n,t.wtRootElement.scrollWidth),a.width=n+"px"}else a.width="";this.clone.wtTable.holder.style.width=a.width;let c=Object(o["outerHeight"])(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(c=0),a.height=c+"px"}adjustRootChildrenSize(){const{holder:t}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,t.style.width=t.parentNode.style.width,t.style.height=t.parentNode.style.height}applyToDOM(){const t=this.wtSettings.getSetting("totalRows");if("number"===typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=this.wot.wtViewport.rowsRenderCalculator.startPosition+"px";else{if(0!==t)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const t=this.isRtl()?"right":"left",{spreader:e}=this.clone.wtTable;"number"===typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?e.style[t]=this.wot.wtViewport.columnsRenderCalculator.startPosition+"px":e.style[t]=""}scrollTo(t,e){let n=this.getTableParentOffset();const i=this.wot.cloneSource?this.wot.cloneSource:this.wot,r=i.wtTable.holder;let s=0;e&&r.offsetHeight!==r.clientHeight&&(s=Object(o["getScrollbarWidth"])(this.domBindings.rootDocument)),e?(n+=this.sumCellSizes(0,t+1),n-=this.wot.wtViewport.getViewportHeight(),n+=1):n+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),t),n+=s,this.setScrollPosition(n)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Object(o["getScrollTop"])(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:t}=this.domBindings,e=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===t&&(!e||"vertical"!==e)){const t=this.wot.wtTable.getTotalHeight(),e=this.clone.wtTable.getTotalHeight(),o=t-e,i=this.domBindings.rootDocument.documentElement.clientHeight;n=Math.max(this.getTableParentOffset()-this.getScrollPosition()-i+t,0),n>o&&(n=0)}return n}adjustHeaderBordersPosition(t){const e=this.wtSettings.getSetting("fixedRowsBottom"),n=this.cachedFixedRowsBottom!==e,i=this.wtSettings.getSetting("columnHeaders");let r=!1;if((n||0===e)&&i.length>0){const e=this.wot.wtTable.holder.parentNode,n=Object(o["hasClass"])(e,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),t||0===this.wtSettings.getSetting("totalRows")?(Object(o["addClass"])(e,"innerBorderBottom"),r=!n):(Object(o["removeClass"])(e,"innerBorderBottom"),r=n)}return r}}const Xn="calculatedRows",$n={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return null===t?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return null===t?-1:t},getFirstPartiallyVisibleRow(){const t=this.dataAccessObject.startRowPartiallyVisible;return null===t?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return null===t?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return null===t?-1:t},getLastPartiallyVisibleRow(){const t=this.dataAccessObject.endRowPartiallyVisible;return null===t?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Object(O["defineGetter"])($n,"MIXIN_NAME",Xn,{writable:!1,enumerable:!1});var Kn=$n;const qn="stickyColumnsStart",Qn={getFirstRenderedColumn(){const t=this.wtSettings.getSetting("totalColumns");return 0===t?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Object(O["defineGetter"])(Qn,"MIXIN_NAME",qn,{writable:!1,enumerable:!1});var Jn=Qn;class Zn extends Je{constructor(t,e,n,o){super(t,e,n,o,Ue)}}Object(O["mixin"])(Zn,Kn),Object(O["mixin"])(Zn,Jn);var to=Zn;class eo extends Hn{constructor(t,e,n,o){super(t,e,Ue,n,o)}createTable(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new to(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:t}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!t.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,n=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let r=0;this.trimmingContainer!==e||i&&"horizontal"===i?(r=this.getScrollPosition(),Object(o["resetCssTransform"])(n)):(r=this.getOverlayOffset()*(this.isRtl()?-1:1),Object(o["setOverlayPosition"])(n,r+"px","0px"));const s=this.adjustHeaderBordersPosition(r);return this.adjustElementsSize(),s}setScrollPosition(t){const{rootWindow:e}=this.domBindings;let n=!1;return this.isRtl()&&(t=-t),this.mainTableScrollableElement===e&&e.scrollX!==t?(e.scrollTo(t,Object(o["getWindowScrollTop"])(e)),n=!0):this.mainTableScrollableElement.scrollLeft!==t&&(this.mainTableScrollableElement.scrollLeft=t,n=!0),n}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(t,e){const n=this.wtSettings.getSetting("defaultColumnWidth");let o=t,i=0;while(o<e)i+=this.wot.wtTable.getStretchedColumnWidth(o)||n,o+=1;return i}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:t}=this.wot,{rootDocument:e,rootWindow:n}=this.domBindings,i=Object(o["getScrollbarWidth"])(e),r=this.clone.wtTable.holder.parentNode,s=r.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==n||"vertical"===a){let e=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(e-=i),e=Math.min(e,t.wtRootElement.scrollHeight),s.height=e+"px"}else s.height="";this.clone.wtTable.holder.style.height=s.height;const l=Object(o["outerWidth"])(this.clone.wtTable.TABLE);s.width=l+"px"}adjustRootChildrenSize(){const{holder:t}=this.clone.wtTable,e=this.wot.selectionManager.getFocusSelection()?parseInt(jn.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,t.style.height=t.parentNode.style.height,t.style.width=parseInt(t.parentNode.style.width,10)+e+"px"}applyToDOM(){const t=this.wtSettings.getSetting("totalColumns"),e=this.isRtl()?"right":"left";if("number"===typeof this.wot.wtViewport.columnsRenderCalculator.startPosition)this.spreader.style[e]=this.wot.wtViewport.columnsRenderCalculator.startPosition+"px";else{if(0!==t)throw new Error("Incorrect value of the columnsRenderCalculator");this.spreader.style[e]="0"}this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){"number"===typeof this.wot.wtViewport.rowsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.top=this.wot.wtViewport.rowsRenderCalculator.startPosition+"px":this.clone.wtTable.spreader.style.top=""}scrollTo(t,e){const{wtSettings:n}=this,i=n.getSetting("rowHeaders"),r=n.getSetting("fixedColumnsStart"),s=this.wot.cloneSource?this.wot.cloneSource:this.wot,a=s.wtTable.holder,l=0===r&&i.length>0&&!Object(o["hasClass"])(a.parentNode,"innerBorderInlineStart")?1:0;let c=this.getTableParentOffset(),h=0;if(e){const n=this.wot.wtTable.getColumnWidth(t),o=this.wot.wtViewport.getViewportWidth();n>o&&(e=!1)}return e&&a.offsetWidth!==a.clientWidth&&(h=Object(o["getScrollbarWidth"])(this.domBindings.rootDocument)),e?(c+=this.sumCellSizes(0,t+1),c-=this.wot.wtViewport.getViewportWidth(),c+=l):c+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),t),c+=h,Object(o["getMaximumScrollLeft"])(this.mainTableScrollableElement)===c-l&&l>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(l),this.setScrollPosition(c)}getTableParentOffset(){const t=this.wtSettings.getSetting("preventOverflow");let e=0;return t||this.trimmingContainer!==this.domBindings.rootWindow||(e=this.wot.wtTable.holderOffset.left),e}getScrollPosition(){return Math.abs(Object(o["getScrollLeft"])(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:t}=this.domBindings,e=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===t&&(!e||"horizontal"!==e)){n=this.isRtl()?Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const t=this.wot.wtTable.getTotalWidth(),e=this.clone.wtTable.getTotalWidth(),o=t-e;n>o&&(n=0)}return n}adjustHeaderBordersPosition(t){const{wtSettings:e}=this,n=this.wot.wtTable.holder.parentNode,i=e.getSetting("rowHeaders"),r=e.getSetting("fixedColumnsStart"),s=e.getSetting("totalRows"),a="vertical"===e.getSetting("preventOverflow");s?Object(o["removeClass"])(n,"emptyRows"):Object(o["addClass"])(n,"emptyRows");let l=!1;if(!a)if(r&&!i.length)Object(o["addClass"])(n,"innerBorderLeft innerBorderInlineStart");else if(!r&&i.length){const e=Object(o["hasClass"])(n,"innerBorderInlineStart");t?(Object(o["addClass"])(n,"innerBorderLeft innerBorderInlineStart"),l=!e):(Object(o["removeClass"])(n,"innerBorderLeft innerBorderInlineStart"),l=e)}return l}}class no extends Je{constructor(t,e,n,o){super(t,e,n,o,ze)}}Object(O["mixin"])(no,en),Object(O["mixin"])(no,Jn);var oo=no;function io(t,e,n){return(e=ro(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ro(t){var e=so(t,"string");return"symbol"==typeof e?e:e+""}function so(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class ao extends Hn{constructor(t,e,n,o,i,r){super(t,e,ze,n,o),io(this,"topOverlay",void 0),io(this,"inlineStartOverlay",void 0),this.topOverlay=i,this.inlineStartOverlay=r}createTable(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new oo(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const t=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const e=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),n=this.topOverlay.getOverlayOffset();Object(o["setOverlayPosition"])(t,e+"px",n+"px")}else Object(o["resetCssTransform"])(t);let e=Object(o["outerHeight"])(this.clone.wtTable.TABLE);const n=Object(o["outerWidth"])(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(e=0),t.style.height=e+"px",t.style.width=n+"px",!1}}class lo extends Je{constructor(t,e,n,o){super(t,e,n,o,Ge)}}Object(O["mixin"])(lo,Vn),Object(O["mixin"])(lo,Jn);var co=lo;class ho extends Hn{constructor(t,e,n,o,i,r){super(t,e,Ge,n,o),this.bottomOverlay=i,this.inlineStartOverlay=r}createTable(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new co(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:t}=this;if(this.updateTrimmingContainer(),!t.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(e.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const t=this.inlineStartOverlay.getOverlayOffset(),n=this.bottomOverlay.getOverlayOffset();e.style[this.isRtl()?"right":"left"]=t+"px",e.style.bottom=n+"px"}else Object(o["resetCssTransform"])(e),this.repositionOverlay();let n=Object(o["outerHeight"])(this.clone.wtTable.TABLE);const i=Object(o["outerWidth"])(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),e.style.height=n+"px",e.style.width=i+"px",!1}repositionOverlay(){const{wtTable:t,wtViewport:e}=this.wot,{rootDocument:n}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let r=0;e.hasVerticalScroll()||(r+=e.getWorkspaceHeight()-t.getTotalHeight()),e.hasVerticalScroll()&&e.hasHorizontalScroll()&&(r+=Object(o["getScrollbarWidth"])(n)),i.style.bottom=r+"px"}}function uo(t,e,n){fo(t,e),e.set(t,n)}function fo(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function go(t,e,n){return(e=po(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function po(t){var e=mo(t,"string");return"symbol"==typeof e?e:e+""}function mo(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function bo(t,e,n){return t.set(vo(t,e),n),n}function wo(t,e){return t.get(vo(t,e))}function vo(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var yo=new WeakMap,Co=new WeakMap,So=new WeakMap,Oo=new WeakMap;class Eo{constructor(t,e,n,i,r,s){go(this,"wot",null),uo(this,yo,[]),go(this,"topOverlay",null),go(this,"bottomOverlay",null),go(this,"inlineStartOverlay",null),go(this,"topInlineStartCornerOverlay",null),go(this,"bottomInlineStartCornerOverlay",null),go(this,"browserLineHeight",void 0),go(this,"wtSettings",null),uo(this,Co,!1),uo(this,So,0),uo(this,Oo,null),go(this,"resizeObserver",new ResizeObserver(t=>{Object(q["requestAnimationFrame"])(()=>{Array.isArray(t)&&t.length&&(bo(So,this,wo(So,this)+1),100===wo(So,this)&&(Object(E["b"])("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),null!==wo(Oo,this)&&clearTimeout(wo(Oo,this)),bo(Oo,this,setTimeout(()=>{bo(So,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=t,this.wtSettings=i,this.domBindings=n,this.facadeGetter=e,this.wtTable=s;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=r,this.scrollbarSize=Object(o["getScrollbarWidth"])(a);const c="hidden"===l.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow");this.scrollableElement=c?s.holder:Object(o["getScrollableElement"])(s.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const e=[...wo(yo,this)];return t&&e.push(this.wtTable),e}initBrowserLineHeight(){const{rootWindow:t,rootDocument:e}=this.domBindings,n=t.getComputedStyle(e.body),o=parseInt(n.lineHeight,10),i=1.2*parseInt(n.fontSize,10);this.browserLineHeight=o||i}initOverlays(){const t=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new Dn(...t),this.bottomOverlay=new Yn(...t),this.inlineStartOverlay=new eo(...t),this.topInlineStartCornerOverlay=new ao(...t,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new ho(...t,this.bottomOverlay,this.inlineStartOverlay),bo(yo,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){bo(Co,this,wo(yo,this).reduce((t,e)=>e.hasRenderingStateChanged()||t,!1)),wo(yo,this).forEach(t=>t.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),wo(yo,this).forEach(t=>{const e=t.hasRenderingStateChanged();t.updateStateOfRendering("after"),e&&!t.needFullRender&&t.reset()})}refreshAll(){this.wot.drawn&&(this.wtTable.holder.parentNode?(this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1):this.destroy())}registerListeners(){const{rootDocument:t,rootWindow:e}=this.domBindings,{mainTableScrollableElement:n}=this.topOverlay,{mainTableScrollableElement:o}=this.inlineStartOverlay;this.eventManager.addEventListener(t.documentElement,"keydown",t=>this.onKeyDown(t)),this.eventManager.addEventListener(t.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(t,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(n,"scroll",t=>this.onTableScroll(t),{passive:!0}),n!==o&&this.eventManager.addEventListener(o,"scroll",t=>this.onTableScroll(t),{passive:!0});const i=e.devicePixelRatio&&e.devicePixelRatio>1,r=this.scrollableElement===e,a=this.wtSettings.getSetting("preventWheel"),l={passive:r};(a||i||!Object(s["isChrome"])())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",t=>this.onCloneWheel(t,a),l);const c=[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let h;c.forEach(t=>{if(t&&t.needFullRender){const{holder:e}=t.clone.wtTable;this.eventManager.addEventListener(e,"wheel",t=>this.onCloneWheel(t,a),l)}}),this.eventManager.addEventListener(e,"resize",()=>{clearTimeout(h),h=setTimeout(()=>{this.wtSettings.getSetting("onWindowResize"),bo(So,this,0)},200)}),r||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(t){const e=this.domBindings.rootWindow,n=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,i=t.target;this.keyPressed&&(o!==e&&i!==e&&!t.target.contains(o)||n!==e&&i!==e&&!t.target.contains(n))||this.syncScrollPositions(t)}onCloneWheel(t,e){const{rootWindow:n}=this.domBindings,o=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,r=t.target,s=i!==n&&r!==n&&!r.contains(i),a=o!==n&&r!==n&&!r.contains(o);if(this.keyPressed&&(s||a)||this.scrollableElement===n)return;const l=this.translateMouseWheelToScroll(t);(e||this.scrollableElement!==n&&l)&&t.preventDefault()}onKeyDown(t){this.keyPressed=Object(a["isKey"])(t.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(t){let e=isNaN(t.deltaY)?-1*t.wheelDeltaY:t.deltaY,n=isNaN(t.deltaX)?-1*t.wheelDeltaX:t.deltaX;1===t.deltaMode&&(n+=n*this.browserLineHeight,e+=e*this.browserLineHeight);const o=this.scrollVertically(e),i=this.scrollHorizontally(n);return o||i}scrollVertically(t){const e=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=t,e!==this.scrollableElement.scrollTop}scrollHorizontally(t){const e=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=t,e!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:t}=this.domBindings,e=this.topOverlay.clone.wtTable.holder,n=this.inlineStartOverlay.clone.wtTable.holder,[o,i]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=e.scrollLeft!==o||this.lastScrollX!==t.scrollX,this.verticalScrolling=n.scrollTop!==i||this.lastScrollY!==t.scrollY,this.lastScrollX=t.scrollX,this.lastScrollY=t.scrollY,this.horizontalScrolling){e.scrollLeft=o;const t=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;t&&(t.scrollLeft=o)}this.verticalScrolling&&(n.scrollTop=i),this.refreshAll()}syncScrollWithMaster(){if(!wo(Co,this))return;const t=this.topOverlay.mainTableScrollableElement,{scrollLeft:e,scrollTop:n}=t;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=e),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=e),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=n),bo(Co,this,!1)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:t}=this,{rootWindow:e}=this.domBindings;"hidden"===e.getComputedStyle(t.wtRootElement.parentNode).getPropertyValue("overflow")?this.scrollableElement=t.holder:this.scrollableElement=Object(o["getScrollableElement"])(t.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const e=this.updateLastSpreaderSize();e&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(t),this.inlineStartOverlay.refresh(t),this.topOverlay.refresh(t),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(t),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(t)}updateLastSpreaderSize(){const t=this.wtTable.spreader,e=t.clientWidth,n=t.clientHeight,o=e!==this.spreaderLastSize.width||n!==this.spreaderLastSize.height;return o&&(this.spreaderLastSize.width=e,this.spreaderLastSize.height=n),o}adjustElementsSize(){const{wtViewport:t}=this.wot,{wtTable:e}=this,{rootWindow:n}=this.domBindings,o=this.scrollableElement===n,i=this.wtSettings.getSetting("totalColumns"),r=this.wtSettings.getSetting("totalRows"),s=t.getRowHeaderWidth(),a=t.getColumnHeaderHeight(),l=a+this.topOverlay.sumCellSizes(0,r)+1,c=s+this.inlineStartOverlay.sumCellSizes(0,i),h=e.hider,u=h.style,d=()=>!o&&this.scrollableElement.scrollTop>Math.max(0,l-e.holder.clientHeight),f=()=>!o&&this.scrollableElement.scrollLeft>Math.max(0,c-e.holder.clientWidth),g=d()?1:0,p=f()?1:0;if(u.width=c+p+"px",u.height=l+g+"px",this.scrollbarSize>0){const{scrollHeight:t,scrollWidth:n}=e.wtRootElement,{scrollHeight:o,scrollWidth:i}=e.holder;this.hasScrollbarRight=t<o,this.hasScrollbarBottom=n<i,this.hasScrollbarRight&&e.hider.scrollWidth+this.scrollbarSize>n?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&e.hider.scrollHeight+this.scrollbarSize>t&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(t){const{wtTable:e}=this;e.hider.style.height=parseInt(e.hider.style.height,10)+t+"px"}expandHiderHorizontallyBy(t){const{wtTable:e}=this;e.hider.style.width=parseInt(e.hider.style.width,10)+t+"px"}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(t){if(!t)return null;const e=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let n=null;return Object(U["arrayEach"])(e,e=>{e&&e.clone&&e.clone.wtTable.TABLE.contains(t)&&(n=e.clone)}),n}syncOverlayTableClassNames(){const t=this.wtTable.TABLE,e=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];Object(U["arrayEach"])(e,e=>{e&&(e.clone.wtTable.TABLE.className=t.className)})}}var Ro=Eo;function To(t,e,n){return(e=Mo(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mo(t){var e=Io(t,"string");return"symbol"==typeof e?e:e+""}function Io(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class xo{constructor(t){To(this,"settings",{}),To(this,"defaults",Object.freeze(this.getDefaults())),Object(O["objectEach"])(this.defaults,(e,n)=>{if(void 0!==t[n])this.settings[n]=t[n];else{if(void 0===e)throw new Error(`A required setting "${n}" was not provided`);this.settings[n]=e}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(t,e,n)=>{const i=this.getSetting("data",t,e);Object(o["fastInnerText"])(n,void 0===i||null===i?"":i)},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:t=>t,onBeforeViewportScrollVertically:t=>t,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:t=>t,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:t=>t,onBeforeHighlightingColumnHeader:t=>t,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(t,e){return void 0===e?Object(O["objectEach"])(t,(t,e)=>{this.settings[e]=t}):this.settings[t]=e,this}getSetting(t,e,n,o,i){return"function"===typeof this.settings[t]?this.settings[t](e,n,o,i):void 0!==e&&Array.isArray(this.settings[t])?this.settings[t][e]:this.settings[t]}getSettingPure(t){return this.settings[t]}has(t){return!!this.settings[t]}}class No extends Je{constructor(t,e,n,o){super(t,e,n,o,"master")}alignOverlaysWithTrimmingContainer(){const t=Object(o["getTrimmingContainer"])(this.wtRootElement),{rootWindow:e}=this.domBindings;if(t===e){const t=this.wtSettings.getSetting("preventOverflow");t||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else{const n=t.parentElement,i=Object(o["getStyle"])(t,"height",e),r=Object(o["getStyle"])(t,"overflow",e),s=this.holder.style,{scrollWidth:a,scrollHeight:l}=t;let c=t.offsetWidth,h=t.offsetHeight;const u=["auto","hidden","scroll"];if(n&&u.includes(r)){const i=t.cloneNode(!1);i.style.overflow="auto",i.style.position="absolute",t.nextElementSibling?n.insertBefore(i,t.nextElementSibling):n.appendChild(i);const r=parseInt(Object(o["getComputedStyle"])(i,e).height,10);n.removeChild(i),0===r&&(h=0)}h=Math.min(h,l),s.height="auto"===i?"auto":h+"px",c=Math.min(c,a),s.width=c+"px",s.overflow="",this.hasTableHeight="auto"===s.height||h>0,this.hasTableWidth=c>0}this.isTableVisible=Object(o["isVisible"])(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:t}=this,{wtViewport:e}=this.dataAccessObject,n="master",o=t.getSetting("columnHeaders"),i=o.length;if(i&&!e.hasOversizedColumnHeadersMarked[n]){const o=t.getSetting("rowHeaders"),r=o.length,s=this.getRenderedColumnsCount();for(let t=0;t<i;t++)for(let e=-1*r;e<s;e++)this.markIfOversizedColumnHeader(e);e.hasOversizedColumnHeadersMarked[n]=!0}}}Object(O["mixin"])(No,Kn),Object(O["mixin"])(No,rn);var Ao=No;function Ho(t,e,n){return(e=jo(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jo(t){var e=_o(t,"string");return"symbol"==typeof e?e:e+""}function _o(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class ko{constructor(){Ho(this,"count",0),Ho(this,"startRow",0),Ho(this,"endRow",0),Ho(this,"startPosition",0),Ho(this,"isVisibleInTrimmingContainer",!0)}initialize(t){let{totalRows:e}=t;this.count=e,this.endRow=this.count-1}process(){}finalize(){}}n("b879"),n("dce9");function Po(t,e,n){return(e=Do(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Do(t){var e=Lo(t,"string");return"symbol"==typeof e?e:e+""}function Lo(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Fo{constructor(){Po(this,"count",0),Po(this,"startRow",null),Po(this,"endRow",null),Po(this,"startPosition",null),Po(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(t,e){const{totalCalculatedHeight:n,zeroBasedScrollOffset:o,innerViewportHeight:i}=e;n<=o&&(this.startRow=t),n>=o&&n<=i&&null===this.startRow&&(this.startRow=t),this.endRow=t}finalize(t){var e;const{scrollOffset:n,viewportHeight:o,horizontalScrollbarHeight:i,totalRows:r,needReverse:s,startPositions:a,rowHeight:l}=t;if(this.endRow===r-1&&s){this.startRow=this.endRow;while(this.startRow>0){const t=a[this.endRow]+l-a[this.startRow-1];if(this.startRow-=1,t>=o-i)break}}this.startPosition=null!==(e=a[this.startRow])&&void 0!==e?e:null;const c=n+o-i;c<0||n>a.at(-1)+l?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,r<this.endRow&&(this.endRow=r-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}class Vo extends Fo{finalize(t){var e;super.finalize(t);const{overrideFn:n,totalRows:o,startPositions:i}=t;null!==this.startRow&&"function"===typeof n&&n(this),this.startRow<0&&(this.startRow=0),this.startPosition=null!==(e=i[this.startRow])&&void 0!==e?e:null,o<this.endRow&&(this.endRow=o-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}function Wo(t,e,n){return(e=Bo(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bo(t){var e=Uo(t,"string");return"symbol"==typeof e?e:e+""}function Uo(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class zo{constructor(){Wo(this,"count",0),Wo(this,"startRow",null),Wo(this,"endRow",null),Wo(this,"startPosition",null),Wo(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(t,e){const{totalCalculatedHeight:n,zeroBasedScrollOffset:o,innerViewportHeight:i,rowHeight:r}=e;n>=o&&n+r<=i&&(null===this.startRow&&(this.startRow=t),this.endRow=t)}finalize(t){var e;const{scrollOffset:n,viewportHeight:o,horizontalScrollbarHeight:i,totalRows:r,needReverse:s,startPositions:a,rowHeight:l}=t;if(this.endRow===r-1&&s){this.startRow=this.endRow;while(this.startRow>0){const t=a[this.endRow]+l-a[this.startRow-1];if(t<=o-i&&(this.startRow-=1),t>=o-i)break}}this.startPosition=null!==(e=a[this.startRow])&&void 0!==e?e:null;const c=n+o-i,h=null===this.startRow?0:t.getRowHeight(this.startRow);c<h||n>a.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,r<this.endRow&&(this.endRow=r-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}function Go(t,e,n){return(e=Yo(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yo(t){var e=Xo(t,"string");return"symbol"==typeof e?e:e+""}function Xo(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class $o{constructor(){Go(this,"count",0),Go(this,"startColumn",0),Go(this,"endColumn",0),Go(this,"startPosition",0),Go(this,"isVisibleInTrimmingContainer",!0)}initialize(t){let{totalColumns:e}=t;this.count=e,this.endColumn=this.count-1}process(){}finalize(){}}function Ko(t,e,n){return(e=qo(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qo(t){var e=Qo(t,"string");return"symbol"==typeof e?e:e+""}function Qo(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Jo{constructor(){Ko(this,"count",0),Ko(this,"startColumn",null),Ko(this,"endColumn",null),Ko(this,"startPosition",null),Ko(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(t,e){const{totalCalculatedWidth:n,zeroBasedScrollOffset:o,viewportWidth:i}=e;n<=o&&(this.startColumn=t);const r=o>0?i+1:i;n>=o&&n<=o+r&&(null!==this.startColumn&&void 0!==this.startColumn||(this.startColumn=t)),this.endColumn=t}finalize(t){var e;const{scrollOffset:n,viewportWidth:o,inlineStartOffset:i,zeroBasedScrollOffset:r,totalColumns:s,needReverse:a,startPositions:l,columnWidth:c}=t;if(this.endColumn===s-1&&a){this.startColumn=this.endColumn;while(this.startColumn>0){const t=l[this.endColumn]+c-l[this.startColumn-1];if(this.startColumn-=1,t>o)break}}this.startPosition=null!==(e=l[this.startColumn])&&void 0!==e?e:null;const h=r>0?o+1:o,u=n+o-h;u<-1*i||n>l.at(-1)+c||-1*n-o>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endColumn&&(this.endColumn=s-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}}class Zo extends Jo{finalize(t){var e;super.finalize(t);const{overrideFn:n,totalColumns:o,startPositions:i}=t;null!==this.startColumn&&"function"===typeof n&&n(this),this.startColumn<0&&(this.startColumn=0),this.startPosition=null!==(e=i[this.startColumn])&&void 0!==e?e:null,o<this.endColumn&&(this.endColumn=o-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}}function ti(t,e,n){return(e=ei(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ei(t){var e=ni(t,"string");return"symbol"==typeof e?e:e+""}function ni(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class oi{constructor(){ti(this,"count",0),ti(this,"startColumn",null),ti(this,"endColumn",null),ti(this,"startPosition",null),ti(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(t,e){const{totalCalculatedWidth:n,zeroBasedScrollOffset:o,viewportWidth:i,columnWidth:r}=e,s=o>0?i+1:i;n>=o&&n+r<=o+s&&(null!==this.startColumn&&void 0!==this.startColumn||(this.startColumn=t),this.endColumn=t)}finalize(t){var e;const{scrollOffset:n,viewportWidth:o,inlineStartOffset:i,zeroBasedScrollOffset:r,totalColumns:s,needReverse:a,startPositions:l,columnWidth:c}=t;if(this.endColumn===s-1&&a){this.startColumn=this.endColumn;while(this.startColumn>0){const t=l[this.endColumn]+c-l[this.startColumn-1];if(t<=o&&(this.startColumn-=1),t>=o)break}}this.startPosition=null!==(e=l[this.startColumn])&&void 0!==e?e:null;const h=r>0?o+1:o,u=n+o-h,d=null===this.startColumn?0:t.getColumnWidth(this.startColumn);u<-1*i||n>l.at(-1)||-1*n-o>-1*d?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endColumn&&(this.endColumn=s-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}}var ii=n("eb36");class ri{constructor(t,e,n,o,i){this.dataAccessObject=t,this.wot=t.wot,this.instance=this.wot,this.domBindings=e,this.wtSettings=n,this.wtTable=i,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new ko:new Vo],["fullyVisible",()=>new zo],["partiallyVisible",()=>new Fo]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new $o:new Zo],["fullyVisible",()=>new oi],["partiallyVisible",()=>new Jo]]),this.eventManager=o,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const t=this.domBindings.rootDocument,e=this.dataAccessObject.topOverlayTrimmingContainer;let n=0;if(e===this.domBindings.rootWindow)n=t.documentElement.clientHeight;else{const t=Object(o["outerHeight"])(e);n=t>0&&e.clientHeight>0?e.clientHeight:1/0}return n}getWorkspaceWidth(){const{wtSettings:t}=this,{rootDocument:e,rootWindow:n}=this.domBindings,i=this.dataAccessObject.inlineStartOverlayTrimmingContainer,r=e.documentElement.offsetWidth,s=t.getSetting("totalColumns"),a=t.getSetting("preventOverflow"),l=t.getSetting("rtlMode"),c=this.wtTable.TABLE.getBoundingClientRect(),h=l?c.right-r:c.left,u=r-h;let d,f;if(a)return Object(o["outerWidth"])(this.wtTable.wtRootElement);if(d=t.getSetting("freezeOverlays")?Math.min(u,r):Math.min(this.getContainerFillWidth(),u,r),i===n&&s>0&&this.sumColumnWidths(0,s-1)>d)return e.documentElement.clientWidth;if(i!==n&&(f=Object(o["getStyle"])(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",n),"scroll"===f||"hidden"===f||"auto"===f))return Math.max(d,i.clientWidth);const g=t.getSetting("stretchH");return"none"!==g&&g?d:Math.max(d,Object(o["outerWidth"])(this.wtTable.TABLE))}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}sumColumnWidths(t,e){let n=0,o=t;while(o<e)n+=this.wtTable.getColumnWidth(o),o+=1;return n}getContainerFillWidth(){if(this.containerWidth)return this.containerWidth;const t=this.wtTable.holder,e=this.domBindings.rootDocument.createElement("div");e.style.width="100%",e.style.height="1px",t.appendChild(e);const n=e.offsetWidth;return this.containerWidth=n,t.removeChild(e),n}getWorkspaceOffset(){return Object(o["offset"])(this.wtTable.TABLE)}getColumnHeaderHeight(){const t=this.wtSettings.getSetting("columnHeaders");return t.length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=Object(o["outerHeight"])(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getViewportHeight(){let t=this.getWorkspaceHeight();if(t===1/0)return t;const e=this.getColumnHeaderHeight();return e>0&&(t-=e),t}getRowHeaderWidth(){const t=this.wtSettings.getSetting("rowHeaderWidth"),e=this.wtSettings.getSetting("rowHeaders");if(t){this.rowHeaderWidth=0;for(let n=0,o=e.length;n<o;n++)this.rowHeaderWidth+=t[n]||t}if(isNaN(this.rowHeaderWidth))if(e.length){let t=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let n=0,i=e.length;n<i;n++)t?(this.rowHeaderWidth+=Object(o["outerWidth"])(t),t=t.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}getViewportWidth(){const t=this.getWorkspaceWidth();if(t===1/0)return t;const e=this.getRowHeaderWidth();return e>0?t-e:t}createRowsCalculator(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:e,wtTable:n}=this;let i,r,s=this.getViewportHeight();this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=e.getSetting("fixedRowsTop"),c=e.getSetting("fixedRowsBottom"),h=e.getSetting("totalRows");return l&&a>=0&&(r=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=r,s-=r),c&&this.dataAccessObject.bottomOverlay.clone&&(r=this.dataAccessObject.bottomOverlay.sumCellSizes(h-c,h),s-=r),i=n.holder.clientHeight===n.holder.offsetHeight?0:Object(o["getScrollbarWidth"])(this.domBindings.rootDocument),new ii["b"]({calculationTypes:t.map(t=>[t,this.rowsCalculatorTypes.get(t)()]),viewportHeight:s,scrollOffset:a,totalRows:e.getSetting("totalRows"),rowHeightFn:t=>n.getRowHeight(t),overrideFn:e.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:i})}createColumnsCalculator(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:e,wtTable:n}=this;let i=this.getViewportWidth(),r=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const s=e.getSetting("fixedColumnsStart");if(s&&r>=0){const t=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);r+=t,i-=t}return n.holder.clientWidth!==n.holder.offsetWidth&&(i-=Object(o["getScrollbarWidth"])(this.domBindings.rootDocument)),new we["b"]({calculationTypes:t.map(t=>[t,this.columnsCalculatorTypes.get(t)()]),viewportWidth:i,scrollOffset:r,totalColumns:e.getSetting("totalColumns"),columnWidthFn:t=>n.getColumnWidth(t),overrideFn:e.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{wtSettings:e}=this,n=this.createRowsCalculator(),o=this.createColumnsCalculator();if(t&&!e.getSetting("renderAllRows")){const e=n.getResultsFor("fullyVisible");t=this.areAllProposedVisibleRowsAlreadyRendered(e)}if(t&&!e.getSetting("renderAllColumns")){const e=o.getResultsFor("fullyVisible");t=this.areAllProposedVisibleColumnsAlreadyRendered(e)}return t||(this.rowsRenderCalculator=n.getResultsFor("rendered"),this.columnsRenderCalculator=o.getResultsFor("rendered")),this.rowsVisibleCalculator=n.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=o.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=o.getResultsFor("partiallyVisible"),t}createVisibleCalculators(){const t=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),e=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=t.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=e.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=t.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(t){if(!this.rowsVisibleCalculator)return!1;let{startRow:e,endRow:n}=t;if(null===e&&null===n){if(!t.isVisibleInTrimmingContainer)return!0;e=this.rowsPartiallyVisibleCalculator.startRow,n=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:o,endRow:i}=this.rowsRenderCalculator;return!(e<o||e===o&&e>0)&&!(n>i||n===i&&n<this.wtSettings.getSetting("totalRows")-1)}areAllProposedVisibleColumnsAlreadyRendered(t){if(!this.columnsVisibleCalculator)return!1;let{startColumn:e,endColumn:n}=t;if(null===e&&null===n){if(!t.isVisibleInTrimmingContainer)return!0;e=this.columnsPartiallyVisibleCalculator.startColumn,n=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:o,endColumn:i}=this.columnsRenderCalculator;return!(e<o||e===o&&e>0)&&!(n>i||n===i&&n<this.wtSettings.getSetting("totalColumns")-1)}resetHasOversizedColumnHeadersMarked(){Object(O["objectEach"])(this.hasOversizedColumnHeadersMarked,(t,e,n)=>{n[e]=void 0})}}var si=ri;n("24b9");function ai(t,e){ci(t,e),e.add(t)}function li(t,e,n){ci(t,e),e.set(t,n)}function ci(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hi(t,e){return t.get(di(t,e))}function ui(t,e,n){return t.set(di(t,e),n),n}function di(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var fi=new WeakMap,gi=new WeakMap,pi=new WeakSet;class mi{constructor(){ai(this,pi),li(this,fi,void 0),li(this,gi,void 0)}setActiveOverlay(t){return ui(gi,this,t),this}setActiveSelection(t){return ui(fi,this,t),this}scan(){const t=hi(fi,this).settings.selectionType,e=new Set;return"active-header"===t?(this.scanColumnsInHeadersRange(t=>e.add(t)),this.scanRowsInHeadersRange(t=>e.add(t))):"area"===t?this.scanCellsRange(t=>e.add(t)):"focus"===t?(this.scanColumnsInHeadersRange(t=>e.add(t)),this.scanRowsInHeadersRange(t=>e.add(t)),this.scanCellsRange(t=>e.add(t))):"fill"===t?this.scanCellsRange(t=>e.add(t)):"header"===t?(this.scanColumnsInHeadersRange(t=>e.add(t)),this.scanRowsInHeadersRange(t=>e.add(t))):"row"===t?(this.scanRowsInHeadersRange(t=>e.add(t)),this.scanRowsInCellsRange(t=>e.add(t))):"column"===t&&(this.scanColumnsInHeadersRange(t=>e.add(t)),this.scanColumnsInCellsRange(t=>e.add(t))),e}scanColumnsInHeadersRange(t){const[e,n,o,i]=hi(fi,this).getCorners(),{wtTable:r}=hi(gi,this),s=r.getRenderedColumnsCount(),a=r.getColumnHeadersCount();let l=0;for(let c=-r.getRowHeadersCount();c<s;c++){const s=r.columnFilter.renderedToSource(c);if(!(s<n||s>i)){for(let c=-a;c<0;c++){if(c<e||c>o)continue;const h=c+a;let u=r.getColumnHeader(s,h);const d=hi(gi,this).getSetting("onBeforeHighlightingColumnHeader",s,h,{selectionType:hi(fi,this).settings.selectionType,columnCursor:l,selectionWidth:i-n+1});null!==d&&(d!==s&&(u=r.getColumnHeader(d,h)),t(u))}l+=1}}}scanRowsInHeadersRange(t){const[e,n,o,i]=hi(fi,this).getCorners(),{wtTable:r}=hi(gi,this),s=r.getRenderedRowsCount(),a=r.getRowHeadersCount();let l=0;for(let c=-r.getColumnHeadersCount();c<s;c++){const s=r.rowFilter.renderedToSource(c);if(!(s<e||s>o)){for(let c=-a;c<0;c++){if(c<n||c>i)continue;const h=c+a;let u=r.getRowHeader(s,h);const d=hi(gi,this).getSetting("onBeforeHighlightingRowHeader",s,h,{selectionType:hi(fi,this).settings.selectionType,rowCursor:l,selectionHeight:o-e+1});null!==d&&(d!==s&&(u=r.getRowHeader(d,h)),t(u))}l+=1}}}scanCellsRange(t){const[e,n,i,r]=hi(fi,this).getCorners(),{wtTable:s}=hi(gi,this);di(pi,this,bi).call(this,(a,l)=>{if(a>=e&&a<=i&&l>=n&&l<=r){const e=s.getCell(hi(gi,this).createCellCoords(a,l)),n=hi(gi,this).getSetting("onAfterDrawSelection",a,l,hi(fi,this).settings.layerLevel);"string"===typeof n&&Object(o["addClass"])(e,n),t(e)}})}scanRowsInCellsRange(t){const[e,,n]=hi(fi,this).getCorners(),{wtTable:o}=hi(gi,this);di(pi,this,bi).call(this,(i,r)=>{if(i>=e&&i<=n){const e=o.getCell(hi(gi,this).createCellCoords(i,r));t(e)}})}scanColumnsInCellsRange(t){const[,e,,n]=hi(fi,this).getCorners(),{wtTable:o}=hi(gi,this);di(pi,this,bi).call(this,(i,r)=>{if(r>=e&&r<=n){const e=o.getCell(hi(gi,this).createCellCoords(i,r));t(e)}})}}function bi(t){const{wtTable:e}=hi(gi,this),n=e.getRenderedRowsCount(),o=e.getRenderedColumnsCount();for(let i=0;i<n;i+=1){const n=e.rowFilter.renderedToSource(i);for(let i=0;i<o;i+=1)t(n,e.columnFilter.renderedToSource(i))}}class wi{constructor(t,e){e&&(this.eventManager=t.eventManager,this.instance=t,this.wot=t,this.settings=e,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=jn,this.cornerCenterPointOffset=-parseInt(this.cornerDefaultStyle.width,10)/2,this.corner=null,this.cornerStyle=null,this.createBorders(e),this.registerListeners())}registerListeners(){const t=this.wot.rootDocument.body;this.eventManager.addEventListener(t,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(t,"mouseup",()=>this.onMouseUp());for(let e=0,n=this.main.childNodes.length;e<n;e++){const t=this.main.childNodes[e];this.eventManager.addEventListener(t,"mouseenter",t=>this.onMouseEnter(t,this.main.childNodes[e]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(t,e){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;t.preventDefault(),Object(l["stopImmediatePropagation"])(t);const n=this,o=this.wot.rootDocument.body,i=e.getBoundingClientRect();function r(t){return t.clientY<Math.floor(i.top)||(t.clientY>Math.ceil(i.top+i.height)||(t.clientX<Math.floor(i.left)||(t.clientX>Math.ceil(i.left+i.width)||void 0)))}function s(t){r(t)&&(n.eventManager.removeEventListener(o,"mousemove",s),e.style.display="block")}e.style.display="none",this.eventManager.addEventListener(o,"mousemove",s)}createBorders(t){const{rootDocument:e}=this.wot;this.main=e.createElement("div");const n=["top","start","bottom","end","corner"];let o=this.main.style;o.position="absolute",o.top=0,o.left=0;for(let s=0;s<5;s++){const i=n[s],r=e.createElement("div");r.className="wtBorder "+(this.settings.className||""),this.settings[i]&&this.settings[i].hide&&(r.className+=" hidden"),o=r.style,o.backgroundColor=this.settings[i]&&this.settings[i].color?this.settings[i].color:t.border.color,o.height=this.settings[i]&&this.settings[i].width?this.settings[i].width+"px":t.border.width+"px",o.width=this.settings[i]&&this.settings[i].width?this.settings[i].width+"px":t.border.width+"px",this.main.appendChild(r)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Object(s["isMobileBrowser"])()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:i}=this.wot;let r=i.bordersHolder;r||(r=e.createElement("div"),r.className="htBorders",i.bordersHolder=r,i.spreader.appendChild(r)),r.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:t}=this.wot;this.selectionHandles={top:t.createElement("DIV"),topHitArea:t.createElement("DIV"),bottom:t.createElement("DIV"),bottomHitArea:t.createElement("DIV")};const e=10,n=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const o={position:"absolute",height:n+"px",width:n+"px","border-radius":parseInt(n/1.5,10)+"px"};Object(O["objectEach"])(o,(t,e)=>{this.selectionHandles.styles.bottomHitArea[e]=t,this.selectionHandles.styles.topHitArea[e]=t});const i={position:"absolute",height:e+"px",width:e+"px","border-radius":parseInt(e/1.5,10)+"px",background:"#F5F5FF",border:"1px solid #4285c8"};Object(O["objectEach"])(i,(t,e)=>{this.selectionHandles.styles.bottom[e]=t,this.selectionHandles.styles.top[e]=t}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(t,e){const n=this.wot.selectionManager.getAreaSelection();return!(!n.cellRange||t===n.cellRange.to.row&&e===n.cellRange.to.col)}updateMultipleSelectionHandlesPosition(t,e,n,o,i,r){const s=this.wot.wtSettings.getSetting("rtlMode"),a=s?"right":"left",{top:l,topHitArea:c,bottom:h,bottomHitArea:u}=this.selectionHandles.styles,d=parseInt(l.borderWidth,10),f=parseInt(l.width,10),g=parseInt(c.width,10),p=this.wot.wtTable.getWidth(),m=this.wot.wtTable.getHeight();l.top=parseInt(n-f-1,10)+"px",l[a]=parseInt(o-f-1,10)+"px",c.top=parseInt(n-g/4*3,10)+"px",c[a]=parseInt(o-g/4*3,10)+"px";const b=Math.min(parseInt(o+i,10),p-f-2*d),w=Math.min(parseInt(o+i-g/4,10),p-g-2*d);h[a]=b+"px",u[a]=w+"px";const v=Math.min(parseInt(n+r,10),m-f-2*d),y=Math.min(parseInt(n+r-g/4,10),m-g-2*d);h.top=v+"px",u.top=y+"px",this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(l.display="block",c.display="block",this.isPartRange(t,e)?(h.display="none",u.display="none"):(h.display="block",u.display="block")):(l.display="none",h.display="none",c.display="none",u.display="none"),t===this.wot.wtSettings.getSetting("fixedRowsTop")||e===this.wot.wtSettings.getSetting("fixedColumnsStart")?(l.zIndex="9999",c.zIndex="9999"):(l.zIndex="",c.zIndex="")}appear(t){if(this.disabled)return;const{wtTable:e,rootDocument:n,rootWindow:i}=this.wot;let r,a,l,c,h,u;const d=e.getRenderedRowsCount();for(let o=0;o<d;o+=1){const n=e.rowFilter.renderedToSource(o);if(n>=t[0]&&n<=t[2]){r=n,h=t[0];break}}for(let o=d-1;o>=0;o-=1){const n=e.rowFilter.renderedToSource(o);if(n>=t[0]&&n<=t[2]){a=n;break}}const f=e.getRenderedColumnsCount();for(let o=0;o<f;o+=1){const n=e.columnFilter.renderedToSource(o);if(n>=t[1]&&n<=t[3]){l=n,u=t[1];break}}for(let o=f-1;o>=0;o-=1){const n=e.columnFilter.renderedToSource(o);if(n>=t[1]&&n<=t[3]){c=n;break}}if(void 0===r||void 0===l)return void this.disappear();let g=e.getCell(this.wot.createCellCoords(r,l));const p=r!==a||l!==c,m=p?e.getCell(this.wot.createCellCoords(a,c)):g,b=Object(o["offset"])(g),w=p?Object(o["offset"])(m):b,v=Object(o["offset"])(e.TABLE),y=Object(o["outerWidth"])(e.TABLE),C=b.top,S=b.left,O=this.wot.wtSettings.getSetting("rtlMode");let E=0,R=0;if(O){const t=Object(o["outerWidth"])(g),e=i.innerWidth-v.left-y;R=S+t-w.left,E=i.innerWidth-S-t-e-1}else R=w.left+Object(o["outerWidth"])(m)-S,E=S-v.left-1;if(this.isEntireColumnSelected(r,a)){const t=this.getDimensionsFromHeader("columns",l,c,h,v);let e=null;t&&([e,E,R]=t),e&&(g=e)}let T=C-v.top-1,M=w.top+Object(o["outerHeight"])(m)-C;if(this.isEntireRowSelected(l,c)){const t=this.getDimensionsFromHeader("rows",r,a,u,v);let e=null;t&&([e,T,M]=t),e&&(g=e)}const I=Object(o["getComputedStyle"])(g,i);parseInt(I.borderTopWidth,10)>0&&(T+=1,M=M>0?M-1:0),parseInt(I[O?"borderRightWidth":"borderLeftWidth"],10)>0&&(E+=1,R=R>0?R-1:0);const x=O?"right":"left";this.topStyle.top=T+"px",this.topStyle[x]=E+"px",this.topStyle.width=R+"px",this.topStyle.display="block",this.startStyle.top=T+"px",this.startStyle[x]=E+"px",this.startStyle.height=M+"px",this.startStyle.display="block";const N=Math.floor(this.settings.border.width/2);this.bottomStyle.top=T+M-N+"px",this.bottomStyle[x]=E+"px",this.bottomStyle.width=R+"px",this.bottomStyle.display="block",this.endStyle.top=T+"px",this.endStyle[x]=E+R-N+"px",this.endStyle.height=M+1+"px",this.endStyle.display="block";let A=this.settings.border.cornerVisible;A="function"===typeof A?A(this.settings.layerLevel):A;const H=this.wot.getSetting("onModifyGetCellCoords",a,c);let[j,_]=[a,c];if(H&&Array.isArray(H)&&([,,j,_]=H),Object(s["isMobileBrowser"])()||!A||this.isPartRange(j,_))this.cornerStyle.display="none";else{this.cornerStyle.top=T+M+this.cornerCenterPointOffset-1+"px",this.cornerStyle[x]=E+R+this.cornerCenterPointOffset-1+"px",this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let t=Object(o["getTrimmingContainer"])(e.TABLE);const r=t===i;r&&(t=n.documentElement);const s=parseInt(this.cornerDefaultStyle.width,10)/2,l=parseInt(this.cornerDefaultStyle.height,10)/2;if(c===this.wot.getSetting("totalColumns")-1){const e=r?m.getBoundingClientRect().left:m.offsetLeft;let n=!1,i=0;O?(i=e-parseInt(this.cornerDefaultStyle.width,10)/2,n=i<0):(i=e+Object(o["outerWidth"])(m)+parseInt(this.cornerDefaultStyle.width,10)/2,n=i>=Object(o["innerWidth"])(t)),n&&(this.cornerStyle[x]=Math.floor(E+R+this.cornerCenterPointOffset-s)+"px",this.cornerStyle[O?"borderLeftWidth":"borderRightWidth"]=0)}if(a===this.wot.getSetting("totalRows")-1){const e=r?m.getBoundingClientRect().top:m.offsetTop,n=e+Object(o["outerHeight"])(m)+parseInt(this.cornerDefaultStyle.height,10)/2,i=n>=Object(o["innerHeight"])(t);i&&(this.cornerStyle.top=Math.floor(T+M+this.cornerCenterPointOffset-l)+"px",this.cornerStyle.borderBottomWidth=0)}this.cornerStyle.display="block"}Object(s["isMobileBrowser"])()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(a,c,T,E,R,M)}isEntireColumnSelected(t,e){return t===this.wot.wtTable.getFirstRenderedRow()&&e===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(t,e){return t===this.wot.wtTable.getFirstRenderedColumn()&&e===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(t,e,n,i,r){const{wtTable:s}=this.wot,a=s.wtRootElement.parentNode;let l=null,c=null,h=null,u=null,d=null,f=null,g=null,p=null;switch(t){case"rows":l=function(){return s.getRowHeader(...arguments)},c=function(){return Object(o["outerHeight"])(...arguments)},h="ht__selection--rows",f="top";break;case"columns":l=function(){return s.getColumnHeader(...arguments)},c=function(){return Object(o["outerWidth"])(...arguments)},h="ht__selection--columns",f="left";break;default:}if(a.classList.contains(h)){const t=this.wot.getSetting("columnHeaders").length;if(g=l(e,t-i),p=l(n,t-i),!g||!p)return!1;const s=Object(o["offset"])(g),a=Object(o["offset"])(p);return g&&p&&(u=s[f]-r[f]-1,d=a[f]+c(p)-s[f]),[g,u,d]}return!1}changeBorderStyle(t,e){const n=this[t].style,i=e[t];!i||i.hide?Object(o["addClass"])(this[t],"hidden"):(Object(o["hasClass"])(this[t],"hidden")&&Object(o["removeClass"])(this[t],"hidden"),n.backgroundColor=i.color,"top"!==t&&"bottom"!==t||(n.height=i.width+"px"),"start"!==t&&"end"!==t||(n.width=i.width+"px"))}changeBorderToDefaultStyle(t){const e={width:1,color:"#000"},n=this[t].style;n.backgroundColor=e.color,n.width=e.width+"px",n.height=e.width+"px"}toggleHiddenClass(t,e){this.changeBorderToDefaultStyle(t),e?Object(o["addClass"])(this[t],"hidden"):Object(o["removeClass"])(this[t],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Object(s["isMobileBrowser"])()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}var vi=wi;function yi(t,e){Si(t,e),e.add(t)}function Ci(t,e,n){Si(t,e),e.set(t,n)}function Si(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Oi(t,e){return t.get(Ri(t,e))}function Ei(t,e,n){return t.set(Ri(t,e),n),n}function Ri(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ti=new WeakMap,Mi=new WeakMap,Ii=new WeakMap,xi=new WeakMap,Ni=new WeakMap,Ai=new WeakMap,Hi=new WeakSet;class ji{constructor(t){yi(this,Hi),Ci(this,Ti,void 0),Ci(this,Mi,void 0),Ci(this,Ii,new mi),Ci(this,xi,new WeakMap),Ci(this,Ni,new WeakSet),Ci(this,Ai,new Map),Ei(Mi,this,t)}setActiveOverlay(t){return Ei(Ti,this,t),Oi(Ii,this).setActiveOverlay(Oi(Ti,this)),Oi(xi,this).has(Oi(Ti,this))||Oi(xi,this).set(Oi(Ti,this),new Set),this}getFocusSelection(){return null!==Oi(Mi,this)?Oi(Mi,this).getFocus():null}getAreaSelection(){return null!==Oi(Mi,this)?Oi(Mi,this).createLayeredArea():null}getBorderInstance(t){if(!t.settings.border)return null;if(Oi(Ai,this).has(t)){const e=Oi(Ai,this).get(t);if(e.has(Oi(Ti,this)))return e.get(Oi(Ti,this));const n=new vi(Oi(Ti,this),t.settings);return e.set(Oi(Ti,this),n),n}const e=new vi(Oi(Ti,this),t.settings);return Oi(Ai,this).set(t,new Map([[Oi(Ti,this),e]])),e}getBorderInstances(t){var e,n;return Array.from(null!==(e=null===(n=Oi(Ai,this).get(t))||void 0===n?void 0:n.values())&&void 0!==e?e:[])}destroyBorders(t){Oi(Ai,this).get(t).forEach(t=>t.destroy()),Oi(Ai,this).delete(t)}render(t){if(null===Oi(Mi,this))return;t&&Ri(Hi,this,_i).call(this);const e=Array.from(Oi(Mi,this)),n=new Map,i=new Map;for(let o=0;o<e.length;o++){const t=e[o],{className:r,headerAttributes:s,createLayers:a,selectionType:l}=t.settings;Oi(Ni,this).has(t)||(Oi(Ni,this).add(t),t.addLocalHook("destroy",()=>this.destroyBorders(t)));const c=this.getBorderInstance(t);if(t.isEmpty()){null===c||void 0===c||c.disappear();continue}if(r){const e=Oi(Ii,this).setActiveSelection(t).scan();e.forEach(t=>{if(n.has(t)){const e=n.get(t);e.has(r)&&!0===a?e.set(r,e.get(r)+1):e.set(r,1)}else n.set(t,new Map([[r,1]]));s&&(i.has(t)||i.set(t,[]),"TH"===t.nodeName&&i.get(t).push(...s))})}const h=t.getCorners();Oi(Ti,this).getSetting("onBeforeDrawBorders",h,l),null===c||void 0===c||c.appear(h)}n.forEach((t,e)=>{var n;const i=Array.from(t).map(t=>{let[e,n]=t;return 1===n?e:[e,...Array.from({length:n-1},(t,n)=>`${e}-${n+1}`)]}).flat();i.forEach(t=>Oi(xi,this).get(Oi(Ti,this)).add(t)),Object(o["addClass"])(e,i),"TD"===e.nodeName&&Array.isArray(null===(n=Oi(Mi,this).options)||void 0===n?void 0:n.cellAttributes)&&Object(o["setAttribute"])(e,Oi(Mi,this).options.cellAttributes)}),Array.from(i.keys()).forEach(t=>{Object(o["setAttribute"])(t,[...i.get(t)])})}}function _i(){const t=Oi(xi,this).get(Oi(Ti,this)),e=Oi(Ti,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let n=0;n<e.length;n++)t.add(e[n]);t.forEach(t=>{var e,n;const i=Oi(Ti,this).wtTable.TABLE.querySelectorAll("."+t);let r=[];Array.isArray(null===(e=Oi(Mi,this).options)||void 0===e?void 0:e.cellAttributes)&&(r=Oi(Mi,this).options.cellAttributes.map(t=>t[0])),Array.isArray(null===(n=Oi(Mi,this).options)||void 0===n?void 0:n.headerAttributes)&&(r=[...r,...Oi(Mi,this).options.headerAttributes.map(t=>t[0])]);for(let s=0,a=i.length;s<a;s++)Object(o["removeClass"])(i[s],t),Object(o["removeAttribute"])(i[s],r)}),t.clear()}class ki extends En{constructor(t,e){super(t,new xo(e));const n=this.wtSettings.getSetting("facade",this);this.wtTable=new Ao(this.getTableDao(),n,this.domBindings,this.wtSettings),this.wtViewport=new si(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new ji(this.wtSettings.getSetting("selections")),this.wtEvent=new ft(n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new Ro(this,n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const t={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},e=[],n=[];Object(O["objectEach"])(t,(t,o)=>{this.wtSettings.getSetting(o).length&&n.push(t),e.push(t)}),Object(o["removeClass"])(this.wtTable.wtRootElement.parentNode,e),Object(o["addClass"])(this.wtTable.wtRootElement.parentNode,n)}getOverlayByName(t){var e;if(!Ye.includes(t))return null;const n=t.replace(/_([a-z])/g,t=>t[1].toUpperCase());return null!==(e=this.wtOverlays[n+"Overlay"])&&void 0!==e?e:null}getViewportDao(){const t=this;return{get wot(){return t},get topOverlayTrimmingContainer(){return t.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return t.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return t.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return t.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return t.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return t.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return t.wtOverlays.topOverlay},get inlineStartOverlay(){return t.wtOverlays.inlineStartOverlay},get bottomOverlay(){return t.wtOverlays.bottomOverlay}}}}class Pi{constructor(t){t instanceof En?this._wot=t:this._initFromSettings(t)}_initFromSettings(t){t.facade=t=>{const e=new Pi(t);return()=>e},this._wot=new ki(t.table,t)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(t){this._wot.drawn=t}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(t){this._wot.drawInterrupted=t}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(t){this._wot.lastMouseOver=t}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(t){this._wot.momentumScrolling=t}get touchApplied(){return this._wot.touchApplied}set touchApplied(t){this._wot.touchApplied=t}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(t){this._wot.eventListeners=t}get eventManager(){return this._wot.eventManager}createCellCoords(t,e){return this._wot.createCellCoords(t,e)}createCellRange(t,e,n){return this._wot.createCellRange(t,e,n)}draw(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._wot.draw(t),this}getCell(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._wot.getCell(t,e)}scrollViewport(t,e,n,o,i){return this._wot.scrollViewport(t,e,n,o,i)}scrollViewportHorizontally(t,e,n){return this._wot.scrollViewportHorizontally(t,e,n)}scrollViewportVertically(t,e,n){return this._wot.scrollViewportVertically(t,e,n)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(t){return this._wot.getOverlayByName(t)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(t,e){return this._wot.wtSettings.update(t,e),this}getSetting(t,e,n,o,i){return this._wot.wtSettings.getSetting(t,e,n,o,i)}hasSetting(t){return this._wot.wtSettings.hasSetting(t)}destroy(){this._wot.destroy()}}function Di(t){let{isShiftKey:e,isLeftClick:n,isRightClick:o,coords:i,selection:r,controller:s,cellCoordsFactory:a}=t;const l=r.isSelected()?r.getSelectedRange().current():null,c=r.isSelectedByCorner(),h=r.isSelectedByRowHeader();if(r.markSource("mouse"),e&&l)i.row>=0&&i.col>=0&&!s.cell?r.setRangeEnd(i):(c||h)&&i.row>=0&&i.col>=0&&!s.cell?r.setRangeEnd(a(i.row,i.col)):c&&i.row<0&&!s.column?r.setRangeEnd(a(l.to.row,i.col)):h&&i.col<0&&!s.row?r.setRangeEnd(a(i.row,l.to.col)):(!c&&!h&&i.col<0||c&&i.col<0)&&!s.row?r.selectRows(Math.max(l.from.row,0),i.row,i.col):(!c&&!h&&i.row<0||h&&i.row<0)&&!s.column&&r.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const t=!r.inInSelection(i),e=n||o&&t;i.row<0&&i.col>=0&&!s.column?e&&r.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!s.row?e&&r.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!s.cell?e&&r.setRangeStart(i):i.col<0&&i.row<0&&r.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}r.markEndSource()}function Li(t){let{isLeftClick:e,coords:n,selection:o,controller:i,cellCoordsFactory:r}=t;if(!e)return;const s=o.isSelectedByRowHeader(),a=o.isSelectedByColumnHeader(),l=o.tableProps.countCols(),c=o.tableProps.countRows();o.markSource("mouse"),a&&!i.column?o.setRangeEnd(r(c-1,n.col)):s&&!i.row?o.setRangeEnd(r(n.row,l-1)):i.cell||o.setRangeEnd(n),o.markEndSource()}const Fi=new Map([["mousedown",Di],["mouseover",Li],["touchstart",Di]]);function Vi(t,e){let{coords:n,selection:o,controller:i,cellCoordsFactory:r}=e;Fi.get(t.type)({coords:n,selection:o,controller:i,cellCoordsFactory:r,isShiftKey:t.shiftKey,isLeftClick:Object(l["isLeftClick"])(t)||"touchstart"===t.type,isRightClick:Object(l["isRightClick"])(t)})}const Wi=new WeakMap,Bi=Symbol("rootInstance");function Ui(t){Wi.set(t,!0)}function zi(t){return t===Bi}function Gi(t){return Wi.has(t)}function Yi(t,e){$i(t,e),e.add(t)}function Xi(t,e,n){$i(t,e),e.set(t,n)}function $i(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ki(t,e,n){return(e=qi(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qi(t){var e=Qi(t,"string");return"symbol"==typeof e?e:e+""}function Qi(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Ji(t,e){return t.get(tr(t,e))}function Zi(t,e,n){return t.set(tr(t,e),n),n}function tr(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var er=new WeakMap,nr=new WeakMap,or=new WeakMap,ir=new WeakMap,rr=new WeakMap,sr=new WeakMap,ar=new WeakMap,lr=new WeakSet;class cr{constructor(t){Yi(this,lr),Ki(this,"hot",void 0),Ki(this,"eventManager",void 0),Ki(this,"settings",void 0),Ki(this,"THEAD",void 0),Ki(this,"TBODY",void 0),Ki(this,"_wt",void 0),Ki(this,"activeWt",void 0),Xi(this,er,0),Xi(this,nr,0),Ki(this,"postponedAdjustElementsSize",!1),Xi(this,or,!1),Xi(this,ir,void 0),Xi(this,rr,void 0),Xi(this,sr,0),Xi(this,ar,0),this.hot=t,this.eventManager=new h["a"](this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.hot.forceFullRender),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(t,e){const n=this._wt.getCell(t,e);return n<0?null:n}scrollViewport(t,e,n,o,i){return this._wt.scrollViewport(t,e,n,o,i)}scrollViewportHorizontally(t,e,n){return this._wt.scrollViewportHorizontally(t,e,n)}scrollViewportVertically(t,e,n){return this._wt.scrollViewportVertically(t,e,n)}createElements(){const{rootElement:t,rootDocument:e}=this.hot,n=t.getAttribute("style");n&&t.setAttribute("data-originalstyle",n),Object(o["addClass"])(t,"handsontable"),Zi(rr,this,e.createElement("TABLE")),Object(o["addClass"])(Ji(rr,this),"htCore"),this.hot.getSettings().tableClassName&&Object(o["addClass"])(Ji(rr,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(Object(o["setAttribute"])(Ji(rr,this),[Object($t["y"])()]),Object(o["setAttribute"])(t,[Object($t["N"])(),Object($t["C"])(-1),Object($t["e"])(this.hot.countCols()),Object($t["v"])()])),this.THEAD=e.createElement("THEAD"),Ji(rr,this).appendChild(this.THEAD),this.TBODY=e.createElement("TBODY"),Ji(rr,this).appendChild(this.TBODY),this.hot.table=Ji(rr,this),this.hot.container.insertBefore(Ji(rr,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:t,rootDocument:e,selection:n,rootWindow:i}=this.hot,r=e.documentElement;this.eventManager.addEventListener(t,"mousedown",t=>{Zi(or,this,!0),this.isTextSelectionAllowed(t.target)||(Object(o["clearTextSelection"])(i),t.preventDefault(),i.focus())}),this.eventManager.addEventListener(t,"mouseup",()=>{Zi(or,this,!1)}),this.eventManager.addEventListener(t,"mousemove",t=>{Ji(or,this)&&!this.isTextSelectionAllowed(t.target)&&(this.settings.fragmentSelection&&Object(o["clearTextSelection"])(i),t.preventDefault())}),this.eventManager.addEventListener(r,"keyup",t=>{n.isInProgress()&&!t.shiftKey&&n.finish()}),this.eventManager.addEventListener(r,"mouseup",i=>{n.isInProgress()&&Object(l["isLeftClick"])(i)&&n.finish(),Zi(ir,this,!1);const r=Object(o["isOutsideInput"])(e.activeElement);Object(o["isInput"])(e.activeElement)&&!r||!r&&(n.isSelected()||n.isSelectedByAnyHeader()||t.contains(i.target)||Object(l["isRightClick"])(i))||this.hot.unlisten()}),this.eventManager.addEventListener(r,"contextmenu",t=>{n.isInProgress()&&Object(l["isRightClick"])(t)&&(n.finish(),Zi(ir,this,!1))}),this.eventManager.addEventListener(r,"touchend",()=>{n.isInProgress()&&n.finish(),Zi(ir,this,!1)}),this.eventManager.addEventListener(r,"mousedown",n=>{const i=n.target,s=n.x||n.clientX,a=n.y||n.clientY;let l=n.target;if(Ji(ir,this)||!t||!this.hot.view)return;const{holder:c}=this._wt.wtTable;if(l===c){const t=Object(o["getScrollbarWidth"])(e);if(e.elementFromPoint(s+t,a)!==c||e.elementFromPoint(s,a+t)!==c)return}else while(l!==r){if(null===l){if(n.isTargetWebComponent)break;return}if(l===t)return;l=l.parentNode}const h="function"===typeof this.settings.outsideClickDeselects?this.settings.outsideClickDeselects(i):this.settings.outsideClickDeselects;h?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let s=Object(o["getParentWindow"])(i);while(null!==s)this.eventManager.addEventListener(s.document.documentElement,"click",()=>{this.hot.unlisten()}),s=Object(o["getParentWindow"])(s);this.eventManager.addEventListener(Ji(rr,this),"selectstart",t=>{this.settings.fragmentSelection||Object(o["isInput"])(t.target)||t.preventDefault()})}translateFromRenderableToVisualCoords(t){let{row:e,col:n}=t;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(e,n))}translateFromRenderableToVisualIndex(t,e){let n=t>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(t):t,o=e>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(e):e;return null===n&&(n=t),null===o&&(o=e),[n,o]}countRenderableIndexes(t,e){const n=Math.min(t.getNotTrimmedIndexesLength(),e),o=t.getNearestNotHiddenIndex(n-1,-1);return null===o?0:t.getRenderableFromVisualIndex(o)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(t,e){return this.countNotHiddenIndexes(t,e,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(t,e){return this.countNotHiddenIndexes(t,e,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(t,e,n,o){if(isNaN(t)||t<0)return 0;const i=n.getNearestNotHiddenIndex(t,e),r=n.getRenderableFromVisualIndex(i);if(!Number.isInteger(r))return 0;let s=0;return e<0?s=r+1:e>0&&(s=o-r),s}countNotHiddenFixedColumnsStart(){const t=this.hot.countCols(),e=Math.min(parseInt(this.settings.fixedColumnsStart,10),t)-1;return this.countNotHiddenColumnIndexes(e,-1)}countNotHiddenFixedRowsTop(){const t=this.hot.countRows(),e=Math.min(parseInt(this.settings.fixedRowsTop,10),t)-1;return this.countNotHiddenRowIndexes(e,-1)}countNotHiddenFixedRowsBottom(){const t=this.hot.countRows(),e=Math.max(t-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(e,1)}countRenderableColumnsInRange(t,e){let n=0;for(let o=t;o<=e;o++)null!==this.hot.columnIndexMapper.getRenderableFromVisualIndex(o)&&(n+=1);return n}countRenderableRowsInRange(t,e){let n=0;for(let o=t;o<=e;o++)null!==this.hot.rowIndexMapper.getRenderableFromVisualIndex(o)&&(n+=1);return n}isMainTableNotFullyCoveredByOverlays(){const t=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),e=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>t&&this.hot.countRenderedCols()>e}initializeWalkontable(){const t={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:Ji(rr,this),isDataViewInstance:()=>Gi(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,stretchH:()=>this.settings.stretchH,data:(t,e)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(t,e)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||t.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||t.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const t=[];return this.hot.hasRowHeaders()&&t.push((t,e)=>{const n=t>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(t):t;this.appendRowHeader(n,e)}),this.hot.runHooks("afterGetRowHeaderRenderers",t),Zi(nr,this,t.length),this.hot.getSettings().ariaTags&&tr(lr,this,hr).call(this)===this.hot.countCols()&&tr(lr,this,ur).call(this,Ji(nr,this)),t},columnHeaders:()=>{const t=[];return this.hot.hasColHeaders()&&t.push((t,e)=>{const n=t>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(t):t;this.appendColHeader(n,e)}),this.hot.runHooks("afterGetColumnHeaderRenderers",t),Zi(er,this,t.length),t},columnWidth:t=>{const e=this.hot.columnIndexMapper.getVisualFromRenderableIndex(t);return this.hot.getColWidth(null===e?t:e)},rowHeight:t=>{const e=this.hot.rowIndexMapper.getVisualFromRenderableIndex(t);return this.hot.getRowHeight(null===e?t:e)},rowHeightByOverlayName:(t,e)=>{const n=this.hot.rowIndexMapper.getVisualFromRenderableIndex(t),o=null===n?t:n;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(o),o,e)},cellRenderer:(t,e,n)=>{const[o,i]=this.translateFromRenderableToVisualIndex(t,e),r=this.hot.runHooks("modifyGetCellCoords",o,i);let s=o,a=i;Array.isArray(r)&&([s,a]=r);const l=this.hot.getCellMeta(s,a),c=this.hot.colToProp(a);let h=this.hot.getDataAtRowProp(s,c);this.hot.hasHook("beforeValueRender")&&(h=this.hot.runHooks("beforeValueRender",h,l)),this.hot.runHooks("beforeRenderer",n,o,i,c,h,l),this.hot.getCellRenderer(l)(this.hot,n,o,i,c,h,l),this.hot.runHooks("afterRenderer",n,o,i,c,h,l)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&Object(o["isVisible"])(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(t,e,n,o)=>{const i=this.translateFromRenderableToVisualCoords(e),r={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=o,Zi(ir,this,!0),this.hot.runHooks("beforeOnCellMouseDown",t,i,n,r),Object(l["isImmediatePropagationStopped"])(t)||(Vi(t,{coords:i,selection:this.hot.selection,controller:r,cellCoordsFactory:(t,e)=>this.hot._createCellCoords(t,e)}),this.hot.runHooks("afterOnCellMouseDown",t,i,n),this.activeWt=this._wt)},onCellContextMenu:(t,e,n,o)=>{const i=this.translateFromRenderableToVisualCoords(e);this.activeWt=o,Zi(ir,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",t,i,n),Object(l["isImmediatePropagationStopped"])(t)||(this.hot.runHooks("afterOnCellContextMenu",t,i,n),this.activeWt=this._wt)},onCellMouseOut:(t,e,n,o)=>{const i=this.translateFromRenderableToVisualCoords(e);this.activeWt=o,this.hot.runHooks("beforeOnCellMouseOut",t,i,n),Object(l["isImmediatePropagationStopped"])(t)||(this.hot.runHooks("afterOnCellMouseOut",t,i,n),this.activeWt=this._wt)},onCellMouseOver:(t,e,n,o)=>{const i=this.translateFromRenderableToVisualCoords(e),r={row:!1,column:!1,cell:!1};this.activeWt=o,this.hot.runHooks("beforeOnCellMouseOver",t,i,n,r),Object(l["isImmediatePropagationStopped"])(t)||(Ji(ir,this)&&Vi(t,{coords:i,selection:this.hot.selection,controller:r,cellCoordsFactory:(t,e)=>this.hot._createCellCoords(t,e)}),this.hot.runHooks("afterOnCellMouseOver",t,i,n),this.activeWt=this._wt)},onCellMouseUp:(t,e,n,o)=>{const i=this.translateFromRenderableToVisualCoords(e);this.activeWt=o,this.hot.runHooks("beforeOnCellMouseUp",t,i,n),Object(l["isImmediatePropagationStopped"])(t)||this.hot.isDestroyed||(this.hot.runHooks("afterOnCellMouseUp",t,i,n),this.activeWt=this._wt)},onCellCornerMouseDown:t=>{t.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",t)},onCellCornerDblClick:t=>{t.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",t)},beforeDraw:(t,e)=>this.beforeRender(t,e),onDraw:t=>this.afterRender(t),onBeforeViewportScrollVertically:t=>{const e=this.hot.rowIndexMapper,n=t<0;let o=t;return n||(o=e.getVisualFromRenderableIndex(t),null!==o)?(o=this.hot.runHooks("beforeViewportScrollVertically",o),this.hot.runHooks("beforeViewportScroll"),n?o:e.getRenderableFromVisualIndex(o)):t},onBeforeViewportScrollHorizontally:t=>{const e=this.hot.columnIndexMapper,n=t<0;let o=t;return n||(o=e.getVisualFromRenderableIndex(t),null!==o)?(o=this.hot.runHooks("beforeViewportScrollHorizontally",o),this.hot.runHooks("beforeViewportScroll"),n?o:e.getRenderableFromVisualIndex(o)):t},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(t,e,n)=>{const o=this.hot.rowIndexMapper,i=t<0;let r=t;i||(r=o.getVisualFromRenderableIndex(t));const s=this.hot.runHooks("beforeHighlightingRowHeader",r,e,n);return i?s:o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(s,1))},onBeforeHighlightingColumnHeader:(t,e,n)=>{const o=this.hot.columnIndexMapper,i=t<0;let r=t;i||(r=o.getVisualFromRenderableIndex(t));const s=this.hot.runHooks("beforeHighlightingColumnHeader",r,e,n);return i?s:o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(s,1))},onAfterDrawSelection:(t,e,n)=>{let o;const[i,r]=this.translateFromRenderableToVisualIndex(t,e),s=this.hot.selection.getSelectedRange(),a=s.size();if(a>0){const t=s.peekByIndex(null!==n&&void 0!==n?n:0);o=[t.from.row,t.from.col,t.to.row,t.to.col]}return this.hot.runHooks("afterDrawSelection",i,r,o,n)},onBeforeDrawBorders:(t,e)=>{const[n,o,i,r]=t,s=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(n),this.hot.columnIndexMapper.getVisualFromRenderableIndex(o),this.hot.rowIndexMapper.getVisualFromRenderableIndex(i),this.hot.columnIndexMapper.getVisualFromRenderableIndex(r)];return this.hot.runHooks("beforeDrawBorders",s,e)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onBeforeStretchingColumnWidth:(t,e)=>{const n=this.hot.columnIndexMapper.getVisualFromRenderableIndex(e);return this.hot.runHooks("beforeStretchingColumnWidth",t,n)},onModifyRowHeaderWidth:t=>this.hot.runHooks("modifyRowHeaderWidth",t),onModifyGetCellCoords:(t,e,n)=>{const o=this.hot.rowIndexMapper,i=this.hot.columnIndexMapper,r=e>=0?i.getVisualFromRenderableIndex(e):e,s=t>=0?o.getVisualFromRenderableIndex(t):t,a=this.hot.runHooks("modifyGetCellCoords",s,r,n);if(Array.isArray(a)){const[t,e,n,r]=a;return[t>=0?o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(t,1)):t,e>=0?i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(e,1)):e,n>=0?o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(n,-1)):n,r>=0?i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(r,-1)):r]}},viewportRowCalculatorOverride:t=>{let e=this.settings.viewportRowRenderingOffset;if("auto"===e&&this.settings.fixedRowsTop&&(e=10),e>0||"auto"===e){const n=this.countRenderableRows(),o=t.startRow,i=t.endRow;if("number"===typeof e)t.startRow=Math.max(o-e,0),t.endRow=Math.min(i+e,n-1);else if("auto"===e){const e=Math.ceil(i/n*12);t.startRow=Math.max(o-e,0),t.endRow=Math.min(i+e,n-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",t)},viewportColumnCalculatorOverride:t=>{let e=this.settings.viewportColumnRenderingOffset;if("auto"===e&&this.settings.fixedColumnsStart&&(e=10),e>0||"auto"===e){const n=this.countRenderableColumns(),o=t.startColumn,i=t.endColumn;if("number"===typeof e&&(t.startColumn=Math.max(o-e,0),t.endColumn=Math.min(i+e,n-1)),"auto"===e){const e=Math.ceil(i/n*6);t.startColumn=Math.max(o-e,0),t.endColumn=Math.min(i+e,n-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",t)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const t=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||t}};this.hot.runHooks("beforeInitWalkontable",t),this._wt=new Pi(t),this.activeWt=this._wt;const e=this._wt.wtTable.spreader,{width:n,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(n,i),this.eventManager.addEventListener(e,"mousedown",t=>{t.target===e&&3===t.which&&t.stopPropagation()}),this.eventManager.addEventListener(e,"contextmenu",t=>{t.target===e&&3===t.which&&t.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())})}isTextSelectionAllowed(t){if(Object(o["isInput"])(t))return!0;const e=Object(o["isChildOf"])(t,this._wt.wtTable.spreader);return!(!0!==this.settings.fragmentSelection||!e)||(!("cell"!==this.settings.fragmentSelection||!this.isSelectedOnlyCell()||!e)||!(this.settings.fragmentSelection||!this.isCellEdited()||!this.isSelectedOnlyCell()))}isMouseDown(){return Ji(ir,this)}isSelectedOnlyCell(){var t,e;return null!==(t=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.isSingleCell())&&void 0!==t&&t}isCellEdited(){const t=this.hot.getActiveEditor();return t&&t.isOpened()}beforeRender(t,e){t&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,e)}afterRender(t){t&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(t,e){if(e.firstChild){const n=e.firstChild;if(!Object(o["hasClass"])(n,"relative"))return Object(o["empty"])(e),void this.appendRowHeader(t,e);this.updateCellHeader(n.querySelector(".rowHeader"),t,this.hot.getRowHeader)}else{const{rootDocument:n,getRowHeader:o}=this.hot,i=n.createElement("div"),r=n.createElement("span");i.className="relative",r.className="rowHeader",this.updateCellHeader(r,t,o),i.appendChild(r),e.appendChild(i)}this.hot.runHooks("afterGetRowHeader",t,e)}appendColHeader(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const r=()=>{const e=t>=0?this.hot.getColumnMeta(t).headerClassName:null;return e?e.split(" "):[]};if(e.firstChild){const s=e.firstChild;Object(o["hasClass"])(s,"relative")?(this.updateCellHeader(s.querySelector(".colHeader"),t,n,i),s.className="",Object(o["addClass"])(s,["relative",...r()])):(Object(o["empty"])(e),this.appendColHeader(t,e,n,i))}else{const{rootDocument:s}=this.hot,a=s.createElement("div"),l=s.createElement("span"),c=r();a.classList.add("relative",...c),l.className="colHeader",this.settings.ariaTags&&(Object(o["setAttribute"])(a,...Object($t["y"])()),Object(o["setAttribute"])(l,...Object($t["y"])())),this.updateCellHeader(l,t,n,i),a.appendChild(l),e.appendChild(a)}this.hot.runHooks("afterGetColHeader",t,e,i)}updateCellHeader(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=e;const s=this._wt.wtOverlays.getParentOverlay(t)||this._wt;t.parentNode&&(Object(o["hasClass"])(t,"colHeader")?r=s.wtTable.columnFilter.sourceToRendered(e):Object(o["hasClass"])(t,"rowHeader")&&(r=s.wtTable.rowFilter.sourceToRendered(e))),r>-1?Object(o["fastInnerHTML"])(t,n(e,i)):(Object(o["fastInnerText"])(t,String.fromCharCode(160)),Object(o["addClass"])(t,"cornerHeader"))}maximumVisibleElementWidth(t){const e=this._wt.wtViewport.getWorkspaceWidth(),n=e-t;return n>0?n:0}maximumVisibleElementHeight(t){const e=this._wt.wtViewport.getWorkspaceHeight(),n=e-t;return n>0?n:0}setLastSize(t,e){Zi(sr,this,t),Zi(ar,this,e)}getLastSize(){return{width:Ji(sr,this),height:Ji(ar,this)}}getFirstRenderedVisibleRow(){return this._wt.wtViewport.rowsRenderCalculator?this.hot.rowIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getFirstRenderedRow(),1):null}getLastRenderedVisibleRow(){return this._wt.wtViewport.rowsRenderCalculator?this.hot.rowIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getLastRenderedRow(),-1):null}getFirstRenderedVisibleColumn(){return this._wt.wtViewport.columnsRenderCalculator?this.hot.columnIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getFirstRenderedColumn(),1):null}getLastRenderedVisibleColumn(){return this._wt.wtViewport.columnsRenderCalculator?this.hot.columnIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getLastRenderedColumn(),-1):null}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return Ji(er,this)}getRowHeadersCount(){return Ji(nr,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(t){var e;return(null!==(e=this._wt.wtOverlays.getParentOverlay(t))&&void 0!==e?e:this._wt).wtTable.name}getOverlayByName(t){return this._wt.getOverlayByName(t)}isVisible(){return this._wt.wtTable.isVisible()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function hr(){return parseInt(this.hot.rootElement.getAttribute(Object($t["e"])()[0]),10)}function ur(t){const e=tr(lr,this,hr).call(this)+t;Object(o["setAttribute"])(this.hot.rootElement,...Object($t["e"])(e))}var dr=cr,fr=n("480c");function gr(t,e,n){return(e=pr(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pr(t){var e=mr(t,"string");return"symbol"==typeof e?e:e+""}function mr(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class br{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];gr(this,"hot",void 0),gr(this,"data",void 0),gr(this,"dataType","array"),gr(this,"colToProp",()=>{}),gr(this,"propToCol",()=>{}),this.hot=t,this.data=e}modifyRowData(t){let e;return this.hot.hasHook("modifyRowData")&&(e=this.hot.runHooks("modifyRowData",t)),void 0===e||Number.isInteger(e)?this.data[t]:e}getData(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.data&&0!==this.data.length?this.getByRange(null,null,t):this.data}setData(t){this.data=t}getAtColumn(t){const e=[];return Object(U["arrayEach"])(this.data,(n,o)=>{const i=this.getAtCell(o,t);e.push(i)}),e}getAtRow(t,e,n){let o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r=void 0===e&&void 0===n,{dataDotNotation:s}=this.hot.getSettings();let a=null,l=null;if(a=this.modifyRowData(t),Array.isArray(a))l=[],r?a.forEach((e,n)=>{l[n]=this.getAtPhysicalCell(t,n,a)}):Object(K["rangeEach"])(e,n,n=>{l[n-e]=this.getAtPhysicalCell(t,n,a)});else if(Object(O["isObject"])(a)||Object(i["isFunction"])(a))if(l=o?[]:{},!r||o){const i=0,r=this.countFirstRowKeys()-1;Object(K["rangeEach"])(i,r,c=>{const h=this.colToProp(c);if(c>=(e||i)&&c<=(n||r)&&!Number.isInteger(h)){const e=this.getAtPhysicalCell(t,h,a);o?l.push(e):s?Object(O["setProperty"])(l,h,e):l[h]=e}})}else Object(O["objectEach"])(a,(e,n)=>{const o=this.getAtPhysicalCell(t,n,a);s?Object(O["setProperty"])(l,n,o):l[n]=o});return l}setAtCell(t,e,n){if(!(t>=this.countRows()||e>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const o=Object(O["createObjectPropListener"])(n);this.hot.runHooks("modifySourceData",t,e,o,"set"),o.isTouched()&&(n=o.value)}Number.isInteger(e)?this.data[t][e]=n:Object(O["setProperty"])(this.data[t],e,n)}}getAtPhysicalCell(t,e,n){let o=null;if(n)if("string"===typeof e){const{dataDotNotation:t}=this.hot.getSettings();o=t?Object(O["getProperty"])(n,e):n[e]}else o="function"===typeof e?e(n):n[e];if(this.hot.hasHook("modifySourceData")){const n=Object(O["createObjectPropListener"])(o);this.hot.runHooks("modifySourceData",t,e,n,"get"),n.isTouched()&&(o=n.value)}return o}getAtCell(t,e){const n=this.modifyRowData(t);return this.getAtPhysicalCell(t,this.colToProp(e),n)}getByRange(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=!1,i=null,r=null,s=null,a=null;null===t||null===e?(o=!0,i=0,s=this.countRows()-1):(i=Math.min(t.row,e.row),r=Math.min(t.col,e.col),s=Math.max(t.row,e.row),a=Math.max(t.col,e.col));const l=[];return Object(K["rangeEach"])(i,s,t=>{l.push(o?this.getAtRow(t,void 0,void 0,n):this.getAtRow(t,r,a,n))}),l}countRows(){if(this.hot.hasHook("modifySourceLength")){const t=this.hot.runHooks("modifySourceLength");if(Number.isInteger(t))return t}return this.data.length}countFirstRowKeys(){return Object(fr["countFirstRowKeys"])(this.data)}destroy(){this.data=null,this.hot=null}}var wr=br,vr=n("1b1a"),yr=n("cef7"),Cr=n("1096"),Sr=n("9056"),Or=n("9f10"),Er=n("00fd");const Rr=new Map([["hiding",yr["a"]],["index",Cr["a"]],["linkedPhysicalIndexToValue",Sr["a"]],["physicalIndexToValue",Or["a"]],["trimming",Er["a"]]]);function Tr(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!Rr.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(Rr.get(t))(e)}var Mr=n("3d57"),Ir=n("c5cd");function xr(t,e,n){return(e=Nr(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nr(t){var e=Ar(t,"string");return"symbol"==typeof e?e:e+""}function Ar(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Hr extends Ir["a"]{constructor(t,e){super(),xr(this,"mergedValuesCache",[]),xr(this,"aggregationFunction",void 0),xr(this,"fallbackValue",void 0),this.aggregationFunction=t,this.fallbackValue=e}getMergedValues(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===t)return this.mergedValuesCache;if(0===this.getLength())return[];const e=Object(U["arrayMap"])(this.get(),t=>t.getValues()),n=[],o=Object(r["isDefined"])(e[0])&&e[0].length||0;for(let i=0;i<o;i+=1){const t=[];for(let n=0;n<this.getLength();n+=1)t.push(e[n][i]);n.push(t)}return Object(U["arrayMap"])(n,this.aggregationFunction)}getMergedValueAtIndex(t,e){const n=this.getMergedValues(e)[t];return Object(r["isDefined"])(n)?n:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}var jr=n("7ae0");function _r(t,e,n){kr(t,e),e.set(t,n)}function kr(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pr(t,e,n){return t.set(Lr(t,e),n),n}function Dr(t,e){return t.get(Lr(t,e))}function Lr(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Fr=new WeakMap;class Vr{constructor(){_r(this,Fr,[])}subscribe(t){return this.addLocalHook("change",t),this._write(Dr(Fr,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(t){return t.length>0&&this.runLocalHooks("change",t),this}_writeInitialChanges(t){Pr(Fr,this,t)}}function Wr(t,e){const n=[];let o=0,i=0;for(;o<t.length&&i<e.length;o++,i++)t[o]!==e[i]&&n.push({op:"replace",index:i,oldValue:t[o],newValue:e[i]});for(;o<e.length;o++)n.push({op:"insert",index:o,oldValue:void 0,newValue:e[o]});for(;i<t.length;i++)n.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return n}function Br(t,e,n){Ur(t,e),e.set(t,n)}function Ur(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zr(t,e){return t.get(Yr(t,e))}function Gr(t,e,n){return t.set(Yr(t,e),n),n}function Yr(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}Object(O["mixin"])(Vr,jr["a"]);var Xr=new WeakMap,$r=new WeakMap,Kr=new WeakMap,qr=new WeakMap,Qr=new WeakMap;class Jr{constructor(){let{initialIndexValue:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Br(this,Xr,new Set),Br(this,$r,[]),Br(this,Kr,[]),Br(this,qr,!1),Br(this,Qr,!1),Gr(Qr,this,null!==t&&void 0!==t&&t)}createObserver(){const t=new Vr;return zr(Xr,this).add(t),t.addLocalHook("unsubscribe",()=>{zr(Xr,this).delete(t)}),t._writeInitialChanges(Wr(zr($r,this),zr(Kr,this))),t}emit(t){let e=zr(Kr,this);zr(qr,this)&&zr($r,this).length===t.length||(0===t.length?t=new Array(e.length).fill(zr(Qr,this)):Gr($r,this,new Array(t.length).fill(zr(Qr,this))),zr(qr,this)||(Gr(qr,this,!0),e=zr($r,this)));const n=Wr(e,t);zr(Xr,this).forEach(t=>t._write(n)),Gr(Kr,this,t)}}function Zr(t,e,n){return(e=ts(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ts(t){var e=es(t,"string");return"symbol"==typeof e?e:e+""}function es(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}new Set;class ns{constructor(){Zr(this,"indexesSequence",new vr["a"]),Zr(this,"trimmingMapsCollection",new Hr(t=>t.some(t=>!0===t),!1)),Zr(this,"hidingMapsCollection",new Hr(t=>t.some(t=>!0===t),!1)),Zr(this,"variousMapsCollection",new Ir["a"]),Zr(this,"hidingChangesObservable",new Jr({initialIndexValue:!1})),Zr(this,"notTrimmedIndexesCache",[]),Zr(this,"notHiddenIndexesCache",[]),Zr(this,"isBatched",!1),Zr(this,"indexesSequenceChanged",!1),Zr(this,"indexesChangeSource",void 0),Zr(this,"trimmedIndexesChanged",!1),Zr(this,"hiddenIndexesChanged",!1),Zr(this,"renderablePhysicalIndexesCache",[]),Zr(this,"fromPhysicalToVisualIndexesCache",new Map),Zr(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",t=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",t,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",t=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",t,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",t=>{this.runLocalHooks("change",t,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(t){if("hiding"!==t)throw new Error(`Unsupported index map type "${t}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(t,e,n){return this.registerMap(t,Tr(e,n))}registerMap(t,e){if(this.trimmingMapsCollection.get(t)||this.hidingMapsCollection.get(t)||this.variousMapsCollection.get(t))throw Error(`Map with name "${t}" has been already registered.`);e instanceof Er["a"]?this.trimmingMapsCollection.register(t,e):e instanceof yr["a"]?this.hidingMapsCollection.register(t,e):this.variousMapsCollection.register(t,e);const n=this.getNumberOfIndexes();return n>0&&e.init(n),e}unregisterMap(t){this.trimmingMapsCollection.unregister(t),this.hidingMapsCollection.unregister(t),this.variousMapsCollection.unregister(t)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(t){const e=this.notTrimmedIndexesCache[t];return Object(r["isDefined"])(e)?e:null}getPhysicalFromRenderableIndex(t){const e=this.renderablePhysicalIndexesCache[t];return Object(r["isDefined"])(e)?e:null}getVisualFromPhysicalIndex(t){const e=this.fromPhysicalToVisualIndexesCache.get(t);return Object(r["isDefined"])(e)?e:null}getVisualFromRenderableIndex(t){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(t))}getRenderableFromVisualIndex(t){const e=this.fromVisualToRenderableIndexesCache.get(t);return Object(r["isDefined"])(e)?e:null}getNearestNotHiddenIndex(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o=this.getPhysicalFromVisualIndex(t);if(null===o)return null;if(this.fromVisualToRenderableIndexesCache.has(t))return t;const i=Array.from(this.fromVisualToRenderableIndexesCache.keys());let r=-1;return r=e>0?i.findIndex(e=>e>t):i.reverse().findIndex(e=>e<t),-1===r?n?this.getNearestNotHiddenIndex(t,-e,!1):null:i[r]}initToLength(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(t).keys()],this.notHiddenIndexesCache=[...new Array(t).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(t),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(t),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(t),this.variousMapsCollection.initEvery(t),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(t){const e=this.getNumberOfIndexes();if(t<e){const e=[...Array(this.getNumberOfIndexes()-t).keys()].map(e=>e+t);this.removeIndexes(e)}else this.insertIndexes(e,t-e)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(t){void 0===this.indexesChangeSource&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(t),"update"===this.indexesChangeSource&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===t)return this.notTrimmedIndexesCache;const e=this.getIndexesSequence();return e.filter(t=>!1===this.isTrimmed(t))}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===t)return this.notHiddenIndexesCache;const e=this.getIndexesSequence();return e.filter(t=>!1===this.isHidden(t))}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===t)return this.renderablePhysicalIndexesCache;const e=this.getNotTrimmedIndexes();return e.filter(t=>!1===this.isHidden(t))}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(t,e){"number"===typeof t&&(t=[t]);const n=Object(U["arrayMap"])(t,t=>this.getPhysicalFromVisualIndex(t)),o=this.getNotTrimmedIndexesLength(),i=t.length,r=Object(Mr["b"])(this.getIndexesSequence(),n),s=r.filter(t=>!1===this.isTrimmed(t));let a=r.indexOf(s[s.length-1])+1;if(e+i<o){const t=s[e];a=r.indexOf(t)}this.indexesChangeSource="move",this.setIndexesSequence(Object(Mr["a"])(r,a,n)),this.indexesChangeSource=void 0}isTrimmed(t){return this.trimmingMapsCollection.getMergedValueAtIndex(t)}isHidden(t){return this.hidingMapsCollection.getMergedValueAtIndex(t)}insertIndexes(t,e){const n=this.getNotTrimmedIndexes()[t],o=Object(r["isDefined"])(n)?n:this.getNumberOfIndexes(),i=this.getIndexesSequence().includes(n)?this.getIndexesSequence().indexOf(n):this.getNumberOfIndexes(),s=Object(U["arrayMap"])(new Array(e).fill(o),(t,e)=>t+e);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(i,s),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(i,s),this.hidingMapsCollection.insertToEvery(i,s),this.variousMapsCollection.insertToEvery(i,s),this.resumeOperations()}removeIndexes(t){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(t),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(t),this.hidingMapsCollection.removeFromEvery(t),this.variousMapsCollection.removeFromEvery(t),this.resumeOperations()}updateCache(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const e=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(!0===t||!1===this.isBatched&&!0===e)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const t=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let e=0;e<t;e+=1){const t=this.getPhysicalFromVisualIndex(e);this.fromPhysicalToVisualIndexesCache.set(t,e)}}cacheFromVisualToRenderableIndexes(){const t=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let e=0;e<t;e+=1){const t=this.getPhysicalFromRenderableIndex(e),n=this.getVisualFromPhysicalIndex(t);this.fromVisualToRenderableIndexesCache.set(n,e)}}}Object(O["mixin"])(ns,jr["a"]);var os=n("1004");function is(t,e){return Object(O["objectEach"])(e,(e,n)=>{Object(r["isUndefined"])(t[n])&&(t[n]=e)}),t}function rs(t){const e=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/,n=e.exec(t);return n?`${n[1].toLowerCase()}-${n[2].toUpperCase()}`:t}function ss(t){Object(r["isDefined"])(t)&&Object(E["a"])(te["a"]`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}var as=n("9acd");function ls(t,e){const n=Array.isArray(t)&&Number.isInteger(e);return n?t[e]:t}const{register:cs,getValues:hs}=Object(as["a"])("phraseFormatters");function us(t,e){cs(t,e)}function ds(){return hs()}us("pluralize",ls);var fs=n("0283");
/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const gs={languageCode:"en-US",[fs["CONTEXTMENU_ITEMS_NO_ITEMS"]]:"No available options",[fs["CONTEXTMENU_ITEMS_ROW_ABOVE"]]:"Insert row above",[fs["CONTEXTMENU_ITEMS_ROW_BELOW"]]:"Insert row below",[fs["CONTEXTMENU_ITEMS_INSERT_LEFT"]]:"Insert column left",[fs["CONTEXTMENU_ITEMS_INSERT_RIGHT"]]:"Insert column right",[fs["CONTEXTMENU_ITEMS_REMOVE_ROW"]]:["Remove row","Remove rows"],[fs["CONTEXTMENU_ITEMS_REMOVE_COLUMN"]]:["Remove column","Remove columns"],[fs["CONTEXTMENU_ITEMS_UNDO"]]:"Undo",[fs["CONTEXTMENU_ITEMS_REDO"]]:"Redo",[fs["CONTEXTMENU_ITEMS_READ_ONLY"]]:"Read only",[fs["CONTEXTMENU_ITEMS_CLEAR_COLUMN"]]:"Clear column",[fs["CONTEXTMENU_ITEMS_ALIGNMENT"]]:"Alignment",[fs["CONTEXTMENU_ITEMS_ALIGNMENT_LEFT"]]:"Left",[fs["CONTEXTMENU_ITEMS_ALIGNMENT_CENTER"]]:"Center",[fs["CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT"]]:"Right",[fs["CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY"]]:"Justify",[fs["CONTEXTMENU_ITEMS_ALIGNMENT_TOP"]]:"Top",[fs["CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE"]]:"Middle",[fs["CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM"]]:"Bottom",[fs["CONTEXTMENU_ITEMS_FREEZE_COLUMN"]]:"Freeze column",[fs["CONTEXTMENU_ITEMS_UNFREEZE_COLUMN"]]:"Unfreeze column",[fs["CONTEXTMENU_ITEMS_BORDERS"]]:"Borders",[fs["CONTEXTMENU_ITEMS_BORDERS_TOP"]]:"Top",[fs["CONTEXTMENU_ITEMS_BORDERS_RIGHT"]]:"Right",[fs["CONTEXTMENU_ITEMS_BORDERS_BOTTOM"]]:"Bottom",[fs["CONTEXTMENU_ITEMS_BORDERS_LEFT"]]:"Left",[fs["CONTEXTMENU_ITEMS_REMOVE_BORDERS"]]:"Remove border(s)",[fs["CONTEXTMENU_ITEMS_ADD_COMMENT"]]:"Add comment",[fs["CONTEXTMENU_ITEMS_EDIT_COMMENT"]]:"Edit comment",[fs["CONTEXTMENU_ITEMS_REMOVE_COMMENT"]]:"Delete comment",[fs["CONTEXTMENU_ITEMS_READ_ONLY_COMMENT"]]:"Read-only comment",[fs["CONTEXTMENU_ITEMS_MERGE_CELLS"]]:"Merge cells",[fs["CONTEXTMENU_ITEMS_UNMERGE_CELLS"]]:"Unmerge cells",[fs["CONTEXTMENU_ITEMS_COPY"]]:"Copy",[fs["CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS"]]:["Copy with header","Copy with headers"],[fs["CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS"]]:["Copy with group header","Copy with group headers"],[fs["CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY"]]:["Copy header only","Copy headers only"],[fs["CONTEXTMENU_ITEMS_CUT"]]:"Cut",[fs["CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD"]]:"Insert child row",[fs["CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD"]]:"Detach from parent",[fs["CONTEXTMENU_ITEMS_HIDE_COLUMN"]]:["Hide column","Hide columns"],[fs["CONTEXTMENU_ITEMS_SHOW_COLUMN"]]:["Show column","Show columns"],[fs["CONTEXTMENU_ITEMS_HIDE_ROW"]]:["Hide row","Hide rows"],[fs["CONTEXTMENU_ITEMS_SHOW_ROW"]]:["Show row","Show rows"],[fs["FILTERS_CONDITIONS_NONE"]]:"None",[fs["FILTERS_CONDITIONS_EMPTY"]]:"Is empty",[fs["FILTERS_CONDITIONS_NOT_EMPTY"]]:"Is not empty",[fs["FILTERS_CONDITIONS_EQUAL"]]:"Is equal to",[fs["FILTERS_CONDITIONS_NOT_EQUAL"]]:"Is not equal to",[fs["FILTERS_CONDITIONS_BEGINS_WITH"]]:"Begins with",[fs["FILTERS_CONDITIONS_ENDS_WITH"]]:"Ends with",[fs["FILTERS_CONDITIONS_CONTAINS"]]:"Contains",[fs["FILTERS_CONDITIONS_NOT_CONTAIN"]]:"Does not contain",[fs["FILTERS_CONDITIONS_GREATER_THAN"]]:"Greater than",[fs["FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL"]]:"Greater than or equal to",[fs["FILTERS_CONDITIONS_LESS_THAN"]]:"Less than",[fs["FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL"]]:"Less than or equal to",[fs["FILTERS_CONDITIONS_BETWEEN"]]:"Is between",[fs["FILTERS_CONDITIONS_NOT_BETWEEN"]]:"Is not between",[fs["FILTERS_CONDITIONS_AFTER"]]:"After",[fs["FILTERS_CONDITIONS_BEFORE"]]:"Before",[fs["FILTERS_CONDITIONS_TODAY"]]:"Today",[fs["FILTERS_CONDITIONS_TOMORROW"]]:"Tomorrow",[fs["FILTERS_CONDITIONS_YESTERDAY"]]:"Yesterday",[fs["FILTERS_VALUES_BLANK_CELLS"]]:"Blank cells",[fs["FILTERS_DIVS_FILTER_BY_CONDITION"]]:"Filter by condition",[fs["FILTERS_DIVS_FILTER_BY_VALUE"]]:"Filter by value",[fs["FILTERS_LABELS_CONJUNCTION"]]:"And",[fs["FILTERS_LABELS_DISJUNCTION"]]:"Or",[fs["FILTERS_BUTTONS_SELECT_ALL"]]:"Select all",[fs["FILTERS_BUTTONS_CLEAR"]]:"Clear",[fs["FILTERS_BUTTONS_OK"]]:"OK",[fs["FILTERS_BUTTONS_CANCEL"]]:"Cancel",[fs["FILTERS_BUTTONS_PLACEHOLDER_SEARCH"]]:"Search",[fs["FILTERS_BUTTONS_PLACEHOLDER_VALUE"]]:"Value",[fs["FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE"]]:"Second value",[fs["CHECKBOX_CHECKED"]]:"Checked",[fs["CHECKBOX_UNCHECKED"]]:"Unchecked"};var ps=gs;const ms=fs,bs=ps.languageCode,{register:ws,getItem:vs,hasItem:ys,getValues:Cs}=Object(as["a"])("languagesDictionaries");function Ss(t,e){let n=t,o=e;return Object(O["isObject"])(t)&&(o=t,n=o.languageCode),Os(n,o),ws(n,Object(O["deepClone"])(o)),Object(O["deepClone"])(o)}function Os(t,e){t!==bs&&is(e,vs(bs))}function Es(t){return Rs(t)?Object(O["deepClone"])(vs(t)):null}function Rs(t){return ys(t)}function Ts(){return Cs()}function Ms(t,e,n){const o=Es(t);if(null===o)return null;const i=o[e];if(Object(r["isUndefined"])(i))return null;const s=Is(i,n);return Array.isArray(s)?s[0]:s}function Is(t,e){let n=t;return Object(U["arrayEach"])(ds(),o=>{n=o(t,e)}),n}function xs(t){let e=rs(t);return Rs(e)||(e=bs,ss(t)),e}Ss(ps);var Ns=n("a309");class As{constructor(t,e){this.settings=t,this.cellRange=e||null}isEmpty(){return null===this.cellRange}add(t){return this.isEmpty()?this.cellRange=this.settings.createCellRange(t):this.cellRange.expand(t),this}replace(t,e){if(!this.isEmpty()){if(this.cellRange.from.isEqual(t))return this.cellRange.from=e,!0;if(this.cellRange.to.isEqual(t))return this.cellRange.to=e,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const t=this.cellRange.getOuterTopStartCorner(),e=this.cellRange.getOuterBottomEndCorner();return[t.row,t.col,e.row,e.col]}destroy(){this.runLocalHooks("destroy")}}Object(O["mixin"])(As,jr["a"]);var Hs=As;function js(t,e,n){return(e=_s(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _s(t){var e=ks(t,"string");return"symbol"==typeof e?e:e+""}function ks(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Ps extends Hs{constructor(t,e){super(t,null),js(this,"visualCellRange",null),this.visualCellRange=e||null,this.commit()}add(t){return null===this.visualCellRange?this.visualCellRange=this.settings.createCellRange(t):this.visualCellRange.expand(t),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(t){let{from:e,to:n}=t,o=this.getNearestNotHiddenCoords(e,1),i=this.getNearestNotHiddenCoords(n,-1);return null===o||null===i?null:((o.row>i.row||o.col>i.col)&&(o=e,i=n),this.settings.createCellRange(o,o,i))}getNearestNotHiddenCoords(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;const o=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,t.row,e);if(null===o)return null;const i=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,t.col,n);return null===i?null:this.settings.createCellCoords(o,i)}getNearestNotHiddenIndex(t,e,n){return e<0?e:t.getNearestNotHiddenIndex(e,n)}commit(){if(null===this.visualCellRange)return this;const t=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return this.cellRange=null===t?null:this.createRenderableCellRange(t.from,t.to),this}syncWith(t){const e=t.from.clone().normalize(),n="N-S"===t.getVerticalDirection()?1:-1,o="W-E"===t.getHorizontalDirection()?1:-1,i=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let r=null;if(null!==i&&null!==i.col&&null!==i.row||(r=this.getNearestNotHiddenCoords(e,n,o)),null!==r&&t.overlaps(r)){const e=t.highlight.clone();if(e.row>=0&&(e.row=r.row),e.col>=0&&(e.col=r.col),null===this.cellRange){const t=this.settings.visualToRenderableCoords(e);this.cellRange=this.settings.createCellRange(t)}t.setHighlight(e)}return"focus"===this.settings.selectionType&&null!==i&&null===r&&t.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:t,to:e}=this.cellRange;return[Math.min(t.row,e.row),Math.min(t.col,e.col),Math.max(t.row,e.row),Math.max(t.col,e.col)]}getVisualCorners(){const t=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),e=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[t.row,t.col,e.row,e.col]}createRenderableCellRange(t,e){const n=this.settings.visualToRenderableCoords(t),o=this.settings.visualToRenderableCoords(e);return null===n.row||null===n.col||null===o.row||null===o.col?null:this.settings.createCellRange(n,n,o)}}var Ds=Ps;function Ls(t){let{activeHeaderClassName:e,...n}=t;return new Ds({className:e,...n,selectionType:Ns["a"]})}function Fs(t){let{areaCornerVisible:e,...n}=t;return new Ds({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...n,selectionType:Ns["b"]})}function Vs(t){let{...e}=t;return new Ds({className:"highlight",...e,selectionType:Ns["b"]})}function Ws(t){let{columnClassName:e,...n}=t;return new Ds({className:e,...n,selectionType:Ns["c"]})}function Bs(t){let{cellCornerVisible:e,...n}=t;return new Ds({className:"current",headerAttributes:[Object($t["I"])()],border:{width:2,color:"#4b89ff",cornerVisible:e},...n,selectionType:Ns["f"]})}function Us(t){let{border:e,visualCellRange:n,...o}=t;return new Ds({...e,...o,selectionType:Ns["d"]},n)}function zs(t){let{...e}=t;return new Ds({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:Ns["e"]})}function Gs(t){let{headerClassName:e,...n}=t;return new Ds({className:e,...n,selectionType:Ns["g"]})}function Ys(t){let{rowClassName:e,...n}=t;return new Ds({className:e,...n,selectionType:Ns["h"]})}function Xs(t,e){$s(t,e),e.add(t)}function $s(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ks(t,e,n){return(e=qs(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qs(t){var e=Qs(t,"string");return"symbol"==typeof e?e:e+""}function Qs(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Js(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Zs=new WeakSet;class ta{constructor(t){Xs(this,Zs),Ks(this,"options",void 0),Ks(this,"layerLevel",0),Ks(this,"focus",void 0),Ks(this,"fill",void 0),Ks(this,"layeredAreas",new Map),Ks(this,"areas",new Map),Ks(this,"rowHeaders",new Map),Ks(this,"columnHeaders",new Map),Ks(this,"activeRowHeaders",new Map),Ks(this,"activeColumnHeaders",new Map),Ks(this,"activeCornerHeaders",new Map),Ks(this,"rowHighlights",new Map),Ks(this,"columnHighlights",new Map),Ks(this,"customSelections",[]),this.options=t,this.focus=Bs(t),this.fill=zs(t)}isEnabledFor(t,e){let n=t;t===Ns["f"]&&(n="current");let o=this.options.disabledCellSelection(e.row,e.col);return"string"===typeof o&&(o=[o]),!1===o||Array.isArray(o)&&!o.includes(n)}useLayerLevel(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.layerLevel=t,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return Js(Zs,this,ea).call(this,this.layeredAreas,Fs)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return Js(Zs,this,ea).call(this,this.areas,Vs)}getAreas(){return[...this.areas.values()]}createRowHeader(){return Js(Zs,this,ea).call(this,this.rowHeaders,Gs)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return Js(Zs,this,ea).call(this,this.columnHeaders,Gs)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return Js(Zs,this,ea).call(this,this.activeRowHeaders,Ls)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return Js(Zs,this,ea).call(this,this.activeColumnHeaders,Ls)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return Js(Zs,this,ea).call(this,this.activeCornerHeaders,Ls)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return Js(Zs,this,ea).call(this,this.rowHighlights,Ys)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return Js(Zs,this,ea).call(this,this.columnHighlights,Ws)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(t){this.customSelections.push(Us({...this.options,...t}))}clear(){this.focus.clear(),this.fill.clear(),Object(U["arrayEach"])(this.areas.values(),t=>{t.clear()}),Object(U["arrayEach"])(this.layeredAreas.values(),t=>{t.clear()}),Object(U["arrayEach"])(this.rowHeaders.values(),t=>{t.clear()}),Object(U["arrayEach"])(this.columnHeaders.values(),t=>{t.clear()}),Object(U["arrayEach"])(this.activeRowHeaders.values(),t=>{t.clear()}),Object(U["arrayEach"])(this.activeColumnHeaders.values(),t=>{t.clear()}),Object(U["arrayEach"])(this.activeCornerHeaders.values(),t=>{t.clear()}),Object(U["arrayEach"])(this.rowHighlights.values(),t=>{t.clear()}),Object(U["arrayEach"])(this.columnHighlights.values(),t=>{t.clear()})}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function ea(t,e){const n=this.layerLevel;if(t.has(n))return t.get(n);const o=e({layerLevel:n,...this.options});return t.set(n,o),o}var na=ta;function oa(t,e,n){return(e=ia(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ia(t){var e=ra(t,"string");return"symbol"==typeof e?e:e+""}function ra(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class sa{constructor(t){oa(this,"ranges",[]),oa(this,"createCellRange",void 0),this.createCellRange=t}isEmpty(){return 0===this.size()}set(t){return this.clear(),this.ranges.push(this.createCellRange(t)),this}add(t){return this.ranges.push(this.createCellRange(t)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(t){return this.ranges.some(e=>e.includes(t))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return e>=0&&e<this.size()&&(t=this.ranges[e]),t}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}var aa=sa;function la(t,e){ha(t,e),e.add(t)}function ca(t,e,n){ha(t,e),e.set(t,n)}function ha(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ua(t,e){return t.get(fa(t,e))}function da(t,e,n){return t.set(fa(t,e),n),n}function fa(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ga=new WeakMap,pa=new WeakMap,ma=new WeakMap,ba=new WeakSet;class wa{constructor(t,e){la(this,ba),ca(this,ga,void 0),ca(this,pa,void 0),ca(this,ma,{x:0,y:0}),da(ga,this,t),da(pa,this,e)}transformStart(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o=ua(pa,this).createCellCoords(t,e);let i=ua(ga,this).current().highlight;const r=ua(pa,this).visualToRenderableCoords(i);let s=0,a=0;if(this.runLocalHooks("beforeTransformStart",o),null!==r.row&&null!==r.col){const{width:t,height:e}=fa(ba,this,ya).call(this),{row:r,col:l}=fa(ba,this,Oa).call(this,i),c=ua(pa,this).fixedRowsBottom(),h=ua(pa,this).minSpareRows(),u=ua(pa,this).minSpareCols(),d=ua(pa,this).autoWrapRow(),f=ua(pa,this).autoWrapCol(),g=ua(pa,this).createCellCoords(r+o.row,l+o.col);if(g.row>=e){const o=Object(O["createObjectPropListener"])(n&&h>0&&0===c),i=g.col+1,r=ua(pa,this).createCellCoords(g.row-e,i>=t?i-t:i);this.runLocalHooks("beforeColumnWrap",o,fa(ba,this,Ea).call(this,r),i>=t),o.value?this.runLocalHooks("insertRowRequire",ua(pa,this).countRenderableRows()):f&&g.assign(r)}else if(g.row<0){const n=Object(O["createObjectPropListener"])(f),o=g.col-1,i=ua(pa,this).createCellCoords(e+g.row,o<0?t+o:o);this.runLocalHooks("beforeColumnWrap",n,fa(ba,this,Ea).call(this,i),o<0),f&&g.assign(i)}if(g.col>=t){const o=Object(O["createObjectPropListener"])(n&&u>0),i=g.row+1,r=ua(pa,this).createCellCoords(i>=e?i-e:i,g.col-t);this.runLocalHooks("beforeRowWrap",o,fa(ba,this,Ea).call(this,r),i>=e),o.value?this.runLocalHooks("insertColRequire",ua(pa,this).countRenderableColumns()):d&&g.assign(r)}else if(g.col<0){const n=Object(O["createObjectPropListener"])(d),o=g.row-1,i=ua(pa,this).createCellCoords(o<0?e+o:o,t+g.col);this.runLocalHooks("beforeRowWrap",n,fa(ba,this,Ea).call(this,i),o<0),d&&g.assign(i)}const{rowDir:p,colDir:m}=fa(ba,this,va).call(this,g);s=p,a=m,i=fa(ba,this,Ea).call(this,g)}return this.runLocalHooks("afterTransformStart",i,s,a),i}transformEnd(t,e){const n=ua(pa,this).createCellCoords(t,e),o=ua(ga,this).current(),i=ua(pa,this).visualToRenderableCoords(o.highlight),r=fa(ba,this,Ca).call(this,o.to.row,o.from.row),s=fa(ba,this,Sa).call(this,o.to.col,o.from.col),a=o.to.clone();let l=0,c=0;if(this.runLocalHooks("beforeTransformEnd",n),null!==i.row&&null!==i.col&&null!==r&&null!==s){const{row:t,col:e}=fa(ba,this,Oa).call(this,o.highlight),i=ua(pa,this).createCellCoords(r+n.row,s+n.col),h=o.getTopStartCorner(),u=o.getTopEndCorner(),d=o.getBottomEndCorner();if(n.col<0&&s>=e&&i.col<e){const t=i.col-e;i.col=fa(ba,this,Sa).call(this,h.col,u.col)+t}else if(n.col>0&&s<=e&&i.col>e){const t=fa(ba,this,Sa).call(this,u.col,h.col),e=Math.max(i.col-t,1);i.col=t+e}if(n.row<0&&r>=t&&i.row<t){const e=i.row-t;i.row=fa(ba,this,Ca).call(this,h.row,d.row)+e}else if(n.row>0&&r<=t&&i.row>t){const t=fa(ba,this,Ca).call(this,d.row,h.row),e=Math.max(i.row-t,1);i.row=t+e}const{rowDir:f,colDir:g}=fa(ba,this,va).call(this,i);l=f,c=g;const p=fa(ba,this,Ea).call(this,i);0===n.row&&0!==n.col?a.col=p.col:0!==n.row&&0===n.col?a.row=p.row:(a.row=p.row,a.col=p.col)}return this.runLocalHooks("afterTransformEnd",a,l,c),a}setOffsetSize(t){let{x:e,y:n}=t;da(ma,this,{x:e,y:n})}resetOffsetSize(){da(ma,this,{x:0,y:0})}}function va(t){const{width:e,height:n}=fa(ba,this,ya).call(this);let o=0,i=0;return t.row<0?(o=-1,t.row=0):t.row>0&&t.row>=n&&(o=1,t.row=n-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:o,colDir:i}}function ya(){return{width:ua(ma,this).x+ua(pa,this).countRenderableColumns(),height:ua(ma,this).y+ua(pa,this).countRenderableRows()}}function Ca(t,e){const n=ua(pa,this).findFirstNonHiddenRenderableRow(t,e);return null===n?null:ua(ma,this).y+n}function Sa(t,e){const n=ua(pa,this).findFirstNonHiddenRenderableColumn(t,e);return null===n?null:ua(ma,this).x+n}function Oa(t){const{row:e,col:n}=ua(pa,this).visualToRenderableCoords(t);if(null===e||null===n)throw new Error("Renderable coords are not visible.");return ua(pa,this).createCellCoords(ua(ma,this).y+e,ua(ma,this).x+n)}function Ea(t){const e=t.clone();return e.col=t.col-ua(ma,this).x,e.row=t.row-ua(ma,this).y,ua(pa,this).renderableToVisualCoords(e)}Object(O["mixin"])(wa,jr["a"]);var Ra=wa,Ta=n("a952");function Ma(t,e,n){Ia(t,e),e.set(t,n)}function Ia(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xa(t,e,n){return(e=Na(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Na(t){var e=Aa(t,"string");return"symbol"==typeof e?e:e+""}function Aa(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Ha(t,e){return t.get(_a(t,e))}function ja(t,e,n){return t.set(_a(t,e),n),n}function _a(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ka=new WeakMap,Pa=new WeakMap,Da=new WeakMap,La=new WeakMap,Fa=new WeakMap,Va=new WeakMap;class Wa{constructor(t,e){var n=this;xa(this,"settings",void 0),xa(this,"tableProps",void 0),xa(this,"inProgress",!1),xa(this,"selectedRange",new aa((t,e,n)=>this.tableProps.createCellRange(t,e,n))),xa(this,"highlight",void 0),Ma(this,ka,void 0),Ma(this,Pa,void 0),xa(this,"selectedByRowHeader",new Set),xa(this,"selectedByColumnHeader",new Set),Ma(this,Da,!1),Ma(this,La,!1),Ma(this,Fa,"unknown"),Ma(this,Va,-1),this.settings=t,this.tableProps=e,this.highlight=new na({headerClassName:t.currentHeaderClassName,activeHeaderClassName:t.activeHeaderClassName,rowClassName:t.currentRowClassName,columnClassName:t.currentColClassName,cellAttributes:[Object($t["I"])()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(t,e)=>this.tableProps.isDisabledCellSelection(t,e),cellCornerVisible:function(){return n.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible(...arguments)},visualToRenderableCoords:t=>this.tableProps.visualToRenderableCoords(t),renderableToVisualCoords:t=>this.tableProps.renderableToVisualCoords(t),createCellCoords:(t,e)=>this.tableProps.createCellCoords(t,e),createCellRange:(t,e,n)=>this.tableProps.createCellRange(t,e,n)}),ja(ka,this,new Ra(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:t=>this.tableProps.visualToRenderableCoords(t),renderableToVisualCoords:t=>this.tableProps.renderableToVisualCoords(t),findFirstNonHiddenRenderableRow:function(){return n.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return n.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(t,e)=>this.tableProps.createCellCoords(t,e),fixedRowsBottom:()=>t.fixedRowsBottom,minSpareRows:()=>t.minSpareRows,minSpareCols:()=>t.minSpareCols,autoWrapRow:()=>t.autoWrapRow,autoWrapCol:()=>t.autoWrapCol})),ja(Pa,this,new Ra(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const t=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,t.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const t=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,t.getOuterBottomEndCorner().col)},visualToRenderableCoords:t=>this.tableProps.visualToRenderableCoords(t),renderableToVisualCoords:t=>this.tableProps.renderableToVisualCoords(t),findFirstNonHiddenRenderableRow:function(){return n.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return n.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(t,e)=>this.tableProps.createCellCoords(t,e),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),Ha(ka,this).addLocalHook("beforeTransformStart",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runLocalHooks("beforeModifyTransformStart",...e)})),Ha(ka,this).addLocalHook("afterTransformStart",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runLocalHooks("afterModifyTransformStart",...e)})),Ha(ka,this).addLocalHook("beforeTransformEnd",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runLocalHooks("beforeModifyTransformEnd",...e)})),Ha(ka,this).addLocalHook("afterTransformEnd",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runLocalHooks("afterModifyTransformEnd",...e)})),Ha(ka,this).addLocalHook("insertRowRequire",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runLocalHooks("insertRowRequire",...e)})),Ha(ka,this).addLocalHook("insertColRequire",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runLocalHooks("insertColRequire",...e)})),Ha(ka,this).addLocalHook("beforeRowWrap",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runLocalHooks("beforeRowWrap",...e)})),Ha(ka,this).addLocalHook("beforeColumnWrap",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runLocalHooks("beforeColumnWrap",...e)})),Ha(Pa,this).addLocalHook("beforeTransformStart",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runLocalHooks("beforeModifyTransformFocus",...e)})),Ha(Pa,this).addLocalHook("afterTransformStart",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runLocalHooks("afterModifyTransformFocus",...e)}))}getSelectedRange(){return this.selectedRange}markSource(t){ja(Fa,this,t)}markEndSource(){ja(Fa,this,"unknown")}getSelectionSource(){return Ha(Fa,this)}setExpectedLayers(t){ja(Va,this,t)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,ja(Va,this,-1)}isInProgress(){return this.inProgress}setRangeStart(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t;const i="multiple"===this.settings.selectionMode,s=Object(r["isUndefined"])(e)?this.tableProps.getShortcutManager().isCtrlPressed():e,a=t.clone();ja(Da,this,!1),this.runLocalHooks("beforeSetRangeStart"+(n?"Only":""),a),(!i||i&&!s&&Object(r["isUndefined"])(e))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(o.clone()),0===this.getLayerLevel()&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),n||this.setRangeEnd(t)}setRangeStartOnly(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;this.setRangeStart(t,e,!0,n)}setRangeEnd(t){if(this.selectedRange.isEmpty())return;const e=t.clone(),n=this.tableProps.countRows(),o=this.tableProps.countCols(),i=this.selectedRange.current().clone().setTo(t).isSingleHeader();if((n>0||o>0)&&(0===n&&e.col<0&&!i||0===o&&e.row<0&&!i))return;this.runLocalHooks("beforeSetRangeEnd",e),this.begin();const r=this.selectedRange.current();if(this.settings.navigableHeaders||r.highlight.normalize(),"single"===this.settings.selectionMode)r.setFrom(r.highlight),r.setTo(r.highlight);else{const t=r.getHorizontalDirection(),n=r.getVerticalDirection(),o=this.isMultiple();r.setTo(e),o&&(t!==r.getHorizontalDirection()||1===r.getWidth()&&!r.includes(r.highlight))&&r.from.assign({col:r.highlight.col}),o&&(n!==r.getVerticalDirection()||1===r.getHeight()&&!r.includes(r.highlight))&&r.from.assign({row:r.highlight.row})}n>0&&o>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!r.isSingleHeader())&&r.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const s=-1===Ha(Va,this)||this.selectedRange.size()===Ha(Va,this);this.runLocalHooks("afterSetRangeEnd",t,s)}applyAndCommit(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.selectedRange.current(),e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getLayerLevel();const n=this.tableProps.countRows(),o=this.tableProps.countCols();e<this.highlight.layerLevel&&(Object(U["arrayEach"])(this.highlight.getAreas(),t=>{t.clear()}),Object(U["arrayEach"])(this.highlight.getLayeredAreas(),t=>{t.clear()}),Object(U["arrayEach"])(this.highlight.getRowHeaders(),t=>{t.clear()}),Object(U["arrayEach"])(this.highlight.getColumnHeaders(),t=>{t.clear()}),Object(U["arrayEach"])(this.highlight.getActiveRowHeaders(),t=>{t.clear()}),Object(U["arrayEach"])(this.highlight.getActiveColumnHeaders(),t=>{t.clear()}),Object(U["arrayEach"])(this.highlight.getActiveCornerHeaders(),t=>{t.clear()}),Object(U["arrayEach"])(this.highlight.getRowHighlights(),t=>{t.clear()}),Object(U["arrayEach"])(this.highlight.getColumnHighlights(),t=>{t.clear()})),this.highlight.useLayerLevel(e);const i=this.highlight.createArea(),r=this.highlight.createLayeredArea(),s=this.highlight.createRowHeader(),a=this.highlight.createColumnHeader(),l=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),u=this.highlight.createRowHighlight(),d=this.highlight.createColumnHighlight();if(i.clear(),r.clear(),s.clear(),a.clear(),l.clear(),c.clear(),h.clear(),u.clear(),d.clear(),this.highlight.isEnabledFor(Ns["b"],t.highlight)&&(this.isMultiple()||e>=1)&&(i.add(t.from).add(t.to).commit(),r.add(t.from).add(t.to).commit(),1===e)){const t=this.selectedRange.previous();this.highlight.useLayerLevel(e-1),this.highlight.createArea().add(t.from).commit().syncWith(t),this.highlight.createLayeredArea().add(t.from).commit().syncWith(t),this.highlight.useLayerLevel(e)}if(this.highlight.isEnabledFor(Ns["g"],t.highlight)){if(!t.isSingleHeader()){const e=this.tableProps.createCellCoords(Math.max(t.from.row,0),-1),n=this.tableProps.createCellCoords(t.to.row,-1),o=this.tableProps.createCellCoords(-1,Math.max(t.from.col,0)),i=this.tableProps.createCellCoords(-1,t.to.col);"single"===this.settings.selectionMode?(s.add(e).commit(),a.add(o).commit(),u.add(e).commit(),d.add(o).commit()):(s.add(e).add(n).commit(),a.add(o).add(i).commit(),u.add(e).add(n).commit(),d.add(o).add(i).commit())}const e=!Ha(La,this)&&this.isEntireRowSelected()&&(o>0&&o===t.getWidth()||0===o&&this.isSelectedByRowHeader()),i=!Ha(La,this)&&this.isEntireColumnSelected()&&(n>0&&n===t.getHeight()||0===n&&this.isSelectedByColumnHeader());e&&l.add(this.tableProps.createCellCoords(Math.max(t.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(t.to.row,0),-1)).commit(),i&&c.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(t.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(t.to.col,0))).commit(),e&&i&&h.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(t){if(this.selectedRange.isEmpty())return;const e=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",t);const n=this.highlight.getFocus();n.clear(),e.setHighlight(t),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(Ns["f"],e.highlight)&&n.add(e.highlight).commit().syncWith(e),this.inProgress||(ja(Da,this,!0),this.runLocalHooks("afterSetFocus",e.highlight))}transformStart(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.settings.navigableHeaders?Ha(ka,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):Ha(ka,this).resetOffsetSize(),this.setRangeStart(Ha(ka,this).transformStart(t,e,n))}transformEnd(t,e){this.settings.navigableHeaders?Ha(ka,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):Ha(ka,this).resetOffsetSize(),this.setRangeEnd(Ha(ka,this).transformEnd(t,e))}transformFocus(t,e){const n=this.selectedRange.current(),{row:o,col:i}=n.getOuterTopStartCorner(),r=this.tableProps.countRenderableColumnsInRange(0,i-1),s=this.tableProps.countRenderableRowsInRange(0,o-1);n.highlight.isHeader()?Ha(Pa,this).setOffsetSize({x:i<0?Math.abs(i):-r,y:o<0?Math.abs(o):-s}):Ha(Pa,this).setOffsetSize({x:i<0?0:-r,y:o<0?0:-s});const a=Ha(Pa,this).transformStart(t,e);this.setRangeFocus(a.normalize())}shiftRows(t,e){if(!this.isSelected())return;const n=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||n.getOuterTopStartCorner().row>=t){const{from:o,to:i,highlight:r}=n,s=this.tableProps.countRows(),a=this.isSelectedByRowHeader(),l=this.isSelectedByColumnHeader(),c=l?-1:0,h=l?0:e;this.getSelectedRange().pop();const u=this.tableProps.createCellCoords(Object(K["clamp"])(o.row+h,c,s-1),o.col),d=this.tableProps.createCellCoords(Object(K["clamp"])(i.row+e,c,s-1),i.col);this.markSource("shift"),r.row>=t?this.setRangeStartOnly(u,!0,this.tableProps.createCellCoords(Object(K["clamp"])(r.row+e,0,s-1),r.col)):this.setRangeStartOnly(u,!0),a&&this.selectedByRowHeader.add(this.getLayerLevel()),l&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(d),this.markEndSource()}}shiftColumns(t,e){if(!this.isSelected())return;const n=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||n.getOuterTopStartCorner().col>=t){const{from:o,to:i,highlight:r}=n,s=this.tableProps.countCols(),a=this.isSelectedByRowHeader(),l=this.isSelectedByColumnHeader(),c=a?-1:0,h=a?0:e;this.getSelectedRange().pop();const u=this.tableProps.createCellCoords(o.row,Object(K["clamp"])(o.col+h,c,s-1)),d=this.tableProps.createCellCoords(i.row,Object(K["clamp"])(i.col+e,c,s-1));this.markSource("shift"),r.col>=t?this.setRangeStartOnly(u,!0,this.tableProps.createCellCoords(r.row,Object(K["clamp"])(r.col+e,0,s-1))):this.setRangeStartOnly(u,!0),a&&this.selectedByRowHeader.add(this.getLayerLevel()),l&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(d),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){if(!this.isSelected())return!1;const t=Object(O["createObjectPropListener"])(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",t),t.value}isFocusSelectionChanged(){return this.isSelected()&&Ha(Da,this)}isSelectedByRowHeader(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(t)&&(-1===t?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(t))}isEntireRowSelected(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();const e=t=>{const{col:e}=t.getOuterTopStartCorner(),n=this.tableProps.countRowHeaders(),o=this.tableProps.countCols();return(n>0&&e<0||0===n)&&t.getWidth()===o};if(-1===t)return Array.from(this.selectedRange).some(t=>e(t));const n=this.selectedRange.peekByIndex(t);return!!n&&e(n)}isSelectedByColumnHeader(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(-1===t?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(t))}isEntireColumnSelected(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();const e=t=>{const{row:e}=t.getOuterTopStartCorner(),n=this.tableProps.countColHeaders(),o=this.tableProps.countRows();return(n>0&&e<0||0===n)&&t.getHeight()===o};if(-1===t)return Array.from(this.selectedRange).some(t=>e(t));const n=this.selectedRange.peekByIndex(t);return!!n&&e(n)}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(t){return this.selectedRange.includes(t)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(t){const e=this.tableProps.visualToRenderableCoords(t);return null!==e.row&&null!==e.col}isAreaCornerVisible(t){return(!Number.isInteger(t)||t===this.getLayerLevel())&&(this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple())}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var t;let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const i=this.tableProps.countRows(),r=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countColHeaders(),l=n?-a:0,c=e?-s:0;if(0===l&&0===c&&(0===i||0===r))return;let h=null===(t=this.getSelectedRange().current())||void 0===t?void 0:t.highlight;const{focusPosition:u,disableHeadersHighlight:d}=o;ja(La,this,d),u&&Number.isInteger(null===u||void 0===u?void 0:u.row)&&Number.isInteger(null===u||void 0===u?void 0:u.col)&&(h=this.tableProps.createCellCoords(Object(K["clamp"])(u.row,l,i-1),Object(K["clamp"])(u.col,c,r-1)));const f=this.tableProps.createCellCoords(l,c),g=this.tableProps.createCellCoords(i-1,r-1);this.clear(),this.setRangeStartOnly(f,void 0,h),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),l<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(g),this.finish(),ja(La,this,!1)}selectCells(t){var e=this;const n=Object(Ta["c"])(t);if(n===Ta["a"])return!1;if(n===Ta["b"])throw new Error(te["a"]`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const o=Object(Ta["d"])(n,{createCellCoords:function(){return e.tableProps.createCellCoords(...arguments)},createCellRange:function(){return e.tableProps.createCellRange(...arguments)},propToCol:t=>this.tableProps.propToCol(t),keepDirection:!0}),i=this.settings.navigableHeaders,r={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:i?this.tableProps.countRowHeaders():0,countColHeaders:i?this.tableProps.countColHeaders():0},s=!t.some(t=>{const e=o(t),n=e.isValid(r);return!(n&&!e.containsHeaders()||n&&e.containsHeaders()&&e.isSingleHeader())});return s&&(this.clear(),this.setExpectedLayers(t.length),Object(U["arrayEach"])(t,t=>{const{from:e,to:n}=o(t);this.setRangeStartOnly(e.clone(),!1),this.setRangeEnd(n.clone())}),this.finish()),s}selectColumns(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const o="string"===typeof t?this.tableProps.propToCol(t):t,i="string"===typeof e?this.tableProps.propToCol(e):e,r=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countColHeaders(),l=0===a?0:-a,c=this.tableProps.createCellCoords(l,o),h=this.tableProps.createCellCoords(r-1,i),u=this.tableProps.createCellRange(c,c,h).isValid({countRows:r,countCols:s,countRowHeaders:0,countColHeaders:a});if(u){let t=0,e=0;Number.isInteger(null===n||void 0===n?void 0:n.row)&&Number.isInteger(null===n||void 0===n?void 0:n.col)?(t=Object(K["clamp"])(n.row,l,r-1),e=Object(K["clamp"])(n.col,Math.min(o,i),Math.max(o,i))):(t=Object(K["clamp"])(n,l,r-1),e=o);const s=this.tableProps.createCellCoords(t,e),c=0===a?0:Object(K["clamp"])(s.row,l,-1),h=r-1,u=this.tableProps.createCellCoords(c,o),d=this.tableProps.createCellCoords(h,i);this.runLocalHooks("beforeSelectColumns",u,d,s),u.row=c,d.row=h,this.setRangeStartOnly(u,void 0,s),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(d),this.runLocalHooks("afterSelectColumns",u,d,s),this.finish()}return u}selectRows(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const o=this.tableProps.countRows(),i=this.tableProps.countCols(),r=this.tableProps.countRowHeaders(),s=0===r?0:-r,a=this.tableProps.createCellCoords(t,s),l=this.tableProps.createCellCoords(e,i-1),c=this.tableProps.createCellRange(a,a,l).isValid({countRows:o,countCols:i,countRowHeaders:r,countColHeaders:0});if(c){let o=0,a=0;Number.isInteger(null===n||void 0===n?void 0:n.row)&&Number.isInteger(null===n||void 0===n?void 0:n.col)?(o=Object(K["clamp"])(n.row,Math.min(t,e),Math.max(t,e)),a=Object(K["clamp"])(n.col,s,i-1)):(o=t,a=Object(K["clamp"])(n,s,i-1));const l=this.tableProps.createCellCoords(o,a),c=0===r?0:Object(K["clamp"])(l.col,s,-1),h=i-1,u=this.tableProps.createCellCoords(t,c),d=this.tableProps.createCellCoords(e,h);this.runLocalHooks("beforeSelectRows",u,d,l),u.col=c,d.col=h,this.setRangeStartOnly(u,void 0,l),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(d),this.runLocalHooks("afterSelectRows",u,d,l),this.finish()}return c}refresh(){if(!this.isSelected())return;const t=this.tableProps.countRows(),e=this.tableProps.countCols();if(0===t||0===e)return void this.deselect();const n=this.selectedRange.peekByIndex(this.selectedRange.size()-1),{from:o,to:i,highlight:r}=n;this.clear(),r.assign({row:Object(K["clamp"])(r.row,-1/0,t-1),col:Object(K["clamp"])(r.col,-1/0,e-1)}),o.assign({row:Object(K["clamp"])(o.row,-1/0,t-1),col:Object(K["clamp"])(o.col,-1/0,e-1)}),i.assign({row:Object(K["clamp"])(i.row,0,t-1),col:Object(K["clamp"])(i.col,0,e-1)}),this.selectedRange.ranges.push(n),this.highlight.getFocus().add(r).commit().syncWith(n),this.applyAndCommit(n)}commit(){const t=this.highlight.getCustomSelections();if(t.forEach(t=>{t.commit()}),!this.isSelected())return;const e=this.highlight.getFocus(),n=this.getLayerLevel();e.commit().syncWith(this.selectedRange.current());for(let o=0;o<this.selectedRange.size();o+=1){this.highlight.useLayerLevel(o);const t=this.highlight.createArea(),e=this.highlight.createLayeredArea(),n=this.highlight.createRowHeader(),i=this.highlight.createColumnHeader(),r=this.highlight.createActiveRowHeader(),s=this.highlight.createActiveColumnHeader(),a=this.highlight.createActiveCornerHeader(),l=this.highlight.createRowHighlight(),c=this.highlight.createColumnHighlight();t.commit(),e.commit(),n.commit(),i.commit(),r.commit(),s.commit(),a.commit(),l.commit(),c.commit()}this.highlight.useLayerLevel(n)}}Object(O["mixin"])(Wa,jr["a"]);var Ba=Wa,Ua=n("76ab");function za(t,e){var n;return"CELL_TYPE"!==t&&((null===(n=e._automaticallyAssignedMetaProps)||void 0===n?void 0:n.has(t))||!Object(O["hasOwnProperty"])(e,t))}function Ga(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;const o="string"===typeof e.type?Object(Ua["a"])(e.type):e.type;if(t._automaticallyAssignedMetaProps&&Object(O["objectEach"])(e,(e,n)=>{t._automaticallyAssignedMetaProps.delete(n)}),!Object(O["isObject"])(o))return;n!==t||t._automaticallyAssignedMetaProps||(t._automaticallyAssignedMetaProps=new Set);const i={};Object(O["objectEach"])(o,(e,o)=>{var r;za(o,n)&&(i[o]=e,null===(r=t._automaticallyAssignedMetaProps)||void 0===r||r.add(o))}),Object(O["extend"])(t,i)}function Ya(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];function n(){}Object(O["inherit"])(n,t);for(let o=0;o<e.length;o++)n.prototype[e[o]]=void 0;return n}function Xa(t){return Number.isInteger(t)&&t>=0}function $a(t,e){if(!t())throw new Error("Assertion failed: "+e)}function Ka(t){return null===t||void 0===t}var qa=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,n,o;for(e=0,n=this.countRows();e<n;e++)if(o=this.getDataAtCell(e,t),!1===Object(r["isEmpty"])(o))return!1;return!0},isEmptyRow(t){let e,n,o,i;for(e=0,n=this.countCols();e<n;e++)if(o=this.getDataAtCell(t,e),!1===Object(r["isEmpty"])(o))return"object"===typeof o&&(i=this.getCellMeta(t,e),Object(O["isObjectEqual"])(this.getSchema()[i.prop],o));return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0});function Qa(t,e,n){return(e=Ja(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ja(t){var e=Za(t,"string");return"symbol"==typeof e?e:e+""}function Za(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function tl(){return class{}}class el{constructor(t){Qa(this,"metaCtor",tl()),Qa(this,"meta",void 0),this.meta=this.metaCtor.prototype,Object(O["extend"])(this.meta,qa()),this.meta.instance=t}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(t){var e;Object(O["extend"])(this.meta,t),Ga(this.meta,{...t,type:null!==(e=t.type)&&void 0!==e?e:this.meta.type},t)}}function nl(t,e,n){return(e=ol(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ol(t){var e=il(t,"string");return"symbol"==typeof e?e:e+""}function il(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class rl{constructor(t){nl(this,"meta",void 0);const e=t.getMetaConstructor();this.meta=new e}getMeta(){return this.meta}updateMeta(t){Object(O["extend"])(this.meta,t),Ga(this.meta,t,t)}}function sl(t,e,n){return(e=al(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function al(t){var e=ll(t,"string");return"symbol"==typeof e?e:e+""}function ll(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class cl{constructor(t){sl(this,"valueFactory",void 0),sl(this,"data",[]),sl(this,"index",[]),sl(this,"holes",new Set),this.valueFactory=t}obtain(t){$a(()=>Xa(t),"Expecting an unsigned number.");const e=this._getStorageIndexByKey(t);let n;if(e>=0)n=this.data[e],void 0===n&&(n=this.valueFactory(t),this.data[e]=n);else if(n=this.valueFactory(t),this.holes.size>0){const e=this.holes.values().next().value;this.holes.delete(e),this.data[e]=n,this.index[t]=e}else this.data.push(n),this.index[t]=this.data.length-1;return n}insert(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;$a(()=>Xa(t)||Ka(t),"Expecting an unsigned number or null/undefined argument.");const n=[],o=this.data.length;for(let r=0;r<e;r++)n.push(o+r),this.data.push(void 0);const i=Ka(t)?this.index.length:t;this.index=[...this.index.slice(0,i),...n,...this.index.slice(i)]}remove(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;$a(()=>Xa(t)||Ka(t),"Expecting an unsigned number or null/undefined argument.");const n=this.index.splice(Ka(t)?this.index.length-e:t,e);for(let o=0;o<n.length;o++){const t=n[o];"number"===typeof t&&this.holes.add(t)}}size(){return this.data.length-this.holes.size}values(){return Object(U["arrayFilter"])(this.data,(t,e)=>!this.holes.has(e))[Symbol.iterator]()}entries(){const t=[];for(let n=0;n<this.data.length;n++){const e=this._getKeyByStorageIndex(n);-1!==e&&t.push([e,this.data[n]])}let e=0;return{next:()=>{if(e<t.length){const n=t[e];return e+=1,{value:n,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(t){return this.index.length>t?this.index[t]:-1}_getKeyByStorageIndex(t){return this.index.indexOf(t)}[Symbol.iterator](){return this.entries()}}function hl(t,e,n){return(e=ul(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ul(t){var e=dl(t,"string");return"symbol"==typeof e?e:e+""}function dl(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}const fl=["data","width"];class gl{constructor(t){hl(this,"globalMeta",void 0),hl(this,"metas",new cl(()=>this._createMeta())),this.globalMeta=t,this.metas=new cl(()=>this._createMeta())}updateMeta(t,e){const n=this.getMeta(t);Object(O["extend"])(n,e),Ga(n,e)}createColumn(t,e){this.metas.insert(t,e)}removeColumn(t,e){this.metas.remove(t,e)}getMeta(t){return this.metas.obtain(t)}getMetaConstructor(t){return this.metas.obtain(t).constructor}clearCache(){this.metas.clear()}_createMeta(){return Ya(this.globalMeta.getMetaConstructor(),fl).prototype}}function pl(t,e,n){return(e=ml(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ml(t){var e=bl(t,"string");return"symbol"==typeof e?e:e+""}function bl(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class wl{constructor(t){pl(this,"columnMeta",void 0),pl(this,"metas",new cl(()=>this._createRow())),this.columnMeta=t}updateMeta(t,e,n){const o=this.getMeta(t,e);Object(O["extend"])(o,n),Ga(o,n)}createRow(t,e){this.metas.insert(t,e)}createColumn(t,e){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).insert(t,e)}removeRow(t,e){this.metas.remove(t,e)}removeColumn(t,e){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).remove(t,e)}getMeta(t,e,n){const o=this.metas.obtain(t).obtain(e);return void 0===n?o:o[n]}setMeta(t,e,n,o){var i;const r=this.metas.obtain(t).obtain(e);null===(i=r._automaticallyAssignedMetaProps)||void 0===i||i.delete(n),r[n]=o}removeMeta(t,e,n){const o=this.metas.obtain(t).obtain(e);delete o[n]}getMetas(){const t=[],e=Array.from(this.metas.values());for(let n=0;n<e.length;n++)Object(r["isDefined"])(e[n])&&t.push(...e[n].values());return t}getMetasAtRow(t){$a(()=>Xa(t),"Expecting an unsigned number.");const e=new Map(this.metas);return e.has(t)?Array.from(e.get(t).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new cl(t=>this._createMeta(t))}_createMeta(t){const e=this.columnMeta.getMetaConstructor(t);return new e}}class vl{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this.hot=t,this.globalMeta=new el(t),this.tableMeta=new rl(this.globalMeta),this.columnMeta=new gl(this.globalMeta),this.cellMeta=new wl(this.columnMeta),n.forEach(t=>new t(this)),this.globalMeta.updateMeta(e)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(t){this.globalMeta.updateMeta(t)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(t){this.tableMeta.updateMeta(t)}getColumnMeta(t){return this.columnMeta.getMeta(t)}updateColumnMeta(t,e){this.columnMeta.updateMeta(t,e)}getCellMeta(t,e,n){let{visualRow:o,visualColumn:i}=n;const r=this.cellMeta.getMeta(t,e);return r.visualRow=o,r.visualCol=i,r.row=t,r.col=e,this.runLocalHooks("afterGetCellMeta",r),r}getCellMetaKeyValue(t,e,n){if("string"!==typeof n)throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(t,e,n)}setCellMeta(t,e,n,o){this.cellMeta.setMeta(t,e,n,o)}updateCellMeta(t,e,n){this.cellMeta.updateMeta(t,e,n)}removeCellMeta(t,e,n){this.cellMeta.removeMeta(t,e,n)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(t){return this.cellMeta.getMetasAtRow(t)}createRow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createRow(t,e)}removeRow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeRow(t,e)}createColumn(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createColumn(t,e),this.columnMeta.createColumn(t,e)}removeColumn(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeColumn(t,e),this.columnMeta.removeColumn(t,e)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}function yl(t,e,n){return(e=Cl(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cl(t){var e=Sl(t,"string");return"symbol"==typeof e?e:e+""}function Sl(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}Object(O["mixin"])(vl,jr["a"]);class Ol{constructor(t){yl(this,"metaManager",void 0),yl(this,"metaSyncMemo",new Map),this.metaManager=t,t.addLocalHook("afterGetCellMeta",t=>this.extendCellMeta(t)),os["a"].getSingleton().add("beforeRender",t=>{t&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(t){var e;const{row:n,col:o}=t;if(null!==(e=this.metaSyncMemo.get(n))&&void 0!==e&&e.has(o))return;const{visualRow:r,visualCol:s}=t,a=this.metaManager.hot,l=a.colToProp(s);t.prop=l,a.runHooks("beforeGetCellMeta",r,s,t);const c=Object(O["hasOwnProperty"])(t,"type")?t.type:null;let h=Object(i["isFunction"])(t.cells)?t.cells(n,o,l):null;var u;c&&(h?h.type=null!==(u=h.type)&&void 0!==u?u:c:h={type:c});h&&this.metaManager.updateCellMeta(n,o,h),a.runHooks("afterGetCellMeta",r,s,t),this.metaSyncMemo.has(n)||this.metaSyncMemo.set(n,new Set),this.metaSyncMemo.get(n).add(o)}}function El(t,e,n){Rl(t,e),e.set(t,n)}function Rl(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tl(t,e,n){return(e=Ml(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ml(t){var e=Il(t,"string");return"symbol"==typeof e?e:e+""}function Il(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function xl(t,e){return t.get(Nl(t,e))}function Nl(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Al=new WeakMap;class Hl{constructor(t){Tl(this,"metaManager",void 0),Tl(this,"usageTracker",new Set),Tl(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(t){const e=this.metaManager.hot.isRtl();if(e&&"fixedColumnsLeft"===t)throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),El(this,Al,(t,e,n)=>{if(!n)throw new Error(`The \`${t}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=t,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((t,e)=>{const{initOnly:n,target:o,onChange:i}=t,r="string"===typeof o,s=r?o:e,a="_"+s;this.metaManager.globalMeta.meta[a]=this.metaManager.globalMeta.meta[s],i?(this.installPropWatcher(e,a,i),r&&this.installPropWatcher(o,a,i)):n&&(this.installPropWatcher(e,a,xl(Al,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(e))})}installPropWatcher(t,e,n){const o=this;Object.defineProperty(this.metaManager.globalMeta.meta,t,{get(){return this[e]},set(i){const r=!o.usageTracker.has(t);o.usageTracker.add(t),n.call(o,t,i,r),this[e]=i},enumerable:!0,configurable:!0})}}var jl=n("3bc4");function _l(t,e,n){return(e=kl(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kl(t){var e=Pl(t,"string");return"symbol"==typeof e?e:e+""}function Pl(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Dl{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(t,e,n){_l(this,"hot",void 0),_l(this,"metaManager",void 0),_l(this,"tableMeta",void 0),_l(this,"dataSource",void 0),_l(this,"duckSchema",void 0),_l(this,"colToPropCache",void 0),_l(this,"propToColCache",void 0),this.hot=t,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=e,this.duckSchema=this.createDuckSchema(),this.createMap()}createMap(){const t=this.getSchema();if("undefined"===typeof t)throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const e=this.tableMeta.columns;let n;if(this.colToPropCache=[],this.propToColCache=new Map,e){let o=0,i=0,r=!1;if("function"===typeof e){const e=Object(O["deepObjectSize"])(t);o=e>0?e:this.countFirstRowKeys(),r=!0}else{const t=this.tableMeta.maxCols;o=Math.min(t,e.length)}for(n=0;n<o;n++){const t=r?e(n):e[n];if(Object(O["isObject"])(t)){if("undefined"!==typeof t.data){const e=r?i:n;this.colToPropCache[e]=t.data,this.propToColCache.set(t.data,e)}i+=1}}}else this.recursiveDuckColumns(t)}countFirstRowKeys(){return Object(fr["countFirstRowKeys"])(this.dataSource)}recursiveDuckColumns(t,e,n){let o,i=e,r=n;return"undefined"===typeof i&&(i=0,r=""),"object"!==typeof t||Array.isArray(t)||Object(O["objectEach"])(t,(t,e)=>{null===t?(o=r+e,this.colToPropCache.push(o),this.propToColCache.set(o,i),i+=1):i=this.recursiveDuckColumns(t,i,e+".")}),i}colToProp(t){if(!1===Number.isInteger(t))return t;const e=this.hot.toPhysicalColumn(t);return null===e?t:this.colToPropCache&&Object(r["isDefined"])(this.colToPropCache[e])?this.colToPropCache[e]:e}propToCol(t){const e=this.propToColCache.get(t);if(Object(r["isDefined"])(e))return this.hot.toVisualColumn(e);const n=this.hot.toVisualColumn(t);return null===n?t:n}getSchema(){const t=this.tableMeta.dataSchema;return t?"function"===typeof t?t():t:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?Object(O["duckSchema"])(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,{source:n,mode:o="above"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=this.hot.countSourceRows();let r=i,s=0,a=t;("number"!==typeof a||a>=i)&&(a=i),a<this.hot.countRows()&&(r=this.hot.toPhysicalRow(a));const l=this.hot.runHooks("beforeCreateRow",a,e,n);if(!1===l||null===r)return{delta:0};const c=this.tableMeta.maxRows,h=this.getSchema().length,u=[];while(s<e&&i+s<c){let t=null;"array"===this.hot.dataType?this.tableMeta.dataSchema?t=Object(O["deepClone"])(this.getSchema()):(t=[],Object(K["rangeEach"])(h-1,()=>t.push(null))):"function"===this.hot.dataType?t=this.tableMeta.dataSchema(a+s):(t={},Object(O["deepExtend"])(t,this.getSchema())),u.push(t),s+=1}this.hot.rowIndexMapper.insertIndexes(a,s),"below"===o&&(r=Math.min(r+1,i)),this.spliceData(r,0,u);const d=this.hot.toVisualRow(r);return this.hot.countSourceRows()===u.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),s>0&&(void 0===t||null===t?this.metaManager.createRow(null,s):"auto"!==n&&this.metaManager.createRow(r,e)),this.hot.runHooks("afterCreateRow",d,s,n),this.hot.forceFullRender=!0,{delta:s,startPhysicalIndex:r}}createCol(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,{source:n,mode:o="start"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const i=this.dataSource,r=this.tableMeta.maxCols,s=this.hot.countSourceCols();let a=t;("number"!==typeof a||a>=s)&&(a=s);const l=this.hot.runHooks("beforeCreateCol",a,e,n);if(!1===l)return{delta:0};let c=s;a<this.hot.countCols()&&(c=this.hot.toPhysicalColumn(a));const h=this.hot.countSourceRows();let u=this.hot.countCols(),d=0,f=c;"end"===o&&(f=Math.min(f+1,s));const g=f;while(d<e&&u<r){if("number"!==typeof a||a>=u)if(h>0)for(let t=0;t<h;t+=1)"undefined"===typeof i[t]&&(i[t]=[]),i[t].push(null);else i.push([null]);else for(let t=0;t<h;t++)i[t].splice(f,0,null);d+=1,f+=1,u+=1}this.hot.columnIndexMapper.insertIndexes(a,d),d>0&&(void 0===t||null===t?this.metaManager.createColumn(null,d):"auto"!==n&&this.metaManager.createColumn(g,e));const p=this.hot.toVisualColumn(g);return this.hot.runHooks("afterCreateCol",p,d,n),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:d,startPhysicalIndex:g}}removeRow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,o=Number.isInteger(t)?t:-e;const i=this.visualRowsToPhysical(o,e),s=this.hot.countSourceRows();o=(s+o)%s;const a=this.hot.runHooks("beforeRemoveRow",o,i.length,i,n);if(!1===a)return!1;const l=i.length;if(this.filterData(o,l,i),o<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(i);const t=Object(r["isDefined"])(this.tableMeta.columns)||Object(r["isDefined"])(this.tableMeta.dataSchema);0===this.hot.rowIndexMapper.getNotTrimmedIndexesLength()&&!1===t&&this.hot.columnIndexMapper.setIndexesSequence([])}const c=i.slice(0).sort((t,e)=>e-t);return c.forEach(t=>{this.metaManager.removeRow(t,1)}),this.hot.runHooks("afterRemoveRow",o,l,i,n),this.hot.forceFullRender=!0,!0}removeCol(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;if("object"===this.hot.dataType||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let o="number"!==typeof t?-e:t;o=(this.hot.countCols()+o)%this.hot.countCols();const i=this.visualColumnsToPhysical(o,e),r=i.slice(0).sort((t,e)=>e-t),s=this.hot.runHooks("beforeRemoveCol",o,e,i,n);if(!1===s)return!1;let a=!0;const l=r.length,c=this.dataSource;for(let h=0;h<l;h++)a&&i[0]!==i[h]-h&&(a=!1);if(a)for(let h=0,u=this.hot.countSourceRows();h<u;h++)c[h].splice(i[0],e),0===h&&this.metaManager.removeColumn(i[0],e);else for(let h=0,u=this.hot.countSourceRows();h<u;h++)for(let t=0;t<l;t++)c[h].splice(r[t],1),0===h&&this.metaManager.removeColumn(r[t],1);return o<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(i),0===this.hot.columnIndexMapper.getNotTrimmedIndexesLength()&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",o,e,i,n),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(t,e,n){const o=this.hot.getDataAtCol(t),i=o.slice(e,e+n),r=o.slice(e+n);for(var s=arguments.length,a=new Array(s>3?s-3:0),l=3;l<s;l++)a[l-3]=arguments[l];Object(U["extendArray"])(a,r);let c=0;while(c<n)a.push(null),c+=1;return Object(U["to2dArray"])(a),this.hot.populateFromArray(e,t,a,null,null,"spliceCol"),i}spliceRow(t,e,n){const o=this.hot.getSourceDataAtRow(t),i=o.slice(e,e+n),r=o.slice(e+n);for(var s=arguments.length,a=new Array(s>3?s-3:0),l=3;l<s;l++)a[l-3]=arguments[l];Object(U["extendArray"])(a,r);let c=0;while(c<n)a.push(null),c+=1;return this.hot.populateFromArray(t,e,[a],null,null,"spliceRow"),i}spliceData(t,e,n){const o=this.hot.runHooks("beforeDataSplice",t,e,n);if(!1!==o){const e=[...this.dataSource.slice(0,t),...n,...this.dataSource.slice(t)];this.dataSource.length=0,e.forEach(t=>this.dataSource.push(t))}}filterData(t,e,n){let o=this.hot.runHooks("filterData",t,e,n);!1===Array.isArray(o)&&(o=this.dataSource.filter((t,e)=>-1===n.indexOf(e))),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,o)}get(t,e){const n=this.hot.toPhysicalRow(t);let o=this.dataSource[n];const i=this.hot.runHooks("modifyRowData",n);o=isNaN(i)?i:o;const{dataDotNotation:r}=this.hot.getSettings();let s=null;if(o&&o.hasOwnProperty&&Object(O["hasOwnProperty"])(o,e))s=o[e];else if(r&&"string"===typeof e&&e.indexOf(".")>-1){let t=o;if(!t)return null;const n=e.split(".");for(let e=0,o=n.length;e<o;e++)if(t=t[n[e]],"undefined"===typeof t)return null;s=t}else"function"===typeof e&&(s=e(this.dataSource.slice(n,n+1)[0]));if(this.hot.hasHook("modifyData")){const t=Object(O["createObjectPropListener"])(s);this.hot.runHooks("modifyData",n,this.propToCol(e),t,"get"),t.isTouched()&&(s=t.value)}return s}getCopyable(t,e){return this.hot.getCellMeta(t,this.propToCol(e)).copyable?this.get(t,e):""}set(t,e,n){const o=this.hot.toPhysicalRow(t);let i=n,r=this.dataSource[o];const s=this.hot.runHooks("modifyRowData",o);if(r=isNaN(s)?s:r,this.hot.hasHook("modifyData")){const t=Object(O["createObjectPropListener"])(i);this.hot.runHooks("modifyData",o,this.propToCol(e),t,"set"),t.isTouched()&&(i=t.value)}const{dataDotNotation:a}=this.hot.getSettings();if(r&&r.hasOwnProperty&&Object(O["hasOwnProperty"])(r,e))r[e]=i;else if(a&&"string"===typeof e&&e.indexOf(".")>-1){let t,n=r,o=0;const s=e.split(".");for(o=0,t=s.length-1;o<t;o++)"undefined"===typeof n[s[o]]&&(n[s[o]]={}),n=n[s[o]];n[s[o]]=i}else"function"===typeof e?e(this.dataSource.slice(o,o+1)[0],i):r[e]=i}visualRowsToPhysical(t,e){const n=this.hot.countSourceRows(),o=[];let i,r=(n+t)%n,s=e;while(r<n&&s)i=this.hot.toPhysicalRow(r),o.push(i),s-=1,r+=1;return o}visualColumnsToPhysical(t,e){const n=this.hot.countCols(),o=[];let i=(n+t)%n,r=e;while(i<n&&r){const t=this.hot.toPhysicalColumn(i);o.push(t),r-=1,i+=1}return o}clear(){for(let t=0;t<this.hot.countSourceRows();t++)for(let e=0;e<this.hot.countCols();e++)this.set(t,this.colToProp(e),"")}getLength(){const t=this.tableMeta.maxRows;let e;e=t<0||0===t?0:t||1/0;const n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(n,e)}getAll(){const t={row:0,col:0},e={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return t.row-e.row!==0||this.hot.countSourceRows()?this.getRange(t,e,Dl.DESTINATION_RENDERER):[]}countCachedColumns(){return this.colToPropCache.length}getRange(t,e,n){const o=[];let i,r,s;const a=this.tableMeta.maxRows,l=this.tableMeta.maxCols;if(0===a||0===l)return[];const c=n===Dl.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(a-1,0),Math.max(t.row,e.row)),u=Math.min(Math.max(l-1,0),Math.max(t.col,e.col));for(i=Math.min(t.row,e.row);i<=h;i++){s=[];const n=i>=0?this.hot.toPhysicalRow(i):i;for(r=Math.min(t.col,e.col);r<=u;r++){if(null===n)break;s.push(c.call(this,i,this.colToProp(r)))}null!==n&&o.push(s)}return o}getText(t,e){return Object(jl["b"])(this.getRange(t,e,Dl.DESTINATION_RENDERER))}getCopyableText(t,e){return Object(jl["b"])(this.getRange(t,e,Dl.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}var Ll=Dl;function Fl(t,e,n,r){const{hotInstance:s,dataMap:a,dataSource:l,internalSource:c,source:h,metaManager:u,firstRun:d}=r,f=Object($["toUpperCaseFirst"])(c),g=s.getSettings();Array.isArray(g.dataSchema)?s.dataType="array":Object(i["isFunction"])(g.dataSchema)?s.dataType="function":s.dataType="object",a&&a.destroy(),t=s.runHooks("before"+f,t,d,h);const p=new Ll(s,t,u);if(e(p),"object"===typeof t&&null!==t)t.push&&t.splice||(t=[t]);else{if(null!==t)throw new Error(`${c} only accepts array of objects or array of arrays (${typeof t} given)`);{const e=p.getSchema();let n;t=[];let o=0,i=0;for(o=0,i=g.startRows;o<i;o++)if("object"!==s.dataType&&"function"!==s.dataType||!g.dataSchema)if("array"===s.dataType)n=Object(O["deepClone"])(e[0]),t.push(n);else{n=[];for(let t=0,e=g.startCols;t<e;t++)n.push(null);t.push(n)}else n=Object(O["deepClone"])(e),t.push(n)}}Array.isArray(t[0])&&(s.dataType="array"),g.data=t,p.dataSource=t,l.data=t,l.dataType=s.dataType,l.colToProp=p.colToProp.bind(p),l.propToCol=p.propToCol.bind(p),l.countCachedColumns=p.countCachedColumns.bind(p),n(p),s.runHooks("after"+f,t,d,h),d||(s.runHooks("afterChange",null,c),s.render()),s.getSettings().ariaTags&&Object(o["setAttribute"])(s.rootElement,[Object($t["C"])(-1),Object($t["e"])(s.countCols()+(s.view?s.countRowHeaders():0))])}function Vl(t){return e=>{let{col:n}=e;t.scrollViewportTo({col:n})}}function Wl(){return()=>{}}function Bl(t){return e=>{t.scrollViewportTo(e.toObject())}}function Ul(t){return e=>{t.scrollViewportTo(e.toObject())}}function zl(t){return e=>{t.scrollViewportTo(e.toObject())}}function Gl(t){return e=>{let{row:n}=e;t.scrollViewportTo({row:n})}}function Yl(t){return e=>{const n=t.selection.getSelectionSource(),{row:o,col:i}=e;if(o<0&&i>=0)t.scrollViewportTo({col:i});else if(i<0&&o>=0)t.scrollViewportTo({row:o});else{if("mouse"===n&&(i===t.view.getLastPartiallyVisibleColumn()||o===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:o,col:i})}}}function Xl(t){const{selection:e}=t;let n=!1,o=!1;return{resume(){o=!1},suspend(){o=!0},skipNextScrollCycle(){n=!0},scrollTo(i){var r;if(n||o)return void(n=!1);let s;e.isFocusSelectionChanged()?s=Bl(t):e.isSelectedByCorner()?s=Wl(t):e.isSelectedByRowHeader()?s=Gl(t):e.isSelectedByColumnHeader()?s=Vl(t):1===e.getSelectedRange().size()&&e.isMultiple()?s=Ul(t):1!==e.getSelectedRange().size()||e.isMultiple()?e.getSelectedRange().size()>1&&(s=zl(t)):s=Yl(t),null===(r=s)||void 0===r||r(i)}}}var $l=n("c4fa");function Kl(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=t.rootElement,o=ql(t),i=ql(t);return o.addEventListener("focus",()=>null===e||void 0===e?void 0:e.onFocusFromTop()),i.addEventListener("focus",()=>null===e||void 0===e?void 0:e.onFocusFromBottom()),n.firstChild.before(o),n.lastChild.after(i),{activate(){t._registerTimeout(()=>{o.tabIndex=0,i.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{o.tabIndex=-1,i.tabIndex=-1},10)}}}function ql(t){const e=t.rootDocument,n=e.createElement("input");return n.type="text",n.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&Object(o["setAttribute"])(n,[Object($t["y"])(),Object($t["n"])()]),n}function Ql(t){const e=tc(t);let n;const{activate:o,deactivate:i}=Kl(t,{onFocusFromTop(){var o;const i=null!==(o=e(n))&&void 0!==o?o:Jl(t);i&&(t.runHooks("modifyFocusOnTabNavigation","from_above",i),t.selectCell(i.row,i.col)),t.listen()},onFocusFromBottom(){var o;const i=null!==(o=e(n))&&void 0!==o?o:Zl(t);i&&(t.runHooks("modifyFocusOnTabNavigation","from_below",i),t.selectCell(i.row,i.col)),t.listen()}}),r={wrapped:!1,flipped:!1};let s=!0,a=!1,l=!1;function c(){r.wrapped=!1,r.flipped=!1,t.deselectCell(),t.unlisten()}t.addHook("afterListen",()=>i()),t.addHook("afterUnlisten",()=>o()),t.addHook("afterSelection",(e,o,i,c,h)=>{var u;(a&&(r.wrapped&&r.flipped||l)&&(l=!1,h.value=!0),s)&&(n=null===(u=t.getSelectedRangeLast())||void 0===u?void 0:u.highlight)}),t.addHook("beforeRowWrap",(t,e,n)=>{r.wrapped=!0,r.flipped=n});const h={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:$l["b"],group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...h,callback:()=>{const{tabNavigation:e}=t.getSettings();a=!0,t.getSelectedRangeLast()&&!e&&(s=!1),e||(l=!0)},position:"before"},{...h,callback:e=>{const{tabNavigation:o,autoWrapRow:i}=t.getSettings();if(a=!1,s=!0,!o||!t.selection.isSelected()||i&&r.wrapped&&r.flipped||!i&&r.wrapped)return i&&r.wrapped&&r.flipped&&(n=e.shiftKey?Jl(t):Zl(t)),c(),!1;e.preventDefault()},position:"after"}])}function Jl(t){const{rowIndexMapper:e,columnIndexMapper:n}=t,{navigableHeaders:o}=t.getSettings();let i=o&&t.countColHeaders()>0?-t.countColHeaders():0,r=o&&t.countRowHeaders()>0?-t.countRowHeaders():0;return 0===i&&(i=e.getVisualFromRenderableIndex(i)),0===r&&(r=n.getVisualFromRenderableIndex(r)),null===i||null===r?null:t._createCellCoords(i,r)}function Zl(t){var e,n;const{rowIndexMapper:o,columnIndexMapper:i}=t,{navigableHeaders:r}=t.getSettings();let s=o.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(s<0){if(!r||0===t.countColHeaders())return null;s=-1}if(a<0){if(!r||0===t.countColHeaders())return null;a=-1}return t._createCellCoords(null!==(e=o.getVisualFromRenderableIndex(s))&&void 0!==e?e:s,null!==(n=i.getVisualFromRenderableIndex(a))&&void 0!==n?n:a)}function tc(t){return e=>{if(!e)return null;const n=Jl(t),o=Zl(t);return e.col<n.col&&(e.col=n.col),e.col>o.col&&(e.col=o.col),e.row<n.row&&(e.row=n.row),e.row>o.row&&(e.row=o.row),e}}var ec=n("6906");const nc=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),oc=t=>t.map(t=>{const e=t.toLowerCase();return nc.has(e)?nc.get(e):e}).sort().join("+"),ic=t=>t.split("+"),rc=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),sc=t=>{let{which:e,key:n}=t;if(rc.has(e))return rc.get(e);const o=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(o)?o:n.toLowerCase()},ac=Symbol("shortcut-context");function lc(t){return Object(O["isObject"])(t)&&t.__kindOf===ac}const cc=t=>{const e=Object(ec["a"])({errorIdExists:e=>`The "${e}" shortcut is already registered in the "${t}" context.`}),n=function(){let{keys:t,callback:n,group:o,runOnlyIf:s=(()=>!0),captureCtrl:a=!1,preventDefault:l=!0,stopPropagation:c=!1,relativeToGroup:h,position:u,forwardToContext:d}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Object(r["isUndefined"])(o))throw new Error("You need to define the shortcut's group.");if(!1===Object(i["isFunction"])(n))throw new Error("The shortcut's callback needs to be a function.");if(!1===Array.isArray(t))throw new Error(te["a"]`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const f={callback:n,group:o,runOnlyIf:s,captureCtrl:a,preventDefault:l,stopPropagation:c};Object(r["isDefined"])(h)&&(f.relativeToGroup=h,f.position=u),lc(d)&&(f.forwardToContext=d),t.forEach(t=>{const n=oc(t),o=e.hasItem(n);if(o){const t=e.getItem(n);let o=t.findIndex(t=>t.group===h);-1!==o?"before"===u?o-=1:o+=1:o=t.length,t.splice(o,0,f)}else e.addItem(n,[f])})},o=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.forEach(t=>{Object(O["objectEach"])(e,(n,o)=>{!1===Object.prototype.hasOwnProperty.call(t,o)&&(t[o]=e[o])}),n(t)})},s=t=>{const n=oc(t);e.removeItem(n)},a=t=>{const n=e.getItems();n.forEach(e=>{let[n,o]=e;const i=o.filter(e=>e.group!==t);0===i.length?s(ic(n)):(o.length=0,o.push(...i))})},l=t=>{const n=oc(t),o=e.getItem(n);return Object(r["isDefined"])(o)?o.slice():[]},c=t=>{const n=oc(t);return e.hasItem(n)};return{__kindOf:ac,addShortcut:n,addShortcuts:o,getShortcuts:l,hasShortcut:c,removeShortcutsByKeys:s,removeShortcutsByGroup:a}};function hc(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const uc=["meta","alt","shift","control"],dc=hc(),fc=[];let gc=0;function pc(t,e,n,i,r){const a=t=>uc.includes(t),c=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=[];return t.altKey&&n.push("alt"),e&&(t.ctrlKey||t.metaKey)?n.push("control/meta"):(t.ctrlKey&&n.push("control"),t.metaKey&&n.push("meta")),t.shiftKey&&n.push("shift"),n},h=t=>{if(!1===e(t))return;const o=n(t);if(229===t.keyCode||!1===o||Object(l["isImmediatePropagationStopped"])(t))return;const h=sc(t);let u=[];a(h)||(u=c(t));const d=[h].concat(u),f=r(t,d);!f&&(Object(s["isMacOS"])()&&u.includes("meta")||!Object(s["isMacOS"])()&&u.includes("control"))&&r(t,[h].concat(c(t,!0))),i(t)},u=t=>{if(t.key){const e=sc(t);a(e)&&dc.press(e)}},d=t=>{if(t.key){const e=sc(t);a(e)&&dc.release(e)}},f=()=>{dc.releaseAll()},g=()=>{let e=t;gc+=1;while(e)1===gc&&(e.document.documentElement.addEventListener("keydown",u),fc.push({event:"keydown",listener:u}),e.document.documentElement.addEventListener("keyup",d),fc.push({event:"keyup",listener:d})),e.document.documentElement.addEventListener("keydown",h),e.document.documentElement.addEventListener("blur",f),e=Object(o["getParentWindow"])(e)},p=()=>{let e=t;gc-=1;while(e){if(0===gc){for(let t=0;t<fc.length;t++){const{event:n,listener:o}=fc[t];e.document.documentElement.removeEventListener(n,o)}fc.length=0}e.document.documentElement.removeEventListener("keydown",h),e.document.documentElement.removeEventListener("blur",f),e=Object(o["getParentWindow"])(e)}};return{mount:g,unmount:p,isPressed:t=>dc.isPressed(t),releasePressedKeys:()=>dc.releaseAll()}}const mc=t=>{let{ownerWindow:e,handleEvent:n,beforeKeyDown:o,afterKeyDown:i}=t;const r=Object(ec["a"])({errorIdExists:t=>`The "${t}" context name is already registered.`});let s="grid";const a=t=>{const e=cc(t);return r.addItem(t,e),e},c=()=>s,h=t=>r.getItem(t),u=t=>{if(!r.hasItem(t))throw new Error(te["a"]`You've tried to activate the "${t}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=t};let d=!1;const f=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:c();const o=lc(n)?n:h(n);let i=!1;if(!o.hasShortcut(e))return i;const r=o.getShortcuts(e);for(let s=0;s<r.length;s++){const{callback:n,runOnlyIf:o,preventDefault:a,stopPropagation:c,captureCtrl:h,forwardToContext:u}=r[s];if(!0===o(t)){if(d=h,i=!1===n(t,e),d=!1,a&&t.preventDefault(),c&&(Object(l["stopImmediatePropagation"])(t),t.stopPropagation()),i)break;u&&f(t,e,u)}}return i},g=pc(e,n,o,i,f);return g.mount(),{addContext:a,getActiveContextName:c,getContext:h,setActiveContextName:u,isCtrlPressed:()=>!d&&(g.isPressed("control")||g.isPressed("meta")),releasePressedKeys:()=>g.releasePressedKeys(),destroy:()=>g.unmount()}};var bc=n("1e8c");let wc=null;const vc=new Map;new Set;function yc(t,e){var n,a=this;let l=arguments.length>2&&void 0!==arguments[2]&&arguments[2],u=this;const d=new h["a"](u);let f,g,p,m,b,w,v=!0;zi(l)&&Ui(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const y=null!==(n=null===e||void 0===e?void 0:e.layoutDirection)&&void 0!==n?n:"inherit",C=["rtl","ltr"].includes(y)?y:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",C),this.isRtl=function(){return"rtl"===C},this.isLtr=function(){return!u.isRtl()},this.getDirectionFactor=function(){return u.isLtr()?1:-1},e.language=xs(e.language);const E=new vl(u,e,[Ol,Hl]),R=E.getTableMeta(),T=E.getGlobalMeta(),M=Object(ec["a"])();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,t.insertBefore(this.container,t.firstChild),Gi(this)&&Object(r["_injectProductInfo"])(e.licenseKey,t),this.guid="ht_"+Object($["randomString"])(),vc.set(this.guid,this),this.columnIndexMapper=new ns,this.rowIndexMapper=new ns,this.columnIndexMapper.addLocalHook("indexesSequenceChange",t=>{u.runHooks("afterColumnSequenceChange",t)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",t=>{u.runHooks("afterRowSequenceChange",t)}),g=new wr(u),this.rootElement.id&&"ht_"!==this.rootElement.id.substring(0,3)||(this.rootElement.id=this.guid);const I=t=>{const{row:e,col:n}=t;return u._createCellCoords(e>=0?u.rowIndexMapper.getRenderableFromVisualIndex(e):e,n>=0?u.columnIndexMapper.getRenderableFromVisualIndex(n):n)},x=t=>{const{row:e,col:n}=t;return u._createCellCoords(e>=0?u.rowIndexMapper.getVisualFromRenderableIndex(e):e,n>=0?u.columnIndexMapper.getVisualFromRenderableIndex(n):n)},N=(t,e)=>{const n=e>t?1:-1,o=Math.min(t,e),i=Math.max(t,e),r=u.rowIndexMapper.getNearestNotHiddenIndex(t,n);return null===r||1===n&&r>i||-1===n&&r<o?null:r>=0?u.rowIndexMapper.getRenderableFromVisualIndex(r):r},A=(t,e)=>{const n=e>t?1:-1,o=Math.min(t,e),i=Math.max(t,e),r=u.columnIndexMapper.getNearestNotHiddenIndex(t,n);return null===r||1===n&&r>i||-1===n&&r<o?null:r>=0?u.columnIndexMapper.getRenderableFromVisualIndex(r):r};let H=new Ba(R,{rowIndexMapper:u.rowIndexMapper,columnIndexMapper:u.columnIndexMapper,countCols:()=>u.countCols(),countRows:()=>u.countRows(),propToCol:t=>f.propToCol(t),isEditorOpened:()=>!!u.getActiveEditor()&&u.getActiveEditor().isOpened(),countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return a.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return a.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>u.getShortcutManager(),createCellCoords:(t,e)=>u._createCellCoords(t,e),createCellRange:(t,e,n)=>u._createCellRange(t,e,n),visualToRenderableCoords:I,renderableToVisualCoords:x,findFirstNonHiddenRenderableRow:N,findFirstNonHiddenRenderableColumn:A,isDisabledCellSelection:(t,e)=>t<0||e<0?u.getSettings().disableVisualSelection:u.getCellMeta(t,e).disableVisualSelection});this.selection=H;const j=t=>{let{hiddenIndexesChanged:e}=t;e&&this.selection.commit()};function _(t){const e=rs(t);Rs(e)?(u.runHooks("beforeLanguageChange",e),T.language=e,u.runHooks("afterLanguageChange",e)):ss(t)}function k(t,e){const n="className"===t?u.rootElement:u.table;if(v)Object(o["addClass"])(n,e);else{let i=[],r=[];T[t]&&(i=Array.isArray(T[t])?T[t]:Object(U["stringToArray"])(T[t])),e&&(r=Array.isArray(e)?e:Object(U["stringToArray"])(e));const s=Object(U["getDifferenceOfArrays"])(i,r),a=Object(U["getDifferenceOfArrays"])(r,i);s.length&&Object(o["removeClass"])(n,s),a.length&&Object(o["addClass"])(n,a)}T[t]=e}function P(){let t=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,t=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){0===this.validatorsInQueue&&!1===t&&(t=!0,this.onQueueEmpty(this.valid))}}}function D(t){const e=t.replace(",",".");return!1===isNaN(parseFloat(e))?parseFloat(e):t}function F(t,e,n){if(!t.length)return void n();const o=u.getActiveEditor(),i=new P;let r=!0;i.onQueueEmpty=()=>{o&&r&&o.cancelChanges(),n()};for(let s=t.length-1;s>=0;s--){const[n,o,,a]=t[s],l=f.propToCol(o);let c;c=Number.isInteger(l)?u.getCellMeta(n,l):{...Object.getPrototypeOf(R),...R},"numeric"===c.type&&"string"===typeof a&&Object(K["isNumericLike"])(a)&&(t[s][3]=D(a)),u.getCellValidator(c)&&(i.addValidatorToQueue(),u.validateCell(t[s][3],c,function(e,n){return function(o){if("boolean"!==typeof o)throw new Error("Validation error: result is not boolean");!1===o&&!1===n.allowInvalid&&(r=!1,t.splice(e,1),n.valid=!0),i.removeValidatorFormQueue()}}(s,c),e))}i.checkIfQueueIsEmpty()}function V(t,e){for(let o=t.length-1;o>=0;o--){let n=!1;if(null!==t[o]){if(null!==t[o][2]&&void 0!==t[o][2]||null!==t[o][3]&&void 0!==t[o][3]){if(R.allowInsertRow)while(t[o][0]>u.countRows()-1){const{delta:t}=f.createRow(void 0,void 0,{source:e});if(0===t){n=!0;break}}if("array"===u.dataType&&(!R.columns||0===R.columns.length)&&R.allowInsertColumn)while(f.propToCol(t[o][1])>u.countCols()-1){const{delta:t}=f.createCol(void 0,void 0,{source:e});if(0===t){n=!0;break}}n||f.set(t[o][0],t[o][1],t[o][3])}}else t.splice(o,1)}const n=t.length>0;if(u.forceFullRender=!0,n){p.adjustRowsAndCols(),u.runHooks("beforeChangeRender",t,e),m.closeEditor(),u.view.render(),m.prepareEditor(),u.view.adjustElementsSize(),u.runHooks("afterChange",t,e||"edit");const n=u.getActiveEditor();n&&Object(r["isDefined"])(n.refreshValue)&&n.refreshValue()}else u.view.render()}function W(t,e,n){return Array.isArray(t)?t:[[t,e,n]]}function B(t,e){const n=u.getActiveEditor(),o=u.runHooks("beforeChange",t,e||"edit"),i=t.filter(t=>null!==t);return!1===o||0===i.length?(n&&n.cancelChanges(),[]):i}this.columnIndexMapper.addLocalHook("cacheUpdated",j),this.rowIndexMapper.addLocalHook("cacheUpdated",j),this.selection.addLocalHook("afterSetRangeEnd",(t,e)=>{const n=Object(O["createObjectPropListener"])(!1),i=this.selection.getSelectedRange(),{from:r,to:s}=i.current(),a=i.size()-1;this.runHooks("afterSelection",r.row,r.col,s.row,s.col,n,a),this.runHooks("afterSelectionByProp",r.row,u.colToProp(r.col),s.row,u.colToProp(s.col),n,a),e&&(!n.isTouched()||n.isTouched()&&!n.value)&&w.scrollTo(t);const l=H.isSelectedByRowHeader(),c=H.isSelectedByColumnHeader();l&&c?Object(o["addClass"])(this.rootElement,["ht__selection--rows","ht__selection--columns"]):l?(Object(o["removeClass"])(this.rootElement,"ht__selection--columns"),Object(o["addClass"])(this.rootElement,"ht__selection--rows")):c?(Object(o["removeClass"])(this.rootElement,"ht__selection--rows"),Object(o["addClass"])(this.rootElement,"ht__selection--columns")):Object(o["removeClass"])(this.rootElement,["ht__selection--rows","ht__selection--columns"]),"shift"!==H.getSelectionSource()&&m.closeEditor(null),u.view.render(),m.prepareEditor()}),this.selection.addLocalHook("beforeSetFocus",t=>{this.runHooks("beforeSelectionFocusSet",t.row,t.col)}),this.selection.addLocalHook("afterSetFocus",t=>{const e=Object(O["createObjectPropListener"])(!1);this.runHooks("afterSelectionFocusSet",t.row,t.col,e),(!e.isTouched()||e.isTouched()&&!e.value)&&w.scrollTo(t),m.closeEditor(),u.view.render(),m.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",t=>{const e=t.length-1,{from:n,to:o}=t[e];this.runHooks("afterSelectionEnd",n.row,n.col,o.row,o.col,e),this.runHooks("afterSelectionEndByProp",n.row,u.colToProp(n.col),o.row,u.colToProp(o.col),e)}),this.selection.addLocalHook("afterIsMultipleSelection",t=>{const e=this.runHooks("afterIsMultipleSelection",t.value);t.value&&(t.value=e)}),this.selection.addLocalHook("afterDeselect",()=>{m.closeEditor(),u.view.render(),Object(o["removeClass"])(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return a.runHooks("beforeSetRangeStart",...e)})).addLocalHook("beforeSetRangeStartOnly",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return a.runHooks("beforeSetRangeStartOnly",...e)})).addLocalHook("beforeSetRangeEnd",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return a.runHooks("beforeSetRangeEnd",...e)})).addLocalHook("beforeSelectColumns",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return a.runHooks("beforeSelectColumns",...e)})).addLocalHook("afterSelectColumns",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return a.runHooks("afterSelectColumns",...e)})).addLocalHook("beforeSelectRows",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return a.runHooks("beforeSelectRows",...e)})).addLocalHook("afterSelectRows",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return a.runHooks("afterSelectRows",...e)})).addLocalHook("beforeModifyTransformStart",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return a.runHooks("modifyTransformStart",...e)})).addLocalHook("afterModifyTransformStart",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return a.runHooks("afterModifyTransformStart",...e)})).addLocalHook("beforeModifyTransformFocus",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return a.runHooks("modifyTransformFocus",...e)})).addLocalHook("afterModifyTransformFocus",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return a.runHooks("afterModifyTransformFocus",...e)})).addLocalHook("beforeModifyTransformEnd",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return a.runHooks("modifyTransformEnd",...e)})).addLocalHook("afterModifyTransformEnd",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return a.runHooks("afterModifyTransformEnd",...e)})).addLocalHook("beforeRowWrap",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return a.runHooks("beforeRowWrap",...e)})).addLocalHook("beforeColumnWrap",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return a.runHooks("beforeColumnWrap",...e)})).addLocalHook("insertRowRequire",t=>this.alter("insert_row_above",t,1,"auto")).addLocalHook("insertColRequire",t=>this.alter("insert_col_start",t,1,"auto")),p={alter(t,e){var n,o;let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;const l=t=>{if(0===t.length)return[];const e=[...t];e.sort((t,e)=>{let[n]=t,[o]=e;return n===o?0:n>o?1:-1});const n=Object(U["arrayReduce"])(e,(t,e)=>{let[n,o]=e;const i=t[t.length-1],[r,s]=i,a=r+s;if(n<=a){const t=Math.max(o-(a-n),0);i[1]+=t}else t.push([n,o]);return t},[e[0]]);return n};switch(t){case"insert_row_below":case"insert_row_above":const a=u.countSourceRows();if(R.maxRows===a)return;const c="insert_row_below"===t?"below":"above";e=null!==(n=e)&&void 0!==n?n:"below"===c?a:0;const{delta:h,startPhysicalIndex:d}=f.createRow(e,i,{source:s,mode:c});H.shiftRows(u.toVisualRow(d),h);break;case"insert_col_start":case"insert_col_end":const g="insert_col_end"===t?"end":"start";e=null!==(o=e)&&void 0!==o?o:"end"===g?u.countSourceCols():0;const{delta:p,startPhysicalIndex:b}=f.createCol(e,i,{source:s,mode:g});if(p){if(Array.isArray(R.colHeaders)){const t=[u.toVisualColumn(b),0];t.length+=p,Array.prototype.splice.apply(R.colHeaders,t)}H.shiftColumns(u.toVisualColumn(b),p)}break;case"remove_row":const w=t=>{let e=0;Object(U["arrayEach"])(t,t=>{let[n,o]=t;const i=Object(r["isEmpty"])(n)?u.countRows()-1:Math.max(n-e,0);Number.isInteger(n)&&(n=Math.max(n-e,0));const a=f.removeRow(n,o,s);if(!a)return;if(H.isSelected()){const{row:t}=u.getSelectedRangeLast().highlight;t>=n&&t<=n+o-1&&m.closeEditor(!0)}const l=u.countRows();0===l?H.deselect():"ContextMenu.removeRow"===s?H.refresh():H.shiftRows(n,-o);const c=R.fixedRowsTop;c>=i+1&&(R.fixedRowsTop-=Math.min(o,c-i));const h=R.fixedRowsBottom;h&&i>=l-h&&(R.fixedRowsBottom-=Math.min(o,h)),e+=o})};Array.isArray(e)?w(l(e)):w([[e,i]]);break;case"remove_col":const v=t=>{let e=0;Object(U["arrayEach"])(t,t=>{let[n,o]=t;const i=Object(r["isEmpty"])(n)?u.countCols()-1:Math.max(n-e,0);let a=u.toPhysicalColumn(i);Number.isInteger(n)&&(n=Math.max(n-e,0));const l=f.removeCol(n,o,s);if(!l)return;if(H.isSelected()){const{col:t}=u.getSelectedRangeLast().highlight;t>=n&&t<=n+o-1&&m.closeEditor(!0)}const c=u.countCols();0===c?H.deselect():"ContextMenu.removeColumn"===s?H.refresh():H.shiftColumns(n,-o);const h=R.fixedColumnsStart;h>=i+1&&(R.fixedColumnsStart-=Math.min(o,h-i)),Array.isArray(R.colHeaders)&&("undefined"===typeof a&&(a=-1),R.colHeaders.splice(a,o)),e+=o})};Array.isArray(e)?v(l(e)):v([[e,i]]);break;default:throw new Error(`There is no such action "${t}"`)}u.view.render(),a||p.adjustRowsAndCols()},adjustRowsAndCols(){const t=R.minRows,e=R.minSpareRows,n=R.minCols,o=R.minSpareCols;if(t){const e=u.countRows();e<t&&f.createRow(e,t-e,{source:"auto"})}if(e){const t=u.countEmptyRows(!0);if(t<e){const n=e-t,o=Math.min(n,R.maxRows-u.countSourceRows());f.createRow(u.countRows(),o,{source:"auto"})}}{let t;(n||o)&&(t=u.countEmptyCols(!0));let e=u.countCols();if(n&&!R.columns&&e<n){const o=n-e;t+=o,f.createCol(e,o,{source:"auto"})}if(o&&!R.columns&&"array"===u.dataType&&t<o){e=u.countCols();const n=o-t,i=Math.min(n,R.maxCols-e);f.createCol(e,i,{source:"auto"})}}u.view&&u.view.adjustElementsSize()},populateFromArray(t,e,n,o,i){let r,s,a,l;const c=[],h={},d=[],f=t.row,g=t.col;if(s=e.length,0===s)return!1;let p=0,m=0;switch(Object(O["isObject"])(n)&&(p=n.col-g+1,m=n.row-f+1),i){case"shift_down":const i=Object(U["pivot"])(e),b=i.length,w=Math.max(b,p),v=u.getData().slice(f),y=Object(U["pivot"])(v).slice(g,g+w);for(a=0;a<w;a+=1)if(a<b){for(r=0,s=i[a].length;r<m-s;r+=1)i[a].push(i[a][r%s]);a<y.length?d.push(i[a].concat(y[a])):d.push(i[a].concat(new Array(v.length).fill(null)))}else d.push(i[a%b].concat(y[a]));u.populateFromArray(f,g,Object(U["pivot"])(d));break;case"shift_right":const C=e.length,S=Math.max(C,m),E=u.getData().slice(f).map(t=>t.slice(g));for(r=0;r<S;r+=1)if(r<C){for(a=0,l=e[r].length;a<p-l;a+=1)e[r].push(e[r][a%l]);if(r<E.length)for(let t=0;t<E[r].length;t+=1)e[r].push(E[r][t]);else e[r].push(...new Array(E[0].length).fill(null))}else e.push(e[r%s].slice(0,S).concat(E[r]));u.populateFromArray(f,g,e);break;case"overwrite":default:h.row=t.row,h.col=t.col;let T,M=0,I=0,x=!0;const N=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const o=e[t%e.length];return null!==n?o[n%o.length]:o},A=e.length,H=n?n.row-t.row+1:0;for(s=n?H:Math.max(A,H),r=0;r<s;r++){if(n&&h.row>n.row&&H>A||!R.allowInsertRow&&h.row>u.countRows()-1||h.row>=R.maxRows)break;const e=r-M,i=N(e).length,d=n?n.col-t.col+1:0;if(l=n?d:Math.max(i,d),h.col=t.col,T=u.getCellMeta(h.row,h.col),"CopyPaste.paste"!==o&&"Autofill.fill"!==o||!T.skipRowOnPaste){for(I=0,a=0;a<l;a++){if(n&&h.col>n.col&&d>i||!R.allowInsertColumn&&h.col>u.countCols()-1||h.col>=R.maxCols)break;if(T=u.getCellMeta(h.row,h.col),("CopyPaste.paste"===o||"Autofill.fill"===o)&&T.skipColumnOnPaste){I+=1,h.col+=1,l+=1;continue}if(T.readOnly&&"UndoRedo.undo"!==o){h.col+=1;continue}const t=a-I;let r=N(e,t),s=u.getDataAtCell(h.row,h.col);if(null!==r&&"object"===typeof r)if(Array.isArray(r)&&null===s&&(s=[]),null===s||"object"!==typeof s)x=!1;else{const t=Object(O["duckSchema"])(Array.isArray(s)?s:s[0]||s),e=Object(O["duckSchema"])(Array.isArray(r)?r:r[0]||r);Object(O["isObjectEqual"])(t,e)||Array.isArray(t)&&Array.isArray(e)?r=Object(O["deepClone"])(r):x=!1}else null!==s&&"object"===typeof s&&(x=!1);x&&c.push([h.row,h.col,r]),x=!0,h.col+=1}h.row+=1}else M+=1,h.row+=1,s+=1}u.setDataAtCell(c,null,null,o||"populateFromArray");break}}},this.init=function(){g.setData(R.data),u.runHooks("beforeInit"),(Object(s["isMobileBrowser"])()||Object(s["isIpadOS"])())&&Object(o["addClass"])(u.rootElement,"mobile"),this.updateSettings(R,!0),this.view=new dr(this),m=S.getInstance(u,R,H),w=Xl(u),b=new L(u),Gi(this)&&Ql(u),u.runHooks("init"),this.forceFullRender=!0,this.view.render(),v&&null===u.rootElement.offsetParent&&Object(o["observeVisibilityChangeOnce"])(u.rootElement,()=>{u.view._wt.wtOverlays.updateLastSpreaderSize(),u.render(),u.view.adjustElementsSize()}),"object"===typeof v&&(u.runHooks("afterChange",v[0],v[1]),v=!1),u.runHooks("afterInit")},this._createCellCoords=function(t,e){return u.view._wt.createCellCoords(t,e)},this._createCellRange=function(t,e,n){return u.view._wt.createCellRange(t,e,n)},this.validateCell=function(t,e,n,o){let s=u.getCellValidator(e);function a(t){let o=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!o||!0===e.hidden)return void n(t);const i=e.visualCol,r=e.visualRow,s=u.getCell(r,i,!0);if(s&&"TH"!==s.nodeName){const t=u.rowIndexMapper.getRenderableFromVisualIndex(r),e=u.columnIndexMapper.getRenderableFromVisualIndex(i);u.view._wt.getSetting("cellRenderer",t,e,s)}n(t)}Object(r["isRegExp"])(s)&&(s=function(t){return function(e,n){n(t.test(e))}}(s)),Object(i["isFunction"])(s)?(t=u.runHooks("beforeValidate",t,e.visualRow,e.prop,o),u._registerImmediate(()=>{s.call(e,t,n=>{u&&(n=u.runHooks("afterValidate",n,t,e.visualRow,e.prop,o),e.valid=n,a(n),u.runHooks("postAfterValidate",n,t,e.visualRow,e.prop,o))})})):u._registerImmediate(()=>{e.valid=!0,a(e.valid,!1)})},this.setDataAtCell=function(t,e,n,o){const i=W(t,e,n),r=[];let s,a,l,c=o;for(s=0,a=i.length;s<a;s++){if("object"!==typeof i[s])throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!==typeof i[s][1])throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");l=i[s][1]>=this.countCols()?i[s][1]:f.colToProp(i[s][1]),r.push([i[s][0],l,g.getAtCell(this.toPhysicalRow(i[s][0]),i[s][1]),i[s][2]])}c||"object"!==typeof t||(c=e);const h=B(r,o);u.runHooks("afterSetDataAtCell",h,c),F(h,c,()=>{V(h,c)})},this.setDataAtRowProp=function(t,e,n,o){const i=W(t,e,n),r=[];let s,a,l=o;for(s=0,a=i.length;s<a;s++)r.push([i[s][0],i[s][1],g.getAtCell(this.toPhysicalRow(i[s][0]),i[s][1]),i[s][2]]);l||"object"!==typeof t||(l=e);const c=B(r,o);u.runHooks("afterSetDataAtRowProp",c,l),F(c,l,()=>{V(c,l)})},this.listen=function(){u&&!u.isListening()&&(vc.forEach(t=>{u!==t&&t.unlisten()}),wc=u.guid,u.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(wc=null,u.runHooks("afterUnlisten"))},this.isListening=function(){return wc===u.guid},this.destroyEditor=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];m.closeEditor(t),u.view.render(),e&&H.isSelected()&&m.prepareEditor()},this.populateFromArray=function(t,e,n,o,i,r,s){if("object"!==typeof n||"object"!==typeof n[0])throw new Error("populateFromArray parameter `input` must be an array of arrays");const a="number"===typeof o?u._createCellCoords(o,i):null;return p.populateFromArray(u._createCellCoords(t,e),n,a,r,s)},this.spliceCol=function(t,e,n){for(var o=arguments.length,i=new Array(o>3?o-3:0),r=3;r<o;r++)i[r-3]=arguments[r];return f.spliceCol(t,e,n,...i)},this.spliceRow=function(t,e,n){for(var o=arguments.length,i=new Array(o>3?o-3:0),r=3;r<o;r++)i[r-3]=arguments[r];return f.spliceRow(t,e,n,...i)},this.getSelected=function(){if(H.isSelected())return Object(U["arrayMap"])(H.getSelectedRange(),t=>{let{from:e,to:n}=t;return[e.row,e.col,n.row,n.col]})},this.getSelectedLast=function(){const t=this.getSelected();let e;return t&&t.length>0&&(e=t[t.length-1]),e},this.getSelectedRange=function(){if(H.isSelected())return Array.from(H.getSelectedRange())},this.getSelectedRangeLast=function(){const t=this.getSelectedRange();let e;return t&&t.length>0&&(e=t[t.length-1]),e},this.emptySelectedCells=function(t){if(!H.isSelected()||0===this.countRows()||0===this.countCols())return;const e=[];Object(U["arrayEach"])(H.getSelectedRange(),t=>{if(t.isSingleHeader())return;const n=t.getTopStartCorner(),o=t.getBottomEndCorner();Object(K["rangeEach"])(n.row,o.row,t=>{Object(K["rangeEach"])(n.col,o.col,n=>{this.getCellMeta(t,n).readOnly||e.push([t,n,null])})})}),e.length>0&&this.setDataAtCell(e,t)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const t=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(t,0),this.isRenderSuspended()||t!==this.renderSuspendedCounter||(this.renderCall?this.render():u.view.render())},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||u.view.render())},this.batchRender=function(t){this.suspendRender();const e=t();return this.resumeRender(),e},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const e=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(e,0),(!this.isExecutionSuspended()&&e===this.executionSuspendedCounter||t)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.suspendExecution();const n=t();return this.resumeExecution(e),n},this.batch=function(t){this.suspendRender(),this.suspendExecution();const e=t();return this.resumeExecution(),this.resumeRender(),e},this.refreshDimensions=function(){if(!u.view)return;const{width:t,height:e}=u.view.getLastSize(),{width:n,height:o}=u.rootElement.getBoundingClientRect(),i=n!==t||o!==e,r=!1===u.runHooks("beforeRefreshDimensions",{width:t,height:e},{width:n,height:o},i);r||((i||u.view._wt.wtOverlays.scrollableElement===u.rootWindow)&&(u.view.setLastSize(n,o),u.render()),u.runHooks("afterRefreshDimensions",{width:t,height:e},{width:n,height:o},i))},this.updateData=function(t,e){Fl(t,t=>{f=t},t=>{f=t,u.columnIndexMapper.fitToLength(this.getInitialColumnCount()),u.rowIndexMapper.fitToLength(this.countSourceRows()),p.adjustRowsAndCols(),H.refresh()},{hotInstance:u,dataMap:f,dataSource:g,internalSource:"updateData",source:e,metaManager:E,firstRun:v})},this.loadData=function(t,e){Fl(t,t=>{f=t},()=>{E.clearCellsCache(),u.initIndexMappers(),p.adjustRowsAndCols(),H.refresh(),v&&(v=[null,"loadData"])},{hotInstance:u,dataMap:f,dataSource:g,internalSource:"loadData",source:e,metaManager:E,firstRun:v})},this.getInitialColumnCount=function(){const t=R.columns;let e=0;if(Array.isArray(t))e=t.length;else if(Object(i["isFunction"])(t))if("array"===u.dataType){const n=this.countSourceCols();for(let o=0;o<n;o+=1)t(o)&&(e+=1)}else"object"!==u.dataType&&"function"!==u.dataType||(e=f.colToPropCache.length);else if(Object(r["isDefined"])(R.dataSchema)){const t=f.getSchema();e=Array.isArray(t)?t.length:Object(O["deepObjectSize"])(t)}else e=this.countSourceCols();return e},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(t,e,n,o){return Object(r["isUndefined"])(t)?f.getAll():f.getRange(u._createCellCoords(t,e),u._createCellCoords(n,o),f.DESTINATION_RENDERER)},this.getCopyableText=function(t,e,n,o){return f.getCopyableText(u._createCellCoords(t,e),u._createCellCoords(n,o))},this.getCopyableData=function(t,e){return f.getCopyable(t,f.colToProp(e))},this.getSchema=function(){return f.getSchema()},this.updateSettings=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=(v?u.loadData:u.updateData).bind(this);let o,s,a=!1;if(Object(r["isDefined"])(t.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(Object(r["isDefined"])(t.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(Object(r["isDefined"])(t.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(o in t)"data"===o||("language"===o?_(t.language):"className"===o?k("className",t.className):"tableClassName"===o&&u.table?(k("tableClassName",t.tableClassName),u.view._wt.wtOverlays.syncOverlayTableClassNames()):os["a"].getSingleton().isRegistered(o)||os["a"].getSingleton().isDeprecated(o)?(Object(i["isFunction"])(t[o])||Array.isArray(t[o]))&&(t[o].initialHook=!0,u.addHook(o,t[o])):!e&&Object(O["hasOwnProperty"])(t,o)&&(T[o]=t[o]));void 0===t.data&&void 0===R.data?n(null,"updateSettings"):void 0!==t.data?n(t.data,"updateSettings"):void 0!==t.columns&&(f.createMap(),u.initIndexMappers());const l=u.countCols(),c=R.columns;if(c&&Object(i["isFunction"])(c)&&(a=!0),void 0===t.cell&&void 0===t.cells&&void 0===t.columns||E.clearCache(),l>0)for(o=0,s=0;o<l;o++){if(c){const t=a?c(o):c[s];t&&E.updateColumnMeta(s,t)}s+=1}Object(r["isDefined"])(t.cell)&&Object(O["objectEach"])(t.cell,t=>{u.setCellMetaObject(t.row,t.col,t)}),u.runHooks("afterCellMetaReset");let h=u.rootElement.style.height;""!==h&&(h=parseInt(u.rootElement.style.height,10));let d=t.height;if(Object(i["isFunction"])(d)&&(d=d()),e){const t=u.rootElement.getAttribute("style");t&&u.rootElement.setAttribute("data-initialstyle",u.rootElement.getAttribute("style"))}if(null===d){const t=u.rootElement.getAttribute("data-initialstyle");t&&(t.indexOf("height")>-1||t.indexOf("overflow")>-1)?u.rootElement.setAttribute("style",t):(u.rootElement.style.height="",u.rootElement.style.overflow="")}else void 0!==d&&(u.rootElement.style.height=isNaN(d)?""+d:d+"px",u.rootElement.style.overflow="hidden");if("undefined"!==typeof t.width){let e=t.width;Object(i["isFunction"])(e)&&(e=e()),u.rootElement.style.width=isNaN(e)?""+e:e+"px"}e||(u.view&&(u.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),u.view._wt.exportSettingsAsClassNames()),u.runHooks("afterUpdateSettings",t)),p.adjustRowsAndCols(),u.view&&!v&&(u.forceFullRender=!0,u.view.render(),u.view._wt.wtOverlays.adjustElementsSize()),e||!u.view||""!==h&&""!==d&&void 0!==d||h===d||u.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const t=u.getSelectedLast();if(R.getValue){if(Object(i["isFunction"])(R.getValue))return R.getValue.call(u);if(t)return u.getData()[t[0][0]][R.getValue]}else if(t)return u.getDataAtCell(t[0],t[1])},this.getSettings=function(){return R},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(t,e,n,o,i){p.alter(t,e,n,o,i)},this.getCell=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=e,i=t;if(e>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(e)))return null;o=this.columnIndexMapper.getRenderableFromVisualIndex(e)}if(t>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(t)))return null;i=this.rowIndexMapper.getRenderableFromVisualIndex(t)}return null===i||null===o||void 0===i||void 0===o?null:u.view.getCellAtCoords(u._createCellCoords(i,o),n)},this.getCoords=function(t){const e=this.view._wt.wtTable.getCoords(t);if(null===e)return null;const{row:n,col:o}=e;let i=n,r=o;return n>=0&&(i=this.rowIndexMapper.getVisualFromRenderableIndex(n)),o>=0&&(r=this.columnIndexMapper.getVisualFromRenderableIndex(o)),u._createCellCoords(i,r)},this.colToProp=function(t){return f.colToProp(t)},this.propToCol=function(t){return f.propToCol(t)},this.toVisualRow=t=>this.rowIndexMapper.getVisualFromPhysicalIndex(t),this.toVisualColumn=t=>this.columnIndexMapper.getVisualFromPhysicalIndex(t),this.toPhysicalRow=t=>this.rowIndexMapper.getPhysicalFromVisualIndex(t),this.toPhysicalColumn=t=>this.columnIndexMapper.getPhysicalFromVisualIndex(t),this.getDataAtCell=function(t,e){return f.get(t,f.colToProp(e))},this.getDataAtRowProp=function(t,e){return f.get(t,e)},this.getDataAtCol=function(t){const e=[],n=f.getRange(u._createCellCoords(0,t),u._createCellCoords(R.data.length-1,t),f.DESTINATION_RENDERER);for(let o=0;o<n.length;o+=1)for(let t=0;t<n[o].length;t+=1)e.push(n[o][t]);return e},this.getDataAtProp=function(t){const e=[],n=f.getRange(u._createCellCoords(0,f.propToCol(t)),u._createCellCoords(R.data.length-1,f.propToCol(t)),f.DESTINATION_RENDERER);for(let o=0;o<n.length;o+=1)for(let t=0;t<n[o].length;t+=1)e.push(n[o][t]);return e},this.getSourceData=function(t,e,n,o){let i;return i=void 0===t?g.getData():g.getByRange(u._createCellCoords(t,e),u._createCellCoords(n,o)),i},this.getSourceDataArray=function(t,e,n,o){let i;return i=void 0===t?g.getData(!0):g.getByRange(u._createCellCoords(t,e),u._createCellCoords(n,o),!0),i},this.getSourceDataAtCol=function(t){return g.getAtColumn(t)},this.setSourceDataAtCell=function(t,e,n,o){const i=W(t,e,n),s=this.hasHook("afterSetSourceDataAtCell"),a=[];s&&Object(U["arrayEach"])(i,t=>{let[e,n,o]=t;a.push([e,n,g.getAtCell(e,n),o])}),Object(U["arrayEach"])(i,t=>{let[e,n,o]=t;g.setAtCell(e,n,o)}),s&&this.runHooks("afterSetSourceDataAtCell",a,o),this.render();const l=u.getActiveEditor();l&&Object(r["isDefined"])(l.refreshValue)&&l.refreshValue()},this.getSourceDataAtRow=function(t){return g.getAtRow(t)},this.getSourceDataAtCell=function(t,e){return g.getAtCell(t,e)},this.getDataAtRow=function(t){const e=f.getRange(u._createCellCoords(t,0),u._createCellCoords(t,this.countCols()-1),f.DESTINATION_RENDERER);return e[0]||[]},this.getDataType=function(t,e,n,o){const i=void 0===t?[0,0,this.countRows(),this.countCols()]:[t,e,n,o],[r,s]=i;let[,,a,l]=i,c=null,h=null;void 0===a&&(a=r),void 0===l&&(l=s);let u="mixed";return Object(K["rangeEach"])(Math.max(Math.min(r,a),0),Math.max(r,a),t=>{let e=!0;return Object(K["rangeEach"])(Math.max(Math.min(s,l),0),Math.max(s,l),n=>{const o=this.getCellMeta(t,n);return h=o.type,c?e=c===h:c=h,e}),u=e?h:"mixed",e}),u},this.removeCellMeta=function(t,e,n){const[o,i]=[this.toPhysicalRow(t),this.toPhysicalColumn(e)];let r=E.getCellMetaKeyValue(o,i,n);const s=u.runHooks("beforeRemoveCellMeta",t,e,n,r);!1!==s&&(E.removeCellMeta(o,i,n),u.runHooks("afterRemoveCellMeta",t,e,n,r)),r=null},this.spliceCellsMeta=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(var n=arguments.length,o=new Array(n>2?n-2:0),i=2;i<n;i++)o[i-2]=arguments[i];if(o.length>0&&!Array.isArray(o[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");e>0&&E.removeRow(this.toPhysicalRow(t),e),o.length>0&&Object(U["arrayEach"])(o.reverse(),e=>{E.createRow(this.toPhysicalRow(t)),Object(U["arrayEach"])(e,(e,n)=>this.setCellMetaObject(t,n,e))}),u.render()},this.setCellMetaObject=function(t,e,n){"object"===typeof n&&Object(O["objectEach"])(n,(n,o)=>{this.setCellMeta(t,e,o,n)})},this.setCellMeta=function(t,e,n,o){const i=u.runHooks("beforeSetCellMeta",t,e,n,o);if(!1===i)return;let r=t,s=e;t<this.countRows()&&(r=this.toPhysicalRow(t)),e<this.countCols()&&(s=this.toPhysicalColumn(e)),E.setCellMeta(r,s,n,o),u.runHooks("afterSetCellMeta",t,e,n,o)},this.getCellsMeta=function(){return E.getCellsMeta()},this.getCellMeta=function(t,e){let n=this.toPhysicalRow(t),o=this.toPhysicalColumn(e);return null===n&&(n=t),null===o&&(o=e),E.getCellMeta(n,o,{visualRow:t,visualColumn:e})},this.getColumnMeta=function(t){return E.getColumnMeta(this.toPhysicalColumn(t))},this.getCellMetaAtRow=function(t){return E.getCellsMetaAtRow(t)},this.isColumnModificationAllowed=function(){return!("object"===u.dataType||R.columns)},this.getCellRenderer=function(t,e){const n="number"===typeof t?u.getCellMeta(t,e).renderer:t.renderer;return"string"===typeof n?Object(Y["b"])(n):Object(r["isUndefined"])(n)?Object(Y["b"])("text"):n},this.getCellEditor=function(t,e){const n="number"===typeof t?u.getCellMeta(t,e).editor:t.editor;return"string"===typeof n?Object(c["a"])(n):Object(r["isUndefined"])(n)?Object(c["a"])("text"):n},this.getCellValidator=function(t,e){const n="number"===typeof t?u.getCellMeta(t,e).validator:t.validator;return"string"===typeof n?Object(X["b"])(n):n},this.validateCells=function(t){this._validateCells(t)},this.validateRows=function(t,e){if(!Array.isArray(t))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(e,t)},this.validateColumns=function(t,e){if(!Array.isArray(t))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(e,void 0,t)},this._validateCells=function(t,e,n){const o=new P;t&&(o.onQueueEmpty=t);let i=u.countRows()-1;while(i>=0){if(void 0!==e&&-1===e.indexOf(i)){i-=1;continue}let t=u.countCols()-1;while(t>=0)void 0===n||-1!==n.indexOf(t)?(o.addValidatorToQueue(),u.validateCell(u.getDataAtCell(i,t),u.getCellMeta(i,t),t=>{if("boolean"!==typeof t)throw new Error("Validation error: result is not boolean");!1===t&&(o.valid=!1),o.removeValidatorFormQueue()},"validateCells"),t-=1):t-=1;i-=1}o.checkIfQueueIsEmpty()},this.getRowHeader=function(t){let e=R.rowHeaders,n=t;return void 0!==n&&(n=u.runHooks("modifyRowHeader",n)),void 0===n?(e=[],Object(K["rangeEach"])(u.countRows()-1,t=>{e.push(u.getRowHeader(t))})):Array.isArray(e)&&void 0!==e[n]?e=e[n]:Object(i["isFunction"])(e)?e=e(n):e&&"string"!==typeof e&&"number"!==typeof e&&(e=n+1),e},this.hasRowHeaders=function(){return!!R.rowHeaders},this.hasColHeaders=function(){if(void 0!==R.colHeaders&&null!==R.colHeaders)return!!R.colHeaders;for(let t=0,e=u.countCols();t<e;t++)if(u.getColHeader(t))return!0;return!1},this.getColHeader=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const n=u.runHooks("modifyColHeader",t);if(void 0===n){const t=[],e=u.countCols();for(let n=0;n<e;n++)t.push(u.getColHeader(n));return t}let o=R.colHeaders;const r=function(t){const e=[],n=u.countCols();let o=0;for(;o<n;o++)Object(i["isFunction"])(R.columns)&&R.columns(o)&&e.push(o);return e[t]},s=u.toPhysicalColumn(n),a=r(s);return!1===R.colHeaders?o=null:R.columns&&Object(i["isFunction"])(R.columns)&&R.columns(a)&&R.columns(a).title?o=R.columns(a).title:R.columns&&R.columns[s]&&R.columns[s].title?o=R.columns[s].title:Array.isArray(R.colHeaders)&&void 0!==R.colHeaders[s]?o=R.colHeaders[s]:Object(i["isFunction"])(R.colHeaders)?o=R.colHeaders(s):R.colHeaders&&"string"!==typeof R.colHeaders&&"number"!==typeof R.colHeaders&&(o=Object(fr["spreadsheetColumnLabel"])(n)),o=u.runHooks("modifyColumnHeaderValue",o,t,e),o},this._getColWidthFromSettings=function(t){let e;if(t>=0){const n=u.getCellMeta(0,t);e=n.width}if(void 0!==e&&e!==R.width||(e=R.colWidths),void 0!==e&&null!==e){switch(typeof e){case"object":e=e[t];break;case"function":e=e(t);break;default:break}"string"===typeof e&&(e=parseInt(e,10))}return e},this.getColWidth=function(t){let e=u._getColWidthFromSettings(t);return e=u.runHooks("modifyColWidth",e,t),void 0===e&&(e=we["a"]),e},this._getRowHeightFromSettings=function(t){let e=R.rowHeights;if(void 0!==e&&null!==e){switch(typeof e){case"object":e=e[t];break;case"function":e=e(t);break;default:break}"string"===typeof e&&(e=parseInt(e,10))}return e},this.getRowHeight=function(t){let e=u._getRowHeightFromSettings(t);return e=u.runHooks("modifyRowHeight",e,t),e},this.countSourceRows=function(){return g.countRows()},this.countSourceCols=function(){return g.countFirstRowKeys()},this.countRows=function(){return f.getLength()},this.countCols=function(){const t=R.maxCols,e=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(t,e)},this.countRenderedRows=function(){return u.view._wt.drawn?u.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return u.view._wt.drawn?u.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return u.view._wt.drawn?u.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return u.view._wt.drawn?u.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=0;return Object(K["rangeEachReverse"])(u.countRows()-1,n=>{if(u.isEmptyRow(n))e+=1;else if(!0===t)return!1}),e},this.countEmptyCols=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=0;return Object(K["rangeEachReverse"])(u.countCols()-1,n=>{if(u.isEmptyCol(n))e+=1;else if(!0===t)return!1}),e},this.isEmptyRow=function(t){return R.isEmptyRow.call(u,t)},this.isEmptyCol=function(t){return R.isEmptyCol.call(u,t)},this.selectCell=function(t,e,n,o){let i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],s=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];return!Object(r["isUndefined"])(t)&&!Object(r["isUndefined"])(e)&&this.selectCells([[t,e,n,o]],i,s)},this.selectCells=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[]],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];!1===e&&w.suspend();const o=H.selectCells(t);return o&&n&&u.listen(),w.resume(),o},this.selectColumns=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=arguments.length>2?arguments[2]:void 0;return H.selectColumns(t,e,n)},this.selectRows=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=arguments.length>2?arguments[2]:void 0;return H.selectRows(t,e,n)},this.deselectCell=function(){H.deselect()},this.selectAll=function(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=arguments.length>2?arguments[2]:void 0;w.skipNextScrollCycle(),H.selectAll(t,e,n)};const q=(t,e)=>t.getNearestNotHiddenIndex(e,1,!0);function Q(t){return()=>{throw new Error(`The "${t}" method cannot be called because this Handsontable instance has been destroyed`)}}this.scrollViewportTo=function(t){var e,n;"number"===typeof t&&(t={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:null===(n=arguments[4])||void 0===n||n});const{row:o,col:i,verticalSnap:r,horizontalSnap:s,considerHiddenIndexes:a}=null!==(e=t)&&void 0!==e?e:{};let l,c,h,d;void 0!==r&&(l="top"===r,c=!l),void 0!==s&&(h="start"===s,d=!h);let f=o,g=i;if(void 0===a||a){const t=Number.isInteger(o)&&o>=0,e=Number.isInteger(i)&&i>=0,n=t?q(this.rowIndexMapper,o):void 0,r=e?q(this.columnIndexMapper,i):void 0;if(null===n||null===r)return!1;f=t?u.rowIndexMapper.getRenderableFromVisualIndex(n):o,g=e?u.columnIndexMapper.getRenderableFromVisualIndex(r):i}const p=Number.isInteger(f),m=Number.isInteger(g);return p&&f>=0&&m&&g>=0?u.view.scrollViewport(u._createCellCoords(f,g),l,d,c,h):p&&f>=0&&(m&&g<0||!m)?u.view.scrollViewportVertically(f,l,c):!!(m&&g>=0&&(p&&f<0||!p))&&u.view.scrollViewportHorizontally(g,d,h)},this.scrollToFocusedCell=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",t);const{highlight:e}=this.getSelectedRangeLast(),n=this.scrollViewportTo(e.toObject());n?this.view.render():(this.removeHook("afterScroll",t),this._registerImmediate(()=>t()))},this.destroy=function(){if(u._clearTimeouts(),u._clearImmediates(),u.view&&u.view.destroy(),g&&g.destroy(),g=null,this.getShortcutManager().destroy(),E.clearCache(),vc.delete(this.guid),Gi(u)){const t=this.rootDocument.querySelector(".hot-display-license-info");t&&t.parentNode.removeChild(t)}Object(o["empty"])(u.rootElement),d.destroy(),m&&m.destroy(),u.batchExecution(()=>{u.rowIndexMapper.unregisterAll(),u.columnIndexMapper.unregisterAll(),M.getItems().forEach(t=>{let[,e]=t;e.destroy()}),M.clear(),u.runHooks("afterDestroy")},!0),os["a"].getSingleton().destroy(u),Object(O["objectEach"])(u,(t,e,n)=>{Object(i["isFunction"])(t)?n[e]=Q(e):"guid"!==e&&(n[e]=null)}),u.isDestroyed=!0,f&&f.destroy(),f=null,p=null,H=null,m=null,u=null},this.getActiveEditor=function(){return m.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return u.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return u.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return u.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return u.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return u.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return u.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return u.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return u.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return u.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return u.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return u.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return u.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(t){const e=Object($["toUpperCaseFirst"])(t);return"UndoRedo"===e?this.undoRedo:M.getItem(e)},this.getPluginName=function(t){return t===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:M.getId(t)},this.getInstance=function(){return u},this.addHook=function(t,e,n){os["a"].getSingleton().add(t,e,u,n)},this.hasHook=function(t){return os["a"].getSingleton().has(t,u)||os["a"].getSingleton().has(t)},this.addHookOnce=function(t,e,n){os["a"].getSingleton().once(t,e,u,n)},this.removeHook=function(t,e){os["a"].getSingleton().remove(t,e,u)},this.runHooks=function(t,e,n,o,i,r,s){return os["a"].getSingleton().run(u,t,e,n,o,i,r,s)},this.getTranslatedPhrase=function(t,e){return Ms(R.language,t,e)},this.toHTML=()=>Object(z["instanceToHTML"])(this),this.toTableElement=()=>{const t=this.rootDocument.createElement("div");return t.insertAdjacentHTML("afterbegin",Object(z["instanceToHTML"])(this)),t.firstElementChild},this.timeouts=[],this._registerTimeout=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=t;"function"===typeof n&&(n=setTimeout(n,e)),this.timeouts.push(n)},this._clearTimeouts=function(){Object(U["arrayEach"])(this.timeouts,t=>{clearTimeout(t)})},this.immediates=[],this._registerImmediate=function(t){this.immediates.push(setImmediate(t))},this._clearImmediates=function(){Object(U["arrayEach"])(this.immediates,t=>{clearImmediate(t)})},this._getEditorManager=function(){return m},this.isRtl=function(){return"rtl"===u.rootWindow.getComputedStyle(u.rootElement).direction},this.isLtr=function(){return!u.isRtl()},this.getDirectionFactor=function(){return u.isLtr()?1:-1};const J=mc({handleEvent(){return u.isListening()},beforeKeyDown:t=>this.runHooks("beforeKeyDown",t),afterKeyDown:t=>{this.isDestroyed||u.runHooks("afterDocumentKeyDown",t)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",t=>{!1===t.ctrlKey&&!1===t.metaKey&&J.releasePressedKeys()}),this.getShortcutManager=function(){return J},this.getFocusManager=function(){return b},Object(G["b"])().forEach(t=>{const e=Object(G["a"])(t);M.addItem(t,new e(this))}),Object(bc["a"])(u),J.setActiveContextName("grid"),os["a"].getSingleton().run(u,"construct")}var Cc=n("ef07"),Sc=n("13e1");function Oc(t,e){const n=new yc(t,e||{},Bi);return n.init(),n}Object(Ua["d"])(Cc["a"]),Oc.editors={BaseEditor:Sc["a"]},Oc.Core=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new yc(t,e,Bi)},Oc.DefaultSettings=qa(),Oc.hooks=os["a"].getSingleton(),Oc.CellCoords=vn["a"],Oc.CellRange=yn["a"],Oc.packageName="handsontable",Oc.buildDate="17/10/2024 09:16:16",Oc.version="14.6.1",Oc.languages={dictionaryKeys:ms,getLanguageDictionary:Es,getLanguagesDictionaries:Ts,registerLanguageDictionary:Ss,getTranslatedPhrase:Ms};e["a"]=Oc},c1cf:function(t,e,n){"use strict";var o=n("e437");
/**
 * @preserve
 * Authors: soakit, HChenZi
 * Last updated: Mar 09, 2023
 *
 * Description: Definition file for Chinese - China language-country.
 */const i=o["a"].languages.dictionaryKeys,r={languageCode:"zh-CN",[i.CONTEXTMENU_ITEMS_ROW_ABOVE]:"",[i.CONTEXTMENU_ITEMS_ROW_BELOW]:"",[i.CONTEXTMENU_ITEMS_INSERT_LEFT]:"",[i.CONTEXTMENU_ITEMS_INSERT_RIGHT]:"",[i.CONTEXTMENU_ITEMS_REMOVE_ROW]:["",""],[i.CONTEXTMENU_ITEMS_REMOVE_COLUMN]:["",""],[i.CONTEXTMENU_ITEMS_UNDO]:"",[i.CONTEXTMENU_ITEMS_REDO]:"",[i.CONTEXTMENU_ITEMS_READ_ONLY]:"",[i.CONTEXTMENU_ITEMS_CLEAR_COLUMN]:"",[i.CONTEXTMENU_ITEMS_ALIGNMENT]:"",[i.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT]:"",[i.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER]:"",[i.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT]:"",[i.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY]:"",[i.CONTEXTMENU_ITEMS_ALIGNMENT_TOP]:"",[i.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE]:"",[i.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM]:"",[i.CONTEXTMENU_ITEMS_FREEZE_COLUMN]:"",[i.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN]:"",[i.CONTEXTMENU_ITEMS_BORDERS]:"",[i.CONTEXTMENU_ITEMS_BORDERS_TOP]:"",[i.CONTEXTMENU_ITEMS_BORDERS_RIGHT]:"",[i.CONTEXTMENU_ITEMS_BORDERS_BOTTOM]:"",[i.CONTEXTMENU_ITEMS_BORDERS_LEFT]:"",[i.CONTEXTMENU_ITEMS_REMOVE_BORDERS]:"",[i.CONTEXTMENU_ITEMS_ADD_COMMENT]:"",[i.CONTEXTMENU_ITEMS_EDIT_COMMENT]:"",[i.CONTEXTMENU_ITEMS_REMOVE_COMMENT]:"",[i.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT]:"",[i.CONTEXTMENU_ITEMS_MERGE_CELLS]:"",[i.CONTEXTMENU_ITEMS_UNMERGE_CELLS]:"",[i.CONTEXTMENU_ITEMS_COPY]:"",[i.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS]:"",[i.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS]:"",[i.CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY]:"",[i.CONTEXTMENU_ITEMS_CUT]:"",[i.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD]:"",[i.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD]:"",[i.CONTEXTMENU_ITEMS_HIDE_COLUMN]:["",""],[i.CONTEXTMENU_ITEMS_SHOW_COLUMN]:["",""],[i.CONTEXTMENU_ITEMS_HIDE_ROW]:["",""],[i.CONTEXTMENU_ITEMS_SHOW_ROW]:["",""],[i.FILTERS_CONDITIONS_NONE]:"",[i.FILTERS_CONDITIONS_EMPTY]:"",[i.FILTERS_CONDITIONS_NOT_EMPTY]:"",[i.FILTERS_CONDITIONS_EQUAL]:"",[i.FILTERS_CONDITIONS_NOT_EQUAL]:"",[i.FILTERS_CONDITIONS_BEGINS_WITH]:"",[i.FILTERS_CONDITIONS_ENDS_WITH]:"",[i.FILTERS_CONDITIONS_CONTAINS]:"",[i.FILTERS_CONDITIONS_NOT_CONTAIN]:"",[i.FILTERS_CONDITIONS_GREATER_THAN]:"",[i.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL]:"",[i.FILTERS_CONDITIONS_LESS_THAN]:"",[i.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL]:"",[i.FILTERS_CONDITIONS_BETWEEN]:"",[i.FILTERS_CONDITIONS_NOT_BETWEEN]:"",[i.FILTERS_CONDITIONS_AFTER]:"",[i.FILTERS_CONDITIONS_BEFORE]:"",[i.FILTERS_CONDITIONS_TODAY]:"",[i.FILTERS_CONDITIONS_TOMORROW]:"",[i.FILTERS_CONDITIONS_YESTERDAY]:"",[i.FILTERS_VALUES_BLANK_CELLS]:"",[i.FILTERS_DIVS_FILTER_BY_CONDITION]:"",[i.FILTERS_DIVS_FILTER_BY_VALUE]:"",[i.FILTERS_LABELS_CONJUNCTION]:"",[i.FILTERS_LABELS_DISJUNCTION]:"",[i.FILTERS_BUTTONS_SELECT_ALL]:"",[i.FILTERS_BUTTONS_CLEAR]:"",[i.FILTERS_BUTTONS_OK]:"",[i.FILTERS_BUTTONS_CANCEL]:"",[i.FILTERS_BUTTONS_PLACEHOLDER_SEARCH]:"",[i.FILTERS_BUTTONS_PLACEHOLDER_VALUE]:"",[i.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE]:""};o["a"].languages.registerLanguageDictionary(r)},c24d:function(t,e,n){"use strict";n.d(e,"a",(function(){return B}));var o=n("c0d8"),i=n("2b0e");function r(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function s(t,e,n){return e=u(e),m(t,f()?Reflect.construct(e,n||[],u(t).constructor):e.apply(t,n))}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,v(o.key),o)}}function c(t,e,n){return e&&l(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function h(t,e,n){return(e=v(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function u(t){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},u(t)}function d(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&b(t,e)}function f(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(f=function(){return!!t})()}function g(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function p(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?g(Object(n),!0).forEach((function(e){h(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function m(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return r(t)}function b(t,e){return b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},b(t,e)}function w(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function v(t){var e=w(t,"string");return"symbol"==typeof e?e:e+""}function y(t){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},y(t)}var C=Symbol("unassigned"),S=null,O="The Handsontable instance bound to this component was destroyed and cannot be used properly.";function E(t){t.hotInstance&&(t.hotInstance.addHook("beforeChange",(function(){t.__internalEdit=!0})),t.hotInstance.addHook("beforeCreateRow",(function(){t.__internalEdit=!0})),t.hotInstance.addHook("beforeCreateCol",(function(){t.__internalEdit=!0})),t.hotInstance.addHook("beforeRemoveRow",(function(){t.__internalEdit=!0})),t.hotInstance.addHook("beforeRemoveCol",(function(){t.__internalEdit=!0})))}function R(t){var e=o["a"].hooks.getRegistered(),n={};for(var i in Object.assign(n,o["a"].DefaultSettings),n)n[i]={default:C};for(var r=0;r<e.length;r++)n[e[r]]={default:C};return n.settings={default:C},"HotTable"===t&&(n.id={type:String,default:"hot-"+Math.random().toString(36).substring(5)},n.wrapperRendererCacheSize={type:Number,default:3e3}),n}function T(t){var e={},n=t["settings"];if(n!==C)for(var o in n)n.hasOwnProperty(o)&&n[o]!==C&&(e[o]=n[o]);for(var i in t)t.hasOwnProperty(i)&&"settings"!==i&&t[i]!==C&&(e[i]=t[i]);return e}function M(t,e){var n=T(t),o=t.settings?t.settings:n,i=t.settings?n:null,r={};for(var s in o)!o.hasOwnProperty(s)||void 0===o[s]||e&&"data"!==s&&A(e[s],o[s])||(r[s]=o[s]);for(var a in i)!i.hasOwnProperty(a)||"id"===a||"settings"===a||"wrapperRendererCacheSize"===a||void 0===i[a]||e&&"data"!==a&&A(e[a],i[a])||(r[a]=i[a]);return r}function I(t,e){var n=null;return t.every((function(t,o){return!t.data||!t.data.attrs||void 0===t.data.attrs[e]||(n=t,!1)})),n}function x(t){return t.filter((function(t){return"HotColumn"===t.$options.name}))}function N(t,e,n,o){var i=e.$el?e.$el.ownerDocument:document,r={propsData:n,parent:e,data:o};S||(S=i.createElement("DIV"),S.id="vueHotComponents",i.body.appendChild(S));var s=i.createElement("DIV");return S.appendChild(s),new t.componentOptions.Ctor(r).$mount(s)}function A(t,e){var n=function(t){var e=function(){var t=new WeakSet;return function(e,n){if("object"===y(n)&&null!==n){if(t.has(n))return;t.add(n)}return n}}();return JSON.stringify(t,e)};return"function"===typeof t&&"function"===typeof e?t.toString()===e.toString():y(t)===y(e)&&n(t)===n(e)}var H="14.6.1",j=("undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self&&self,{});(function(t){(function(e,n){var o=t;n(o)})(0,(function(t){var e=Symbol("newer"),n=Symbol("older");function o(t,e){"number"!==typeof t&&(e=t,t=0),this.size=0,this.limit=t,this.oldest=this.newest=void 0,this._keymap=new Map,e&&(this.assign(e),t<1&&(this.limit=this.size))}function i(t,o){this.key=t,this.value=o,this[e]=void 0,this[n]=void 0}t.LRUMap=o,o.prototype._markEntryAsUsed=function(t){t!==this.newest&&(t[e]&&(t===this.oldest&&(this.oldest=t[e]),t[e][n]=t[n]),t[n]&&(t[n][e]=t[e]),t[e]=void 0,t[n]=this.newest,this.newest&&(this.newest[e]=t),this.newest=t)},o.prototype.assign=function(t){var o,r=this.limit||Number.MAX_VALUE;this._keymap.clear();for(var s=t[Symbol.iterator](),a=s.next();!a.done;a=s.next()){var l=new i(a.value[0],a.value[1]);if(this._keymap.set(l.key,l),o?(o[e]=l,l[n]=o):this.oldest=l,o=l,0==r--)throw new Error("overflow")}this.newest=o,this.size=this._keymap.size},o.prototype.get=function(t){var e=this._keymap.get(t);if(e)return this._markEntryAsUsed(e),e.value},o.prototype.set=function(t,o){var r=this._keymap.get(t);return r?(r.value=o,this._markEntryAsUsed(r),this):(this._keymap.set(t,r=new i(t,o)),this.newest?(this.newest[e]=r,r[n]=this.newest):this.oldest=r,this.newest=r,++this.size,this.size>this.limit&&this.shift(),this)},o.prototype.shift=function(){var t=this.oldest;if(t)return this.oldest[e]?(this.oldest=this.oldest[e],this.oldest[n]=void 0):(this.oldest=void 0,this.newest=void 0),t[e]=t[n]=void 0,this._keymap["delete"](t.key),--this.size,[t.key,t.value]},o.prototype.has=function(t){return this._keymap.has(t)}}))})(j);var _={name:"HotTable",props:R("HotTable"),watch:{mergedHotSettings:function(t){this.hotInstance&&void 0!==t&&(t.data&&(this.hotInstance.isColumnModificationAllowed()||!this.hotInstance.isColumnModificationAllowed()&&this.hotInstance.countSourceCols()===this.miscCache.currentSourceColumns)&&(this.matchHotMappersSize(),delete t.data),Object.keys(t).length?this.hotInstance.updateSettings(t):this.hotInstance.render(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols())}},data:function(){var t=this,e=new j.LRUMap(this.wrapperRendererCacheSize);return e.shift=function(){var t=j.LRUMap.prototype.shift.call(this);return t[1].component.$destroy(),t},{__internalEdit:!1,miscCache:{currentSourceColumns:null},__hotInstance:null,columnSettings:null,rendererCache:e,editorCache:new Map,get hotInstance(){return!t.__hotInstance||t.__hotInstance&&!t.__hotInstance.isDestroyed?t.__hotInstance:(console.warn(O),null)},set hotInstance(e){t.__hotInstance=e}}},computed:{mergedHotSettings:function(){return M(this.$props,this.hotInstance?this.hotInstance.getSettings():void 0)}},methods:{hotInit:function(){var t=this.getGlobalRendererVNode(),e=this.getGlobalEditorVNode(),n=M(this.$props);n.columns=this.columnSettings?this.columnSettings:n.columns,e&&(n.editor=this.getEditorClass(e,this),e.child.$destroy()),t&&(n.renderer=this.getRendererWrapper(t,this),t.child.$destroy()),this.hotInstance=new o["a"].Core(this.$el,n),this.hotInstance.init(),E(this),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols()},matchHotMappersSize:function(){var t=this;if(this.hotInstance){var e,n=this.hotInstance.getSourceData(),o=[],i=[],r=this.hotInstance.rowIndexMapper.getNumberOfIndexes(),s=this.hotInstance.isColumnModificationAllowed(),a=0;if(n&&n.length!==r&&n.length<r)for(var l=n.length;l<r;l++)o.push(l);if(s)if(a=this.hotInstance.columnIndexMapper.getNumberOfIndexes(),n&&n[0]&&(null===(e=n[0])||void 0===e?void 0:e.length)!==a&&n[0].length<a)for(var c=n[0].length;c<a;c++)i.push(c);this.hotInstance.batch((function(){o.length>0?t.hotInstance.rowIndexMapper.removeIndexes(o):t.hotInstance.rowIndexMapper.insertIndexes(r-1,n.length-r),s&&0!==n.length&&(i.length>0?t.hotInstance.columnIndexMapper.removeIndexes(i):t.hotInstance.columnIndexMapper.insertIndexes(a-1,n[0].length-a))}))}},getGlobalRendererVNode:function(){var t=this.$slots["default"]||[];return I(t,"hot-renderer")},getGlobalEditorVNode:function(){var t=this.$slots["default"]||[];return I(t,"hot-editor")},getColumnSettings:function(){var t=x(this.$children),e=!1,n=t.map((function(t){return t.usesRendererComponent&&(e=!0),p({},t.columnSettings)}));return e&&this.settings&&(!1!==this.settings.autoColumnSize||this.settings.autoRowSize)&&(!1!==this.autoColumnSize||this.autoRowSize)&&console.warn("Your `hot-table` configuration includes both `hot-column` and `autoRowSize`/`autoColumnSize`, which are not compatible with each other in this version of `@handsontable/vue`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment."),n.length?n:void 0},getRendererWrapper:function(t,e){var n=this;return function(o,i,r,s,a,l,c){if(i&&!i.getAttribute("ghost-table")){var h=n.rendererCache,u={hotInstance:o,TD:i,row:r,col:s,prop:a,value:l,cellProperties:c,isRenderer:!0};if(h&&!h.has("".concat(r,"-").concat(s))){var d=N(t,e,t.componentOptions.propsData,u);h.set("".concat(r,"-").concat(s),{component:d,lastUsedTD:null})}var f=h.get("".concat(r,"-").concat(s)),g=f.component,p=f.lastUsedTD;if(Object.assign(g.$data,u),!g.$el.parentElement||p!==i){while(i.firstChild)i.removeChild(i.firstChild);i.appendChild(g.$el),f.lastUsedTD=i}}return i}},getEditorClass:function(t,e){var n=t.key?t.key.toString():null,o=t.componentOptions.Ctor.options.name,i=n?"".concat(o,":").concat(n):o,r=this.editorCache,s=null;return r.has(i)?s=r.get(i):(s=N(t,e,t.componentOptions.propsData,{isEditor:!0}),r.set(i,s)),s.$data.hotCustomEditorClass}},mounted:function(){return this.columnSettings=this.getColumnSettings(),this.hotInit()},beforeDestroy:function(){this.hotInstance&&this.hotInstance.destroy()},version:H};function k(t,e,n,o,i,r,s,a,l,c){const h="function"===typeof n?n.options:n;return t&&t.render&&(h.render=t.render,h.staticRenderFns=t.staticRenderFns,h._compiled=!0,i&&(h.functional=!0)),n}var P=_,D=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:t.id}},[t._t("default")],2)},L=[],F=void 0,V=void 0,W=!1,B=k({render:D,staticRenderFns:L},F,P,V,W);R("HotColumn");function U(t,e,n,o){var i,r=arguments.length,s=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(r<3?i(s):r>3?i(e,n,s):i(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s}function z(t){return z="function"===typeof Symbol&&"symbol"===y(Symbol.iterator)?function(t){return y(t)}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":y(t)},z(t)}function G(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Y(t){return X(t)||$(t)||K()}function X(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}function $(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function K(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function q(){return"undefined"!==typeof Reflect&&Reflect.defineMetadata&&Reflect.getOwnMetadataKeys}function Q(t,e){J(t,e),Object.getOwnPropertyNames(e.prototype).forEach((function(n){J(t.prototype,e.prototype,n)})),Object.getOwnPropertyNames(e).forEach((function(n){J(t,e,n)}))}function J(t,e,n){var o=n?Reflect.getOwnMetadataKeys(e,n):Reflect.getOwnMetadataKeys(e);o.forEach((function(o){var i=n?Reflect.getOwnMetadata(o,e,n):Reflect.getOwnMetadata(o,e);n?Reflect.defineMetadata(o,i,t,n):Reflect.defineMetadata(o,i,t)}))}"function"===typeof SuppressedError&&SuppressedError;var Z={__proto__:[]},tt=Z instanceof Array;function et(t){var e=z(t);return null==t||"object"!==e&&"function"!==e}function nt(t,e){var n=e.prototype._init;e.prototype._init=function(){var e=this,n=Object.getOwnPropertyNames(t);if(t.$options.props)for(var o in t.$options.props)t.hasOwnProperty(o)||n.push(o);n.forEach((function(n){Object.defineProperty(e,n,{get:function(){return t[n]},set:function(e){t[n]=e},configurable:!0})}))};var o=new e;e.prototype._init=n;var i={};return Object.keys(o).forEach((function(t){void 0!==o[t]&&(i[t]=o[t])})),i}var ot=["data","beforeCreate","created","beforeMount","mounted","beforeDestroy","destroyed","beforeUpdate","updated","activated","deactivated","render","errorCaptured","serverPrefetch"];function it(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.name=e.name||t._componentTag||t.name;var n=t.prototype;Object.getOwnPropertyNames(n).forEach((function(t){if("constructor"!==t)if(ot.indexOf(t)>-1)e[t]=n[t];else{var o=Object.getOwnPropertyDescriptor(n,t);void 0!==o.value?"function"===typeof o.value?(e.methods||(e.methods={}))[t]=o.value:(e.mixins||(e.mixins=[])).push({data:function(){return G({},t,o.value)}}):(o.get||o.set)&&((e.computed||(e.computed={}))[t]={get:o.get,set:o.set})}})),(e.mixins||(e.mixins=[])).push({data:function(){return nt(this,t)}});var o=t.__decorators__;o&&(o.forEach((function(t){return t(e)})),delete t.__decorators__);var r=Object.getPrototypeOf(t.prototype),s=r instanceof i["default"]?r.constructor:i["default"],a=s.extend(e);return st(a,t,s),q()&&Q(a,t),a}var rt={prototype:!0,arguments:!0,callee:!0,caller:!0};function st(t,e,n){Object.getOwnPropertyNames(e).forEach((function(o){if(!rt[o]){var i=Object.getOwnPropertyDescriptor(t,o);if(!i||i.configurable){var r=Object.getOwnPropertyDescriptor(e,o);if(!tt){if("cid"===o)return;var s=Object.getOwnPropertyDescriptor(n,o);if(!et(r.value)&&s&&s.value===r.value)return}Object.defineProperty(t,o,r)}}}))}function at(t){return"function"===typeof t?it(t):function(e){return it(e,t)}}at.registerHooks=function(t){ot.push.apply(ot,Y(t))};var lt=function(t){function e(){var t;return a(this,e),t=s(this,e,arguments),t.name="BaseEditorComponent",t.instance=null,t.row=null,t.col=null,t.prop=null,t.TD=null,t.originalValue=null,t.cellProperties=null,t.state=null,t.hot=null,t}return d(e,t),c(e,[{key:"mounted",value:function(){var t=this;this.$data.hotCustomEditorClass=function(){var e=function(e){function n(e){var o;return a(this,n),o=s(this,n,[e]),t.$data.hotCustomEditorInstance=o,o}return d(n,e),c(n,[{key:"focus",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}}])}(o["a"].editors.BaseEditor);return Object.getOwnPropertyNames(o["a"].editors.BaseEditor.prototype).forEach((function(n){"constructor"!==n&&(e.prototype[n]=function(){for(var e,o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return(e=t[n]).call.apply(e,[this].concat(i))})})),e}()}},{key:"_fireCallbacks",value:function(){for(var t,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];(t=o["a"].editors.BaseEditor.prototype._fireCallbacks).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"beginEditing",value:function(){for(var t,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return(t=o["a"].editors.BaseEditor.prototype.beginEditing).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"cancelChanges",value:function(){for(var t,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return(t=o["a"].editors.BaseEditor.prototype.cancelChanges).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"checkEditorSection",value:function(){for(var t,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return(t=o["a"].editors.BaseEditor.prototype.checkEditorSection).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"close",value:function(){for(var t,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return(t=o["a"].editors.BaseEditor.prototype.close).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"discardEditor",value:function(){for(var t,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return(t=o["a"].editors.BaseEditor.prototype.discardEditor).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"enableFullEditMode",value:function(){for(var t,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return(t=o["a"].editors.BaseEditor.prototype.enableFullEditMode).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"extend",value:function(){for(var t,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return(t=o["a"].editors.BaseEditor.prototype.extend).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"finishEditing",value:function(){for(var t,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return(t=o["a"].editors.BaseEditor.prototype.finishEditing).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"focus",value:function(){for(var t,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return(t=o["a"].editors.BaseEditor.prototype.focus).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"getValue",value:function(){for(var t,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return(t=o["a"].editors.BaseEditor.prototype.getValue).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"init",value:function(){for(var t,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return(t=o["a"].editors.BaseEditor.prototype.init).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"isInFullEditMode",value:function(){for(var t,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return(t=o["a"].editors.BaseEditor.prototype.isInFullEditMode).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"isOpened",value:function(){for(var t,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return(t=o["a"].editors.BaseEditor.prototype.isOpened).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"isWaiting",value:function(){for(var t,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return(t=o["a"].editors.BaseEditor.prototype.isWaiting).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"open",value:function(){for(var t,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return(t=o["a"].editors.BaseEditor.prototype.open).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"prepare",value:function(t,e,n,i,r,s){return this.$data.hotInstance=s.instance,this.$data.row=t,this.$data.col=e,this.$data.prop=n,this.$data.TD=i,this.$data.originalValue=r,this.$data.cellProperties=s,o["a"].editors.BaseEditor.prototype.prepare.call(this.$data.hotCustomEditorInstance,t,e,n,i,r,s)}},{key:"saveValue",value:function(){for(var t,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return(t=o["a"].editors.BaseEditor.prototype.saveValue).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"setValue",value:function(){for(var t,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return(t=o["a"].editors.BaseEditor.prototype.setValue).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"addHook",value:function(){for(var t,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return(t=o["a"].editors.BaseEditor.prototype.addHook).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"removeHooksByKey",value:function(){for(var t,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return(t=o["a"].editors.BaseEditor.prototype.removeHooksByKey).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"clearHooks",value:function(){for(var t,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return(t=o["a"].editors.BaseEditor.prototype.clearHooks).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"getEditedCell",value:function(){for(var t,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return(t=o["a"].editors.BaseEditor.prototype.getEditedCell).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"getEditedCellRect",value:function(){for(var t,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return(t=o["a"].editors.BaseEditor.prototype.getEditedCellRect).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"getEditedCellsZIndex",value:function(){for(var t,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return(t=o["a"].editors.BaseEditor.prototype.getEditedCellsZIndex).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"getEditedCellsLayerClass",value:function(){for(var t,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return(t=o["a"].editors.BaseEditor.prototype.getEditedCellsLayerClass).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}}])}(i["default"]);lt=U([at({})],lt)},c272:function(t,e,n){"use strict";t.exports={}},c4fa:function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return i}));const o="gridDefault",i="editorManager.handlingEditor"},c5ae:function(t,e,n){"use strict";var o=n("9e75"),i=Math.min;t.exports=function(t){var e=o(t);return e>0?i(e,9007199254740991):0}},c5cd:function(t,e,n){"use strict";n.d(e,"a",(function(){return h})),n.d(e,"b",(function(){return u}));n("7a89");var o=n("7b9c"),i=n("351d"),r=n("7ae0");function s(t,e,n){return(e=a(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a(t){var e=l(t,"string");return"symbol"==typeof e?e:e+""}function l(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}let c=0;class h{constructor(){s(this,"collection",new Map)}register(t,e){!1===this.collection.has(t)&&(this.collection.set(t,e),e.addLocalHook("change",()=>this.runLocalHooks("change",e)),c+=1)}unregister(t){const e=this.collection.get(t);Object(o["isDefined"])(e)&&(e.destroy(),this.collection.delete(t),this.runLocalHooks("change",e),c-=1)}unregisterAll(){this.collection.forEach((t,e)=>this.unregister(e)),this.collection.clear()}get(t){return Object(o["isUndefined"])(t)?Array.from(this.collection.values()):this.collection.get(t)}getLength(){return this.collection.size}removeFromEvery(t){this.collection.forEach(e=>{e.remove(t)})}insertToEvery(t,e){this.collection.forEach(n=>{n.insert(t,e)})}initEvery(t){this.collection.forEach(e=>{e.init(t)})}}function u(){return c}Object(i["mixin"])(h,r["a"])},c5d7:function(t,e,n){"use strict";var o=n("ac4f"),i=n("7064"),r=n("88c5");o({target:"Set",proto:!0,real:!0,forced:!r("union")},{union:i})},c9a1:function(t,e,n){"use strict";var o=n("54ad"),i=o.navigator,r=i&&i.userAgent;t.exports=r?String(r):""},cac7:function(t,e,n){"use strict";var o=n("d128"),i=n("a60d"),r=n("1caf");t.exports=function(t,e,n){o?i.f(t,e,r(0,n)):t[e]=n}},cb29:function(t,e,n){var o=n("23e7"),i=n("81d5"),r=n("44d2");o({target:"Array",proto:!0},{fill:i}),r("fill")},cbf2:function(t,e,n){"use strict";var o=n("80dd"),i=n("c272"),r=o("iterator"),s=Array.prototype;t.exports=function(t){return void 0!==t&&(i.Array===t||s[r]===t)}},cef7:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));n("d06e");var o=n("9f10"),i=n("81ea");class r extends o["a"]{constructor(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];super(t)}getHiddenIndexes(){return Object(i["arrayReduce"])(this.getValues(),(t,e,n)=>(e&&t.push(n),t),[])}}},cf36:function(t,e,n){"use strict";var o=n("b343"),i=n("1caf");t.exports=!o((function(){var t=new Error("a");return!("stack"in t)||(Object.defineProperty(t,"stack",i(1,7)),7!==t.stack)}))},d06e:function(t,e,n){"use strict";var o=n("ac4f"),i=n("fc2d"),r=n("7dcf4"),s=n("2349"),a=n("ae20"),l=n("b343"),c=l((function(){return 4294967297!==[].push.call({length:4294967296},1)})),h=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}},u=c||!h();o({target:"Array",proto:!0,arity:1,forced:u},{push:function(t){var e=i(this),n=r(e),o=arguments.length;a(n+o);for(var l=0;l<o;l++)e[n]=arguments[l],n++;return s(e,n),n}})},d128:function(t,e,n){"use strict";var o=n("b343");t.exports=!o((function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]}))},d233:function(t,e,n){"use strict";var o=Object.prototype.hasOwnProperty,i=function(){for(var t=[],e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t}(),r=function(t){var e;while(t.length){var n=t.pop();if(e=n.obj[n.prop],Array.isArray(e)){for(var o=[],i=0;i<e.length;++i)"undefined"!==typeof e[i]&&o.push(e[i]);n.obj[n.prop]=o}}return e},s=function(t,e){for(var n=e&&e.plainObjects?Object.create(null):{},o=0;o<t.length;++o)"undefined"!==typeof t[o]&&(n[o]=t[o]);return n},a=function t(e,n,i){if(!n)return e;if("object"!==typeof n){if(Array.isArray(e))e.push(n);else{if(!e||"object"!==typeof e)return[e,n];(i&&(i.plainObjects||i.allowPrototypes)||!o.call(Object.prototype,n))&&(e[n]=!0)}return e}if(!e||"object"!==typeof e)return[e].concat(n);var r=e;return Array.isArray(e)&&!Array.isArray(n)&&(r=s(e,i)),Array.isArray(e)&&Array.isArray(n)?(n.forEach((function(n,r){if(o.call(e,r)){var s=e[r];s&&"object"===typeof s&&n&&"object"===typeof n?e[r]=t(s,n,i):e.push(n)}else e[r]=n})),e):Object.keys(n).reduce((function(e,r){var s=n[r];return o.call(e,r)?e[r]=t(e[r],s,i):e[r]=s,e}),r)},l=function(t,e){return Object.keys(e).reduce((function(t,n){return t[n]=e[n],t}),t)},c=function(t){try{return decodeURIComponent(t.replace(/\+/g," "))}catch(e){return t}},h=function(t){if(0===t.length)return t;for(var e="string"===typeof t?t:String(t),n="",o=0;o<e.length;++o){var r=e.charCodeAt(o);45===r||46===r||95===r||126===r||r>=48&&r<=57||r>=65&&r<=90||r>=97&&r<=122?n+=e.charAt(o):r<128?n+=i[r]:r<2048?n+=i[192|r>>6]+i[128|63&r]:r<55296||r>=57344?n+=i[224|r>>12]+i[128|r>>6&63]+i[128|63&r]:(o+=1,r=65536+((1023&r)<<10|1023&e.charCodeAt(o)),n+=i[240|r>>18]+i[128|r>>12&63]+i[128|r>>6&63]+i[128|63&r])}return n},u=function(t){for(var e=[{obj:{o:t},prop:"o"}],n=[],o=0;o<e.length;++o)for(var i=e[o],s=i.obj[i.prop],a=Object.keys(s),l=0;l<a.length;++l){var c=a[l],h=s[c];"object"===typeof h&&null!==h&&-1===n.indexOf(h)&&(e.push({obj:s,prop:c}),n.push(h))}return r(e)},d=function(t){return"[object RegExp]"===Object.prototype.toString.call(t)},f=function(t){return null!==t&&"undefined"!==typeof t&&!!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t))};t.exports={arrayToObject:s,assign:l,compact:u,decode:c,encode:h,isBuffer:f,isRegExp:d,merge:a}},d2e4:function(t,e,n){"use strict";var o,i,r,s,a=n("54ad"),l=n("0204"),c=n("7d61"),h=n("73fa"),u=n("69ba"),d=n("b343"),f=n("f808"),g=n("9674"),p=n("2179"),m=n("6038"),b=n("b4f5"),w=n("911c"),v=a.setImmediate,y=a.clearImmediate,C=a.process,S=a.Dispatch,O=a.Function,E=a.MessageChannel,R=a.String,T=0,M={},I="onreadystatechange";d((function(){o=a.location}));var x=function(t){if(u(M,t)){var e=M[t];delete M[t],e()}},N=function(t){return function(){x(t)}},A=function(t){x(t.data)},H=function(t){a.postMessage(R(t),o.protocol+"//"+o.host)};v&&y||(v=function(t){m(arguments.length,1);var e=h(t)?t:O(t),n=g(arguments,1);return M[++T]=function(){l(e,void 0,n)},i(T),T},y=function(t){delete M[t]},w?i=function(t){C.nextTick(N(t))}:S&&S.now?i=function(t){S.now(N(t))}:E&&!b?(r=new E,s=r.port2,r.port1.onmessage=A,i=c(s.postMessage,s)):a.addEventListener&&h(a.postMessage)&&!a.importScripts&&o&&"file:"!==o.protocol&&!d(H)?(i=H,a.addEventListener("message",A,!1)):i=I in p("script")?function(t){f.appendChild(p("script"))[I]=function(){f.removeChild(this),x(t)}}:function(t){setTimeout(N(t),0)}),t.exports={set:v,clear:y}},d3e6:function(t,e,n){"use strict";var o=n("7d61"),i=n("7b69"),r=n("088f"),s=n("71ca"),a=n("cbf2"),l=n("7dcf4"),c=n("1e92"),h=n("bb2a"),u=n("9582"),d=n("142d"),f=TypeError,g=function(t,e){this.stopped=t,this.result=e},p=g.prototype;t.exports=function(t,e,n){var m,b,w,v,y,C,S,O=n&&n.that,E=!(!n||!n.AS_ENTRIES),R=!(!n||!n.IS_RECORD),T=!(!n||!n.IS_ITERATOR),M=!(!n||!n.INTERRUPTED),I=o(e,O),x=function(t){return m&&d(m,"normal",t),new g(!0,t)},N=function(t){return E?(r(t),M?I(t[0],t[1],x):I(t[0],t[1])):M?I(t,x):I(t)};if(R)m=t.iterator;else if(T)m=t;else{if(b=u(t),!b)throw new f(s(t)+" is not iterable");if(a(b)){for(w=0,v=l(t);v>w;w++)if(y=N(t[w]),y&&c(p,y))return y;return new g(!1)}m=h(t,b)}C=R?t.next:m.next;while(!(S=i(C,m)).done){try{y=N(S.value)}catch(A){d(m,"throw",A)}if("object"==typeof y&&y&&c(p,y))return y}return new g(!1)}},d435:function(t,e,n){"use strict";var o=n("d128"),i=n("b343"),r=n("2179");t.exports=!o&&!i((function(){return 7!==Object.defineProperty(r("div"),"a",{get:function(){return 7}}).a}))},d62b:function(t,e,n){"use strict";t.exports=!1},d852:function(t,e,n){"use strict";n("7a89"),n("d06e");var o=n("0716");function i(t,e,n){r(t,e),e.set(t,n)}function r(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function s(t,e,n){return(e=a(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a(t){var e=l(t,"string");return"symbol"==typeof e?e:e+""}function l(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function c(t,e){return t.get(u(t,e))}function h(t,e,n){return t.set(u(t,e),n),n}function u(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var d=new WeakMap;class f{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];s(this,"highlight",null),s(this,"from",null),s(this,"to",null),i(this,d,!1),this.highlight=t.clone(),this.from=e.clone(),this.to=n.clone(),h(d,this,o)}setHighlight(t){return this.highlight=t.clone(),this}setFrom(t){return this.from=t.clone(),this}setTo(t){return this.to=t.clone(),this}isValid(t){return this.from.isValid(t)&&this.to.isValid(t)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return!(!this.from.isHeader()||!this.to.isHeader())||(this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0)}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const t=Math.max(this.from.row,0),e=Math.max(this.to.row,0);return Math.max(t,e)-Math.min(t,e)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const t=Math.max(this.from.col,0),e=Math.max(this.to.col,0);return Math.max(t,e)-Math.min(t,e)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(t){const{row:e,col:n}=t,o=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();return o.row<=e&&i.row>=e&&o.col<=n&&i.col>=n}includesRange(t){return this.includes(t.getOuterTopStartCorner())&&this.includes(t.getOuterBottomEndCorner())}isEqual(t){return Math.min(this.from.row,this.to.row)===Math.min(t.from.row,t.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(t.from.row,t.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(t.from.col,t.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(t.from.col,t.to.col)}overlaps(t){return t.isSouthEastOf(this.getOuterTopLeftCorner())&&t.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(t){return this.getOuterTopLeftCorner().isSouthEastOf(t)||this.getOuterBottomRightCorner().isSouthEastOf(t)}isNorthWestOf(t){return this.getOuterTopLeftCorner().isNorthWestOf(t)||this.getOuterBottomRightCorner().isNorthWestOf(t)}isOverlappingHorizontally(t){return this.getOuterTopEndCorner().col>=t.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=t.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=t.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=t.getOuterTopStartCorner().col}isOverlappingVertically(t){return this.getOuterBottomStartCorner().row>=t.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=t.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=t.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=t.getOuterTopRightCorner().row}expand(t){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();return(t.row<e.row||t.col<e.col||t.row>n.row||t.col>n.col)&&(this.from=this._createCellCoords(Math.min(e.row,t.row),Math.min(e.col,t.col)),this.to=this._createCellCoords(Math.max(n.row,t.row),Math.max(n.col,t.col)),!0)}expandByRange(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.includesRange(t)||!this.overlaps(t))return!1;const n=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner(),i=this.getDirection(),r=t.getOuterTopStartCorner(),s=t.getOuterBottomEndCorner(),a=Math.min(n.row,r.row),l=Math.min(n.col,r.col),c=Math.max(o.row,s.row),h=Math.max(o.col,s.col),u=this._createCellCoords(a,l),d=this._createCellCoords(c,h);return this.from=u,this.to=d,this.setDirection(i),e&&(this.highlight.row===this.getOuterBottomRightCorner().row&&"N-S"===this.getVerticalDirection()&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&"W-E"===this.getHorizontalDirection()&&this.flipDirectionHorizontally()),!0}getDirection(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0}setDirection(t){switch(t){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break;default:break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){const t=this.getDirection();switch(t){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break;default:break}}flipDirectionHorizontally(){const t=this.getDirection();switch(t){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break;default:break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return c(d,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return c(d,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return c(d,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return c(d,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return c(d,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return c(d,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return c(d,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return c(d,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(t){return t.isEqual(this.getOuterTopLeftCorner())||t.isEqual(this.getOuterTopRightCorner())||t.isEqual(this.getOuterBottomLeftCorner())||t.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(t){return t instanceof o["a"]&&(t.isEqual(this.getOuterBottomEndCorner())?this.getOuterTopStartCorner():t.isEqual(this.getOuterTopStartCorner())?this.getOuterBottomEndCorner():t.isEqual(this.getOuterTopEndCorner())?this.getOuterBottomStartCorner():t.isEqual(this.getOuterBottomStartCorner())?this.getOuterTopEndCorner():void 0)}getBordersSharedWith(t){if(!this.includesRange(t))return[];const e={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},n={top:Math.min(t.from.row,t.to.row),bottom:Math.max(t.from.row,t.to.row),left:Math.min(t.from.col,t.to.col),right:Math.max(t.from.col,t.to.col)},o=[];return e.top===n.top&&o.push("top"),e.right===n.right&&o.push(c(d,this)?"left":"right"),e.bottom===n.bottom&&o.push("bottom"),e.left===n.left&&o.push(c(d,this)?"right":"left"),o}getInner(){const t=this.getOuterTopStartCorner(),e=this.getOuterBottomEndCorner(),n=[];for(let o=t.row;o<=e.row;o++)for(let i=t.col;i<=e.col;i++)this.from.row===o&&this.from.col===i||this.to.row===o&&this.to.col===i||n.push(this._createCellCoords(o,i));return n}getAll(){const t=this.getOuterTopStartCorner(),e=this.getOuterBottomEndCorner(),n=[];for(let o=t.row;o<=e.row;o++)for(let i=t.col;i<=e.col;i++)t.row===o&&t.col===i?n.push(t):e.row===o&&e.col===i?n.push(e):n.push(this._createCellCoords(o,i));return n}forAll(t){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();for(let o=e.row;o<=n.row;o++)for(let i=e.col;i<=n.col;i++){const e=t(o,i);if(!1===e)return}}clone(){return new f(this.highlight,this.from,this.to,c(d,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(t,e){return new o["a"](t,e,c(d,this))}}e["a"]=f},dce9:function(t,e,n){"use strict";var o=n("ac4f"),i=n("fd18"),r=n("bf78"),s=n("9e75"),a=n("2408"),l=n("b343"),c=i("".charAt),h=l((function(){return"\ud842"!=="".at(-2)}));o({target:"String",proto:!0,forced:h},{at:function(t){var e=a(r(this)),n=e.length,o=s(t),i=o>=0?o:n+o;return i<0||i>=n?void 0:c(e,i)}})},dd49:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var o=n("a357"),i=n("5d7f"),r=n("7b9c");const s="text";function a(t,e,n,s,a,l,c){o["a"].apply(this,[t,e,n,s,a,l,c]);let h=l;if(!h&&c.placeholder&&(h=c.placeholder),h=Object(r["stringify"])(h),c.trimWhitespace&&(h=h.trim()),c.rendererTemplate){Object(i["empty"])(e);const o=t.rootDocument.createElement("TEMPLATE");o.setAttribute("bind","{{}}"),o.innerHTML=c.rendererTemplate,HTMLTemplateElement.decorate(o),o.model=t.getSourceDataAtRow(n),e.appendChild(o)}else Object(i["fastInnerText"])(e,h)}a.RENDERER_TYPE=s},de26:function(t,e,n){"use strict";var o=n("54d7");t.exports=function(t,e){return o[t]||(o[t]=e||{})}},de3b:function(t,e,n){"use strict";function o(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function i(t){return!1===t.isImmediatePropagationEnabled}function r(t){return 2===t.button}function s(t){return 0===t.button}function a(t){return t instanceof TouchEvent}function l(t,e){const n={x:t.offsetX,y:t.offsetY};let o=t.target;if(!(e instanceof HTMLElement)||o!==e&&o.contains(e))return n;while(o!==e)n.x+=o.offsetLeft,n.y+=o.offsetTop,o=o.offsetParent;return n}n.r(e),n.d(e,"stopImmediatePropagation",(function(){return o})),n.d(e,"isImmediatePropagationStopped",(function(){return i})),n.d(e,"isRightClick",(function(){return r})),n.d(e,"isLeftClick",(function(){return s})),n.d(e,"isTouchEvent",(function(){return a})),n.d(e,"offsetRelativeTo",(function(){return l}))},e156:function(t,e,n){"use strict";var o=n("12e9"),i=n("73fa"),r=n("939b"),s=n("80dd"),a=s("toStringTag"),l=Object,c="Arguments"===r(function(){return arguments}()),h=function(t,e){try{return t[e]}catch(n){}};t.exports=o?r:function(t){var e,n,o;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=h(e=l(t),a))?n:c?r(e):"Object"===(o=r(e))&&i(e.callee)?"Arguments":o}},e1c6:function(t,e,n){"use strict";t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},e285:function(t,e,n){var o=n("da84"),i=o.isFinite;t.exports=Number.isFinite||function(t){return"number"==typeof t&&i(t)}},e437:function(t,e,n){"use strict";var o={};n.r(o),n.d(o,"getNormalizedDate",(function(){return ve}));var i=n("c0d8"),r=(n("7a89"),n("d06e"),n("03529")),s=n("5d7f"),a=n("de3b"),l=n("351d"),c=n("c4fa");const h="handsontableEditor",u="handsontable";class d extends r["a"]{static get EDITOR_TYPE(){return u}open(){super.open(),this.htEditor&&this.htEditor.destroy(),"none"===this.htContainer.style.display&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),Object(s["setCaretPosition"])(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(t,e,n,o,i,r){super.prepare(t,e,n,o,i,r);const s=this,a={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,afterOnCellMouseDown(t,e){const n=this.getSourceData(e.row,e.col);void 0!==n&&s.setValue(n),s.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&Object(l["extend"])(a,r.handsontable),this.htOptions=a}beginEditing(t,e){const n=this.hot.getSettings().onBeginEditing;n&&!1===n()||super.beginEditing(t,e)}createElements(){super.createElements();const t=this.hot.rootDocument.createElement("DIV");t.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(t),this.htContainer=t,this.assignHooks()}finishEditing(t,e,n){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const t=this.htEditor.getValue();void 0!==t&&this.setValue(t)}super.finishEditing(t,e,n)}assignHooks(){this.hot.addHook("afterDestroy",()=>{this.htEditor&&this.htEditor.destroy()})}registerShortcuts(){const t=this.hot.getShortcutManager(),e=t.getContext("editor");super.registerShortcuts();const n={group:h,relativeToGroup:c["a"],position:"before"},o=(t,e)=>{const n=this.htEditor;if(void 0!==t&&(t<0||n.flipped&&t>n.countRows()-1?n.deselectCell():n.selectCell(t,0),n.getData().length))return e.preventDefault(),Object(a["stopImmediatePropagation"])(e),this.hot.listen(),this.TEXTAREA.focus(),!1};e.addShortcuts([{keys:[["ArrowUp"]],callback:t=>{const e=this.htEditor;let n,i;return!e.getSelectedLast()&&e.flipped?n=e.countRows()-1:e.getSelectedLast()&&(e.flipped?(i=e.getSelectedLast()[0],n=Math.max(0,i-1)):(i=e.getSelectedLast()[0],n=i-1)),o(n,t)},preventDefault:!1},{keys:[["ArrowDown"]],callback:t=>{const e=this.htEditor;let n,i;if(e.getSelectedLast()||e.flipped){if(e.getSelectedLast())if(e.flipped)n=e.getSelectedLast()[0]+1;else if(!e.flipped){const t=e.countRows()-1;i=e.getSelectedLast()[0],n=Math.min(t,i+1)}}else n=0;return o(n,t)},preventDefault:!1}],n)}unregisterShortcuts(){super.unregisterShortcuts();const t=this.hot.getShortcutManager(),e=t.getContext("editor");e.removeShortcutsByGroup(h)}}var f=n("81ea"),g=n("7b9c"),p=n("29b0"),m=n("f938"),b=n("63d8"),w=n("dd49"),v=n("8828");function y(t,e,n){C(t,e),e.set(t,n)}function C(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function S(t,e,n){return(e=O(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function O(t){var e=E(t,"string");return"symbol"==typeof e?e:e+""}function E(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function R(t,e){return t.get(T(t,e))}function T(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const M="autocomplete";var I=new WeakMap;class x extends d{constructor(){super(...arguments),S(this,"query",null),S(this,"strippedChoices",[]),S(this,"rawChoices",[]),y(this,I,this.hot.guid.slice(0,9)),S(this,"sortByRelevance",(function(t,e,n){const o=[],i=[],r=t.length;let s,a,l,c,h=e.length;if(0===r){for(l=0;l<h;l++)i.push(l);return i}for(l=0;l<h;l++){if(a=Object(p["stripTags"])(Object(g["stringify"])(e[l])),n)c=a.indexOf(t);else{const e=this.cellProperties.locale;c=a.toLocaleLowerCase(e).indexOf(t.toLocaleLowerCase(e))}-1!==c&&(s=a.length-c-r,o.push({baseIndex:l,index:c,charsLeft:s,value:a}))}for(o.sort((t,e)=>{if(-1===e.index)return-1;if(-1===t.index)return 1;if(t.index<e.index)return-1;if(e.index<t.index)return 1;if(t.index===e.index){if(t.charsLeft<e.charsLeft)return-1;if(t.charsLeft>e.charsLeft)return 1}return 0}),l=0,h=o.length;l<h;l++)i.push(o[l].baseIndex);return i}))}static get EDITOR_TYPE(){return M}getValue(){const t=this.rawChoices.find(t=>{const e=this.stripValueIfNeeded(t);return e===this.TEXTAREA.value});return Object(g["isDefined"])(t)?t:this.TEXTAREA.value}createElements(){super.createElements(),Object(s["addClass"])(this.htContainer,"autocompleteEditor"),Object(s["addClass"])(this.htContainer,-1===this.hot.rootWindow.navigator.platform.indexOf("Mac")?"":"htMacScroll"),this.hot.getSettings().ariaTags&&Object(s["setAttribute"])(this.TEXTAREA,[Object(v["M"])(),Object(v["h"])(),Object(v["m"])("listbox"),Object(v["b"])()])}prepare(t,e,n,o,i,r){super.prepare(t,e,n,o,i,r),this.hot.getSettings().ariaTags&&Object(s["setAttribute"])(this.TEXTAREA,[Object(v["k"])("false"),Object(v["i"])(`${R(I,this)}-listbox-${t}-${e}`)])}open(){super.open();const t=void 0===this.cellProperties.trimDropdown||this.cellProperties.trimDropdown,e=this.hot.getSettings().ariaTags,n=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,o=null===n||void 0===n?void 0:n.length,{row:i,col:r}=this;this.showEditableElement(),this.focus();let a=Object(s["getScrollbarWidth"])();0===a&&Object(b["isMacOS"])()&&(a+=15),this.addHook("beforeKeyDown",t=>this.onBeforeKeyDown(t)),this.htEditor.updateSettings({colWidths:t?[Object(s["outerWidth"])(this.TEXTAREA)-2]:void 0,width:t?Object(s["outerWidth"])(this.TEXTAREA)+a:void 0,autoColumnSize:!0,renderer:(t,i,r,a,l,c,h)=>{Object(w["a"])(t,i,r,a,l,c,h);const{filteringCaseSensitive:u,allowHtml:d,locale:f}=this.cellProperties,p=this.query;let m,b,y=Object(g["stringify"])(c);y&&!d&&(m=!0===u?y.indexOf(p):y.toLocaleLowerCase(f).indexOf(p.toLocaleLowerCase(f)),-1!==m&&(b=y.substr(m,p.length),y=y.replace(b,`<strong>${b}</strong>`))),e&&Object(s["setAttribute"])(i,[Object(v["w"])(),...n?[Object(v["J"])(o)]:[],...n?[Object(v["x"])(n.indexOf(c)+1)]:[],["id",`${this.htEditor.rootElement.id}_${r}-${a}`]]),i.innerHTML=y},afterSelectionEnd:(t,n)=>{if(e){const e=this.htEditor.getCell(t,n,!0);Object(s["setAttribute"])(e,[Object(v["I"])()]),Object(s["setAttribute"])(this.TEXTAREA,...Object(v["a"])(e.id))}}}),e&&(Object(s["setAttribute"])(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...Object(v["y"])()),Object(s["setAttribute"])(this.htEditor.rootElement,[Object(v["q"])(),Object(v["r"])("polite"),Object(v["A"])("text"),["id",`${R(I,this)}-listbox-${i}-${r}`]]),Object(s["setAttribute"])(this.TEXTAREA,...Object(v["k"])("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&Object(s["setAttribute"])(this.TEXTAREA,[Object(v["k"])("false")])}discardEditor(t){super.discardEditor(t),this.hot.view.render()}queryChoices(t){const e=this.cellProperties.source;this.query=t,"function"===typeof e?e.call(this.cellProperties,t,t=>{this.rawChoices=t,this.updateChoicesList(this.stripValuesIfNeeded(t))}):Array.isArray(e)?(this.rawChoices=e,this.updateChoicesList(this.stripValuesIfNeeded(e))):this.updateChoicesList([])}updateChoicesList(t){const e=Object(s["getCaretPosition"])(this.TEXTAREA),n=Object(s["getSelectionEndPosition"])(this.TEXTAREA),o=this.cellProperties.sortByRelevance,i=this.cellProperties.filter;let r=null,a=null,l=t;o&&(r=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const c=Array.isArray(r)?r.length:0;if(!1===i)c&&(a=r[0]);else{const t=[];for(let e=0,n=l.length;e<n;e++){if(o&&c<=e)break;c?t.push(l[r[e]]):t.push(l[e])}a=0,l=t}this.strippedChoices=l,0===l.length?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(Object(f["pivot"])([l])),l.length>0&&(this.updateDropdownDimensions(),this.flipDropdownIfNeeded(),!0===this.cellProperties.strict&&this.highlightBestMatchingChoice(a)),this.hot.listen(),Object(s["setCaretPosition"])(this.TEXTAREA,e,e===n?void 0:n)}flipDropdownIfNeeded(){const t=Object(s["getTrimmingContainer"])(this.hot.view._wt.wtTable.TABLE),e=t===this.hot.rootWindow,n=this.cellProperties.preventOverflow;if(e||!e&&(n||"horizontal"===n))return!1;const o=Object(s["offset"])(this.TEXTAREA),i=Object(s["outerHeight"])(this.TEXTAREA),r=this.getDropdownHeight(),a=t.scrollTop,l=Object(s["outerHeight"])(this.hot.view._wt.wtTable.THEAD),c=Object(s["offset"])(t),h=o.top-c.top-l+a,u=t.scrollHeight-h-l-i,d=r>u&&h>u;return d?this.flipDropdown(r):this.unflipDropdown(),this.limitDropdownIfNeeded(d?h:u,r),d}limitDropdownIfNeeded(t,e){if(e>t){let n=0,o=0,i=0,r=null;do{i=this.htEditor.getRowHeight(o)||this.htEditor.view._wt.getSetting("defaultRowHeight"),n+=i,o+=1}while(n<t);r=n-i,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=parseInt(this.htEditor.rootElement.style.top,10)+e-r+"px"),this.setDropdownHeight(n-i)}}flipDropdown(t){const e=this.htEditor.rootElement.style;e.position="absolute",e.top=-t+"px",this.htEditor.flipped=!0}unflipDropdown(){const t=this.htEditor.rootElement.style;t.position="absolute",t.top="",this.htEditor.flipped=void 0}updateDropdownDimensions(){const t=this.htEditor.getColWidth(0)+Object(s["getScrollbarWidth"])(this.hot.rootDocument)+2,e=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:e?void 0:t}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(t){this.htEditor.updateSettings({height:t})}highlightBestMatchingChoice(t){"number"===typeof t?this.htEditor.selectCell(t,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getDropdownHeight(){const t=this.htEditor.getRowHeight(0)||23,e=this.cellProperties.visibleRows;return this.strippedChoices.length>=e?e*t:this.strippedChoices.length*t+8}stripValueIfNeeded(t){return this.stripValuesIfNeeded([t])[0]}stripValuesIfNeeded(t){const{allowHtml:e}=this.cellProperties,n=Object(f["arrayMap"])(t,t=>Object(g["stringify"])(t)),o=Object(f["arrayMap"])(n,t=>e?t:Object(p["stripTags"])(t));return o}allowKeyEventPropagation(t){const e=this.htEditor.getSelectedRangeLast(),n={row:e?e.from.row:-1};let o=!1;return t===m["KEY_CODES"].ARROW_DOWN&&n.row>0&&n.row<this.htEditor.countRows()-1&&(o=!0),t===m["KEY_CODES"].ARROW_UP&&n.row>-1&&(o=!0),o}onBeforeKeyDown(t){if(Object(m["isPrintableChar"])(t.keyCode)||t.keyCode===m["KEY_CODES"].BACKSPACE||t.keyCode===m["KEY_CODES"].DELETE||t.keyCode===m["KEY_CODES"].INSERT){let e=10;if(t.keyCode===m["KEY_CODES"].C&&(t.ctrlKey||t.metaKey))return;this.isOpened()||(e+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},e)}}}var N=n("13e1");const A="checkbox";class H extends N["a"]{static get EDITOR_TYPE(){return A}beginEditing(t,e){if(e&&"mouseup"===e.type&&"TD"===e.target.nodeName){const t=this.TD.querySelector('input[type="checkbox"]');Object(s["hasClass"])(t,"htBadValue")||t.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}var j=n("c1df");
/*!
 * Pikaday
 *
 * Copyright  2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */const _=()=>window,k=()=>window.document,P=(t,e)=>window.setTimeout(t,e),D=function(t,e,n,o){t.addEventListener(e,n,!!o)},L=function(t,e,n,o){t.removeEventListener(e,n,!!o)},F=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},V=function(t,e){return-1!==(" "+t.className+" ").indexOf(" "+e+" ")},W=function(t,e){V(t,e)||(t.className=""===t.className?e:t.className+" "+e)},B=function(t,e){t.className=F((" "+t.className+" ").replace(" "+e+" "," "))},U=function(t){return/Array/.test(Object.prototype.toString.call(t))},z=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},G=function(t){let e=t.getDay();return 0===e||6===e},Y=function(t){return t%4===0&&t%100!==0||t%400===0},X=function(t,e){return[31,Y(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},$=function(t){z(t)&&t.setHours(0,0,0,0)},K=function(t,e){return t.getTime()===e.getTime()},q=function(t,e,n){let o,i;for(o in e)i=void 0!==t[o],i&&"object"===typeof e[o]&&null!==e[o]&&void 0===e[o].nodeName?z(e[o])?n&&(t[o]=new Date(e[o].getTime())):U(e[o])?n&&(t[o]=e[o].slice(0)):t[o]=q({},e[o],n):!n&&i||(t[o]=e[o]);return t},Q=function(t,e,n){let o=k().createEvent("HTMLEvents");o.initEvent(e,!0,!1),o=q(o,n),t.dispatchEvent(o)},J=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},Z={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},tt=function(t,e,n){e+=t.firstDay;while(e>=7)e-=7;return n?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},et=function(t){let e=[],n="false";if(t.isEmpty){if(!t.showDaysInNextAndPreviousMonths)return'<td class="is-empty"></td>';e.push("is-outside-current-month"),t.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled")}return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),n="true"),t.hasEvent&&e.push("has-event"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+n+'"><button class="pika-button pika-day" type="button" data-pika-year="'+t.year+'" data-pika-month="'+t.month+'" data-pika-day="'+t.day+'">'+t.day+"</button></td>"},nt=function(t,e){t.setHours(0,0,0,0);let n=t.getDate(),o=t.getDay(),i=e,r=i-1,s=7,a=function(t){return(t+s-1)%s};t.setDate(n+r-a(o));let l=new Date(t.getFullYear(),0,i),c=864e5,h=(t.getTime()-l.getTime())/c,u=1+Math.round((h-r+a(l.getDay()))/s);return u},ot=function(t,e,n,o,i){let r=new Date(o,n,e),s=t.hasMoment?t.moment(r).isoWeek():nt(r,i);return'<td class="pika-week">'+s+"</td>"},it=function(t,e,n,o){return'<tr class="pika-row'+(n?" pick-whole-week":"")+(o?" is-selected":"")+'">'+(e?t.reverse():t).join("")+"</tr>"},rt=function(t){return"<tbody>"+t.join("")+"</tbody>"},st=function(t){let e,n=[];for(t.showWeekNumber&&n.push("<th></th>"),e=0;e<7;e++)n.push('<th scope="col"><abbr title="'+tt(t,e)+'">'+tt(t,e,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?n.reverse():n).join("")+"</tr></thead>"},at=function(t,e,n,o,i,r){let s,a,l,c,h,u=t._o,d=n===u.minYear,f=n===u.maxYear,g='<div id="'+r+'" class="pika-title" role="heading" aria-live="polite">',p=!0,m=!0;for(l=[],s=0;s<12;s++)l.push('<option value="'+(n===i?s-e:12+s-e)+'"'+(s===o?' selected="selected"':"")+(d&&s<u.minMonth||f&&s>u.maxMonth?' disabled="disabled"':"")+">"+u.i18n.months[s]+"</option>");for(c='<div class="pika-label">'+u.i18n.months[o]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",U(u.yearRange)?(s=u.yearRange[0],a=u.yearRange[1]+1):(s=n-u.yearRange,a=1+n+u.yearRange),l=[];s<a&&s<=u.maxYear;s++)s>=u.minYear&&l.push('<option value="'+s+'"'+(s===n?' selected="selected"':"")+">"+s+"</option>");return h='<div class="pika-label">'+n+u.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",u.showMonthAfterYear?g+=h+c:g+=c+h,d&&(0===o||u.minMonth>=o)&&(p=!1),f&&(11===o||u.maxMonth<=o)&&(m=!1),0===e&&(g+='<button class="pika-prev'+(p?"":" is-disabled")+'" type="button">'+u.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(g+='<button class="pika-next'+(m?"":" is-disabled")+'" type="button">'+u.i18n.nextMonth+"</button>"),g+"</div>"},lt=function(t,e,n){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+n+'">'+st(t)+rt(e)+"</table>"};function ct(t){let e=this,n=e.config(t);e._onMouseDown=function(t){if(!e._v)return;t=t||_().event;let o=t.target||t.srcElement;if(o)if(V(o,"is-disabled")||(!V(o,"pika-button")||V(o,"is-empty")||V(o.parentNode,"is-disabled")?V(o,"pika-prev")?e.prevMonth():V(o,"pika-next")&&e.nextMonth():(e.setDate(new Date(o.getAttribute("data-pika-year"),o.getAttribute("data-pika-month"),o.getAttribute("data-pika-day"))),n.bound&&P((function(){e.hide(),n.blurFieldOnSelect&&n.field&&n.field.blur()}),100))),V(o,"pika-select"))e._c=!0;else{if(!t.preventDefault)return t.returnValue=!1,!1;t.preventDefault()}},e._onChange=function(t){t=t||_().event;let n=t.target||t.srcElement;n&&(V(n,"pika-select-month")?e.gotoMonth(n.value):V(n,"pika-select-year")&&e.gotoYear(n.value))},e._onKeyChange=function(t){if(t=t||_().event,e.isVisible())switch(t.keyCode){case 13:case 27:n.field&&n.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null);break}},e._parseFieldValue=function(){if(n.parse)return n.parse(n.field.value,n.format);if(this.hasMoment){let t=this.moment(n.field.value,n.format,n.formatStrict);return t&&t.isValid()?t.toDate():null}return new Date(Date.parse(n.field.value))},e._onInputChange=function(t){let n;t.firedBy!==e&&(n=e._parseFieldValue(),z(n)&&e.setDate(n),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let t=k().activeElement;do{if(V(t,"pika-single"))return}while(t=t.parentNode);e._c||(e._b=P((function(){e.hide()}),50)),e._c=!1},e._onClick=function(t){t=t||_().event;let o=t.target||t.srcElement,i=o;if(o){!hasEventListeners&&V(o,"pika-select")&&(o.onchange||(o.setAttribute("onchange","return;"),D(o,"change",e._onChange)));do{if(V(i,"pika-single")||i===n.trigger)return}while(i=i.parentNode);e._v&&o!==n.trigger&&i!==n.trigger&&e.hide()}},e.el=k().createElement("div"),e.el.className="pika-single"+(n.isRTL?" is-rtl":"")+(n.theme?" "+n.theme:""),D(e.el,"mousedown",e._onMouseDown,!0),D(e.el,"touchend",e._onMouseDown,!0),D(e.el,"change",e._onChange),n.keyboardInput&&D(k(),"keydown",e._onKeyChange),n.field&&(n.container?n.container.appendChild(e.el):n.bound?k().body.appendChild(e.el):n.field.parentNode.insertBefore(e.el,n.field.nextSibling),D(n.field,"change",e._onInputChange),n.defaultDate||(n.defaultDate=e._parseFieldValue(),n.setDefaultDate=!0));let o=n.defaultDate;z(o)?n.setDefaultDate?e.setDate(o,!0):e.gotoDate(o):e.gotoDate(new Date),n.bound?(this.hide(),e.el.className+=" is-bound",D(n.trigger,"click",e._onInputClick),D(n.trigger,"focus",e._onInputFocus),D(n.trigger,"blur",e._onInputBlur)):this.show()}function ht(t,e,n){return(e=ut(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ut(t){var e=dt(t,"string");return"symbol"==typeof e?e:e+""}function dt(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}ct.prototype={config:function(t){this._o||(this._o=q({},Z,!0));let e=q(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme="string"===typeof e.theme&&e.theme?e.theme:null,e.bound=!!(void 0!==e.bound?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn="function"===typeof e.disableDayFn?e.disableDayFn:null;let n=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=n>4?4:n,z(e.minDate)||(e.minDate=!1),z(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),U(e.yearRange)){let t=(new Date).getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||t,e.yearRange[1]=parseInt(e.yearRange[1],10)||t}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||Z.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(t){return t=t||this._o.format,z(this._d)?this._o.toString?this._o.toString(this._d,t):this.hasMoment?this.moment(this._d).format(t):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(t,e){this.hasMoment&&this.moment.isMoment(t)&&this.setDate(t.toDate(),e)},useMoment:function(t){this.hasMoment=!0,this.moment=t},getDate:function(){return z(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",Q(this._o.field,"change",{firedBy:this})),this.draw();if("string"===typeof t&&(t=new Date(Date.parse(t))),!z(t))return;let n=this._o.minDate,o=this._o.maxDate;z(n)&&t<n?t=n:z(o)&&t>o&&(t=o),this._d=new Date(t.getTime()),$(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),Q(this._o.field,"change",{firedBy:this})),e||"function"!==typeof this._o.onSelect||this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(t){let e=!0;if(z(t)){if(this.calendars){let n=new Date(this.calendars[0].year,this.calendars[0].month,1),o=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),i=t.getTime();o.setMonth(o.getMonth()+1),o.setDate(o.getDate()-1),e=i<n.getTime()||o.getTime()<i}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],"right"===this._o.mainCalendar&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(t,e){let n,o=this.getDate()||new Date,i=24*parseInt(e)*60*60*1e3;"add"===t?n=new Date(o.valueOf()+i):"subtract"===t&&(n=new Date(o.valueOf()-i)),this.setDate(n)},adjustCalendars:function(){this.calendars[0]=J(this.calendars[0]);for(let t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=J({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){t instanceof Date?($(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=Z.minDate,this._o.minYear=Z.minYear,this._o.minMonth=Z.minMonth,this._o.startRange=Z.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?($(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=Z.maxDate,this._o.maxYear=Z.maxYear,this._o.maxMonth=Z.maxMonth,this._o.endRange=Z.endRange),this.draw()},setStartRange:function(t){this._o.startRange=t},setEndRange:function(t){this._o.endRange=t},draw:function(t){if(!this._v&&!t)return;let e,n=this._o,o=n.minYear,i=n.maxYear,r=n.minMonth,s=n.maxMonth,a="";this._y<=o&&(this._y=o,!isNaN(r)&&this._m<r&&(this._m=r)),this._y>=i&&(this._y=i,!isNaN(s)&&this._m>s&&(this._m=s));for(let l=0;l<n.numberOfMonths;l++)e="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),a+='<div class="pika-lendar">'+at(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year,e)+this.render(this.calendars[l].year,this.calendars[l].month,e)+"</div>";this.el.innerHTML=a,n.bound&&"hidden"!==n.field.type&&P((function(){n.trigger.focus()}),1),"function"===typeof this._o.onDraw&&this._o.onDraw(this),n.bound&&n.field.setAttribute("aria-label",n.ariaLabel)},adjustPosition:function(){let t,e,n,o,i,r,s,a,l,c,h;this._o.container||(this.el.style.position="absolute",t=this._o.trigger,e=this.el.offsetWidth,n=this.el.offsetHeight,o=_().innerWidth||k().documentElement.clientWidth,i=_().innerHeight||k().documentElement.clientHeight,r=k().body.scrollTop||k().documentElement.scrollTop,c=!0,h=!0,l=t.getBoundingClientRect(),s=l.left+_().pageXOffset,a=l.bottom+_().pageYOffset,(this._o.reposition&&s+e>o||this._o.position.indexOf("right")>-1&&s-e+t.offsetWidth>0)&&(s=s-e+t.offsetWidth,c=!1),(this._o.reposition&&a+n>i+r||this._o.position.indexOf("top")>-1&&a-n-t.offsetHeight>0)&&(a=a-n-t.offsetHeight,h=!1),s<0&&(s=0),a<0&&(a=0),this.el.style.left=s+"px",this.el.style.top=a+"px",W(this.el,c?"left-aligned":"right-aligned"),W(this.el,h?"bottom-aligned":"top-aligned"),B(this.el,c?"right-aligned":"left-aligned"),B(this.el,h?"top-aligned":"bottom-aligned"))},render:function(t,e,n){let o=this._o,i=new Date,r=X(t,e),s=new Date(t,e,1).getDay(),a=[],l=[];$(i),o.firstDay>0&&(s-=o.firstDay,s<0&&(s+=7));let c=0===e?11:e-1,h=11===e?0:e+1,u=0===e?t-1:t,d=11===e?t+1:t,f=X(u,c),g=r+s,p=g;while(p>7)p-=7;g+=7-p;let m=!1;for(let b=0,w=0;b<g;b++){let n=new Date(t,e,b-s+1),g=!!z(this._d)&&K(n,this._d),p=K(n,i),v=-1!==o.events.indexOf(n.toDateString()),y=b<s||b>=r+s,C=b-s+1,S=e,O=t,E=o.startRange&&K(o.startRange,n),R=o.endRange&&K(o.endRange,n),T=o.startRange&&o.endRange&&o.startRange<n&&n<o.endRange,M=o.minDate&&n<o.minDate||o.maxDate&&n>o.maxDate||o.disableWeekends&&G(n)||o.disableDayFn&&o.disableDayFn(n);y&&(b<s?(C=f+C,S=c,O=u):(C-=r,S=h,O=d));let I={day:C,month:S,year:O,hasEvent:v,isSelected:g,isToday:p,isDisabled:M,isEmpty:y,isStartRange:E,isEndRange:R,isInRange:T,showDaysInNextAndPreviousMonths:o.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:o.enableSelectionDaysInNextAndPreviousMonths};o.pickWholeWeek&&g&&(m=!0),l.push(et(I)),7===++w&&(o.showWeekNumber&&l.unshift(ot(this,b-s,e,t,o.firstWeekOfYearMinDays)),a.push(it(l,o.isRTL,o.pickWholeWeek,m)),l=[],w=0,m=!1)}return lt(o,a,n)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),B(this.el,"is-hidden"),this._o.bound&&(D(k(),"click",this._onClick),this.adjustPosition()),"function"===typeof this._o.onOpen&&this._o.onOpen.call(this))},hide:function(){let t=this._v;!1!==t&&(this._o.bound&&L(k(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),W(this.el,"is-hidden"),this._v=!1,void 0!==t&&"function"===typeof this._o.onClose&&this._o.onClose.call(this))},destroy:function(){let t=this._o;this.hide(),L(this.el,"mousedown",this._onMouseDown,!0),L(this.el,"touchend",this._onMouseDown,!0),L(this.el,"change",this._onChange),t.keyboardInput&&L(k(),"keydown",this._onKeyChange),t.field&&(L(t.field,"change",this._onInputChange),t.bound&&(L(t.trigger,"click",this._onInputClick),L(t.trigger,"focus",this._onInputFocus),L(t.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};const ft="date",gt="dateEditor";class pt extends r["a"]{constructor(){super(...arguments),ht(this,"defaultDateFormat","DD/MM/YYYY"),ht(this,"parentDestroyed",!1),ht(this,"$datePicker",null)}static get EDITOR_TYPE(){return ft}init(){if("function"!==typeof j)throw new Error("You need to include moment.js to your project.");if("function"!==typeof ct)throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),Object(s["addClass"])(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",t=>{Object(s["hasClass"])(t.target,"pika-day")&&this.hideDatepicker(),t.stopPropagation()})}destroyElements(){const t=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),t&&t.removeChild(this.datePicker)}prepare(t,e,n,o,i,r){super.prepare(t,e,n,o,i,r)}open(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const e=this.hot.getShortcutManager(),n=e.getContext("editor");this.showDatepicker(t),super.open(),n.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:gt})}close(){var t;this._opened=!1,null!==(t=this.$datePicker)&&void 0!==t&&t.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{const t=this.hot._getEditorManager();t.closeEditor(),this.hot.view.render(),t.prepareEditor()});const e=this.hot.getShortcutManager(),n=e.getContext("editor");n.removeShortcutsByGroup(gt),super.close()}finishEditing(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super.finishEditing(t,e)}showDatepicker(t){const e=this.cellProperties.dateFormat||this.defaultDateFormat,n=this.hot.view.isMouseDown(),o=!!t&&Object(m["isFunctionKey"])(t.keyCode);let i;this.datePicker.style.display="block",this.$datePicker=new ct(this.getDatePickerConfig()),"function"===typeof this.$datePicker.useMoment&&this.$datePicker.useMoment(j),this.$datePicker._onInputFocus=function(){},this.originalValue?(i=this.originalValue,j(i,e,!0).isValid()&&this.$datePicker.setMoment(j(i,e),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),o||n||this.setValue("")):this.cellProperties.defaultDate?(i=this.cellProperties.defaultDate,j(i,e,!0).isValid()&&this.$datePicker.setMoment(j(i,e),!0),o||n||this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){const t=this.TEXTAREA,e={};this.cellProperties&&this.cellProperties.datePickerConfig&&Object(l["deepExtend"])(e,this.cellProperties.datePickerConfig);const n=e.onSelect,o=e.onClose;return e.field=t,e.trigger=t,e.container=this.datePicker,e.bound=!1,e.keyboardInput=!1,e.format=e.format||this.defaultDateFormat,e.reposition=e.reposition||!1,e.isRTL=!1,e.onSelect=t=>{let e=t;isNaN(e.getTime())||(e=j(e).format(this.cellProperties.dateFormat||this.defaultDateFormat)),this.setValue(e),n&&n()},e.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),o&&o()},e}refreshDimensions(t){var e;if(super.refreshDimensions(t),this.state!==N["b"].EDITING)return;if(this.TD=this.getEditedCell(),!this.TD)return void this.hideDatepicker();const{rowIndexMapper:n,columnIndexMapper:o}=this.hot,{wtOverlays:i}=this.hot.view._wt,{wtTable:r}=null!==(e=i.getParentOverlay(this.TD))&&void 0!==e?e:this.hot.view._wt,a=n.getVisualFromRenderableIndex(r.getFirstPartiallyVisibleRow()),l=n.getVisualFromRenderableIndex(r.getLastPartiallyVisibleRow()),c=o.getVisualFromRenderableIndex(r.getFirstPartiallyVisibleColumn()),h=o.getVisualFromRenderableIndex(r.getLastPartiallyVisibleColumn());if(this.row>=a&&this.row<=l&&this.col>=c&&this.col<=h){const t=this.TD.getBoundingClientRect();this.datePickerStyle.top=this.hot.rootWindow.pageYOffset+t.top+Object(s["outerHeight"])(this.TD)+"px";let e=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?e+=t.right-Object(s["outerWidth"])(this.datePicker):e+=t.left,this.datePickerStyle.left=e+"px"}else this.hideDatepicker()}}var mt=n("1004");const bt="dropdown";class wt extends x{static get EDITOR_TYPE(){return bt}prepare(t,e,n,o,i,r){super.prepare(t,e,n,o,i,r),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}mt["a"].getSingleton().add("beforeValidate",(function(t,e,n){const o=this.propToCol(n);if(Number.isInteger(o)){const t=this.getCellMeta(e,o);t.editor===wt&&void 0===t.strict&&(t.filter=!1,t.strict=!0)}}));const vt="numeric";class yt extends r["a"]{static get EDITOR_TYPE(){return vt}}const Ct="password";class St extends r["a"]{static get EDITOR_TYPE(){return Ct}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,Object(s["empty"])(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const Ot="ht_editor_visible",Et="selectEditor",Rt="select";class Tt extends N["a"]{static get EDITOR_TYPE(){return Rt}init(){this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.select.style.display="none",Object(s["addClass"])(this.select,"htSelectEditor"),this.hot.rootElement.appendChild(this.select),this.registerHooks()}getValue(){return this.select.value}setValue(t){this.select.value=t}open(){this._opened=!0,this.refreshDimensions(),this.select.style.display="";const t=this.hot.getShortcutManager();t.setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.select.style.display="none",Object(s["hasClass"])(this.select,Ot)&&Object(s["removeClass"])(this.select,Ot),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(t,e,n,o,i,r){super.prepare(t,e,n,o,i,r);const a=this.cellProperties.selectOptions;let c;c="function"===typeof a?this.prepareOptions(a(this.row,this.col,this.prop)):this.prepareOptions(a),Object(s["empty"])(this.select),Object(l["objectEach"])(c,(t,e)=>{const n=this.hot.rootDocument.createElement("OPTION");n.value=e,Object(s["fastInnerHTML"])(n,t),this.select.appendChild(n)})}prepareOptions(t){let e={};if(Array.isArray(t))for(let n=0,o=t.length;n<o;n++)e[t[n]]=t[n];else"object"===typeof t&&(e=t);return e}refreshValue(){const t=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=t,this.setValue(t),this.refreshDimensions()}refreshDimensions(){if(this.state!==N["b"].EDITING)return;if(this.TD=this.getEditedCell(),!this.TD)return void this.close();const{top:t,start:e,width:n,height:o}=this.getEditedCellRect(),i=this.select.style;i.height=o+"px",i.width=n+"px",i.top=t+"px",i[this.hot.isRtl()?"right":"left"]=e+"px",i.margin="0px",Object(s["addClass"])(this.select,Ot)}registerShortcuts(){const t=this.hot.getShortcutManager(),e=t.getContext("editor"),n={group:Et};this.isInFullEditMode()&&e.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const t=this.select.selectedIndex-1;t>=0&&(this.select[t].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const t=this.select.selectedIndex+1;t<=this.select.length-1&&(this.select[t].selected=!0)}}],n)}unregisterShortcuts(){const t=this.hot.getShortcutManager(),e=t.getContext("editor");e.removeShortcutsByGroup(Et)}}const Mt="time";class It extends r["a"]{static get EDITOR_TYPE(){return Mt}prepare(t,e,n,o,i,r){super.prepare(t,e,n,o,i,r),this.TEXTAREA.dir="ltr"}}var xt=n("491c");function Nt(){Object(xt["e"])(N["a"]),Object(xt["e"])(x),Object(xt["e"])(H),Object(xt["e"])(pt),Object(xt["e"])(wt),Object(xt["e"])(d),Object(xt["e"])(yt),Object(xt["e"])(St),Object(xt["e"])(Tt),Object(xt["e"])(r["a"]),Object(xt["e"])(It)}var At=n("a357");const Ht="html";function jt(t,e,n,o,i,r,a){At["a"].apply(this,[t,e,n,o,i,r,a]),Object(s["fastInnerHTML"])(e,null===r||void 0===r?"":r,!1)}jt.RENDERER_TYPE=Ht;var _t=n("87d6");const kt="autocomplete";function Pt(t,e,n,o,i,r,a){const{rootDocument:l}=t,c=a.allowHtml?jt:w["a"],h=l.createElement("DIV"),u=t.getSettings().ariaTags;if(h.className="htAutocompleteArrow",u&&h.setAttribute(...Object(v["n"])()),h.appendChild(l.createTextNode(String.fromCharCode(9660))),c.apply(this,[t,e,n,o,i,r,a]),e.firstChild||e.appendChild(l.createTextNode(String.fromCharCode(160))),e.insertBefore(h,e.firstChild),Object(s["addClass"])(e,"htAutocomplete"),!t.acArrowListener){const i=new _t["a"](t);t.acArrowListener=function(i){Object(s["hasClass"])(i.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(n,o),e)},i.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{i.destroy()})}}Pt.RENDERER_TYPE=kt;const Dt="dropdown";function Lt(t,e,n,o,i,r,s){Pt.apply(this,[t,e,n,o,i,r,s])}Lt.RENDERER_TYPE=Dt;var Ft=n("0283");const Vt=new WeakMap,Wt=new WeakMap,Bt="htBadValue",Ut="data-row",zt="data-col",Gt="checkboxRenderer",Yt="checkbox";function Xt(t,e,n,o,i,r,a){const{rootDocument:l}=t,h=t.getSettings().ariaTags;At["a"].apply(this,[t,e,n,o,i,r,a]),$t(t);let u=Kt(l);const d=a.label;let f=!1;if("undefined"===typeof a.checkedTemplate&&(a.checkedTemplate=!0),"undefined"===typeof a.uncheckedTemplate&&(a.uncheckedTemplate=!1),Object(s["empty"])(e),r===a.checkedTemplate||Object(g["stringify"])(r).toLocaleLowerCase(a.locale)===Object(g["stringify"])(a.checkedTemplate).toLocaleLowerCase(a.locale)?u.checked=!0:r===a.uncheckedTemplate||Object(g["stringify"])(r).toLocaleLowerCase(a.locale)===Object(g["stringify"])(a.uncheckedTemplate).toLocaleLowerCase(a.locale)?u.checked=!1:Object(g["isEmpty"])(r)?Object(s["addClass"])(u,"noValue"):(u.style.display="none",Object(s["addClass"])(u,Bt),f=!0),Object(s["setAttribute"])(u,[[Ut,n],[zt,o]]),h&&Object(s["setAttribute"])(u,[Object(v["p"])(u.checked?t.getTranslatedPhrase(Ft["CHECKBOX_CHECKED"]):t.getTranslatedPhrase(Ft["CHECKBOX_UNCHECKED"])),Object(v["d"])(u.checked),Object(v["c"])()]),!f&&d){let s="";if(d.value)s="function"===typeof d.value?d.value.call(this,n,o,i,r):d.value;else if(d.property){const e=t.getDataAtRowProp(n,d.property);s=null!==e?e:""}const a=qt(l,s,!0!==d.separated);"before"===d.position?d.separated?(e.appendChild(a),e.appendChild(u)):(a.appendChild(u),u=a):d.position&&"after"!==d.position||(d.separated?(e.appendChild(u),e.appendChild(a)):(a.insertBefore(u,a.firstChild),u=a))}function p(){const e=t.getShortcutManager(),n=e.getContext("grid"),o={group:Gt,relativeToGroup:c["a"],position:"before"};n.addShortcuts([{keys:[["space"]],callback:()=>(m(),!b()),runOnlyIf:()=>{var e;return null===(e=t.getSelectedRangeLast())||void 0===e?void 0:e.highlight.isCell()}},{keys:[["enter"]],callback:()=>(m(),!b()),runOnlyIf:()=>{const e=t.getSelectedRangeLast();return t.getSettings().enterBeginsEditing&&(null===e||void 0===e?void 0:e.isSingle())&&e.highlight.isCell()}},{keys:[["delete"],["backspace"]],callback:()=>(m(!0),!b()),runOnlyIf:()=>{var e;return null===(e=t.getSelectedRangeLast())||void 0===e?void 0:e.highlight.isCell()}}],o)}function m(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const n=t.getSelectedRange(),o=[],i=new Map;let r=[],s=0;if(n){for(let a=0;a<n.length;a++){const{row:l,col:c}=n[a].getTopStartCorner(),{row:h,col:u}=n[a].getBottomEndCorner();for(let n=l;n<=h;n+=1)for(let a=c;a<=u;a+=1){const l=t.getCellMeta(n,a),c={checkedTemplate:l.checkedTemplate,uncheckedTemplate:l.uncheckedTemplate};if("checkbox"!==l.type){!0!==e||l.readOnly||(i.has(o.length)?i.set(o.length,[...i.get(o.length),[n,a,null]]):i.set(o.length,[[n,a,null]]));continue}if(!0===l.readOnly)continue;"undefined"===typeof l.checkedTemplate&&(l.checkedTemplate=!0),"undefined"===typeof l.uncheckedTemplate&&(l.uncheckedTemplate=!1);const h=t.getDataAtCell(n,a);!1===e?[l.checkedTemplate,l.checkedTemplate.toString()].includes(h)?r.push([n,a,l.uncheckedTemplate,c]):[l.uncheckedTemplate,l.uncheckedTemplate.toString(),null,void 0].includes(h)&&r.push([n,a,l.checkedTemplate,c]):r.push([n,a,l.uncheckedTemplate,c]),s+=1}o.push(s),s=0}r=r.every(t=>{let[,,e]=t;return e===r[0][2]})?r.map(t=>{let[e,n,o]=t;return[e,n,o]}):r.map(t=>{let[e,n,,o]=t;return[e,n,o.checkedTemplate]}),r.length>0&&o.forEach((e,n)=>{let o=r.splice(0,e);i.size&&i.has(n)&&(o=[...o,...i.get(n)]),t.setDataAtCell(o)})}}function b(){const e=t.getSelectedRange();if(e){for(let n=0;n<e.length;n++){const o=e[n].getTopStartCorner(),i=e[n].getBottomEndCorner();for(let e=o.row;e<=i.row;e++)for(let n=o.col;n<=i.col;n++){const o=t.getCellMeta(e,n),i=t.getCell(e,n);if(null===i||void 0===i)return!0;{const t=i.querySelectorAll("input[type=checkbox]");if(t.length>0&&!o.readOnly)return!0}}}return!1}}(!d||d&&!d.separated)&&e.appendChild(u),f&&e.appendChild(l.createTextNode("#bad-value#")),Vt.has(t)||(Vt.set(t,!0),p())}function $t(t){let e=Wt.get(t);if(!e){const{rootElement:n}=t;e=new _t["a"](t),e.addEventListener(n,"click",e=>Jt(e,t)),e.addEventListener(n,"mouseup",e=>Qt(e,t)),e.addEventListener(n,"change",e=>Zt(e,t)),Wt.set(t,e)}return e}function Kt(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function qt(t,e,n){const o=t.createElement("label");return o.className="htCheckboxRendererLabel "+(n?"fullWidth":""),o.appendChild(t.createTextNode(e)),o.cloneNode(!0)}function Qt(t,e){const{target:n}=t;te(n)&&n.hasAttribute(Ut)&&n.hasAttribute(zt)&&setTimeout(e.listen,10)}function Jt(t,e){const{target:n}=t;if(!te(n))return;if(!n.hasAttribute(Ut)||!n.hasAttribute(zt))return;const o=parseInt(n.getAttribute(Ut),10),i=parseInt(n.getAttribute(zt),10),r=e.getCellMeta(o,i);r.readOnly&&t.preventDefault()}function Zt(t,e){const{target:n}=t;if(!te(n))return;if(!n.hasAttribute(Ut)||!n.hasAttribute(zt))return;const o=parseInt(n.getAttribute(Ut),10),i=parseInt(n.getAttribute(zt),10),r=e.getCellMeta(o,i);if(!r.readOnly){let n=null;n=t.target.checked?void 0===r.uncheckedTemplate||r.checkedTemplate:void 0!==r.uncheckedTemplate&&r.uncheckedTemplate,e.setDataAtCell(o,i,n)}}function te(t){return"INPUT"===t.tagName&&"checkbox"===t.getAttribute("type")}mt["a"].getSingleton().add("modifyAutoColumnSizeSeed",(function(t,e,n){const{label:o,type:i,row:r,column:s,prop:a}=e;if(i===Yt){if(o){const{value:e,property:i}=o;let l=n;if(e)l="function"===typeof e?e(r,s,a,n):e;else if(i){const t=this.getDataAtRowProp(r,i);l=null!==t?t:n}t=l}return t}})),Xt.RENDERER_TYPE=Yt;const ee="handsontable";function ne(t,e,n,o,i,r,s){Pt.apply(this,[t,e,n,o,i,r,s])}ne.RENDERER_TYPE=ee;var oe=n("8722"),ie=n("ffec");const re="numeric";function se(t,e){if(Object(ie["isNumeric"])(t)){const n=e.numericFormat,o=n&&n.culture||"-",i=n&&n.pattern;if("undefined"!==typeof o&&!oe.languages()[o]){const t=o.replace("-",""),e=oe.allLanguages?oe.allLanguages[o]:oe[t];e&&oe.registerLanguage(e)}oe.setLanguage(o),t=oe(t).format(i||"0")}return t}function ae(t,e,n,o,i,r,s){let a=r;if(Object(ie["isNumeric"])(a)){const t=s.className||"",n=t.length?t.split(" "):[];a=se(a,s),n.indexOf("htLeft")<0&&n.indexOf("htCenter")<0&&n.indexOf("htRight")<0&&n.indexOf("htJustify")<0&&n.push("htRight"),n.indexOf("htNumeric")<0&&n.push("htNumeric"),s.className=n.join(" "),e.dir="ltr"}Object(w["a"])(t,e,n,o,i,a,s)}ae.RENDERER_TYPE=re;const le="password";function ce(t,e,n,o,i,r,a){w["a"].apply(this,[t,e,n,o,i,r,a]);const l=a.hashLength||e.innerHTML.length,c=a.hashSymbol||"*";let h="";Object(ie["rangeEach"])(l-1,()=>{h+=c}),Object(s["fastInnerHTML"])(e,h)}ce.RENDERER_TYPE=le;const he="select";function ue(t,e,n,o,i,r,s){w["a"].apply(this,[t,e,n,o,i,r,s])}ue.RENDERER_TYPE=he;const de="time";function fe(t,e,n,o,i,r,s){w["a"].apply(this,[t,e,n,o,i,r,s]),e.dir="ltr"}fe.RENDERER_TYPE=de;var ge=n("3d76");function pe(){Object(ge["d"])(Pt),Object(ge["d"])(At["a"]),Object(ge["d"])(Xt),Object(ge["d"])(Lt),Object(ge["d"])(ne),Object(ge["d"])(jt),Object(ge["d"])(ae),Object(ge["d"])(ce),Object(ge["d"])(ue),Object(ge["d"])(w["a"]),Object(ge["d"])(fe)}const me="autocomplete";function be(t,e){let n=t;null!==n&&void 0!==n||(n=""),this.allowEmpty&&""===n?e(!0):this.strict&&this.source?"function"===typeof this.source?this.source(n,we(n,e)):we(n,e)(this.source):e(!0)}function we(t,e){const n=t;return function(t){let o=!1;for(let e=0,i=t.length;e<i;e++)if(n===t[e]){o=!0;break}e(o)}}function ve(t){const e=new Date(t);return isNaN(new Date(t+"T00:00").getDate())?e:new Date(e.getTime()+6e4*e.getTimezoneOffset())}be.VALIDATOR_TYPE=me;const ye="date";function Ce(t,e){const n=Object(xt["b"])(ft,this.instance);let o=t,i=!0;null!==o&&void 0!==o||(o="");let r=j(o,this.dateFormat||n.defaultDateFormat,!0).isValid(),s=j(new Date(o)).isValid()||r;if(this.allowEmpty&&""===o&&(s=!0,r=!0),s||(i=!1),!s&&r&&(i=!0),s&&!r)if(!0===this.correctFormat){const t=Se(o,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,t,"dateValidator"),i=!0}else i=!1;e(i)}function Se(t,e){const n=j(ve(t)),o=j(t,e),i=t.search(/[A-z]/g)>-1;let r;return r=n.isValid()&&n.format("x")===o.format("x")||!o.isValid()||i?n:o,r.format(e)}Ce.VALIDATOR_TYPE=ye;const Oe="dropdown";function Ee(t,e){be.apply(this,[t,e])}Ee.VALIDATOR_TYPE=Oe;const Re="numeric";function Te(t,e){let n=t;null!==n&&void 0!==n||(n=""),this.allowEmpty&&""===n?e(!0):e(""!==n&&Object(ie["isNumeric"])(t))}Te.VALIDATOR_TYPE=Re;const Me=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],Ie="time";function xe(t,e){const n=this.timeFormat||"h:mm:ss a";let o=!0,i=t;null===i&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const r=/^\d{1,2}$/.test(i);r&&(i+=":00");const s=j(i,Me,!0).isValid()?j(i):j(i,n);let a=s.isValid(),l=j(i,n,!0).isValid()&&!r;if(this.allowEmpty&&""===i&&(a=!0,l=!0),a||(o=!1),!a&&l&&(o=!0),a&&!l)if(!0===this.correctFormat){const t=s.format(n);this.instance.setDataAtCell(this.visualRow,this.visualCol,t,"timeValidator"),o=!0}else o=!1;e(o)}xe.VALIDATOR_TYPE=Ie;var Ne=n("169f");function Ae(){Object(Ne["d"])(be),Object(Ne["d"])(Ee),Object(Ne["d"])(Ce),Object(Ne["d"])(Te),Object(Ne["d"])(xe)}const He="autocomplete",je={CELL_TYPE:He,editor:x,renderer:Pt,validator:be},_e="checkbox",ke={CELL_TYPE:_e,editor:H,renderer:Xt},Pe="date";function De(t,e,n,o,i,r,s){Pt.apply(this,[t,e,n,o,i,r,s])}De.RENDERER_TYPE=Pe;const Le="date",Fe={CELL_TYPE:Le,editor:pt,renderer:De,validator:Ce},Ve="dropdown",We={CELL_TYPE:Ve,editor:wt,renderer:Lt,validator:Ee},Be="handsontable",Ue={CELL_TYPE:Be,editor:d,renderer:ne},ze="numeric",Ge={CELL_TYPE:ze,editor:yt,renderer:ae,validator:Te,dataType:"number"},Ye="password",Xe={CELL_TYPE:Ye,editor:St,renderer:ce,copyable:!1},$e="select",Ke={CELL_TYPE:$e,editor:Tt,renderer:ue};var qe=n("ef07");const Qe="time",Je={CELL_TYPE:Qe,editor:It,renderer:fe,validator:xe};var Ze=n("76ab");function tn(){Object(Ze["d"])(je),Object(Ze["d"])(ke),Object(Ze["d"])(Fe),Object(Ze["d"])(We),Object(Ze["d"])(Ue),Object(Ze["d"])(Ge),Object(Ze["d"])(Xe),Object(Ze["d"])(Ke),Object(Ze["d"])(qe["a"]),Object(Ze["d"])(Je)}var en=n("24b5");function nn(t,e){rn(t,e),e.add(t)}function on(t,e,n){rn(t,e),e.set(t,n)}function rn(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sn(t,e,n){return(e=an(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function an(t){var e=ln(t,"string");return"symbol"==typeof e?e:e+""}function ln(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function cn(t,e){return t.get(hn(t,e))}function hn(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const un=new Map([["plugin",en["c"]],["cell-type",Ze["c"]],["editor",xt["d"]],["renderer",ge["c"]],["validator",Ne["c"]]]),dn="base",fn=[];let gn=null;var pn=new WeakMap,mn=new WeakSet;class bn{static get PLUGIN_KEY(){return dn}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}constructor(t){nn(this,mn),sn(this,"eventManager",new _t["a"](this)),sn(this,"pluginName",null),sn(this,"pluginsInitializedCallbacks",[]),sn(this,"isPluginsReady",!1),sn(this,"enabled",!1),sn(this,"initialized",!1),on(this,pn,{}),Object(l["defineGetter"])(this,"hot",t,{writable:!1}),gn=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",t=>this.onUpdateSettings(t)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const t=this.constructor.PLUGIN_DEPS,e=Array.isArray(t)?t:[];if(e.length>0){const t=[];if(e.forEach(e=>{const[n,o]=e.split(":");if(!un.has(n))throw new Error(`Unknown plugin dependency type "${n}" was found.`);un.get(n)(o)||t.push(` - ${o} (${n})`)}),t.length>0){const e=[`The ${this.pluginName} plugin requires the following modules:\n`,t.join("\n")+"\n"].join("");fn.push(e)}}gn||(gn=Object(en["b"])()),gn.indexOf("UndoRedo")>=0&&gn.splice(gn.indexOf("UndoRedo"),1),gn.indexOf(this.pluginName)>=0&&gn.splice(gn.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()});const n=0===gn.length;if(n){if(fn.length>0){const t=[fn.join("\n")+"\n","You have to import and register them manually."].join("");throw new Error(t)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var t;null===(t=this.eventManager)||void 0===t||t.clear(),this.clearHooks(),this.enabled=!1}addHook(t,e,n){cn(pn,this)[t]=cn(pn,this)[t]||[];const o=cn(pn,this)[t];this.hot.addHook(t,e,n),o.push(e),cn(pn,this)[t]=o}removeHooks(t){Object(f["arrayEach"])(cn(pn,this)[t]||[],e=>{this.hot.removeHook(t,e)})}clearHooks(){const t=cn(pn,this);Object(l["objectEach"])(t,(t,e)=>this.removeHooks(e)),t.length=0}callOnPluginsReady(t){this.isPluginsReady?t():this.pluginsInitializedCallbacks.push(t)}onAfterPluginsInitialized(){Object(f["arrayEach"])(this.pluginsInitializedCallbacks,t=>t()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(t){const e=hn(mn,this,wn).call(this,t);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&e&&this.updatePlugin(t))}updatePlugin(){}destroy(){var t;null===(t=this.eventManager)||void 0===t||t.destroy(),this.clearHooks(),Object(l["objectEach"])(this,(t,e)=>{"hot"!==e&&(this[e]=null)}),delete this.t,delete this.hot}}function wn(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if("boolean"===typeof e)return e;for(let n=0;n<e.length;n++)if(void 0!==t[e[n]])return!0;return!1}var vn=n("7dd09");function yn(t,e,n){return(e=Cn(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cn(t){var e=Sn(t,"string");return"symbol"==typeof e?e:e+""}function Sn(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class On{constructor(t){yn(this,"hot",null),yn(this,"container",null),yn(this,"injected",!1),yn(this,"rows",[]),yn(this,"columns",[]),yn(this,"samples",null),yn(this,"settings",{useHeaders:!0}),this.hot=t}addRow(t,e){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const n={row:t};this.rows.push(n),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(t)),this.table.tr.appendChild(this.createRow(t)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}addColumnHeadersRow(t){const e=this.hot.getColHeader(0);if(null!==e&&void 0!==e){const e={row:-1};this.rows.push(e),this.container=this.createContainer(this.hot.rootElement.className),this.samples=t,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),e.table=this.table.table}}addColumn(t,e){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const n={col:t};this.columns.push(n),this.samples=e,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&null!==this.hot.getColHeader(t)&&this.hot.view.appendColHeader(t,this.table.th),this.table.tBody.appendChild(this.createCol(t)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}getHeights(t){this.injected||this.injectTable(),Object(f["arrayEach"])(this.rows,e=>{const{height:n}=e.table.getBoundingClientRect();t(e.row,Math.ceil(n)-1)})}getWidths(t){this.injected||this.injectTable(),Object(f["arrayEach"])(this.columns,e=>{const{width:n}=e.table.getBoundingClientRect();t(e.col,Math.ceil(n))})}setSettings(t){this.settings=t}setSetting(t,e){this.settings||(this.settings={}),this.settings[t]=e}getSettings(){return this.settings}getSetting(t){return this.settings?this.settings[t]:null}createColGroupsCol(t){const e=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&e.appendChild(this.createColElement(-1,-1)),this.samples.forEach(n=>{Object(f["arrayEach"])(n.strings,n=>{e.appendChild(this.createColElement(n.col,t))})}),e}createRow(t){const{rootDocument:e}=this.hot,n=e.createDocumentFragment(),o=e.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(t,o),n.appendChild(o)),this.samples.forEach(o=>{Object(f["arrayEach"])(o.strings,o=>{const i=o.col,r=this.hot.getCellMeta(t,i),s=this.hot.getCellRenderer(r),a=e.createElement("td");a.setAttribute("ghost-table",1),s(this.hot,a,t,i,this.hot.colToProp(i),o.value,r),n.appendChild(a)})}),n}appendColumnHeadersRow(){const{rootDocument:t}=this.hot,e=t.createDocumentFragment(),n=[];if(this.hot.hasRowHeaders()){const o=t.createElement("th");n.push([-1,o]),e.appendChild(o)}this.samples.forEach(o=>{Object(f["arrayEach"])(o.strings,o=>{const i=o.col,r=t.createElement("th");n.push([i,r]),e.appendChild(r)})}),this.table.tHead.appendChild(e),Object(f["arrayEach"])(n,t=>{const[e,n]=t;this.hot.view.appendColHeader(e,n)})}createCol(t){const{rootDocument:e}=this.hot,n=e.createDocumentFragment();return this.samples.forEach(o=>{Object(f["arrayEach"])(o.strings,o=>{const i=o.row,r=this.hot.getCellMeta(i,t),s=this.hot.getCellRenderer(r),a=e.createElement("td"),l=e.createElement("tr");a.setAttribute("ghost-table",1),s(this.hot,a,i,t,this.hot.colToProp(t),o.value,r),l.appendChild(a),n.appendChild(l)})}),n}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.injected||((t||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(t,e){const n=this.hot.rootDocument.createElement("col");let o=0;e>=0&&t>=0&&(o=this.hot.getCellMeta(e,t).colspan);let i=this.hot.getColWidth(t);if(o>1)for(let r=t+1;r<t+o;r++)i+=this.hot.getColWidth(r);return n.style.width=i+"px",n}createTable(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const{rootDocument:e}=this.hot,n=e.createDocumentFragment(),o=e.createElement("table"),i=e.createElement("thead"),r=e.createElement("tbody"),a=e.createElement("colgroup"),l=e.createElement("tr"),c=e.createElement("th");return this.isVertical()&&o.appendChild(a),this.isHorizontal()&&(l.appendChild(c),i.appendChild(l),o.style.tableLayout="auto",o.style.width="auto"),o.appendChild(i),this.isVertical()&&r.appendChild(l),o.appendChild(r),Object(s["addClass"])(o,t),n.appendChild(o),{fragment:n,table:o,tHead:i,tBody:r,colGroup:a,tr:l,th:c}}createContainer(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const{rootDocument:e}=this.hot,n=e.createDocumentFragment(),o=e.createElement("div"),i="htGhostTable htAutoSize "+t.trim();return Object(s["addClass"])(o,i),n.appendChild(o),{fragment:n,container:o}}isVertical(){return!(!this.rows.length||this.columns.length)}isHorizontal(){return!(!this.columns.length||this.rows.length)}}var En=On;function Rn(t,e,n){return(e=Tn(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tn(t){var e=Mn(t,"string");return"symbol"==typeof e?e:e+""}function Mn(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class In{static get SAMPLE_COUNT(){return 3}constructor(t){Rn(this,"samples",null),Rn(this,"dataFactory",null),Rn(this,"customSampleCount",null),Rn(this,"allowDuplicates",!1),this.dataFactory=t}getSampleCount(){return this.customSampleCount?this.customSampleCount:In.SAMPLE_COUNT}setSampleCount(t){this.customSampleCount=t}setAllowDuplicates(t){this.allowDuplicates=t}generateRowSamples(t,e){return this.generateSamples("row",e,t)}generateColumnSamples(t,e){return this.generateSamples("col",e,t)}generateSamples(t,e,n){const o=new Map,{from:i,to:r}="number"===typeof n?{from:n,to:n}:n;return Object(ie["rangeEach"])(i,r,n=>{const i=this.generateSample(t,e,n);o.set(n,i)}),o}generateSample(t,e,n){if("row"!==t&&"col"!==t)throw new Error("Unsupported sample type");const o=new Map,i="row"===t?"col":"row",r=[];return Object(ie["rangeEach"])(e.from,e.to,e=>{const s="row"===t?this.dataFactory(n,e):this.dataFactory(e,n);if(!1===s)return;const{value:a,bundleSeed:c}=s,h="string"===typeof c&&c.length>0;let u;u=h?c:Object(l["isObject"])(a)?""+Object.keys(a).length:Array.isArray(a)?""+a.length:""+Object(g["stringify"])(a).length,o.has(u)||o.set(u,{needed:this.getSampleCount(),strings:[]});const d=o.get(u);if(d.needed){const t=r.indexOf(a)>-1;(!t||this.allowDuplicates||h)&&(d.strings.push({value:a,[i]:e}),r.push(a),d.needed-=1)}}),o}}var xn=In,Nn=n("861dd"),An=n("9f10");function Hn(t,e){_n(t,e),e.add(t)}function jn(t,e,n){_n(t,e),e.set(t,n)}function _n(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kn(t,e,n){return(e=Pn(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pn(t){var e=Dn(t,"string");return"symbol"==typeof e?e:e+""}function Dn(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Ln(t,e){return t.get(Vn(t,e))}function Fn(t,e,n){return t.set(Vn(t,e),n),n}function Vn(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}mt["a"].getSingleton().register("modifyAutoColumnSizeSeed");const Wn="autoColumnSize",Bn=10,Un="autoColumnSize";var zn=new WeakMap,Gn=new WeakMap,Yn=new WeakSet;class Xn extends bn{static get PLUGIN_KEY(){return Wn}static get PLUGIN_PRIORITY(){return Bn}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(t){super(t),Hn(this,Yn),kn(this,"ghostTable",new En(this.hot)),kn(this,"samplesGenerator",new xn((t,e)=>{const n=this.hot.toPhysicalRow(t),o=this.hot.toPhysicalColumn(e);if(this.hot.rowIndexMapper.isHidden(n)||this.hot.columnIndexMapper.isHidden(o))return!1;const i=this.hot.getCellMeta(t,e);let r="";i.spanned||(r=this.hot.getDataAtCell(t,e));let s="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(s=this.hot.runHooks("modifyAutoColumnSizeSeed",s,i,r)),{value:r,bundleSeed:s}})),kn(this,"inProgress",!1),kn(this,"measuredColumns",0),kn(this,"columnWidthsMap",new An["a"]),jn(this,zn,[]),jn(this,Gn,[]),this.hot.columnIndexMapper.registerMap(Un,this.columnWidthsMap),this.addHook("beforeColumnResize",(t,e,n)=>Vn(Yn,this,Jn).call(this,t,e,n))}isEnabled(){return!1!==this.hot.getSettings()[Wn]&&!this.hot.getSettings().colWidths}enablePlugin(){var t=this;if(this.enabled)return;const e=this.hot.getSettings()[Wn];e&&null!==e.useHeaders&&void 0!==e.useHeaders&&this.ghostTable.setSetting("useHeaders",e.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return Vn(Yn,t,qn).call(t,...n)})),this.addHook("beforeChangeRender",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return Vn(Yn,t,Qn).call(t,...n)})),this.addHook("afterFormulasValuesUpdate",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return Vn(Yn,t,to).call(t,...n)})),this.addHook("beforeRender",()=>Vn(Yn,this,Kn).call(this)),this.addHook("modifyColWidth",(t,e)=>this.getColumnWidth(e,t)),this.addHook("init",()=>Vn(Yn,this,Zn).call(this)),super.enablePlugin()}updatePlugin(){Fn(Gn,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(t,e,n)=>Vn(Yn,this,Jn).call(this,t,e,n))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const t=this.getFirstVisibleColumn(),e=this.getLastVisibleColumn();if(-1===t||-1===e)return;const n=this.hot.renderCall;this.calculateColumnsWidth({from:t,to:e},void 0,n)}calculateColumnsWidth(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countRows()-1},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o="number"===typeof t?{from:t,to:t}:t,i="number"===typeof e?{from:e,to:e}:e;Object(ie["rangeEach"])(o.from,o.to,t=>{let e=this.hot.toPhysicalColumn(t);if(null===e&&(e=t),n||null===this.columnWidthsMap.getValueAtIndex(e)&&!this.hot._getColWidthFromSettings(e)){const e=this.samplesGenerator.generateColumnSamples(t,i);e.forEach((t,e)=>this.ghostTable.addColumn(e,t))}}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((t,e)=>{const n=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(n,e)})},!0),this.measuredColumns=o.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=0;const o=this.hot.countCols()-1;let i=null;this.inProgress=!0;const r=()=>{if(!this.hot)return Object(vn["cancelAnimationFrame"])(i),void(this.inProgress=!1);this.calculateColumnsWidth({from:n,to:Math.min(n+Xn.CALCULATION_STEP,o)},t,e),n=n+Xn.CALCULATION_STEP+1,n<o?i=Object(vn["requestAnimationFrame"])(r):(Object(vn["cancelAnimationFrame"])(i),this.inProgress=!1,this.hot.view.adjustElementsSize())},s=this.getSyncCalculationLimit();s>=0&&(this.calculateColumnsWidth({from:0,to:s},t,e),n=s+1),n<o?r():this.inProgress=!1}setSamplingOptions(){const t=this.hot.getSettings()[Wn],e=t&&Object(l["hasOwnProperty"])(t,"samplingRatio")?t.samplingRatio:void 0,n=t&&Object(l["hasOwnProperty"])(t,"allowSampleDuplicates")?t.allowSampleDuplicates:void 0;e&&!isNaN(e)&&this.samplesGenerator.setSampleCount(parseInt(e,10)),n&&this.samplesGenerator.setAllowDuplicates(n)}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const t=this.hot.getSettings()[Wn];let e=Xn.SYNC_CALCULATION_LIMIT;const n=this.hot.countCols()-1;return Object(l["isObject"])(t)&&(e=t.syncLimit,Object(p["isPercentValue"])(e)?e=Object(ie["valueAccordingPercent"])(n,e):e>>=0),Math.min(e,n)}getColumnWidth(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=e;return void 0===o&&(o=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(t)),n&&"number"===typeof o&&(o=Math.max(o,Nn["a"]))),o}getFirstVisibleColumn(){var t;return null!==(t=this.hot.view.getFirstRenderedVisibleColumn())&&void 0!==t?t:-1}getLastVisibleColumn(){var t;return null!==(t=this.hot.view.getLastRenderedVisibleColumn())&&void 0!==t?t:-1}findColumnsWhereHeaderWasChanged(){const t=this.hot.getColHeader(),e=t.reduce((t,e,n)=>{const o=Ln(zn,this).length;return(o-1<n||Ln(zn,this)[n]!==e)&&t.push(this.hot.toVisualColumn(n)),o-1<n?Ln(zn,this).push(e):Ln(zn,this)[n]=e,t},[]);return e}clearCache(t){Array.isArray(t)?this.hot.batchExecution(()=>{t.forEach(t=>{this.columnWidthsMap.setValueAtIndex(t,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(t=>null===t).length}destroy(){this.ghostTable.clean(),super.destroy()}}function $n(t){const e={from:0,to:this.hot.countRows()-1};t.forEach(t=>{const n=this.hot.toPhysicalColumn(t);if(null!==n&&!this.hot._getColWidthFromSettings(n)){const n=this.samplesGenerator.generateColumnSamples(t,e);n.forEach((t,e)=>this.ghostTable.addColumn(e,t))}}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((t,e)=>{const n=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(n,e)})},!0),this.ghostTable.clean())}function Kn(){this.calculateVisibleColumnsWidth(),this.inProgress||(Vn(Yn,this,$n).call(this,Ln(Gn,this)),Fn(Gn,this,[]))}function qn(t,e){e||this.recalculateAllColumnsWidth()}function Qn(t){const e=t.reduce((t,e)=>{let[,n]=e;const o=this.hot.propToCol(n);return Number.isInteger(o)&&-1===t.indexOf(o)&&t.push(o),t},[]);Ln(Gn,this).push(...e)}function Jn(t,e,n){let o=t;return n&&(this.calculateColumnsWidth(e,void 0,!0),o=this.getColumnWidth(e,void 0,!1)),o}function Zn(){Fn(zn,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth()}function to(t){const e=t.reduce((t,e)=>{var n;const o=null===(n=e.address)||void 0===n?void 0:n.col;if(Number.isInteger(o)){const e=this.hot.toVisualColumn(o);-1===t.indexOf(e)&&t.push(e)}return t},[]);Ln(Gn,this).push(...e)}const eo={horizontal:"horizontal",vertical:"vertical"};function no(t,e,n){let o,i,r;return e[0]===t[0]&&e[1]<t[1]?(r="left",o=n(e[0],e[1]),i=n(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(r="right",o=n(e[0],t[3]+1),i=n(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(r="up",o=n(e[0],e[1]),i=n(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(r="down",o=n(t[2]+1,e[1]),i=n(e[2],e[3])),o&&o.normalize(),i&&i.normalize(),{directionOfDrag:r,startOfDragCoords:o,endOfDragCoords:i}}function oo(t){const e={};return!0===t?(e.directions=Object.keys(eo),e.autoInsertRow=!0):Object(l["isObject"])(t)?(Object(g["isDefined"])(t.autoInsertRow)?t.direction===eo.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,Object(g["isDefined"])(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(eo)):"string"===typeof t?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function io(t,e){ro(t,e),e.add(t)}function ro(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function so(t,e,n){return(e=ao(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ao(t){var e=lo(t,"string");return"symbol"==typeof e?e:e+""}function lo(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function co(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}mt["a"].getSingleton().register("modifyAutofillRange"),mt["a"].getSingleton().register("beforeAutofill"),mt["a"].getSingleton().register("afterAutofill");const ho="autofill",uo=20,fo=["fillHandle"],go="insert_row_below",po=200;var mo=new WeakSet;class bo extends bn{constructor(){super(...arguments),io(this,mo),so(this,"addingStarted",!1),so(this,"mouseDownOnCellCorner",!1),so(this,"mouseDragOutside",!1),so(this,"handleDraggedCells",0),so(this,"directions",[]),so(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return ho}static get PLUGIN_PRIORITY(){return uo}static get SETTING_KEYS(){return[ho,...fo]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",t=>co(mo,this,vo).call(this,t)),this.addHook("afterOnCellCornerDblClick",t=>co(mo,this,wo).call(this,t)),this.addHook("beforeOnCellMouseOver",(t,e)=>co(mo,this,yo).call(this,e)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const t=this.hot.getSelectedRangeLast(),{row:e,col:n}=t.getTopStartCorner(),{row:o,col:i}=t.getBottomEndCorner(),r=this.hot.runHooks("modifyCopyableRange",[{startRow:e,startCol:n,endRow:o,endCol:i}]),s=[],a=[],l=[];return Object(f["arrayEach"])(r,t=>{for(let e=t.startRow;e<=t.endRow;e+=1)-1===s.indexOf(e)&&s.push(e);for(let e=t.startCol;e<=t.endCol;e+=1)-1===a.indexOf(e)&&a.push(e)}),Object(f["arrayEach"])(s,t=>{const e=[];Object(f["arrayEach"])(a,n=>{e.push(this.hot.getCopyableData(t,n))}),l.push(e)}),l}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[t,e,n,o]=this.hot.selection.highlight.getFill().getVisualCorners(),i=this.hot.getSelectedRangeLast(),r=i.getTopStartCorner(),s=i.getBottomEndCorner();this.resetSelectionOfDraggedArea();const a=[r.row,r.col,s.row,s.col],l=this.hot.runHooks("modifyAutofillRange",[Math.min(r.row,t),Math.min(r.col,e),Math.max(s.row,n),Math.max(s.col,o)],a),{directionOfDrag:c,startOfDragCoords:h,endOfDragCoords:u}=no(a,l,(t,e)=>this.hot._createCellCoords(t,e));if(h&&h.row>-1&&h.col>-1){const t=this.getSelectionData(),e=i.clone(),n=this.hot._createCellRange(h,h,u),o=this.hot.runHooks("beforeAutofill",t,e,n,c);if(!1===o)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let r=o;const s=o;if(["up","left"].indexOf(c)>-1&&(1!==s.length||0!==s[0].length))if(r=[],"up"===c){const t=u.row-h.row+1,e=t%s.length;for(let n=0;n<t;n++)r.push(s[(n+(s.length-e))%s.length])}else{const t=u.col-h.col+1,e=t%s[0].length;for(let n=0;n<s.length;n++){r.push([]);for(let o=0;o<t;o++)r[n].push(s[n][(o+(s[n].length-e))%s[n].length])}}this.hot.populateFromArray(h.row,h.col,r,u.row,u.col,this.pluginName+".fill",null),this.setSelection(l),this.hot.runHooks("afterAutofill",r,e,n,c),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(t){return t.row<0&&(t.row=0),t.col<0&&(t.col=0),t}getCoordsOfDragAndDropBorders(t){const e=this.hot.getSelectedRangeLast(),n=e.getBottomEndCorner();let o=t;if(this.directions.includes(eo.vertical)&&this.directions.includes(eo.horizontal)){const i=e.getTopStartCorner();(n.col<=t.col||i.col>=t.col)&&(o=this.hot._createCellCoords(n.row,t.col)),(n.row<t.row||i.row>t.row)&&(o=this.hot._createCellCoords(t.row,n.col))}else if(this.directions.includes(eo.vertical))o=this.hot._createCellCoords(t.row,n.col);else{if(!this.directions.includes(eo.horizontal))return;o=this.hot._createCellCoords(n.row,t.col)}return this.reduceSelectionAreaIfNeeded(o)}showBorder(t){const e=this.getCoordsOfDragAndDropBorders(t);e&&this.redrawBorders(e)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(go,void 0,1,this.pluginName+".fill"),this.addingStarted=!1},po)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&!1===this.addingStarted&&this.autoInsertRow){const t=this.hot.getSelectedLast(),e=this.hot.selection.highlight.getFill().getVisualCorners(),n=this.hot.countRows();t[2]<n-1&&e[2]===n-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(t){const e=this.hot.getData(),n=this.hot.countRows();let o;for(let i=t[2]+1;i<n;i++){for(let o=t[1];o<=t[3];o++){const t=e[i][o];if(!Object(g["isEmpty"])(t))return-1}const n=e[i][t[1]-1],r=e[i][t[3]+1];Object(g["isEmpty"])(n)&&Object(g["isEmpty"])(r)||(o=i)}return o}addSelectionFromStartAreaToSpecificRowIndex(t,e){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(t[0],t[1])).add(this.hot._createCellCoords(e,t[3])).commit()}setSelection(t){this.hot.selectCell(...Object(f["arrayMap"])(t,t=>Math.max(t,0)),!1,!1)}selectAdjacent(){const t=this.hot.getSelectedLast(),e=this.getIndexOfLastAdjacentFilledInRow(t);return-1!==e&&void 0!==e&&(this.addSelectionFromStartAreaToSpecificRowIndex(t,e),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(t){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(t).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(t){const{documentElement:e}=this.hot.rootDocument,n=Object(s["offset"])(this.hot.table).top-(this.hot.rootWindow.pageYOffset||e.scrollTop)+Object(s["outerHeight"])(this.hot.table),o=Object(s["offset"])(this.hot.table).left-(this.hot.rootWindow.pageXOffset||e.scrollLeft)+Object(s["outerWidth"])(this.hot.table);return t.clientY>n&&t.clientX<=o}registerEvents(){const{documentElement:t}=this.hot.rootDocument;this.eventManager.addEventListener(t,"mouseup",()=>co(mo,this,Co).call(this)),this.eventManager.addEventListener(t,"mousemove",t=>co(mo,this,So).call(this,t))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const t=oo(this.hot.getSettings().fillHandle);this.directions=t.directions,this.autoInsertRow=t.autoInsertRow}destroy(){super.destroy()}}function wo(){const t=this.selectAdjacent();t&&this.fillIn()}function vo(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function yo(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function Co(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function So(t){const e=this.getIfMouseWasDraggedOutside(t);!1===this.addingStarted&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function Oo(t,e){Ro(t,e),e.add(t)}function Eo(t,e,n){Ro(t,e),e.set(t,n)}function Ro(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function To(t,e,n){return(e=Mo(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mo(t){var e=Io(t,"string");return"symbol"==typeof e?e:e+""}function Io(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function xo(t,e,n){return t.set(Ao(t,e),n),n}function No(t,e){return t.get(Ao(t,e))}function Ao(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Ho="autoRowSize",jo=40,_o="autoRowSize";var ko=new WeakMap,Po=new WeakSet;class Do extends bn{static get PLUGIN_KEY(){return Ho}static get PLUGIN_PRIORITY(){return jo}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(t){super(t),Oo(this,Po),To(this,"headerHeight",null),To(this,"ghostTable",new En(this.hot)),To(this,"samplesGenerator",new xn((t,e)=>{const n=this.hot.toPhysicalRow(t),o=this.hot.toPhysicalColumn(e);if(this.hot.rowIndexMapper.isHidden(n)||this.hot.columnIndexMapper.isHidden(o))return!1;if(t>=0&&e>=0){const n=this.hot.getCellMeta(t,e);if(n.hidden)return!1}let i;return t>=0?i=this.hot.getDataAtCell(t,e):-1===t&&(i=this.hot.getColHeader(e)),{value:i}})),To(this,"inProgress",!1),To(this,"measuredRows",0),To(this,"rowHeightsMap",new An["a"]),Eo(this,ko,[]),this.hot.rowIndexMapper.registerMap(_o,this.rowHeightsMap),this.addHook("beforeRowResize",(t,e,n)=>Ao(Po,this,Vo).call(this,t,e,n))}isEnabled(){const t=this.hot.getSettings()[Ho];return!0===t||Object(l["isObject"])(t)}enablePlugin(){var t=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return Ao(Po,t,Wo).call(t,...n)})),this.addHook("beforeChangeRender",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return Ao(Po,t,Bo).call(t,...n)})),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return Ao(Po,t,zo).call(t,...n)})),this.addHook("beforeRender",()=>Ao(Po,this,Fo).call(this)),this.addHook("modifyRowHeight",(t,e)=>this.getRowHeight(e,t)),this.addHook("init",()=>Ao(Po,this,Uo).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin())}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(t,e,n)=>Ao(Po,this,Vo).call(this,t,e,n))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const t=this.getFirstVisibleRow(),e=this.getLastVisibleRow();if(-1===t||-1===e)return;const n=this.hot.renderCall;this.calculateRowsHeight({from:t,to:e},void 0,n)}calculateRowsHeight(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countCols()-1},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o="number"===typeof t?{from:t,to:t}:t,i="number"===typeof e?{from:e,to:e}:e;if(null!==this.hot.getColHeader(0)){const t=this.samplesGenerator.generateRowSamples(-1,i);this.ghostTable.addColumnHeadersRow(t.get(-1))}Object(ie["rangeEach"])(o.from,o.to,t=>{let e=this.hot.toPhysicalRow(t);if(null===e&&(e=t),n||null===this.rowHeightsMap.getValueAtIndex(e)){const e=this.samplesGenerator.generateRowSamples(t,i);e.forEach((t,e)=>this.ghostTable.addRow(e,t))}}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((t,e)=>{t<0?this.headerHeight=e:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(t),e)})},!0),this.measuredRows=o.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=0;const o=this.hot.countRows()-1;let i=null;this.inProgress=!0;const r=()=>{if(!this.hot)return Object(vn["cancelAnimationFrame"])(i),void(this.inProgress=!1);this.calculateRowsHeight({from:n,to:Math.min(n+Do.CALCULATION_STEP,o)},t,e),n=n+Do.CALCULATION_STEP+1,n<o?i=Object(vn["requestAnimationFrame"])(r):(Object(vn["cancelAnimationFrame"])(i),this.inProgress=!1,this.hot.view.adjustElementsSize(),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},s=this.getSyncCalculationLimit();s>=0&&(this.calculateRowsHeight({from:0,to:s},t,e),n=s+1),n<o?r():(this.inProgress=!1,this.hot.view.adjustElementsSize())}setSamplingOptions(){const t=this.hot.getSettings()[Ho],e=t&&Object(l["hasOwnProperty"])(t,"samplingRatio")?t.samplingRatio:void 0,n=t&&Object(l["hasOwnProperty"])(t,"allowSampleDuplicates")?t.allowSampleDuplicates:void 0;e&&!isNaN(e)&&this.samplesGenerator.setSampleCount(parseInt(e,10)),n&&this.samplesGenerator.setAllowDuplicates(n)}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const t=this.hot.getSettings()[Ho];let e=Do.SYNC_CALCULATION_LIMIT;const n=this.hot.countRows()-1;return Object(l["isObject"])(t)&&(e=t.syncLimit,Object(p["isPercentValue"])(e)?e=Object(ie["valueAccordingPercent"])(n,e):e>>=0),Math.min(e,n)}getRowHeight(t,e){const n=t<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(t));let o=e;return null!==n&&n>(e||0)&&(o=n),o}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var t;return null!==(t=this.hot.view.getFirstRenderedVisibleRow())&&void 0!==t?t:-1}getLastVisibleRow(){var t;return null!==(t=this.hot.view.getLastRenderedVisibleRow())&&void 0!==t?t:-1}clearCache(t){this.headerHeight=null,Array.isArray(t)?this.hot.batchExecution(()=>{t.forEach(t=>{this.rowHeightsMap.setValueAtIndex(t,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(t){const{from:e,to:n}="number"===typeof t?{from:t,to:t}:t;this.hot.batchExecution(()=>{Object(ie["rangeEach"])(Math.min(e,n),Math.max(e,n),t=>{this.rowHeightsMap.setValueAtIndex(t,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(t=>null===t).length}destroy(){this.ghostTable.clean(),super.destroy()}}function Lo(t){const e={from:0,to:this.hot.countCols()-1};t.forEach(t=>{const n=this.samplesGenerator.generateRowSamples(t,e);n.forEach((t,e)=>this.ghostTable.addRow(e,t))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((t,e)=>{const n=this.hot.toPhysicalRow(t);this.rowHeightsMap.setValueAtIndex(n,e)})},!0),this.ghostTable.clean())}function Fo(){this.calculateVisibleRowsHeight(),this.inProgress||(Ao(Po,this,Lo).call(this,No(ko,this)),xo(ko,this,[]))}function Vo(t,e,n){let o=t;return n&&(this.calculateRowsHeight(e,void 0,!0),o=this.getRowHeight(e)),o}function Wo(t,e){e||this.recalculateAllRowsHeight()}function Bo(t){const e=t.reduce((t,e)=>{let[n]=e;return-1===t.indexOf(n)&&t.push(n),t},[]);No(ko,this).push(...e)}function Uo(){this.recalculateAllRowsHeight()}function zo(t){const e=t.reduce((t,e)=>{var n;const o=null===(n=e.address)||void 0===n?void 0:n.row;if(Number.isInteger(o)){const e=this.hot.toVisualRow(o);-1===t.indexOf(e)&&t.push(e)}return t},[]);No(ko,this).push(...e)}var Go=n("bdd7"),Yo=n("1096"),Xo=n("a73f");const{getListWithInsertedItems:$o,getListWithRemovedItems:Ko}=Object(Go["a"])("physicallyIndexed");class qo extends Yo["a"]{constructor(){super(t=>t)}insert(t,e){const n=Object(Xo["b"])(this.indexedValues,e);this.indexedValues=$o(n,t,e,this.initValueOrFn),super.insert(t,e)}remove(t){const e=Ko(this.indexedValues,t);this.indexedValues=Object(Xo["a"])(e,t),super.remove(t)}}var Qo=qo;const{getListWithInsertedItems:Jo,getListWithRemovedItems:Zo}=Object(Go["a"])("physicallyIndexed");class ti extends Yo["a"]{constructor(){super(t=>t)}insert(t,e){this.indexedValues=Jo(this.indexedValues,t,e,(t,e)=>this.getNextValue(e)),super.insert(t,e)}remove(t){this.indexedValues=Zo(this.indexedValues,t),super.remove(t)}getNextValue(t){return Math.max(...this.getValues())+1+t}}var ei=ti;function ni(t,e){oi(t,e),e.add(t)}function oi(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ii(t,e,n){return(e=ri(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ri(t){var e=si(t,"string");return"symbol"==typeof e?e:e+""}function si(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function ai(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const li="bindRowsWithHeaders",ci=210,hi="loose",ui=new Map([["loose",Qo],["strict",ei]]);var di=new WeakSet;class fi extends bn{constructor(){super(...arguments),ni(this,di),ii(this,"headerIndexes",null)}static get PLUGIN_KEY(){return li}static get PLUGIN_PRIORITY(){return ci}isEnabled(){return!!this.hot.getSettings()[li]}enablePlugin(){if(this.enabled)return;let t=this.hot.getSettings()[li];"string"!==typeof t&&(t=hi);const e=ui.get(t);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new e),this.addHook("modifyRowHeader",t=>ai(di,this,gi).call(this,t)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function gi(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}var pi=n("bd5e");function mi(t,e){wi(t,e),e.add(t)}function bi(t,e,n){wi(t,e),e.set(t,n)}function wi(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vi(t,e,n){return(e=yi(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yi(t){var e=Ci(t,"string");return"symbol"==typeof e?e:e+""}function Ci(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Si(t,e){return t.get(Ei(t,e))}function Oi(t,e,n){return t.set(Ei(t,e),n),n}function Ei(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Ri="collapsibleColumns",Ti=290,Mi=["nestedHeaders"],Ii="collapsibleIndicator",xi=Ri,Ni=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var Ai=new WeakMap,Hi=new WeakSet;class ji extends bn{constructor(){super(...arguments),mi(this,Hi),vi(this,"nestedHeadersPlugin",null),vi(this,"headerStateManager",null),bi(this,Ai,null)}static get PLUGIN_KEY(){return Ri}static get PLUGIN_PRIORITY(){return Ti}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[Ri,...Mi]}isEnabled(){return!!this.hot.getSettings()[Ri]}enablePlugin(){var t=this;if(this.enabled)return;const{nestedHeaders:e}=this.hot.getSettings();e||Object(pi["b"])("You need to configure the Nested Headers plugin in order to use collapsible headers."),Oi(Ai,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>Ei(Hi,this,Pi).call(this)),this.addHook("afterLoadData",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return Ei(Hi,t,Di).call(t,...n)})),this.addHook("afterGetColHeader",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return Ei(Hi,t,_i).call(t,...n)})),this.addHook("beforeOnCellMouseDown",(t,e,n)=>Ei(Hi,this,ki).call(this,t,e,n)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:t}=this.hot.getSettings();"boolean"===typeof t?this.headerStateManager.mapState(t=>({collapsible:t.origColspan>1})):Array.isArray(t)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(t))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Oi(Ai,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var t;const{row:e,col:n}=this.hot.getSelectedRangeLast().highlight,{collapsible:o,isCollapsed:i,columnIndex:r}=null!==(t=this.headerStateManager.getHeaderTreeNodeData(e,n))&&void 0!==t?t:{};if(o)return i?this.expandSection({row:e,col:r}):this.collapseSection({row:e,col:r}),!1},runOnlyIf:()=>{var t,e;return(null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.isSingle())&&(null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight.isHeader())},group:xi,relativeToGroup:c["a"],position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(xi)}clearButtons(){if(!this.hot.view)return;const t=this.hot.view._wt.getSetting("columnHeaders").length,e=this.hot.view._wt.wtTable.THEAD,n=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,o=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,i=function(t){t&&t.parentNode.removeChild(t)};Object(ie["rangeEach"])(0,t-1,t=>{const r=e.childNodes[t],s=n.childNodes[t],a=o?o.childNodes[t]:null;Object(ie["rangeEach"])(0,r.childNodes.length-1,t=>{let e=r.childNodes[t].querySelector("."+Ii);i(e),s&&s.childNodes[t]&&(e=s.childNodes[t].querySelector("."+Ii),i(e)),o&&a&&a.childNodes[t]&&(e=a.childNodes[t].querySelector("."+Ii),i(e))})},!0)}expandSection(t){this.toggleCollapsibleSection([t],"expand")}collapseSection(t){this.toggleCollapsibleSection([t],"collapse")}toggleAllCollapsibleSections(t){const e=this.headerStateManager.mapNodes(e=>{const{collapsible:n,origColspan:o,headerLevel:i,columnIndex:r,isCollapsed:s}=e;if(!0===n&&o>1&&(s&&"expand"===t||!s&&"collapse"===t))return{row:this.headerStateManager.levelToRowCoords(i),col:r}});this.toggleCollapsibleSection(e,t)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(t,e){if(!Ni.has(e))throw new Error(`Unsupported action is passed (${e}).`);if(!Array.isArray(t))return;const n=Object(f["arrayFilter"])(t,t=>{let{row:e}=t;return e<0});let o=n.length>0;Object(f["arrayEach"])(n,t=>{var n;let{row:i,col:r}=t;const{collapsible:s,isCollapsed:a}=null!==(n=this.headerStateManager.getHeaderSettings(i,r))&&void 0!==n?n:{};if(!s||a&&"collapse"===e||!a&&"expand"===e)return o=!1,!1});const i=[],r=[];o&&Object(f["arrayEach"])(n,t=>{let{row:n,col:o}=t;const{colspanCompensation:s,affectedColumns:a,rollbackModification:l}=this.headerStateManager.triggerNodeModification(e,n,o);s>0&&(r.push(...a),i.push(l))});const s=this.getCollapsedColumns();let a=[];"collapse"===e?a=Object(f["arrayUnique"])([...s,...r]):"expand"===e&&(a=Object(f["arrayFilter"])(s,t=>!r.includes(t)));const l=Ni.get(e),c=this.hot.runHooks(l.beforeHook,s,a,o);if(!1===c)return void Object(f["arrayEach"])(i,t=>{t()});this.hot.batchExecution(()=>{Object(f["arrayEach"])(r,t=>{Si(Ai,this).setValueAtIndex(this.hot.toPhysicalColumn(t),l.hideColumn)})},!0);const h=this.getCollapsedColumns().length!==s.length,u=this.hot.getSelectedRangeLast();if("collapse"===e&&h&&u){const{row:t,col:e}=u.highlight,n=this.hot.rowIndexMapper.isHidden(t)||this.hot.columnIndexMapper.isHidden(e);if(n&&r.includes(e)){const n=t>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(t,1,!0):t,o=e>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(e,1,!0):e;null!==n&&null!==o&&this.hot.selectCell(n,o)}}this.hot.runHooks(l.afterHook,s,a,o,h),this.hot.render(),this.hot.view.adjustElementsSize()}getCollapsedColumns(){return Si(Ai,this).getHiddenIndexes()}destroy(){Oi(Ai,this,null),super.destroy()}}function _i(t,e,n){var o;const{collapsible:i,origColspan:r,isCollapsed:a}=null!==(o=this.headerStateManager.getHeaderSettings(n,t))&&void 0!==o?o:{},l=i&&r>1&&t>=this.hot.getSettings().fixedColumnsStart,c=this.hot.getSettings().ariaTags;let h=e.querySelector("."+Ii);var u;(Object(s["removeAttribute"])(e,[Object(v["k"])("")[0]]),l)?(h||(h=this.hot.rootDocument.createElement("div"),Object(s["addClass"])(h,Ii),e.querySelector("div:first-child").appendChild(h)),Object(s["removeClass"])(h,["collapsed","expanded"]),a?(Object(s["addClass"])(h,"collapsed"),Object(s["fastInnerText"])(h,"+"),c&&Object(s["setAttribute"])(e,...Object(v["k"])(!1))):(Object(s["addClass"])(h,"expanded"),Object(s["fastInnerText"])(h,"-"),c&&Object(s["setAttribute"])(e,...Object(v["k"])(!0))),c&&Object(s["setAttribute"])(h,...Object(v["n"])())):null===(u=h)||void 0===u||u.remove()}function ki(t,e){Object(s["hasClass"])(t.target,Ii)&&(Object(s["hasClass"])(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):Object(s["hasClass"])(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),Object(a["stopImmediatePropagation"])(t))}function Pi(){this.updatePlugin()}function Di(t,e){e||this.updatePlugin()}var Li=n("97b9"),Fi=n("1b1a"),Vi=n("9056");function Wi(t,e,n){return(e=Bi(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bi(t){var e=Ui(t,"string");return"symbol"==typeof e?e:e+""}function Ui(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}const zi=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],Gi=!1,Yi=!0,Xi=!0;class $i{constructor(t,e){Wi(this,"hot",void 0),Wi(this,"sortingStates",new Vi["a"]),Wi(this,"sortEmptyCells",Gi),Wi(this,"indicator",Yi),Wi(this,"headerAction",Xi),Wi(this,"compareFunctionFactory",void 0),Wi(this,"mapName",void 0),this.hot=t,this.mapName=e,this.hot.columnIndexMapper.registerMap(e,this.sortingStates)}updateAllColumnsProperties(t){Object(l["isObject"])(t)&&Object(l["objectEach"])(t,(t,e)=>{zi.includes(e)&&(this[e]=t)})}getAllColumnsProperties(){const t={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return"function"===typeof this.compareFunctionFactory&&(t.compareFunctionFactory=this.compareFunctionFactory),t}getSortOrderOfColumn(t){var e;return null===(e=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(t)))||void 0===e?void 0:e.sortOrder}getIndexOfColumnInSortQueue(t){return t=this.hot.toPhysicalColumn(t),this.sortingStates.getEntries().findIndex(e=>{let[n]=e;return n===t})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return 0===this.getNumberOfSortedColumns()}isColumnSorted(t){return Object(l["isObject"])(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(t)))}getSortStates(){if(null===this.sortingStates)return[];const t=this.sortingStates.getEntries();return t.map(t=>{let[e,n]=t;return{column:this.hot.toVisualColumn(e),...n}})}getColumnSortState(t){const e=this.getSortOrderOfColumn(t);if(Object(g["isDefined"])(e))return{column:t,sortOrder:e}}setSortStates(t){this.sortingStates.clear();for(let e=0;e<t.length;e+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(t[e].column),{sortOrder:t[e].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}n("38b3"),n("f448"),n("66e1"),n("2582"),n("f86b"),n("1587"),n("c5d7");function Ki(t,e,n){const o=e.locale;return function(e,i){const{sortEmptyCells:r}=n;return"string"===typeof e&&(e=e.toLocaleLowerCase(o)),"string"===typeof i&&(i=i.toLocaleLowerCase(o)),e===i?dr:Object(g["isEmpty"])(e)?Object(g["isEmpty"])(i)?dr:r&&"asc"===t?fr:gr:Object(g["isEmpty"])(i)?r&&"asc"===t?gr:fr:isNaN(e)&&!isNaN(i)?"asc"===t?gr:fr:!isNaN(e)&&isNaN(i)?"asc"===t?fr:gr:(isNaN(e)||isNaN(i)||(e=parseFloat(e),i=parseFloat(i)),e<i?"asc"===t?fr:gr:e>i?"asc"===t?gr:fr:dr)}}const qi="default";function Qi(t,e,n){return function(e,o){const i=parseFloat(e),r=parseFloat(o),{sortEmptyCells:s}=n;if(i===r||isNaN(i)&&isNaN(r))return dr;if(s){if(Object(g["isEmpty"])(e))return"asc"===t?fr:gr;if(Object(g["isEmpty"])(o))return"asc"===t?gr:fr}return isNaN(i)?gr:isNaN(r)?fr:i<r?"asc"===t?fr:gr:i>r?"asc"===t?gr:fr:dr}}const Ji="numeric";function Zi(t,e,n){const o=e.checkedTemplate,i=e.uncheckedTemplate,{sortEmptyCells:r}=n;return function(s,a){const l=Object(g["isEmpty"])(s),c=Object(g["isEmpty"])(a),h=l?i:s,u=c?i:a,d=h===i||h===o,f=u===i||u===o;if(!1===r){if(l&&!1===c)return gr;if(!1===l&&c)return fr}return!1===d&&f?"asc"===t?fr:gr:d&&!1===f?"asc"===t?gr:fr:!1===d&&!1===f?Ki(t,e,n)(s,a):h===i&&u===o?"asc"===t?fr:gr:h===o&&u===i?"asc"===t?gr:fr:dr}}const tr="checkbox";function er(t,e,n){return Rr(t,e.dateFormat,n)}const nr="date";function or(t,e,n){return Rr(t,e.timeFormat,n)}const ir="time";var rr=n("9acd");const{register:sr,getItem:ar,hasItem:lr}=Object(rr["a"])("sorting.compareFunctionFactory"),{register:cr,getItem:hr}=Object(rr["a"])("sorting.mainSortComparator");function ur(t){return lr(t)?ar(t):ar(qi)}sr(tr,Zi),sr(nr,er),sr(qi,Ki),sr(Ji,Qi),sr(ir,or);const dr=0,fr=-1,gr=1;function pr(t,e){const n=hr(e);for(var o=arguments.length,i=new Array(o>2?o-2:0),r=2;r<o;r++)i[r-2]=arguments[r];t.sort(n(...i))}const mr="asc",br="desc",wr="colHeader";function vr(t){if(!1===Object(l["isObject"])(t))return!1;const{column:e,sortOrder:n}=t;return Number.isInteger(e)&&[mr,br].includes(n)}function yr(t){if(t.some(t=>!1===vr(t)))return!1;const e=t.map(t=>{let{column:e}=t;return e});return new Set(e).size===e.length}function Cr(t){if(t!==br)return t===mr?br:mr}function Sr(t){const e=t.querySelector("."+wr);return e}function Or(t,e){if(t<0||!e.parentNode)return!1;const n=e.parentNode.parentNode.childNodes,o=Array.from(n).indexOf(e.parentNode)-n.length;return-1===o}function Er(t,e,n){return-1===t&&e>=0&&!1===Object(a["isRightClick"])(n)}function Rr(t,e,n){return function(o,i){const{sortEmptyCells:r}=n;if(o===i)return dr;if(Object(g["isEmpty"])(o))return Object(g["isEmpty"])(i)?dr:r&&"asc"===t?fr:gr;if(Object(g["isEmpty"])(i))return r&&"asc"===t?gr:fr;const s=j(o,e),a=j(i,e);return s.isValid()?a.isValid()?a.isAfter(s)?"asc"===t?fr:gr:a.isBefore(s)?"asc"===t?gr:fr:dr:fr:gr}}const Tr="ascending",Mr="descending",Ir="indicatorDisabled",xr="columnSorting",Nr="sortAction",Ar=new Map([[mr,Tr],[br,Mr]]);function Hr(t,e,n,o){const i=[xr];if(o&&i.push(Nr),!1===n)return i.push(Ir),i;const r=t.getSortOrderOfColumn(e);return Object(g["isDefined"])(r)&&i.push(Ar.get(r)),i}function jr(){return Array.from(Ar.values()).concat(Nr,Ir,xr)}function _r(t,e){return function(n,o){const[,...i]=n,[,...r]=o;return function(n){const o=t[n],s=e[n],a=i[n],l=r[n],c=s.columnSorting,h=c.compareFunctionFactory?c.compareFunctionFactory:ur(s.type),u=h(o,s,c)(a,l);return u}(0)}}function kr(t,e){Pr(t,e),e.add(t)}function Pr(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Dr(t,e,n){return(e=Lr(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lr(t){var e=Fr(t,"string");return"symbol"==typeof e?e:e+""}function Fr(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Vr(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Wr="columnSorting",Br=50,Ur="append",zr="replace",Gr=Wr;cr(Wr,_r),mt["a"].getSingleton().register("beforeColumnSort"),mt["a"].getSingleton().register("afterColumnSort");var Yr=new WeakSet;class Xr extends bn{constructor(){super(...arguments),kr(this,Yr),Dr(this,"columnStatesManager",null),Dr(this,"columnMetaCache",null),Dr(this,"pluginKey",Wr),Dr(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return Wr}static get PLUGIN_PRIORITY(){return Br}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var t=this;this.enabled||(this.columnStatesManager=new $i(this.hot,this.pluginKey+".sortingStates"),this.columnMetaCache=new An["a"](t=>{let e=this.hot.toVisualColumn(t);return null===e&&(e=t),this.getMergedPluginSettings(e)}),this.hot.columnIndexMapper.registerMap(this.pluginKey+".columnMeta",this.columnMetaCache),this.addHook("afterGetColHeader",(t,e)=>Vr(Yr,this,Kr).call(this,t,e)),this.addHook("beforeOnCellMouseDown",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return Vr(Yr,t,Qr).call(t,...n)})),this.addHook("afterOnCellMouseDown",(t,e)=>this.onAfterOnCellMouseDown(t,e)),this.addHook("afterInit",()=>Vr(Yr,this,$r).call(this)),this.addHook("afterLoadData",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return Vr(Yr,t,qr).call(t,...n)})),this.hot.view&&Vr(Yr,this,$r).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const t=(t,e)=>{const n=Sr(e);!1!==Or(t,e)&&null!==n&&this.updateHeaderClasses(n)};this.hot.addHook("afterGetColHeader",t),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",t)}),this.hot.batchExecution(()=>{null!==this.indexesSequenceCache&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap(this.pluginKey+".columnMeta"),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:t}=this.hot.getSelectedRangeLast();return this.sort(this.getColumnNextConfig(t.col)),!1},runOnlyIf:()=>{var t,e;const n=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return n&&(null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.isSingle())&&this.hot.selection.isCellVisible(n)&&-1===n.row&&n.col>=0},relativeToGroup:c["a"],position:"before",group:Gr})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Gr)}sort(t){const e=this.getSortConfig(),n=this.getNormalizedSortConfigs(t),o=this.areValidSortConfigs(n),i=this.hot.runHooks("beforeColumnSort",e,n,o);!1!==i&&(0===e.length&&null===this.indexesSequenceCache&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new Fi["a"]),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),o&&(this.columnStatesManager.setSortStates(n),this.sortByPresetSortStates(n),this.saveAllSortSettings(n)),this.hot.runHooks("afterColumnSort",e,o?n:e,o),o&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(t){return Object(g["isDefined"])(t)?this.columnStatesManager.getColumnSortState(t):this.columnStatesManager.getSortStates()}setSortConfig(t){const e=this.getNormalizedSortConfigs(t);this.areValidSortConfigs(e)&&this.columnStatesManager.setSortStates(e)}getNormalizedSortConfigs(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(t)?t.slice(0,1):[t]}areValidSortConfigs(t){const e=this.hot.countCols();return yr(t)&&t.every(t=>{let{column:n}=t;return n<=e&&n>=0})}saveAllSortSettings(t){const e=this.columnStatesManager.getAllColumnsProperties(),n=t=>{let{column:e,...n}=t;return{column:this.hot.toPhysicalColumn(e),...n}};e.initialConfig=Object(f["arrayMap"])(t,n),this.hot.runHooks("persistentStateSave","columnSorting",e)}getAllSavedSortSettings(){const t={};this.hot.runHooks("persistentStateLoad","columnSorting",t);const e=t.value,n=t=>{let{column:e,...n}=t;return{column:this.hot.toVisualColumn(e),...n}};return Object(g["isDefined"])(e)&&Array.isArray(e.initialConfig)&&(e.initialConfig=Object(f["arrayMap"])(e.initialConfig,n)),e}getColumnNextConfig(t){const e=this.columnStatesManager.getSortOrderOfColumn(t);if(Object(g["isDefined"])(e)){const n=Cr(e);return Object(g["isDefined"])(n)?{column:t,sortOrder:n}:void 0}const n=this.hot.countCols();if(Number.isInteger(t)&&t>=0&&t<n)return{column:t,sortOrder:Cr()}}getNextSortConfig(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ur;const n=this.columnStatesManager.getIndexOfColumnInSortQueue(t),o=-1!==n,i=this.getSortConfig(),r=this.getColumnNextConfig(t);if(o){if(Object(g["isUndefined"])(r))return[...i.slice(0,n),...i.slice(n+1)];if(e===Ur)return[...i.slice(0,n),...i.slice(n+1),r];if(e===zr)return[...i.slice(0,n),r,...i.slice(n+1)]}return Object(g["isDefined"])(r)?i.concat(r):i}getPluginColumnConfig(t){if(Object(l["isObject"])(t)){const e=t[this.pluginKey];if(Object(l["isObject"])(e))return e}return{}}getMergedPluginSettings(t){const e=this.hot.getSettings()[this.pluginKey],n=this.columnStatesManager.getAllColumnsProperties(),o=this.hot.getCellMeta(0,t),i=Object.getPrototypeOf(o);return Array.isArray(i.columns)?Object.assign(n,e,this.getPluginColumnConfig(i.columns[t])):Object(Li["isFunction"])(i.columns)?Object.assign(n,e,this.getPluginColumnConfig(i.columns(t))):Object.assign(n,e)}getFirstCellSettings(t){const e=this.hot.getCellMeta(0,t),n=Object.create(e);return n[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(t)),n}getNumberOfRowsToSort(t){const e=this.hot.getSettings();return e.maxRows<=t?e.maxRows:t-e.minSpareRows}sortByPresetSortStates(t){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),0===t.length)return;const e=[],n=this.hot.countRows(),o=e=>Object(f["arrayMap"])(t,t=>this.hot.getDataAtCell(e,t.column));for(let l=0;l<this.getNumberOfRowsToSort(n);l+=1)e.push([this.hot.toPhysicalRow(l)].concat(o(l)));const i=Object(f["arrayMap"])(e,t=>t[0]);pr(e,this.pluginKey,Object(f["arrayMap"])(t,t=>t.sortOrder),Object(f["arrayMap"])(t,t=>this.getFirstCellSettings(t.column)));for(let l=e.length;l<n;l+=1)e.push([l].concat(o(l)));const r=Object(f["arrayMap"])(e,t=>t[0]),s=new Map(Object(f["arrayMap"])(i,(t,e)=>[t,r[e]])),a=Object(f["arrayMap"])(this.hot.rowIndexMapper.getIndexesSequence(),t=>s.has(t)?s.get(t):t);this.hot.rowIndexMapper.setIndexesSequence(a)}sortBySettings(t){if(Object(l["isObject"])(t)){this.columnStatesManager.updateAllColumnsProperties(t);const e=t.initialConfig;(Array.isArray(e)||Object(l["isObject"])(e))&&this.sort(e)}else this.hot.render()}updateHeaderClasses(t){if(Object(s["removeClass"])(t,jr(t)),!1!==this.enabled){for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];Object(s["addClass"])(t,Hr(...n))}}onUpdateSettings(t){super.onUpdateSettings(),null!==this.columnMetaCache&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),Object(g["isDefined"])(t[this.pluginKey])&&this.sortBySettings(t[this.pluginKey])}wasClickableHeaderClicked(t,e){const n=this.getFirstCellSettings(e)[this.pluginKey],o=n.headerAction;return o&&Object(s["hasClass"])(t.target,wr)}onAfterOnCellMouseDown(t,e){if(!1!==Er(e.row,e.col,t)&&this.wasClickableHeaderClicked(t,e.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(e.col));const t=this.hot.getActiveEditor(),n=this.getColumnNextConfig(e.col);null!==t&&void 0!==t&&t.isOpened()&&this.hot.getCellValidator(t.row,t.col)?this.hot.addHookOnce("postAfterValidate",()=>{this.sort(n)}):this.sort(n)}}destroy(){var t;null===(t=this.columnStatesManager)||void 0===t||t.destroy(),super.destroy()}}function $r(){const t=this.getAllSavedSortSettings();if(Object(l["isObject"])(t))this.sortBySettings(t);else{const t=this.hot.getSettings()[this.pluginKey];this.sortBySettings(t)}}function Kr(t,e){const n=Sr(e);if(!1===Or(t,e)||null===n)return;const o=this.getFirstCellSettings(t)[this.pluginKey],i=o.indicator,r=o.headerAction;if(this.updateHeaderClasses(n,this.columnStatesManager,t,i,r),this.hot.getSettings().ariaTags){const n=this.columnStatesManager.getSortOrderOfColumn(t);Object(s["setAttribute"])(e,...Object(v["K"])(n?n+"ending":"none"))}}function qr(t){!0===t&&this.hot.view&&Vr(Yr,this,$r).call(this)}function Qr(t,e,n,o){!1!==Er(e.row,e.col,t)&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(o.column=!0)}function Jr(t,e,n){return(e=Zr(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zr(t){var e=ts(t,"string");return"symbol"==typeof e?e:e+""}function ts(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class es{constructor(t,e){Jr(this,"plugin",void 0),Jr(this,"hot",void 0),Jr(this,"endpoints",[]),Jr(this,"settings",void 0),Jr(this,"settingsType","array"),Jr(this,"currentEndpoint",null),Jr(this,"cellsToSetCache",[]),this.plugin=t,this.hot=this.plugin.hot,this.settings=e}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(t){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings)[t]:this.endpoints[t]}getAllEndpoints(){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(t){return this.parseSettings(t.call(this))}parseSettings(t){const e=[];let n=t;if(n||"function"!==typeof this.settings)return n||(n=this.settings),Object(f["arrayEach"])(n,t=>{const n={};this.assignSetting(t,n,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(t,n,"reversedRowCoords",!1),this.assignSetting(t,n,"destinationRow",new Error("\n        You must provide a destination row for the Column Summary plugin in order to work properly!\n      ")),this.assignSetting(t,n,"destinationColumn",new Error("\n        You must provide a destination column for the Column Summary plugin in order to work properly!\n      ")),this.assignSetting(t,n,"sourceColumn",t.destinationColumn),this.assignSetting(t,n,"type","sum"),this.assignSetting(t,n,"forceNumeric",!1),this.assignSetting(t,n,"suppressDataTypeErrors",!0),this.assignSetting(t,n,"customFunction",null),this.assignSetting(t,n,"readOnly",!0),this.assignSetting(t,n,"roundFloat",!1),e.push(n)}),e;this.settingsType="function"}assignSetting(t,e,n,o){if("ranges"!==n||void 0!==t[n]){if("ranges"!==n||0!==t[n].length)if(void 0===t[n]){if(o instanceof Error)throw o;e[n]=o}else"destinationRow"===n&&e.reversedRowCoords?e[n]=this.hot.countRows()-t[n]-1:e[n]=t[n]}else e[n]=o}resetSetupBeforeStructureAlteration(t,e,n){if("function"!==this.settingsType)return;const o=t.indexOf("row")>-1?"row":"col",i=this.getAllEndpoints();Object(f["arrayEach"])(i,i=>{"row"===o&&i.destinationRow>=e&&("insert_row"===t?i.alterRowOffset=n:"remove_row"===t&&(i.alterRowOffset=-1*n)),"col"===o&&i.destinationColumn>=e&&("insert_col"===t?i.alterColumnOffset=n:"remove_col"===t&&(i.alterColumnOffset=-1*n))}),this.resetAllEndpoints(i,!1)}resetSetupAfterStructureAlteration(t,e,n,o,i){let r=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];if("function"===this.settingsType){const t=()=>(this.hot.removeHook("beforeViewRender",t),this.refreshAllEndpoints());return void this.hot.addHookOnce("beforeViewRender",t)}const s=t.indexOf("row")>-1?"row":"col",a=t.indexOf("remove")>-1?-1:1,l=this.getAllEndpoints(),c=0===t.indexOf("move_row"),h=e;Object(f["arrayEach"])(l,t=>{"row"===s&&t.destinationRow>=h&&(t.alterRowOffset=a*n),"col"===s&&t.destinationColumn>=h&&(t.alterColumnOffset=a*n)}),this.resetAllEndpoints(l,!c),c?Object(f["arrayEach"])(l,t=>{this.extendEndpointRanges(t,h,o[0],o.length),this.recreatePhysicalRanges(t),this.clearOffsetInformation(t)}):Object(f["arrayEach"])(l,t=>{this.shiftEndpointCoordinates(t,h)}),r&&this.refreshAllEndpoints()}clearOffsetInformation(t){t.alterRowOffset=void 0,t.alterColumnOffset=void 0}extendEndpointRanges(t,e,n,o){Object(f["arrayEach"])(t.ranges,t=>{t[1]&&(e>=t[0]&&e<=t[1]?n>t[1]?t[1]+=o:n<t[0]&&(t[0]-=o):n>=t[0]&&n<=t[1]&&(t[1]-=o,e<=t[0]&&(t[0]+=1,t[1]+=1)))})}recreatePhysicalRanges(t){const e=t.ranges,n=[],o=[];Object(f["arrayEach"])(e,t=>{const e=[];if(t[1])for(let n=t[0];n<=t[1];n++)e.push(this.hot.toPhysicalRow(n));else e.push(this.hot.toPhysicalRow(t[0]));o.push(e)}),Object(f["arrayEach"])(o,t=>{let e=[];Object(f["arrayEach"])(t,(o,i)=>{0===i?e.push(o):t[i]!==t[i-1]+1&&(e.push(t[i-1]),n.push(e),e=[],e.push(o)),i===t.length-1&&(e.push(o),n.push(e))})}),t.ranges=n}shiftEndpointCoordinates(t,e){t.alterRowOffset&&0!==t.alterRowOffset?(t.destinationRow+=t.alterRowOffset||0,Object(f["arrayEach"])(t.ranges,n=>{Object(f["arrayEach"])(n,(o,i)=>{o>=e&&(n[i]+=t.alterRowOffset||0)})})):t.alterColumnOffset&&0!==t.alterColumnOffset&&(t.destinationColumn+=t.alterColumnOffset||0,t.sourceColumn+=t.alterColumnOffset||0)}resetAllEndpoints(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getAllEndpoints(),e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=t.some(t=>{const e=t.alterRowOffset||0,n=t.alterColumnOffset||0;return t.destinationRow+e>=this.hot.countRows()||t.destinationColumn+n>=this.hot.countCols()});n||(this.cellsToSetCache=[],Object(f["arrayEach"])(t,t=>{this.resetEndpointValue(t,e)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],Object(f["arrayEach"])(this.getAllEndpoints(),t=>{this.currentEndpoint=t,this.plugin.calculate(t),this.setEndpointValue(t,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(t){const e=[];this.cellsToSetCache=[],Object(f["arrayEach"])(t,(t,n,o)=>{""+(t[2]||"")!==""+t[3]&&Object(f["arrayEach"])(this.getAllEndpoints(),(t,i)=>{this.hot.propToCol(o[n][1])===t.sourceColumn&&-1===e.indexOf(i)&&e.push(i)})}),Object(f["arrayEach"])(e,t=>{this.refreshEndpoint(this.getEndpoint(t))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(t=>{const e=this.hot.toVisualRow(t.destinationRow);if(null!==e){const n=this.hot.getCellMeta(e,t.destinationColumn);n.readOnly=t.readOnly,n.className="columnSummaryResult"}})}refreshEndpoint(t){this.currentEndpoint=t,this.plugin.calculate(t),this.setEndpointValue(t),this.currentEndpoint=null}resetEndpointValue(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=t.alterRowOffset||0,o=t.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(t.destinationRow+(e?n:0)),this.hot.toVisualColumn(t.destinationColumn+(e?o:0)),""])}setEndpointValue(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o=this.hot.toVisualRow(t.destinationRow);if(t.destinationRow>=this.hot.countRows()||t.destinationColumn>=this.hot.countCols())return void this.throwOutOfBoundsWarning();const i=this.hot.toVisualRow(t.destinationRow);if(null!==i){const n=this.hot.getCellMeta(i,t.destinationColumn);"init"!==e&&n.readOnly===t.readOnly||(n.readOnly=t.readOnly,n.className="columnSummaryResult")}if((!0===t.roundFloat||Number.isInteger(t.roundFloat))&&!isNaN(t.result)){const e=t.roundFloat;let n=0;Number.isInteger(e)&&(n=Math.min(Math.max(0,e),100)),t.result=t.result.toFixed(n)}n?this.hot.setDataAtCell(o,t.destinationColumn,t.result,"ColumnSummary.set"):this.cellsToSetCache.push([o,t.destinationColumn,t.result]),t.alterRowOffset=void 0,t.alterColumnOffset=void 0}throwOutOfBoundsWarning(){Object(pi["b"])("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}var ns=es,os=n("67a8");function is(t){return null===t||void 0===t||isNaN(t)}function rs(t,e){ss(t,e),e.add(t)}function ss(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function as(t,e,n){return(e=ls(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ls(t){var e=cs(t,"string");return"symbol"==typeof e?e:e+""}function cs(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function hs(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const us="columnSummary",ds=220;var fs=new WeakSet;class gs extends bn{constructor(){super(...arguments),rs(this,fs),as(this,"endpoints",null)}static get PLUGIN_KEY(){return us}static get PLUGIN_PRIORITY(){return ds}isEnabled(){return!!this.hot.getSettings()[us]}enablePlugin(){var t=this;this.enabled||(this.settings=this.hot.getSettings()[us],this.endpoints=new ns(this,this.settings),this.addHook("afterInit",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return hs(fs,t,ps).call(t,...n)})),this.addHook("afterChange",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return hs(fs,t,bs).call(t,...n)})),this.addHook("afterUpdateSettings",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return hs(fs,t,ms).call(t,...n)})),this.addHook("beforeCreateRow",(t,e,n)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",t,e,null,n)),this.addHook("beforeCreateCol",(t,e,n)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",t,e,null,n)),this.addHook("beforeRemoveRow",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return t.endpoints.resetSetupBeforeStructureAlteration("remove_row",...n)})),this.addHook("beforeRemoveCol",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return t.endpoints.resetSetupBeforeStructureAlteration("remove_col",...n)})),this.addHook("afterCreateRow",(t,e,n)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",t,e,null,n)),this.addHook("afterCreateCol",(t,e,n)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",t,e,null,n)),this.addHook("afterRemoveRow",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return t.endpoints.resetSetupAfterStructureAlteration("remove_row",...n)})),this.addHook("afterRemoveCol",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return t.endpoints.resetSetupAfterStructureAlteration("remove_col",...n)})),this.addHook("afterRowMove",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return hs(fs,t,ws).call(t,...n)})),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(t){switch(t.type.toLowerCase()){case"sum":t.result=this.calculateSum(t);break;case"min":t.result=this.calculateMinMax(t,t.type);break;case"max":t.result=this.calculateMinMax(t,t.type);break;case"count":t.result=this.countEntries(t);break;case"average":t.result=this.calculateAverage(t);break;case"custom":t.result=t.customFunction.call(this,t);break;default:break}}calculateSum(t){let e=0;return Object(l["objectEach"])(t.ranges,n=>{e+=this.getPartialSum(n,t.sourceColumn)}),e}getPartialSum(t,e){let n=0,o=t[1]||t[0],i=null,r=0;do{if(i=this.getCellValue(o,e),i=is(i)?null:i,null!==i){const t=((""+i).split(".")[1]||[]).length||1;t>r&&(r=t)}n+=i||0,o-=1}while(o>=t[0]);return Math.round(n*10**r)/10**r}calculateMinMax(t,e){let n=null;return Object(l["objectEach"])(t.ranges,o=>{const i=this.getPartialMinMax(o,t.sourceColumn,e);if(null===n&&null!==i&&(n=i),null!==i)switch(e){case"min":n=Math.min(n,i);break;case"max":n=Math.max(n,i);break;default:break}}),null===n?"Not enough data":n}getPartialMinMax(t,e,n){let o,i=null,r=t[1]||t[0];do{if(o=this.getCellValue(r,e),o=is(o)?null:o,null===i)i=o;else if(null!==o)switch(n){case"min":i=Math.min(i,o);break;case"max":i=Math.max(i,o);break;default:break}r-=1}while(r>=t[0]);return i}countEmpty(t,e){let n,o=0,i=t[1]||t[0];do{n=this.getCellValue(i,e),n=is(n)?null:n,null===n&&(o+=1),i-=1}while(i>=t[0]);return o}countEntries(t){let e=0;const n=t.ranges;return Object(l["objectEach"])(n,n=>{const o=void 0===n[1]?1:n[1]-n[0]+1,i=this.countEmpty(n,t.sourceColumn);e+=o,e-=i}),e}calculateAverage(t){const e=this.calculateSum(t),n=this.countEntries(t);return e/n}getCellValue(t,e){const n=this.hot.toVisualRow(t),o=this.hot.toVisualColumn(e);let i=this.hot.getSourceDataAtCell(t,e),r="";if(null!==n&&null!==o&&(r=this.hot.getCellMeta(n,o).className||""),r.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&("string"===typeof i&&(i=i.replace(/,/,".")),i=parseFloat(i)),isNaN(i)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(os["a"]`ColumnSummary plugin: cell at (${t}, ${e}) is not in a\x20
          numeric format. Cannot do the calculation.`);return i}}function ps(){this.endpoints.initEndpoints()}function ms(t){void 0!==t.columns&&this.endpoints.refreshCellMetas()}function bs(t,e){t&&"ColumnSummary.reset"!==e&&"ColumnSummary.set"!==e&&"loadData"!==e&&this.endpoints.refreshChangedEndpoints(t)}function ws(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}var vs=n("7ae0");function ys(t,e){Ss(t,e),e.add(t)}function Cs(t,e,n){Ss(t,e),e.set(t,n)}function Ss(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Os(t,e){return t.get(Rs(t,e))}function Es(t,e,n){return t.set(Rs(t,e),n),n}function Rs(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ts=new WeakMap,Ms=new WeakMap,Is=new WeakMap,xs=new WeakSet;class Ns{constructor(){ys(this,xs),Cs(this,Ts,!0),Cs(this,Ms,null),Cs(this,Is,new ResizeObserver(t=>Rs(xs,this,As).call(this,t)))}setObservedElement(t){Es(Ms,this,t)}unobserve(){Os(Is,this).unobserve(Os(Ms,this))}observe(){Es(Ts,this,!0),Os(Is,this).observe(Os(Ms,this))}destroy(){Os(Is,this).disconnect()}}function As(t){!Os(Ts,this)&&Array.isArray(t)&&t.length?t.forEach(t=>{let{borderBoxSize:e}=t;const{inlineSize:n,blockSize:o}=e[0];this.runLocalHooks("resize",n,o)}):Es(Ts,this,!1)}function Hs(t,e,n){js(t,e),e.set(t,n)}function js(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _s(t,e){return t.get(Ps(t,e))}function ks(t,e,n){return t.set(Ps(t,e),n),n}function Ps(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}Object(l["mixin"])(Ns,vs["a"]);var Ds=new WeakMap,Ls=new WeakMap,Fs=new WeakMap,Vs=new WeakMap,Ws=new WeakMap,Bs=new WeakMap,Us=new WeakMap;class zs{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(t,e){var n=this;Hs(this,Ds,void 0),Hs(this,Ls,!1),Hs(this,Fs,null),Hs(this,Vs,void 0),Hs(this,Ws,void 0),Hs(this,Bs,!0),Hs(this,Us,new Ns),ks(Ds,this,t),ks(Ls,this,e),ks(Vs,this,this.createEditor()),ks(Ws,this,_s(Vs,this).style),_s(Us,this).setObservedElement(this.getInputElement()),_s(Us,this).addLocalHook("resize",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runLocalHooks("resize",...e)})),this.hide()}setPosition(t,e){_s(Ws,this).left=t+"px",_s(Ws,this).top=e+"px"}setSize(t,e){if(t&&e){const n=this.getInputElement();n.style.width=t+"px",n.style.height=e+"px"}}getSize(){return{width:Object(s["outerWidth"])(this.getInputElement()),height:Object(s["outerHeight"])(this.getInputElement())}}observeSize(){_s(Us,this).observe()}resetSize(){const t=this.getInputElement();t.style.width="",t.style.height=""}setReadOnlyState(t){const e=this.getInputElement();e.readOnly=t}show(){_s(Ws,this).display="block",ks(Bs,this,!1)}hide(){_s(Us,this).unobserve(),_s(Bs,this)||(_s(Ws,this).display="none"),ks(Bs,this,!0)}isVisible(){return"block"===_s(Ws,this).display}setValue(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const e=t||"";this.getInputElement().value=e}getValue(){return this.getInputElement().value}isFocused(){return _s(Ds,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const t=_s(Ds,this).createElement("div"),e=_s(Ds,this).createElement("textarea");return t.style.display="none",ks(Fs,this,_s(Ds,this).createElement("div")),_s(Fs,this).setAttribute("dir",_s(Ls,this)?"rtl":"ltr"),Object(s["addClass"])(_s(Fs,this),zs.CLASS_EDITOR_CONTAINER),_s(Ds,this).body.appendChild(_s(Fs,this)),Object(s["addClass"])(t,zs.CLASS_EDITOR),Object(s["addClass"])(e,zs.CLASS_INPUT),e.setAttribute("data-hot-input",!0),t.appendChild(e),_s(Fs,this).appendChild(t),t}getInputElement(){return _s(Vs,this).querySelector("."+zs.CLASS_INPUT)}destroy(){const t=_s(Fs,this)?_s(Fs,this).parentNode:null;_s(Vs,this).parentNode.removeChild(_s(Vs,this)),ks(Vs,this,null),ks(Ws,this,null),_s(Us,this).destroy(),t&&t.removeChild(_s(Fs,this))}}Object(l["mixin"])(zs,vs["a"]);var Gs=zs;function Ys(t,e,n){return(e=Xs(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xs(t){var e=$s(t,"string");return"symbol"==typeof e?e:e+""}function $s(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}const Ks=250,qs=250;class Qs{constructor(t){Ys(this,"wasLastActionShow",!0),Ys(this,"showDebounced",null),Ys(this,"hidingTimer",null),this.updateDelay(t)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{!1===this.wasLastActionShow&&this.runLocalHooks("hide")},qs)}show(t){this.wasLastActionShow=!0,this.showDebounced(t)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ks;this.showDebounced=Object(Li["debounce"])(t=>{this.wasLastActionShow&&this.runLocalHooks("show",t.from.row,t.from.col)},t)}destroy(){this.clearLocalHooks()}}Object(l["mixin"])(Qs,vs["a"]);var Js=Qs;const Zs="---------";function ta(){return{name:Zs}}function ea(t){return{key:"commentsAddEdit",name(){var e;const n=null===(e=this.getSelectedRangeLast())||void 0===e?void 0:e.highlight;return null!==n&&void 0!==n&&n.isCell()&&t.getCommentAtCell(n.row,n.col)?this.getTranslatedPhrase(Ft["CONTEXTMENU_ITEMS_EDIT_COMMENT"]):this.getTranslatedPhrase(Ft["CONTEXTMENU_ITEMS_ADD_COMMENT"])},callback(){const e=this.getSelectedRangeLast();t.setRange(e),t.show(),t.focusEditor()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||0===this.countRenderedRows()||0===this.countRenderedCols())}}}function na(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(Ft["CONTEXTMENU_ITEMS_REMOVE_COMMENT"])},callback(){const e=this.getSelectedRangeLast();e.forAll((e,n)=>{e>=0&&n>=0&&t.removeCommentAtCell(e,n,!1)}),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||0===this.countRenderedRows()||0===this.countRenderedCols())}}}function oa(t,e){if(-1!==t.indexOf(e))return t;const n=t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","");return`${n} ${e}`}function ia(t,e){if(-1!==t.indexOf(e))return t;const n=t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","");return`${n} ${e}`}function ra(t,e){const n={};return Object(f["arrayEach"])(t,t=>{t.forAll((t,o)=>{t>=0&&o>=0&&(n[t]||(n[t]=[]),n[t][o]=e(t,o))})}),n}function sa(t,e,n,o,i){Object(f["arrayEach"])(t,t=>{t.forAll((t,r)=>{t>=0&&r>=0&&aa(t,r,e,n,o,i)})})}function aa(t,e,n,o,i,r){const s=i(t,e);let a=o;s.className&&(a="vertical"===n?oa(s.className,o):ia(s.className,o)),r(t,e,"className",a)}function la(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}function ca(t,e){let n=!1;return Array.isArray(t)&&Object(f["arrayEach"])(t,t=>(t.forAll((t,o)=>{if(t>=0&&o>=0&&e(t,o))return n=!0,!1}),n)),n}function ha(t,e){const n={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:t}=e.defaultView,{top:o,left:i}=t.getBoundingClientRect();n.top=o,n.left=i}return n}function ua(t){return function(e,n){const o=this.getCellMeta(e,n).className;return o&&-1!==o.indexOf(t)}}function da(t,e){return ca(t.getSelectedRange(),ua(e).bind(t))}function fa(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(Ft["CONTEXTMENU_ITEMS_READ_ONLY_COMMENT"]),n=ca(this.getSelectedRange(),(e,n)=>t.getCommentMeta(e,n,Ia));return n?la(e):e},callback(){const e=this.getSelectedRangeLast();e.forAll((e,n)=>{if(e>=0&&n>=0){const o=!!t.getCommentMeta(e,n,Ia);t.updateCommentMeta(e,n,{[Ia]:!o})}})},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||0===this.countRenderedRows()||0===this.countRenderedCols())}}}function ga(t,e){ma(t,e),e.add(t)}function pa(t,e,n){ma(t,e),e.set(t,n)}function ma(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ba(t,e,n){return(e=wa(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wa(t){var e=va(t,"string");return"symbol"==typeof e?e:e+""}function va(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function ya(t,e,n){return t.set(Sa(t,e),n),n}function Ca(t,e){return t.get(Sa(t,e))}function Sa(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Oa="comments",Ea=60,Ra="comment",Ta="value",Ma="style",Ia="readOnly",xa=Oa,Na="plugin:"+Oa;var Aa=new WeakMap,Ha=new WeakMap,ja=new WeakMap,_a=new WeakMap,ka=new WeakMap,Pa=new WeakMap,Da=new WeakSet;class La extends bn{constructor(){super(...arguments),ga(this,Da),ba(this,"range",{}),pa(this,Aa,null),pa(this,Ha,null),pa(this,ja,!1),pa(this,_a,!1),pa(this,ka,null),pa(this,Pa,"")}static get PLUGIN_KEY(){return Oa}static get PLUGIN_PRIORITY(){return Ea}isEnabled(){return!!this.hot.getSettings()[Oa]}enablePlugin(){var t=this;this.enabled||(Ca(Aa,this)||(ya(Aa,this,new Gs(this.hot.rootDocument,this.hot.isRtl())),Ca(Aa,this).addLocalHook("resize",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return Sa(Da,t,Ga).call(t,...n)}))),Ca(Ha,this)||ya(Ha,this,new Js(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",t=>this.addToContextMenu(t)),this.addHook("afterRenderer",(t,e,n,o,i,r)=>Sa(Da,this,Ba).call(this,t,r)),this.addHook("afterScroll",()=>Sa(Da,this,Xa).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",t=>Sa(Da,this,Ya).call(this,t)),Ca(Ha,this).addLocalHook("hide",()=>this.hide()),Ca(Ha,this).addLocalHook("show",(t,e)=>this.showAtCell(t,e)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){Ca(Ha,this).updateDelay(this.getDisplayDelaySetting()),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const t=this.hot.getShortcutManager(),e=t.getContext("grid"),n=t.addContext(Na);e.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const e=this.hot.getSelectedRangeLast();ya(_a,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(e),this.show(),this.focusEditor(),t.setActiveContextName(Na),this.hot._registerTimeout(()=>{ya(_a,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var t;return(null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight.isCell())&&!Ca(Aa,this).isVisible()},group:xa}),n.addShortcut({keys:[["Escape"]],callback:()=>{Ca(Aa,this).setValue(Ca(Pa,this)),this.hide(),t.setActiveContextName("grid")},runOnlyIf:()=>Ca(Aa,this).isVisible()&&Ca(Aa,this).isFocused(),group:xa}),n.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),t.setActiveContextName("grid")},runOnlyIf:()=>Ca(Aa,this).isVisible()&&Ca(Aa,this).isFocused(),group:xa})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(xa)}registerListeners(){const{rootDocument:t}=this.hot,e=this.getEditorInputElement();this.eventManager.addEventListener(t,"mouseover",t=>Sa(Da,this,Va).call(this,t)),this.eventManager.addEventListener(t,"mousedown",t=>Sa(Da,this,Fa).call(this,t)),this.eventManager.addEventListener(t,"mouseup",()=>Sa(Da,this,Wa).call(this)),this.eventManager.addEventListener(e,"focus",()=>Sa(Da,this,za).call(this)),this.eventManager.addEventListener(e,"blur",()=>Sa(Da,this,Ua).call(this))}setRange(t){this.range=t}clearRange(){this.range={}}targetIsCellWithComment(t){const e=Object(s["closest"])(t.target,"TD","TBODY");return!!(e&&Object(s["hasClass"])(e,"htCommentCell")&&Object(s["closest"])(e,[this.hot.rootElement]))}targetIsCommentTextArea(t){return this.getEditorInputElement()===t.target}setComment(t){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const e=Ca(Aa,this).getValue();let n="";null!==t&&void 0!==t?n=t:null!==e&&void 0!==e&&(n=e);const o=this.range.from.row,i=this.range.from.col;this.updateCommentMeta(o,i,{[Ta]:n}),this.hot.render()}setCommentAtCell(t,e,n){this.setRange({from:this.hot._createCellCoords(t,e)}),this.setComment(n)}removeComment(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,Ra),t&&this.hot.render(),this.hide()}removeCommentAtCell(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.setRange({from:this.hot._createCellCoords(t,e)}),this.removeComment(n)}getComment(){const t=this.range.from.row,e=this.range.from.col;return this.getCommentMeta(t,e,Ta)}getCommentAtCell(t,e){return this.getCommentMeta(t,e,Ta)}show(){var t;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:e,col:n}}=this.range;if(e<0||e>this.hot.countSourceRows()-1||n<0||n>this.hot.countSourceCols()-1)return!1;const o=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return Ca(Ha,this).cancelHiding(),Ca(Aa,this).setValue(null!==(t=o[Ra]?o[Ra][Ta]:null)&&void 0!==t?t:""),Ca(Aa,this).show(),this.refreshEditor(!0),!0}showAtCell(t,e){return this.setRange({from:this.hot._createCellCoords(t,e)}),this.show()}hide(){Ca(Aa,this).hide()}refreshEditor(){var t,e;let n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!n&&(!this.range.from||!Ca(Aa,this).isVisible()))return;const{rowIndexMapper:o,columnIndexMapper:i}=this.hot,{row:r,col:a}=this.range.from;let l=o.getRenderableFromVisualIndex(r),c=i.getRenderableFromVisualIndex(a);const h=null===l;Ca(Aa,this).setPosition(0,0),null===l&&(l=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(r,-1))),null===c&&(c=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(a,-1)));const u=null===l,d=null===c;l=null!==(t=l)&&void 0!==t?t:0,c=null!==(e=c)&&void 0!==e?e:0;const{rootWindow:f,view:{_wt:g}}=this.hot,{wtTable:p}=g,m=g.getCell({row:l,col:c},!0),b=this.getCommentMeta(r,a,Ma);b?Ca(Aa,this).setSize(b.width,b.height):Ca(Aa,this).resetSize();const w=d?0:p.getStretchedColumnWidth(c),v=h&&!u?Object(s["outerHeight"])(m):0,{left:y,top:C,width:S,height:O}=m.getBoundingClientRect(),{width:E,height:R}=Ca(Aa,this).getSize(),{innerWidth:T,innerHeight:M}=this.hot.rootWindow,I=this.hot.rootDocument.documentElement;let x=y+f.scrollX+w,N=C+f.scrollY+v;this.hot.isRtl()&&(x-=E+w),this.hot.isLtr()&&y+S+E>T?x=y+f.scrollX-E-1:this.hot.isRtl()&&x<-(I.scrollWidth-I.clientWidth)&&(x=y+f.scrollX+w+1),C+R>M&&(N-=R-O+1),Ca(Aa,this).setPosition(x,N),Ca(Aa,this).setReadOnlyState(this.getCommentMeta(r,a,Ia)),Ca(Aa,this).observeSize()}focusEditor(){Ca(Aa,this).focus()}updateCommentMeta(t,e,n){const o=this.hot.getCellMeta(t,e)[Ra];let i;o?(i=Object(l["deepClone"])(o),Object(l["deepExtend"])(i,n)):i=n,this.hot.setCellMeta(t,e,Ra,i)}getCommentMeta(t,e,n){const o=this.hot.getCellMeta(t,e);if(o[Ra])return o[Ra][n]}addToContextMenu(t){t.items.push({name:Zs},ea(this),na(this),fa(this))}getDisplayDelaySetting(){const t=this.hot.getSettings()[Oa];if(Object(l["isObject"])(t))return t.displayDelay}getEditorInputElement(){return Ca(Aa,this).getInputElement()}destroy(){var t,e;null===(t=Ca(Aa,this))||void 0===t||t.destroy(),null===(e=Ca(Ha,this))||void 0===e||e.destroy(),super.destroy()}}function Fa(t){if(this.hot.view&&this.hot.view._wt&&!Ca(ja,this)&&!this.targetIsCommentTextArea(t)){const e=Object(s["closest"])(t.target,"TD","TBODY");let n=null;e&&(n=this.hot.getCoords(e)),(!e||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}function Va(t){const{rootDocument:e}=this.hot;if(!(Ca(ja,this)||Ca(Aa,this).isFocused()||Object(s["hasClass"])(t.target,"wtBorder")||Ca(ka,this)===t.target)&&Ca(Aa,this))if(ya(ka,this,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const e=this.hot._createCellRange(this.hot.getCoords(t.target));Ca(Ha,this).show(e)}else Object(s["isChildOf"])(t.target,e)&&!this.targetIsCommentTextArea(t)&&Ca(Ha,this).hide()}function Wa(){ya(ja,this,!1)}function Ba(t,e){e[Ra]&&e[Ra][Ta]&&Object(s["addClass"])(t,e.commentedCellClassName)}function Ua(){ya(Pa,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function za(){ya(Pa,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(Na)}function Ga(t,e){this.updateCommentMeta(this.range.from.row,this.range.from.col,{[Ma]:{width:t,height:e}})}function Ya(t){Ca(Aa,this).isVisible()&&Object(a["stopImmediatePropagation"])(t)}function Xa(){Ca(_a,this)||this.hide()}n("956b");function $a(t,e,n){return(e=Ka(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ka(t){var e=qa(t,"string");return"symbol"==typeof e?e:e+""}function qa(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Qa{constructor(t){$a(this,"hot",void 0),$a(this,"commands",{}),$a(this,"commonCallback",null),this.hot=t}registerCommand(t,e){this.commands[t]=e}setCommonCallback(t){this.commonCallback=t}execute(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];const i=t.split(":"),r=i[0],s=2===i.length?i[1]:null;let a=this.commands[r];if(!a)throw new Error(`Menu command '${r}' not exists.`);if(s&&a.submenu&&(a=Ja(s,a.submenu.items)),!0===a.disabled)return;if("function"===typeof a.disabled&&!0===a.disabled.call(this.hot))return;if(Object(l["hasOwnProperty"])(a,"submenu"))return;const c=[];"function"===typeof a.callback&&c.push(a.callback),"function"===typeof this.commonCallback&&c.push(this.commonCallback),n.unshift(i.join(":")),Object(f["arrayEach"])(c,t=>t.apply(this.hot,n))}}function Ja(t,e){let n;return Object(f["arrayEach"])(e,e=>{const o=e.key?e.key.split(":"):null;if(Array.isArray(o)&&o[1]===t)return n=e,!1}),n}const Za="alignment";function tl(){return{key:Za,name(){return this.getTranslatedPhrase(Ft["CONTEXTMENU_ITEMS_ALIGNMENT"])},disabled(){if(0===this.countRows()||0===this.countCols())return!0;const t=this.getSelectedRangeLast();return!t||(!!t.isSingleHeader()||!(this.getSelectedRange()&&!this.selection.isSelectedByCorner()))},submenu:{items:[{key:Za+":left",checkable:!0,ariaLabel(){return this.getTranslatedPhrase(Ft["CONTEXTMENU_ITEMS_ALIGNMENT_LEFT"])},ariaChecked(){return da(this,"htLeft")},name(){let t=this.getTranslatedPhrase(Ft["CONTEXTMENU_ITEMS_ALIGNMENT_LEFT"]);return da(this,"htLeft")&&(t=la(t)),t},callback(){const t=this.getSelectedRange(),e=ra(t,(t,e)=>this.getCellMeta(t,e).className),n="horizontal",o="htLeft";this.runHooks("beforeCellAlignment",e,t,n,o),sa(t,n,o,(t,e)=>this.getCellMeta(t,e),(t,e,n,o)=>this.setCellMeta(t,e,n,o)),this.render()},disabled:!1},{key:Za+":center",checkable:!0,ariaLabel(){return this.getTranslatedPhrase(Ft["CONTEXTMENU_ITEMS_ALIGNMENT_CENTER"])},ariaChecked(){return da(this,"htCenter")},name(){let t=this.getTranslatedPhrase(Ft["CONTEXTMENU_ITEMS_ALIGNMENT_CENTER"]);return da(this,"htCenter")&&(t=la(t)),t},callback(){const t=this.getSelectedRange(),e=ra(t,(t,e)=>this.getCellMeta(t,e).className),n="horizontal",o="htCenter";this.runHooks("beforeCellAlignment",e,t,n,o),sa(t,n,o,(t,e)=>this.getCellMeta(t,e),(t,e,n,o)=>this.setCellMeta(t,e,n,o)),this.render()},disabled:!1},{key:Za+":right",checkable:!0,ariaLabel(){return this.getTranslatedPhrase(Ft["CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT"])},ariaChecked(){return da(this,"htRight")},name(){let t=this.getTranslatedPhrase(Ft["CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT"]);return da(this,"htRight")&&(t=la(t)),t},callback(){const t=this.getSelectedRange(),e=ra(t,(t,e)=>this.getCellMeta(t,e).className),n="horizontal",o="htRight";this.runHooks("beforeCellAlignment",e,t,n,o),sa(t,n,o,(t,e)=>this.getCellMeta(t,e),(t,e,n,o)=>this.setCellMeta(t,e,n,o)),this.render()},disabled:!1},{key:Za+":justify",checkable:!0,ariaLabel(){return this.getTranslatedPhrase(Ft["CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY"])},ariaChecked(){return da(this,"htJustify")},name(){let t=this.getTranslatedPhrase(Ft["CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY"]);return da(this,"htJustify")&&(t=la(t)),t},callback(){const t=this.getSelectedRange(),e=ra(t,(t,e)=>this.getCellMeta(t,e).className),n="horizontal",o="htJustify";this.runHooks("beforeCellAlignment",e,t,n,o),sa(t,n,o,(t,e)=>this.getCellMeta(t,e),(t,e,n,o)=>this.setCellMeta(t,e,n,o)),this.render()},disabled:!1},{name:Zs},{key:Za+":top",checkable:!0,ariaLabel(){return this.getTranslatedPhrase(Ft["CONTEXTMENU_ITEMS_ALIGNMENT_TOP"])},ariaChecked(){return da(this,"htTop")},name(){let t=this.getTranslatedPhrase(Ft["CONTEXTMENU_ITEMS_ALIGNMENT_TOP"]);return da(this,"htTop")&&(t=la(t)),t},callback(){const t=this.getSelectedRange(),e=ra(t,(t,e)=>this.getCellMeta(t,e).className),n="vertical",o="htTop";this.runHooks("beforeCellAlignment",e,t,n,o),sa(t,n,o,(t,e)=>this.getCellMeta(t,e),(t,e,n,o)=>this.setCellMeta(t,e,n,o)),this.render()},disabled:!1},{key:Za+":middle",checkable:!0,ariaLabel(){return this.getTranslatedPhrase(Ft["CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE"])},ariaChecked(){return da(this,"htMiddle")},name(){let t=this.getTranslatedPhrase(Ft["CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE"]);return da(this,"htMiddle")&&(t=la(t)),t},callback(){const t=this.getSelectedRange(),e=ra(t,(t,e)=>this.getCellMeta(t,e).className),n="vertical",o="htMiddle";this.runHooks("beforeCellAlignment",e,t,n,o),sa(t,n,o,(t,e)=>this.getCellMeta(t,e),(t,e,n,o)=>this.setCellMeta(t,e,n,o)),this.render()},disabled:!1},{key:Za+":bottom",checkable:!0,ariaLabel(){return this.getTranslatedPhrase(Ft["CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM"])},ariaChecked(){return da(this,"htBottom")},name(){let t=this.getTranslatedPhrase(Ft["CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM"]);return da(this,"htBottom")&&(t=la(t)),t},callback(){const t=this.getSelectedRange(),e=ra(t,(t,e)=>this.getCellMeta(t,e).className),n="vertical",o="htBottom";this.runHooks("beforeCellAlignment",e,t,n,o),sa(t,n,o,(t,e)=>this.getCellMeta(t,e),(t,e,n,o)=>this.setCellMeta(t,e,n,o)),this.render()},disabled:!1}]}}}const el="clear_column";function nl(){return{key:el,name(){return this.getTranslatedPhrase(Ft["CONTEXTMENU_ITEMS_CLEAR_COLUMN"])},callback(t,e){const n=e[0].start.col,o=e[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e[0].start.row,e[0].end.row),o,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();return!t||(!!(t.isSingleHeader()&&t.highlight.col<0)||!this.selection.isSelectedByColumnHeader())}}}const ol="col_left";function il(){return{key:ol,name(){return this.getTranslatedPhrase(Ft["CONTEXTMENU_ITEMS_INSERT_LEFT"])},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t)return!0;if(t.isSingleHeader()&&t.highlight.col<0)return!0;if(this.selection.isSelectedByCorner()){const t=this.countCols();return 0===t}return this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const rl="col_right";function sl(){return{key:rl,name(){return this.getTranslatedPhrase(Ft["CONTEXTMENU_ITEMS_INSERT_RIGHT"])},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||(!!(t.isSingleHeader()&&t.highlight.col<0)||!this.selection.isSelectedByCorner()&&(this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols))},hidden(){return!this.getSettings().allowInsertColumn}}}const al="make_read_only";function ll(){return{key:al,checkable:!0,ariaChecked(){const t=ca(this.getSelectedRange(),(t,e)=>this.getCellMeta(t,e).readOnly);return t},ariaLabel(){return this.getTranslatedPhrase(Ft["CONTEXTMENU_ITEMS_READ_ONLY"])},name(){let t=this.getTranslatedPhrase(Ft["CONTEXTMENU_ITEMS_READ_ONLY"]);const e=ca(this.getSelectedRange(),(t,e)=>this.getCellMeta(t,e).readOnly);return e&&(t=la(t)),t},callback(){const t=this.getSelectedRange(),e=ca(t,(t,e)=>this.getCellMeta(t,e).readOnly);Object(f["arrayEach"])(t,t=>{t.forAll((t,n)=>{t>=0&&n>=0&&this.setCellMeta(t,n,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeLast();return!t||(!!t.isSingleHeader()||(!!this.selection.isSelectedByCorner()||(0===this.countRows()||0===this.countCols()||(!this.getSelectedRange()||0===this.getSelectedRange().length))))}}}const cl="redo";function hl(){return{key:cl,name(){return this.getTranslatedPhrase(Ft["CONTEXTMENU_ITEMS_REDO"])},callback(){this.redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}var ul=n("a952");const dl="remove_col";function fl(){return{key:dl,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,n,,o]=t[0];n-o!==0&&(e=1)}return this.getTranslatedPhrase(Ft["CONTEXTMENU_ITEMS_REMOVE_COLUMN"],e)},callback(){this.alter("remove_col",Object(ul["e"])(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t)return!0;if(t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?0===e:this.selection.isSelectedByRowHeader()||0===e},hidden(){return!this.getSettings().allowRemoveColumn}}}const gl="remove_row";function pl(){return{key:gl,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[n,,o]=t[0];n-o!==0&&(e=1)}return this.getTranslatedPhrase(Ft["CONTEXTMENU_ITEMS_REMOVE_ROW"],e)},callback(){this.alter("remove_row",Object(ul["f"])(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t)return!0;if(t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?0===e:this.selection.isSelectedByColumnHeader()||0===e},hidden(){return!this.getSettings().allowRemoveRow}}}const ml="row_above";function bl(){return{key:ml,name(){return this.getTranslatedPhrase(Ft["CONTEXTMENU_ITEMS_ROW_ABOVE"])},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();if(!t)return!0;if(t.isSingleHeader()&&t.highlight.row<0)return!0;if(this.selection.isSelectedByCorner()){const t=this.countRows();return 0===t}return this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const wl="row_below";function vl(){return{key:wl,name(){return this.getTranslatedPhrase(Ft["CONTEXTMENU_ITEMS_ROW_BELOW"])},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!t||(!!(t.isSingleHeader()&&t.highlight.row<0)||!this.selection.isSelectedByCorner()&&(this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows))},hidden(){return!this.getSettings().allowInsertRow}}}const yl="no_items";function Cl(){return{key:yl,name(){return this.getTranslatedPhrase(Ft["CONTEXTMENU_ITEMS_NO_ITEMS"])},disabled:!0,isCommand:!1}}const Sl="undo";function Ol(){return{key:Sl,name(){return this.getTranslatedPhrase(Ft["CONTEXTMENU_ITEMS_UNDO"])},callback(){this.undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const El=[ml,wl,ol,rl,el,gl,dl,Sl,cl,al,Za,Zs,yl],Rl={[Zs]:ta,[yl]:Cl,[ml]:bl,[wl]:vl,[ol]:il,[rl]:sl,[el]:nl,[gl]:pl,[dl]:fl,[Sl]:Ol,[cl]:hl,[al]:ll,[Za]:tl};function Tl(){const t={};return Object(l["objectEach"])(Rl,(e,n)=>{t[n]=e()}),t}function Ml(t,e,n){return(e=Il(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Il(t){var e=xl(t,"string");return"symbol"==typeof e?e:e+""}function xl(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Nl{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;Ml(this,"hot",void 0),Ml(this,"predefinedItems",Tl()),Ml(this,"defaultOrderPattern",void 0),this.hot=t,this.defaultOrderPattern=e}setPredefinedItems(t){const e={};this.defaultOrderPattern.length=0,Object(l["objectEach"])(t,(t,n)=>{let o="";t.name===Zs?(e[Zs]=t,o=Zs):isNaN(parseInt(n,10))?(t.key=void 0===t.key?n:t.key,e[n]=t,o=t.key):(e[t.key]=t,o=t.key),this.defaultOrderPattern.push(o)}),this.predefinedItems=e}getItems(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return Al(t,this.defaultOrderPattern,this.predefinedItems)}}function Al(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=[];let i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),Object(l["isObject"])(i)?Object(l["objectEach"])(i,(t,e)=>{let i=n["string"===typeof t?t:e];i||(i=t),Object(l["isObject"])(t)?Object(l["extend"])(i,t):"string"===typeof i&&(i={name:i}),void 0===i.key&&(i.key=e),o.push(i)}):Object(f["arrayEach"])(i,(t,e)=>{let i=n[t];!i&&El.indexOf(t)>=0||(i||(i={name:t,key:""+e}),Object(l["isObject"])(t)&&Object(l["extend"])(i,t),void 0===i.key&&(i.key=e),o.push(i))}),o}function Hl(t,e,n){return(e=jl(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jl(t){var e=_l(t,"string");return"symbol"==typeof e?e:e+""}function _l(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class kl{constructor(t,e){Hl(this,"top",void 0),Hl(this,"topRelative",void 0),Hl(this,"left",void 0),Hl(this,"leftRelative",void 0),Hl(this,"scrollTop",void 0),Hl(this,"scrollLeft",void 0),Hl(this,"cellHeight",void 0),Hl(this,"cellWidth",void 0);const n=e.scrollY,o=e.scrollX;let i,r,s,a,l,c;this.rootWindow=e,this.type=this.getSourceType(t),"literal"===this.type?(i=parseInt(t.top,10),s=parseInt(t.left,10),l=t.height||0,c=t.width||0,r=i,a=s,i+=n,s+=o):"event"===this.type&&(i=parseInt(t.pageY,10),s=parseInt(t.pageX,10),l=t.target.clientHeight,c=t.target.clientWidth,r=i-n,a=s-o),this.top=i,this.topRelative=r,this.left=s,this.leftRelative=a,this.scrollTop=n,this.scrollLeft=o,this.cellHeight=l,this.cellWidth=c}getSourceType(t){let e="literal";return t instanceof Event&&(e="event"),e}fitsAbove(t){return this.topRelative>=t.offsetHeight}fitsBelow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+t.offsetHeight<=e}fitsOnRight(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+t.offsetWidth<=e}fitsOnLeft(t){return this.leftRelative>=t.offsetWidth}}function Pl(t,e,n){Dl(t,e),e.set(t,n)}function Dl(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ll(t,e){return t.get(Vl(t,e))}function Fl(t,e,n){return t.set(Vl(t,e),n),n}function Vl(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Wl=new WeakMap,Bl=new WeakMap,Ul=new WeakMap,zl=new WeakMap,Gl=new WeakMap;class Yl{constructor(t){Pl(this,Wl,void 0),Pl(this,Bl,void 0),Pl(this,Ul,void 0),Pl(this,zl,!1),Pl(this,Gl,{above:0,below:0,left:0,right:0}),Fl(zl,this,t)}setOffset(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Ll(Gl,this)[t]=e,this}setElement(t){return Fl(Wl,this,t),this}setParentElement(t){return Fl(Bl,this,t),this}updatePosition(t){Fl(Ul,this,new kl(t,Ll(Wl,this).ownerDocument.defaultView)),Ll(zl,this)?(Ll(Ul,this).fitsBelow(Ll(Wl,this))?this.setPositionBelowCursor():Ll(Ul,this).fitsAbove(Ll(Wl,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){"rtl"===Ll(Wl,this).dir?Ll(Ul,this).fitsOnLeft(Ll(Wl,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():Ll(Ul,this).fitsOnRight(Ll(Wl,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let t=Ll(Gl,this).above+Ll(Ul,this).top-Ll(Wl,this).offsetHeight;Ll(Bl,this)&&(t=Ll(Ul,this).top+Ll(Ul,this).cellHeight-Ll(Wl,this).offsetHeight+3),Ll(Wl,this).style.top=t+"px"}setPositionBelowCursor(){let t=Ll(Gl,this).below+Ll(Ul,this).top+1;Ll(Bl,this)&&(t=Ll(Ul,this).top-1),Ll(Wl,this).style.top=t+"px"}setPositionOnRightOfCursor(){let t=Ll(Ul,this).left;if(Ll(Bl,this)){const e=Number.parseInt(getComputedStyle(Ll(Bl,this).querySelector(".htCore")).borderRightWidth,10);t+=Ll(Ul,this).cellWidth+e}else t+=Ll(Gl,this).right;Ll(Wl,this).style.left=t+"px"}setPositionOnLeftOfCursor(){let t=Ll(Gl,this).left+Ll(Ul,this).left-Ll(Wl,this).offsetWidth;if(Ll(Bl,this)){const e=Number.parseInt(getComputedStyle(Ll(Bl,this).querySelector(".htCore")).borderLeftWidth,10);t-=e}Ll(Wl,this).style.left=t+"px"}}function Xl(t){let{initialPage:e=-1,size:n=(()=>0),onItemSelect:o=(()=>{}),onClear:i=(()=>{})}=t;const r=new Set;let s=Object(ie["clamp"])(e,-1,g()-1);function a(t,e){const n=g()-1;if(t<0&&(t=n),t>n&&(t=0),r.has(t))return-1;r.add(t);const i=o(t,!1);return!1===i&&(t=a(1===e?++t:--t,e)),t}function l(t){t>-1&&t<g()&&!1!==o(t,!0)&&(s=t)}function c(){return s}function h(){g()>0&&(r.clear(),s=a(0,1))}function u(){g()>0&&(r.clear(),s=a(g()-1,-1))}function d(){g()>0&&(r.clear(),s=a(++s,1))}function f(){g()>0&&(r.clear(),s=a(--s,-1))}function g(){return Math.max(n(),0)}function p(){r.clear(),s=e,i()}return{setCurrentPage:l,getCurrentPage:c,toFirstItem:h,toLastItem:u,toNextItem:d,toPreviousItem:f,getSize:g,clear:p}}function $l(t){return Object(f["arrayMap"])(t,t=>({start:t.getTopStartCorner(),end:t.getBottomEndCorner()}))}function Kl(t){return Object(l["hasOwnProperty"])(t,"submenu")}function ql(t){return new RegExp(Zs,"i").test(t.name)}function Ql(t,e){return!0===t.disabled||"function"===typeof t.disabled&&!0===t.disabled.call(e)}function Jl(t){return Object(l["hasOwnProperty"])(t,"disableSelection")}function Zl(t){return Object(s["hasClass"])(t,"htSeparator")}function tc(t){return Object(s["hasClass"])(t,"htSubmenu")}function ec(t){return Object(s["hasClass"])(t,"htDisabled")}function nc(t){return Object(s["hasClass"])(t,"htSelectionDisabled")}function oc(t,e){return!t.hidden||!("function"===typeof t.hidden&&t.hidden.call(e))}function ic(t,e){const n=t.slice(0);for(let o=0;o<n.length;){if(n[o].name!==e)break;n.shift()}return n}function rc(t,e){let n=t.slice(0);return n.reverse(),n=ic(n,e),n.reverse(),n}function sc(t){const e=[];return Object(f["arrayEach"])(t,(t,n)=>{n>0?e[e.length-1].name!==t.name&&e.push(t):e.push(t)}),e}function ac(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Zs,n=t.slice(0);return n=ic(n,e),n=rc(n,e),n=sc(n),n}function lc(t){return!0===t.checkable}function cc(t){return Xl({size:()=>t.countRows(),onItemSelect(e,n){const o=t.getCell(e,0);if(!o||Zl(o)||ec(o)||nc(o))return!1;t.selectCell(e,0,...n?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function hc(t){const{hot:e,hotMenu:n}=t;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(n,o)=>{const i=e.getSettings(),r="function"===typeof i.tabMoves?i.tabMoves(n):i.tabMoves;o.includes("shift")?e.selection.transformStart(-r.row,-r.col):e.selection.transformStart(r.row,r.col),t.close(!0)}},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[["ArrowRight"]],callback:()=>{const e=n.getSelectedLast();if(e){const n=t.openSubMenu(e[0]);n&&n.getNavigator().toFirstItem()}}},{keys:[["ArrowLeft"]],callback:()=>{const e=n.getSelectedLast();e&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:e=>{const o=n.getSelectedLast();o&&(n.getSourceDataAtRow(o[0]).submenu?t.openSubMenu(o[0]).getNavigator().toFirstItem():(t.executeCommand(e),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{const e=n.getSelectedLast();e?n.selection.transformStart(-n.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{const e=n.getSelectedLast();e?n.selection.transformStart(n.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const uc="menu",dc=uc;function fc(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const n=[];function o(t,e){a(e).addShortcuts(t,{group:uc})}function i(t,e){const i=a(e);t.forEach(t=>{let{keys:e}=t;e.forEach(t=>i.removeShortcutsByKeys(t))}),n.push({shortcuts:t,contextName:e}),o(t,e)}function r(){return[...n]}function s(t){return t?`${dc}:${t}`:dc}function a(e){var n;const o=t.hotMenu.getShortcutManager(),i=s(e);return null!==(n=o.getContext(i))&&void 0!==n?n:o.addContext(i)}function l(e){t.hotMenu.getShortcutManager().setActiveContextName(s(e))}return o(hc(t)),e.forEach(t=>{let{shortcuts:e,contextName:n}=t;i(e,n)}),{addCustomShortcuts:i,getCustomShortcuts:r,getContext:a,listen:l}}function gc(t){return(e,n,o,i,r,a)=>{const l=e.getSourceDataAtRow(o),c=t.rootDocument.createElement("div"),h="function"===typeof a?a.call(t):a,u="function"===typeof l.ariaLabel?l.ariaLabel.call(t):l.ariaLabel,d="function"===typeof l.ariaChecked?l.ariaChecked.call(t):l.ariaChecked;if(Object(s["empty"])(n),Object(s["addClass"])(c,"htItemWrapper"),t.getSettings().ariaTags){const e=!Ql(l,t)&&!Jl(l)&&!ql(l);Object(s["setAttribute"])(n,[...lc(l)?[Object(v["u"])(),Object(v["p"])(u),Object(v["d"])(d)]:[Object(v["t"])(),Object(v["p"])(h)],...e?[Object(v["L"])(-1)]:[],...Ql(l,t)?[Object(v["j"])()]:[],...Kl(l)?[Object(v["k"])(!1)]:[]])}n.className="",n.appendChild(c),ql(l)?Object(s["addClass"])(n,"htSeparator"):"function"===typeof l.renderer?(Object(s["addClass"])(n,"htCustomMenuRenderer"),n.appendChild(l.renderer(e,c,o,i,r,h))):Object(s["fastInnerHTML"])(c,h),Ql(l,t)?Object(s["addClass"])(n,"htDisabled"):Jl(l)?Object(s["addClass"])(n,"htSelectionDisabled"):Kl(l)&&Object(s["addClass"])(n,"htSubmenu")}}function pc(t,e,n){mc(t,e),e.set(t,n)}function mc(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bc(t,e,n){return(e=wc(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wc(t){var e=vc(t,"string");return"symbol"==typeof e?e:e+""}function vc(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function yc(t,e,n){return t.set(Sc(t,e),n),n}function Cc(t,e){return t.get(Sc(t,e))}function Sc(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Oc=215;var Ec=new WeakMap,Rc=new WeakMap,Tc=new WeakMap;class Mc{get tableBorderWidth(){return void 0===Cc(Tc,this)&&this.hotMenu&&yc(Tc,this,parseInt(Object(s["getComputedStyle"])(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),Cc(Tc,this)}constructor(t,e){var n=this;bc(this,"hot",void 0),bc(this,"options",void 0),bc(this,"eventManager",new _t["a"](this)),bc(this,"container",void 0),bc(this,"positioner",void 0),bc(this,"hotMenu",null),bc(this,"hotSubMenus",{}),bc(this,"parentMenu",void 0),bc(this,"menuItems",null),bc(this,"origOutsideClickDeselects",null),pc(this,Ec,void 0),pc(this,Rc,void 0),pc(this,Tc,void 0),this.hot=t,this.options=e||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:Oc,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new Yl(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.parentMenu.runLocalHooks("afterSelectionChange",...e)}))}registerEvents(){let t=this.hot.rootWindow;while(t)this.eventManager.addEventListener(t.document,"mousedown",t=>this.onDocumentMouseDown(t)),this.eventManager.addEventListener(t.document,"touchstart",t=>this.onDocumentMouseDown(t)),this.eventManager.addEventListener(t.document,"contextmenu",t=>this.onDocumentContextMenu(t)),t=Object(s["getParentWindow"])(t)}setMenuItems(t){this.menuItems=t}getNavigator(){return Cc(Ec,this)}getKeyboardShortcutsCtrl(){return Cc(Rc,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return null!==this.parentMenu}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const t=Object(Li["debounce"])(t=>this.openSubMenu(t),300),e=this.options.minWidth||Oc;let n=!1,o=Object(f["arrayFilter"])(this.menuItems,t=>(t.key===yl&&(n=!0),oc(t,this.hot)));if(o.length<1&&!n)o.push(Tl()[yl]);else if(0===o.length)return;o=ac(o,Zs);let i=!1;const r={data:o,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(t){return Object(g["isDefined"])(t)&&t<e?e:t},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:gc(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,beforeOnCellMouseOver:(t,e)=>{Cc(Ec,this).setCurrentPage(e.row)},afterOnCellMouseOver:(e,n)=>{this.isAllSubMenusClosed()?t(n.row):this.openSubMenu(n.row)},rowHeights:t=>o[t].name===Zs?1:void 0,afterOnCellContextMenu:t=>{t.preventDefault(),Object(b["isWindowsOS"])()&&i&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(t,e,n,o,i)=>{this.hotMenu.view.isMouseDown()&&(i.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:t=>{this.hasSelectedItem()&&(i=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(t))},afterOnCellMouseUp:t=>{Object(b["isWindowsOS"])()&&Object(a["isRightClick"])(t)||!i||!this.hasSelectedItem()||(Object(b["isMobileBrowser"])()||Object(b["isIpadOS"])()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,r),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),yc(Ec,this,cc(this.hotMenu)),yc(Rc,this,fc(this)),Cc(Rc,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isOpened())if(t&&this.isSubMenu())this.parentMenu.close();else if(Cc(Ec,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const t=this.parentMenu.hotMenu.getSelectedLast();if(t){const e=this.parentMenu.hotMenu.getCell(t[0],0);Object(s["setAttribute"])(e,[Object(v["k"])(!1)])}}this.parentMenu.hotMenu.listen()}}openSubMenu(t){if(!this.hotMenu)return!1;const e=this.hotMenu.getCell(t,0);if(this.closeAllSubMenus(),!e||!tc(e))return!1;const n=this.hotMenu.getSourceDataAtRow(t),o=new Mc(this.hot,{parent:this,name:n.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return o.setMenuItems(n.submenu.items),o.open(),o.setPosition(e.getBoundingClientRect()),this.hotSubMenus[n.key]=o,this.hot.getSettings().ariaTags&&Object(s["setAttribute"])(e,[Object(v["k"])(!0)]),o}closeSubMenu(t){const e=this.hotMenu.getSourceDataAtRow(t),n=this.hotSubMenus[e.key];if(n){n.destroy(),delete this.hotSubMenus[e.key];const o=this.hotMenu.getCell(t,0);this.hot.getSettings().ariaTags&&Object(s["setAttribute"])(o,[Object(v["k"])(!1)])}}closeAllSubMenus(){Object(f["arrayEach"])(this.hotMenu.getData(),(t,e)=>this.closeSubMenu(e))}isAllSubMenusClosed(){return 0===Object.keys(this.hotSubMenus).length}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const t=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),t&&t.removeChild(this.container)}isOpened(){return null!==this.hotMenu}executeCommand(t){if(!this.isOpened()||!this.hasSelectedItem())return;const e=this.getSelectedItem();if(this.runLocalHooks("select",e,t),this.isCommandPassive(e))return;const n=this.hot.getSelectedRange(),o=n?$l(n):[];this.runLocalHooks("executeCommand",e.key,o,t),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",e.key,o,t)}isCommandPassive(t){return!1===t.isCommand||ql(t)||Ql(t,this.hot)||Kl(t)}setOffset(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.positioner.setOffset(t,e)}setPosition(t){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(t)}updateMenuDimensions(){const{wtTable:t}=this.hotMenu.view._wt,e=this.hotMenu.getSettings().data,n=t.hider.style,o=t.holder.style,i=parseInt(n.width,10),r=Object(f["arrayReduce"])(e,(t,e,n)=>{const o=this.hotMenu.getCell(n,0),i=o?Object(s["outerHeight"])(this.hotMenu.getCell(n,0)):0;return t+(e.name===Zs?1:i)},0);o.width=i+3+"px",o.height=r+3+"px",n.height=o.height}createContainer(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const e=this.options.container.ownerDocument;let n,o=t;return o&&(Object(Li["isFunction"])(o)&&(o=o.call(this.hot),o=null===o||Object(g["isUndefined"])(o)?"":o.toString()),o=o.replace(/[^A-z0-9]/g,"_"),o=`${this.options.className}Sub_${o}`,n=e.querySelector(`.${this.options.className}.${o}`)),n||(n=e.createElement("div"),Object(s["addClass"])(n,"htMenu "+this.options.className),o&&Object(s["addClass"])(n,o),this.options.container.appendChild(n)),n}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&Object(s["setAttribute"])(this.hotMenu.rootElement,[Object(v["s"])(),Object(v["L"])(-1)])}onDocumentMouseDown(t){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!Object(s["isChildOf"])(t.target,this.hotMenu.rootElement)?this.close(!0):!this.isAllSubMenusClosed()&&!this.isSubMenu()||Object(s["isChildOf"])(t.target,".htMenu")||this.close(!0))}onDocumentContextMenu(t){this.isOpened()&&Object(s["hasClass"])(t.target,"htCore")&&Object(s["isChildOf"])(t.target,this.hotMenu.rootElement)&&t.preventDefault()}}function Ic(t,e){xc(t,e),e.add(t)}function xc(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Nc(t,e,n){return(e=Ac(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ac(t){var e=Hc(t,"string");return"symbol"==typeof e?e:e+""}function Hc(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function jc(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}Object(l["mixin"])(Mc,vs["a"]);const _c="contextMenu",kc=70,Pc=_c;mt["a"].getSingleton().register("afterContextMenuDefaultOptions"),mt["a"].getSingleton().register("beforeContextMenuShow"),mt["a"].getSingleton().register("afterContextMenuShow"),mt["a"].getSingleton().register("afterContextMenuHide"),mt["a"].getSingleton().register("afterContextMenuExecute");var Dc=new WeakSet;class Lc extends bn{constructor(){super(...arguments),Ic(this,Dc),Nc(this,"commandExecutor",new Qa(this.hot)),Nc(this,"itemsFactory",null),Nc(this,"menu",null)}static get PLUGIN_KEY(){return _c}static get PLUGIN_PRIORITY(){return kc}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[ml,wl,Zs,ol,rl,Zs,gl,dl,Zs,Sl,cl,Zs,al,Zs,Za]}isEnabled(){return!!this.hot.getSettings()[_c]}enablePlugin(){var t=this;if(this.enabled)return;const e=this.hot.getSettings()[_c];"function"===typeof e.callback&&this.commandExecutor.setCommonCallback(e.callback),this.menu=new Mc(this.hot,{className:"htContextMenu",keepInViewport:!0,container:e.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>jc(Dc,this,Vc).call(this)),this.menu.addLocalHook("afterOpen",()=>jc(Dc,this,Wc).call(this)),this.menu.addLocalHook("afterClose",()=>jc(Dc,this,Bc).call(this)),this.menu.addLocalHook("executeCommand",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return t.executeCommand.call(t,...n)})),this.addHook("afterOnCellContextMenu",t=>jc(Dc,this,Fc).call(this,t)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:t}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const e=this.hot.getCell(t.row,t.col,!0).getBoundingClientRect(),n=ha(this.menu.container,this.hot.rootDocument);this.open({left:e.left+n.left,top:e.top+n.top-1+e.height},{left:e.width,above:-e.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var t;const e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return e&&this.hot.selection.isCellVisible(e)&&!this.menu.isOpened()},group:Pc})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Pc)}open(t){var e;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{above:0,below:0,left:0,right:0};if(null!==(e=this.menu)&&void 0!==e&&e.isOpened())return;this.prepareMenuItems(),this.menu.open();const o=this.menu.tableBorderWidth>0;o||(n.below+=1,n.right+=1,n.above-=1,n.left-=1),Object(l["objectEach"])(n,(t,e)=>{this.menu.setOffset(e,t)}),this.menu.setPosition(t)}close(){var t;null===(t=this.menu)||void 0===t||t.close(),this.itemsFactory=null}executeCommand(t){null===this.itemsFactory&&this.prepareMenuItems();for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];this.commandExecutor.execute(t,...n)}prepareMenuItems(){this.itemsFactory=new Nl(this.hot,Lc.DEFAULT_ITEMS);const t=this.hot.getSettings()[_c],e={items:this.itemsFactory.getItems(t)};this.hot.runHooks("afterContextMenuDefaultOptions",e),this.itemsFactory.setPredefinedItems(e.items);const n=this.itemsFactory.getItems(t);this.hot.runHooks("beforeContextMenuSetItems",n),this.menu.setMenuItems(n),Object(f["arrayEach"])(n,t=>this.commandExecutor.registerCommand(t.key,t))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function Fc(t){const e=this.hot.getSettings(),n=e.rowHeaders,o=e.colHeaders;function i(t){return"TD"===t.nodeName||"TD"===t.parentNode.nodeName}const r=t.target;if(this.close(),Object(s["hasClass"])(r,"handsontableInput"))return;if(t.preventDefault(),t.stopPropagation(),!n&&!o&&!i(r)&&(!Object(s["hasClass"])(r,"current")||!Object(s["hasClass"])(r,"wtBorder")))return;const a=ha(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+a.top,left:t.clientX+a.left})}function Vc(){this.hot.runHooks("beforeContextMenuShow",this)}function Wc(){this.hot.runHooks("afterContextMenuShow",this)}function Bc(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}Lc.SEPARATOR={name:Zs};var Uc=n("3bc4");function zc(t){return{key:"copy",name(){return this.getTranslatedPhrase(Ft["CONTEXTMENU_ITEMS_COPY"])},callback(){t.copyCellsOnly()},disabled(){if(0===this.countRows()||0===this.countCols())return!0;const t=this.getSelectedRangeLast();if(!t)return!0;if(t.isSingleHeader())return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}function Gc(t){return{key:"copy_column_headers_only",name(){const t=this.getSelectedRangeLast(),e=t?Object(ie["clamp"])(t.getWidth()-1,0,1):0;return this.getTranslatedPhrase(Ft["CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY"],e)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const t=this.getSelectedRangeLast();if(!t)return!0;if(t.isSingleHeader())return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}function Yc(t){return{key:"copy_with_column_group_headers",name(){const t=this.getSelectedRangeLast(),e=t?Object(ie["clamp"])(t.getWidth()-1,0,1):0;return this.getTranslatedPhrase(Ft["CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS"],e)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const t=this.getSelectedRangeLast();if(!t)return!0;if(t.isSingleHeader())return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}function Xc(t){return{key:"copy_with_column_headers",name(){const t=this.getSelectedRangeLast(),e=t?Object(ie["clamp"])(t.getWidth()-1,0,1):0;return this.getTranslatedPhrase(Ft["CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS"],e)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const t=this.getSelectedRangeLast();if(!t)return!0;if(t.isSingleHeader())return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}function $c(t){return{key:"cut",name(){return this.getTranslatedPhrase(Ft["CONTEXTMENU_ITEMS_CUT"])},callback(){t.cut()},disabled(){if(0===this.countRows()||0===this.countCols())return!0;const t=this.getSelectedRangeLast();if(!t)return!0;if(t.isSingleHeader())return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}class Kc{constructor(){this.data={}}setData(t,e){this.data[t]=e}getData(t){return this.data[t]||void 0}}class qc{constructor(){this.clipboardData=new Kc}preventDefault(){}}function Qc(t,e){Zc(t,e),e.add(t)}function Jc(t,e,n){Zc(t,e),e.set(t,n)}function Zc(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function th(t,e){return t.get(nh(t,e))}function eh(t,e,n){return t.set(nh(t,e),n),n}function nh(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var oh=new WeakMap,ih=new WeakMap,rh=new WeakMap,sh=new WeakMap,ah=new WeakMap,lh=new WeakMap,ch=new WeakSet;class hh{constructor(t){let{countRows:e,countColumns:n,rowsLimit:o,columnsLimit:i,countColumnHeaders:r}=t;Qc(this,ch),Jc(this,oh,void 0),Jc(this,ih,void 0),Jc(this,rh,void 0),Jc(this,sh,void 0),Jc(this,ah,void 0),Jc(this,lh,void 0),eh(ih,this,e),eh(rh,this,n),eh(sh,this,o),eh(ah,this,i),eh(lh,this,r)}setSelectedRange(t){eh(oh,this,t)}getCellsRange(){if(0===th(ih,this).call(this)||0===th(rh,this).call(this))return null;const{row:t,col:e}=th(oh,this).getTopStartCorner(),{row:n,col:o}=th(oh,this).getBottomEndCorner(),i=nh(ch,this,dh).call(this,t,n),r=nh(ch,this,uh).call(this,e,o),s=n!==i||o!==r;return{isRangeTrimmed:s,startRow:t,startCol:e,endRow:i,endCol:r}}getMostBottomColumnHeadersRange(){if(0===th(rh,this).call(this)||0===th(lh,this).call(this))return null;const{col:t}=th(oh,this).getTopStartCorner(),{col:e}=th(oh,this).getBottomEndCorner(),n=nh(ch,this,uh).call(this,t,e),o=e!==n;return{isRangeTrimmed:o,startRow:-1,startCol:t,endRow:-1,endCol:n}}getAllColumnHeadersRange(){if(0===th(rh,this).call(this)||0===th(lh,this).call(this))return null;const{col:t}=th(oh,this).getTopStartCorner(),{col:e}=th(oh,this).getBottomEndCorner(),n=nh(ch,this,uh).call(this,t,e),o=e!==n;return{isRangeTrimmed:o,startRow:-th(lh,this).call(this),startCol:t,endRow:-1,endCol:n}}}function uh(t,e){return Math.min(e,Math.max(t+th(ah,this).call(this)-1,t))}function dh(t,e){return Math.min(e,Math.max(t+th(sh,this).call(this)-1,t))}function fh(t){const e=[],n=[];return Object(f["arrayEach"])(t,t=>{const o=Math.min(t.startRow,t.endRow),i=Math.max(t.startRow,t.endRow);Object(ie["rangeEach"])(o,i,t=>{-1===e.indexOf(t)&&e.push(t)});const r=Math.min(t.startCol,t.endCol),s=Math.max(t.startCol,t.endCol);Object(ie["rangeEach"])(r,s,t=>{-1===n.indexOf(t)&&n.push(t)})}),{rows:e,columns:n}}var gh=n("a776");function ph(t,e){bh(t,e),e.add(t)}function mh(t,e,n){bh(t,e),e.set(t,n)}function bh(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wh(t,e,n){return(e=vh(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vh(t){var e=yh(t,"string");return"symbol"==typeof e?e:e+""}function yh(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Ch(t,e){return t.get(Oh(t,e))}function Sh(t,e,n){return t.set(Oh(t,e),n),n}function Oh(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}mt["a"].getSingleton().register("afterCopyLimit"),mt["a"].getSingleton().register("modifyCopyableRange"),mt["a"].getSingleton().register("beforeCut"),mt["a"].getSingleton().register("afterCut"),mt["a"].getSingleton().register("beforePaste"),mt["a"].getSingleton().register("afterPaste"),mt["a"].getSingleton().register("beforeCopy"),mt["a"].getSingleton().register("afterCopy");const Eh="copyPaste",Rh=80,Th=["fragmentSelection"],Mh=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var Ih=new WeakMap,xh=new WeakMap,Nh=new WeakMap,Ah=new WeakMap,Hh=new WeakMap,jh=new WeakMap,_h=new WeakMap,kh=new WeakMap,Ph=new WeakSet;class Dh extends bn{constructor(){super(...arguments),ph(this,Ph),wh(this,"columnsLimit",1/0),wh(this,"rowsLimit",1/0),wh(this,"pasteMode","overwrite"),wh(this,"uiContainer",this.hot.rootDocument.body),mh(this,Ih,!1),mh(this,xh,!1),mh(this,Nh,!1),mh(this,Ah,"cells-only"),mh(this,Hh,!1),mh(this,jh,!1),mh(this,_h,new hh({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),mh(this,kh,!1),wh(this,"copyableRanges",[])}static get PLUGIN_KEY(){return Eh}static get SETTING_KEYS(){return[Eh,...Th]}static get PLUGIN_PRIORITY(){return Rh}isEnabled(){return!!this.hot.getSettings()[Eh]}enablePlugin(){var t=this;if(this.enabled)return;const{[Eh]:e}=this.hot.getSettings();var n,o;"object"===typeof e&&(this.pasteMode=null!==(n=e.pasteMode)&&void 0!==n?n:this.pasteMode,this.rowsLimit=isNaN(e.rowsLimit)?this.rowsLimit:e.rowsLimit,this.columnsLimit=isNaN(e.columnsLimit)?this.columnsLimit:e.columnsLimit,Sh(Ih,this,!!e.copyColumnHeaders),Sh(xh,this,!!e.copyColumnGroupHeaders),Sh(Nh,this,!!e.copyColumnHeadersOnly),this.uiContainer=null!==(o=e.uiContainer)&&void 0!==o?o:this.uiContainer);this.addHook("afterContextMenuDefaultOptions",t=>Oh(Ph,this,Bh).call(this,t)),this.addHook("afterSelection",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return Oh(Ph,t,Uh).call(t,...n)})),this.addHook("afterSelectionEnd",()=>Oh(Ph,this,zh).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",(function(){return t.onCopy(...arguments)})),this.eventManager.addEventListener(this.hot.rootDocument,"cut",(function(){return t.onCut(...arguments)})),this.eventManager.addEventListener(this.hot.rootDocument,"paste",(function(){return t.onPaste(...arguments)})),Object(b["isSafari"])()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return Oh(Ph,t,Gh).call(t,...n)})),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return Oh(Ph,t,Yh).call(t,...n)})),this.addHook("afterSelection",()=>Oh(Ph,this,Xh).call(this))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"cells-only";Sh(Ah,this,t),Sh(Hh,this,!0),Oh(Ph,this,Lh).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){Sh(jh,this,!0),Oh(Ph,this,Lh).call(this,"cut")}getRangedCopyableData(t){return Object(Uc["b"])(this.getRangedData(t))}getRangedData(t){const e=[],{rows:n,columns:o}=fh(t);return Object(f["arrayEach"])(n,t=>{const n=[];Object(f["arrayEach"])(o,e=>{t<0?n.push(this.hot.getColHeader(e,t)):n.push(this.hot.getCopyableData(t,e))}),e.push(n)}),e}paste(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;if(!t&&!e)return;const n=new qc;t&&n.clipboardData.setData("text/plain",t),e&&n.clipboardData.setData("text/html",e),this.onPaste(n)}setCopyableText(){const t=this.hot.getSelectedRangeLast();if(!t)return;if(t.isSingleHeader())return void(this.copyableRanges=[]);Ch(_h,this).setSelectedRange(t);const e=new Map([["headers",null],["cells",null]]);"column-headers-only"===Ch(Ah,this)?e.set("headers",Ch(_h,this).getMostBottomColumnHeadersRange()):("with-column-headers"===Ch(Ah,this)?e.set("headers",Ch(_h,this).getMostBottomColumnHeadersRange()):"with-column-group-headers"===Ch(Ah,this)&&e.set("headers",Ch(_h,this).getAllColumnHeadersRange()),e.set("cells",Ch(_h,this).getCellsRange())),this.copyableRanges=Array.from(e.values()).filter(t=>null!==t).map(t=>{let{startRow:e,startCol:n,endRow:o,endCol:i}=t;return{startRow:e,startCol:n,endRow:o,endCol:i}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const n=e.get("cells");if(null!==n&&n.isRangeTrimmed){const{startRow:t,startCol:e,endRow:o,endCol:i}=n;this.hot.runHooks("afterCopyLimit",o-t+1,i-e+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var t;return null===(t=this.hot.getActiveEditor())||void 0===t?void 0:t.isOpened()}populateValues(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.hot.getSelectedRangeLast();if(!t.length)return;const n=t.length,o=t[0].length,i=[],{row:r,col:s}=e.getTopStartCorner(),{row:a,col:l}=e.getBottomEndCorner();let c=r,h=s,u=r,d=s;while(i.length<n||c<=a){const{skipRowOnPaste:e,visualRow:a}=this.hot.getCellMeta(c,s);if(c=a+1,!0===e)continue;u=a,h=s;const f=[],g=i.length%n;while(f.length<o||h<=l){const{skipColumnOnPaste:e,visualCol:n}=this.hot.getCellMeta(r,h);if(h=n+1,!0===e)continue;d=n;const i=f.length%o;f.push(t[g][i])}i.push(f)}return Sh(kh,this,!0),this.hot.populateFromArray(r,s,i,void 0,void 0,"CopyPaste.paste",this.pasteMode),[r,s,u,d]}onCopy(t){var e;const n=this.hot.getFocusManager().getRefocusElement(),o=null===(e=t.target)||void 0===e?void 0:e.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!Ch(Hh,this)||this.isEditorOpened()||t.target instanceof HTMLElement&&(o&&t.target!==n||!o&&t.target!==this.hot.rootDocument.body))return;t.preventDefault(),this.setCopyableText(),Sh(Hh,this,!1);const i=this.getRangedData(this.copyableRanges),r=Oh(Ph,this,Fh).call(this,this.copyableRanges),s=!!this.hot.runHooks("beforeCopy",i,this.copyableRanges,r);if(s){const e=Object(Uc["b"])(i);if(t&&t.clipboardData){const n=Object(gh["_dataToHTML"])(i,this.hot.rootDocument);t.clipboardData.setData("text/plain",e),t.clipboardData.setData("text/html",[Mh,n].join(""))}else"undefined"===typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",e);this.hot.runHooks("afterCopy",i,this.copyableRanges,r)}Sh(Ah,this,"cells-only")}onCut(t){var e;const n=this.hot.getFocusManager().getRefocusElement(),o=null===(e=t.target)||void 0===e?void 0:e.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!Ch(jh,this)||this.isEditorOpened()||t.target instanceof HTMLElement&&(o&&t.target!==n||!o&&t.target!==this.hot.rootDocument.body))return;t.preventDefault(),this.setCopyableText(),Sh(jh,this,!1);const i=this.getRangedData(this.copyableRanges),r=!!this.hot.runHooks("beforeCut",i,this.copyableRanges);if(r){const e=Object(Uc["b"])(i);if(t&&t.clipboardData){const n=Object(gh["_dataToHTML"])(i,this.hot.rootDocument);t.clipboardData.setData("text/plain",e),t.clipboardData.setData("text/html",[Mh,n].join(""))}else"undefined"===typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",e);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",i,this.copyableRanges)}}onPaste(t){var e;const n=this.hot.getFocusManager().getRefocusElement(),o=null===(e=t.target)||void 0===e?void 0:e.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||t.target instanceof HTMLElement&&(o&&t.target!==n||!o&&t.target!==this.hot.rootDocument.body))return;let i;if(t.preventDefault(),t&&"undefined"!==typeof t.clipboardData){const e=Object(p["sanitize"])(t.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});if(e&&/(<table)|(<TABLE)/g.test(e)){const t=Object(gh["htmlToGridSettings"])(e,this.hot.rootDocument);i=t.data}else i=t.clipboardData.getData("text/plain")}else"undefined"===typeof ClipboardEvent&&"undefined"!==typeof this.hot.rootWindow.clipboardData&&(i=this.hot.rootWindow.clipboardData.getData("Text"));if("string"===typeof i&&(i=Object(Uc["a"])(i)),void 0===i||i&&0===i.length)return;if(!1===this.hot.runHooks("beforePaste",i,this.copyableRanges))return;const[r,s,a,l]=this.populateValues(i);this.hot.selectCell(r,s,Math.min(this.hot.countRows()-1,a),Math.min(this.hot.countCols()-1,l)),this.hot.runHooks("afterPaste",i,this.copyableRanges)}destroy(){super.destroy()}}function Lh(t){if(Object(b["isSafari"])()){const e=this.hot.getSelectedRangeLast();if(e){const{row:n,col:o}=e.highlight,i=this.hot.getCell(n,o,!0);i&&Object(s["runWithSelectedContendEditableElement"])(i,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function Fh(t){const{rows:e}=fh(t);let n=0;for(let o=0;o<e.length;o++){if(e[o]>=0)break;n+=1}return{columnHeadersCount:n}}function Vh(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,o=this.hot.getCell(e,n,!0);o&&Object(s["makeElementContentEditableAndSelectItsContent"])(o)}}}function Wh(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,o=this.hot.getCell(e,n,!0);null!==o&&void 0!==o&&o.hasAttribute("contenteditable")&&Object(s["removeContentEditableFromElementAndDeselect"])(o)}}}function Bh(t){t.items.push({name:"---------"},zc(this)),Ch(Ih,this)&&t.items.push(Xc(this)),Ch(xh,this)&&t.items.push(Yc(this)),Ch(Nh,this)&&t.items.push(Gc(this)),t.items.push($c(this))}function Uh(t,e,n,o,i){Ch(kh,this)&&(i.value=!0),Sh(kh,this,!1)}function zh(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function Gh(){Oh(Ph,this,Wh).call(this)}function Yh(){Oh(Ph,this,Vh).call(this)}function Xh(){Oh(Ph,this,Wh).call(this)}function $h(t,e){return`border_row${t}col${e}`}function Kh(){return{width:1,color:"#000"}}function qh(){return{hide:!0}}function Qh(){return{width:1,color:"#000",cornerVisible:!1}}function Jh(t){var e,n;(Object(g["isDefined"])(t.start)||Object(g["isDefined"])(t.left))&&(t.start=null!==(e=t.start)&&void 0!==e?e:t.left);(Object(g["isDefined"])(t.end)||Object(g["isDefined"])(t.right))&&(t.end=null!==(n=t.end)&&void 0!==n?n:t.right);return delete t.left,delete t.right,t}function Zh(t){return Object(g["isDefined"])(t.start)&&(t.left=t.start),Object(g["isDefined"])(t.end)&&(t.right=t.end),t}function tu(t,e){return{id:$h(t,e),border:Qh(),row:t,col:e,top:qh(),bottom:qh(),start:qh(),end:qh()}}function eu(t,e){return Object(l["hasOwnProperty"])(e,"border")&&e.border&&(t.border=e.border),Object(l["hasOwnProperty"])(e,"top")&&Object(g["isDefined"])(e.top)&&(e.top?(Object(l["isObject"])(e.top)||(e.top=Kh()),t.top=e.top):(e.top=qh(),t.top=e.top)),Object(l["hasOwnProperty"])(e,"bottom")&&Object(g["isDefined"])(e.bottom)&&(e.bottom?(Object(l["isObject"])(e.bottom)||(e.bottom=Kh()),t.bottom=e.bottom):(e.bottom=qh(),t.bottom=e.bottom)),Object(l["hasOwnProperty"])(e,"start")&&Object(g["isDefined"])(e.start)&&(e.start?(Object(l["isObject"])(e.start)||(e.start=Kh()),t.start=e.start):(e.start=qh(),t.start=e.start)),Object(l["hasOwnProperty"])(e,"end")&&Object(g["isDefined"])(e.end)&&(e.end?(Object(l["isObject"])(e.end)||(e.end=Kh()),t.end=e.end):(e.end=qh(),t.end=e.end)),t}function nu(t,e){let n=!1;return Object(f["arrayEach"])(t.getSelectedRange(),o=>{o.forAll((o,i)=>{if(o<0||i<0)return;const r=t.getCellMeta(o,i).borders;if(r){if(!e)return n=!0,!1;if(!Object(l["hasOwnProperty"])(r[e],"hide")||!1===r[e].hide)return n=!0,!1}})}),n}function ou(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}function iu(t){return t.some(t=>Object(g["isDefined"])(t.left)||Object(g["isDefined"])(t.right))}function ru(t){return t.some(t=>Object(g["isDefined"])(t.start)||Object(g["isDefined"])(t.end))}const su=new Map([["left","start"],["right","end"]]);function au(t){var e;return null!==(e=su.get(t))&&void 0!==e?e:t}function lu(t){return{key:"borders:top",name(){let t=this.getTranslatedPhrase(Ft["CONTEXTMENU_ITEMS_BORDERS_TOP"]);const e=nu(this,"top");return e&&(t=ou(t)),t},callback(e,n){const o=nu(this,"top");t.prepareBorder(n,"top",o)}}}function cu(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let t=this.getTranslatedPhrase(Ft["CONTEXTMENU_ITEMS_BORDERS_RIGHT"]);const n=nu(this,e);return n&&(t=ou(t)),t},callback(n,o){const i=nu(this,e);t.prepareBorder(o,e,i)}}}function hu(t){return{key:"borders:bottom",name(){let t=this.getTranslatedPhrase(Ft["CONTEXTMENU_ITEMS_BORDERS_BOTTOM"]);const e=nu(this,"bottom");return e&&(t=ou(t)),t},callback(e,n){const o=nu(this,"bottom");t.prepareBorder(n,"bottom",o)}}}function uu(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let t=this.getTranslatedPhrase(Ft["CONTEXTMENU_ITEMS_BORDERS_LEFT"]);const n=nu(this,e);return n&&(t=ou(t)),t},callback(n,o){const i=nu(this,e);t.prepareBorder(o,e,i)}}}function du(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(Ft["CONTEXTMENU_ITEMS_REMOVE_BORDERS"])},callback(e,n){t.prepareBorder(n,"noBorders")},disabled(){return!nu(this)}}}function fu(t,e){gu(t,e),e.add(t)}function gu(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pu(t,e,n){return(e=mu(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mu(t){var e=bu(t,"string");return"symbol"==typeof e?e:e+""}function bu(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function wu(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const vu="customBorders",yu=90;var Cu=new WeakSet;class Su extends bn{constructor(){super(...arguments),fu(this,Cu),pu(this,"savedBorders",[])}static get PLUGIN_KEY(){return vu}static get PLUGIN_PRIORITY(){return yu}isEnabled(){return!!this.hot.getSettings()[vu]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",t=>wu(Cu,this,Ou).call(this,t)),this.addHook("init",()=>wu(Cu,this,Eu).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(t,e){let n=["top","bottom","start","end"],o=null;e&&(this.checkSettingsCohesion([e]),n=Object.keys(e),o=Jh(e));const i=Object(ul["c"])(t),r=Object(ul["d"])(i,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});Object(f["arrayEach"])(t,t=>{r(t).forAll((t,e)=>{Object(f["arrayEach"])(n,n=>{this.prepareBorderFromCustomAdded(t,e,o,au(n))})})}),this.hot.view.render()}getBorders(t){if(!Array.isArray(t))return this.savedBorders;const e=Object(ul["c"])(t),n=Object(ul["d"])(e,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),o=[];return Object(f["arrayEach"])(t,t=>{n(t).forAll((t,e)=>{Object(f["arrayEach"])(this.savedBorders,n=>{n.row===t&&n.col===e&&o.push(Zh(n))})})}),o}clearBorders(t){t?this.setBorders(t):(Object(f["arrayEach"])(this.savedBorders,t=>{this.clearBordersFromSelectionSettings(t.id),this.clearNullCellRange(),this.hot.removeCellMeta(t.row,t.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(t,e){const n=this.checkSavedBorders(t);n||this.savedBorders.push(t);const o=this.hot._createCellRange(this.hot._createCellCoords(t.row,t.col)),i=this.checkCustomSelections(t,o,e);i||this.hot.selection.highlight.addCustomSelection({border:t,visualCellRange:o})}prepareBorderFromCustomAdded(t,e,n,o){const i=this.hot.countRows(),r=this.hot.countCols();if(t>=i||e>=r)return;let s=tu(t,e);n&&(s=eu(s,n),Object(f["arrayEach"])(this.hot.selection.highlight.customSelections,t=>{if(s.id===t.settings.id)return Object.assign(t.settings,n),s.id=t.settings.id,s.top=t.settings.top,s.bottom=t.settings.bottom,s.start=t.settings.start,s.end=t.settings.end,!1})),this.hot.setCellMeta(t,e,"borders",Zh(s)),this.insertBorderIntoSettings(s,o)}prepareBorderFromCustomAddedRange(t,e){const n=Math.min(t.to.row,this.hot.countRows()-1),o=Math.min(t.to.col,this.hot.countCols()-1);Object(ie["rangeEach"])(t.from.row,n,n=>{Object(ie["rangeEach"])(t.from.col,o,o=>{const i=tu(n,o);let r=0;n===t.from.row&&Object(l["hasOwnProperty"])(e,"top")&&(r+=1,i.top=e.top),n===t.to.row&&Object(l["hasOwnProperty"])(e,"bottom")&&(r+=1,i.bottom=e.bottom),o===t.from.col&&Object(l["hasOwnProperty"])(e,"start")&&(r+=1,i.start=e.start),o===t.to.col&&Object(l["hasOwnProperty"])(e,"end")&&(r+=1,i.end=e.end),r>0&&(this.hot.setCellMeta(n,o,"borders",Zh(i)),this.insertBorderIntoSettings(i))})})}removeAllBorders(t,e){const n=$h(t,e);this.spliceBorder(n),this.clearBordersFromSelectionSettings(n),this.clearNullCellRange(),this.hot.removeCellMeta(t,e,"borders")}setBorder(t,e,n,o){let i=this.hot.getCellMeta(t,e).borders;if(i=i&&void 0!==i.border?Jh(i):tu(t,e),o){i[n]=qh();const r=this.countHide(i);if(4===r)this.removeAllBorders(t,e);else{const r=this.checkCustomSelectionsFromContextMenu(i,n,o);r||this.insertBorderIntoSettings(i),this.hot.setCellMeta(t,e,"borders",Zh(i))}}else{i[n]=Kh();const r=this.checkCustomSelectionsFromContextMenu(i,n,o);r||this.insertBorderIntoSettings(i),this.hot.setCellMeta(t,e,"borders",Zh(i))}}prepareBorder(t,e,n){Object(f["arrayEach"])(t,t=>{let{start:o,end:i}=t;if(o.row===i.row&&o.col===i.col)"noBorders"===e?this.removeAllBorders(o.row,o.col):this.setBorder(o.row,o.col,e,n);else switch(e){case"noBorders":Object(ie["rangeEach"])(o.col,i.col,t=>{Object(ie["rangeEach"])(o.row,i.row,e=>{this.removeAllBorders(e,t)})});break;case"top":Object(ie["rangeEach"])(o.col,i.col,t=>{this.setBorder(o.row,t,e,n)});break;case"bottom":Object(ie["rangeEach"])(o.col,i.col,t=>{this.setBorder(i.row,t,e,n)});break;case"start":Object(ie["rangeEach"])(o.row,i.row,t=>{this.setBorder(t,o.col,e,n)});break;case"end":Object(ie["rangeEach"])(o.row,i.row,t=>{this.setBorder(t,i.col,e,n)});break;default:break}})}createCustomBorders(t){Object(f["arrayEach"])(t,t=>{const e=Jh(t);t.range?this.prepareBorderFromCustomAddedRange(t.range,e):this.prepareBorderFromCustomAdded(t.row,t.col,e)})}countHide(t){const{top:e,bottom:n,start:o,end:i}=t,r=[e,n,o,i];return Object(f["arrayReduce"])(r,(t,e)=>{let n=t;return e&&e.hide&&(n+=1),n},0)}clearBordersFromSelectionSettings(t){const e=Object(f["arrayMap"])(this.hot.selection.highlight.customSelections,t=>t.settings.id).indexOf(t);e>-1&&this.hot.selection.highlight.customSelections[e].clear()}clearNullCellRange(){Object(f["arrayEach"])(this.hot.selection.highlight.customSelections,(t,e)=>{if(null===t.cellRange)return this.hot.selection.highlight.customSelections[e].destroy(),this.hot.selection.highlight.customSelections.splice(e,1),!1})}hideBorders(){Object(f["arrayEach"])(this.savedBorders,t=>{this.clearBordersFromSelectionSettings(t.id),this.clearNullCellRange()})}spliceBorder(t){const e=Object(f["arrayMap"])(this.savedBorders,t=>t.id).indexOf(t);e>-1&&this.savedBorders.splice(e,1)}checkSavedBorders(t){let e=!1;const n=this.countHide(t);return 4===n?(this.spliceBorder(t.id),e=!0):Object(f["arrayEach"])(this.savedBorders,(n,o)=>{if(t.id===n.id)return this.savedBorders[o]=t,e=!0,!1}),e}checkCustomSelectionsFromContextMenu(t,e,n){let o=!1;return Object(f["arrayEach"])(this.hot.selection.highlight.customSelections,i=>{if(t.id===i.settings.id){const t=this.hot.view._wt.selectionManager.getBorderInstances(i);return Object(f["arrayEach"])(t,t=>{t.toggleHiddenClass(e,n)}),o=!0,!1}}),o}checkCustomSelections(t,e,n){const o=this.countHide(t);let i=!1;return 4===o?(this.removeAllBorders(t.row,t.col),i=!0):Object(f["arrayEach"])(this.hot.selection.highlight.customSelections,o=>{if(t.id===o.settings.id){if(o.visualCellRange=e,o.commit(),n){const e=this.hot.view._wt.selectionManager.getBorderInstances(o);Object(f["arrayEach"])(e,e=>{e.changeBorderStyle(n,t)})}return i=!0,!1}}),i}changeBorderSettings(){const t=this.hot.getSettings()[vu];if(Array.isArray(t)){const e=Object(l["deepClone"])(t);this.checkSettingsCohesion(e),e.length||(this.savedBorders=e),this.createCustomBorders(e)}else void 0!==t&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(t){const e=iu(t),n=ru(t);if(e&&n)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&e)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function Ou(t){this.hot.getSettings()[vu]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(Ft["CONTEXTMENU_ITEMS_BORDERS"])},disabled(){const t=this.getSelectedRangeLast();return!t||(!!t.isSingleHeader()||this.selection.isSelectedByCorner())},submenu:{items:[lu(this),cu(this),hu(this),uu(this),du(this)]}})}function Eu(){this.changeBorderSettings()}function Ru(t,e){Tu(t,e),e.add(t)}function Tu(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mu(t,e,n){return(e=Iu(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Iu(t){var e=xu(t,"string");return"symbol"==typeof e?e:e+""}function xu(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Nu(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Au="dragToScroll",Hu=100;var ju=new WeakSet;class _u extends bn{constructor(){super(...arguments),Ru(this,ju),Mu(this,"boundaries",null),Mu(this,"callback",null),Mu(this,"listening",!1)}static get PLUGIN_KEY(){return Au}static get PLUGIN_PRIORITY(){return Hu}isEnabled(){return!!this.hot.getSettings()[Au]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",t=>Nu(ju,this,ku).call(this,t)),this.addHook("afterOnCellCornerMouseDown",t=>Nu(ju,this,ku).call(this,t)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=t}setCallback(t){this.callback=t}check(t,e){let n=0,o=0;e<this.boundaries.top?o=e-this.boundaries.top:e>this.boundaries.bottom&&(o=e-this.boundaries.bottom),t<this.boundaries.left?n=t-this.boundaries.left:t>this.boundaries.right&&(n=t-this.boundaries.right),this.callback(n,o)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:t}=this.hot;let e=t;while(e)this.eventManager.addEventListener(e.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(e.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(e.document,"mousemove",t=>this.onMouseMove(t)),e=Object(s["getParentWindow"])(e)}unregisterEvents(){this.eventManager.clear()}onMouseMove(t){this.isListening()&&this.check(t.clientX,t.clientY)}destroy(){super.destroy()}}function ku(t){if(Object(a["isRightClick"])(t))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((t,n)=>{var o,i;const r=null!==(o=e.scrollLeft)&&void 0!==o?o:e.scrollX,s=null!==(i=e.scrollTop)&&void 0!==i?i:e.scrollY;e.scroll(r+50*Math.sign(t),s+20*Math.sign(n))}),this.listen()}function Pu(t,e){Lu(t,e),e.add(t)}function Du(t,e,n){Lu(t,e),e.set(t,n)}function Lu(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fu(t,e,n){return(e=Vu(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vu(t){var e=Wu(t,"string");return"symbol"==typeof e?e:e+""}function Wu(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Bu(t,e){return t.get(zu(t,e))}function Uu(t,e,n){return t.set(zu(t,e),n),n}function zu(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}mt["a"].getSingleton().register("afterDropdownMenuDefaultOptions"),mt["a"].getSingleton().register("beforeDropdownMenuShow"),mt["a"].getSingleton().register("afterDropdownMenuShow"),mt["a"].getSingleton().register("afterDropdownMenuHide"),mt["a"].getSingleton().register("afterDropdownMenuExecute");const Gu="dropdownMenu",Yu=230,Xu="changeType",$u=Gu;var Ku=new WeakMap,qu=new WeakSet;class Qu extends bn{static get PLUGIN_KEY(){return Gu}static get PLUGIN_PRIORITY(){return Yu}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[ol,rl,Zs,dl,Zs,el,Zs,al,Zs,Za]}constructor(t){super(t),Pu(this,qu),Fu(this,"commandExecutor",new Qa(this.hot)),Fu(this,"itemsFactory",null),Fu(this,"menu",null),Du(this,Ku,!1),this.hot.addHook("afterGetColHeader",(t,e)=>zu(qu,this,td).call(this,t,e))}isEnabled(){return this.hot.getSettings()[Gu]}enablePlugin(){var t=this;if(this.enabled)return;this.itemsFactory=new Nl(this.hot,Qu.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return zu(qu,t,sd).call(t,...n)})),this.addHook("beforeViewportScrollHorizontally",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return zu(qu,t,rd).call(t,...n)}));const e=this.hot.getSettings()[Gu],n={items:this.itemsFactory.getItems(e)};this.registerEvents(),"function"===typeof e.callback&&this.commandExecutor.setCommonCallback(e.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const o=this.itemsFactory.getItems(e);this.menu&&this.menu.destroy(),this.menu=new Mc(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:e.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",o),this.menu.setMenuItems(o),this.menu.addLocalHook("beforeOpen",()=>zu(qu,this,ed).call(this)),this.menu.addLocalHook("afterOpen",()=>zu(qu,this,nd).call(this)),this.menu.addLocalHook("afterSubmenuOpen",t=>zu(qu,this,od).call(this,t)),this.menu.addLocalHook("afterClose",()=>zu(qu,this,id).call(this)),this.menu.addLocalHook("executeCommand",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return t.executeCommand.call(t,...n)})),Object(f["arrayEach"])(o,t=>this.commandExecutor.registerCommand(t.key,t))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("grid"),e=()=>{const{highlight:t}=this.hot.getSelectedRangeLast();if((t.isHeader()&&-1===t.row||t.isCell())&&t.col>=0){this.hot.selectColumns(t.col,t.col,-1);const{from:e}=this.hot.getSelectedRangeLast(),n=ha(this.menu.container,this.hot.rootDocument),o=this.hot.getCell(-1,e.col,!0).querySelector("."+Xu),i=o.getBoundingClientRect();this.open({left:i.left+n.left,top:i.top+o.offsetHeight+n.top},{left:i.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};t.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:e,runOnlyIf:()=>{var t;const e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return e&&this.hot.selection.isCellVisible(e)&&e.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:$u},{keys:[["Shift","Alt","ArrowDown"]],callback:e,runOnlyIf:()=>{var t;const e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return e&&this.hot.selection.isCellVisible(e)&&e.isCell()&&!this.menu.isOpened()},group:$u}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup($u)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",t=>zu(qu,this,Zu).call(this,t))}open(t){var e;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{above:0,below:0,left:0,right:0};null!==(e=this.menu)&&void 0!==e&&e.isOpened()||(this.menu.open(),Object(l["objectEach"])(n,(t,e)=>{this.menu.setOffset(e,t)}),this.menu.setPosition(t))}close(){var t;null===(t=this.menu)||void 0===t||t.close()}executeCommand(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];this.commandExecutor.execute(t,...n)}setListening(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.menu.isOpened()&&(t?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function Ju(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function Zu(t){if(Object(s["hasClass"])(t.target,Xu)){const e=ha(this.menu.container,this.hot.rootDocument),n=t.target.getBoundingClientRect();t.stopPropagation(),Uu(Ku,this,!1),this.open({left:n.left+e.left,top:n.top+t.target.offsetHeight+e.top},{left:n.width,right:0,above:0,below:3})}}function td(t,e){const n=e.parentNode;if(!n)return;const o=n.parentNode.childNodes,i=Array.prototype.indexOf.call(o,n);if(t<0||i!==o.length-1)return;const r=e.querySelector("."+Xu);if(this.enabled&&r)return;if(!this.enabled)return void(r&&r.parentNode.removeChild(r));const a=this.hot.rootDocument.createElement("button");a.className=Xu,a.type="button",a.tabIndex=-1,this.hot.getSettings().ariaTags&&(Object(s["setAttribute"])(a,[Object(v["n"])(),Object(v["p"])(" ")]),Object(s["setAttribute"])(e,[Object(v["m"])("menu")])),a.onclick=function(){return!1},e.firstChild.insertBefore(a,e.firstChild.firstChild)}function ed(){this.hot.runHooks("beforeDropdownMenuShow",this)}function nd(){this.hot.runHooks("afterDropdownMenuShow",this),zu(qu,this,Ju).call(this,this.menu)}function od(t){zu(qu,this,Ju).call(this,t)}function id(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function rd(t){return Bu(Ku,this)?null:t}function sd(t){Object(s["hasClass"])(t.target,Xu)&&Uu(Ku,this,!0)}function ad(t,e,n){return(e=ld(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ld(t){var e=cd(t,"string");return"symbol"==typeof e?e:e+""}function cd(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}Qu.SEPARATOR={name:Zs};class hd{constructor(t){ad(this,"hot",void 0),ad(this,"options",{}),this.hot=t}setOptions(t){this.options=t}getData(){const{startRow:t,startCol:e,endRow:n,endCol:o}=this._getDataRange(),i=this.options,r=[];return Object(ie["rangeEach"])(t,n,t=>{const n=[];!i.exportHiddenRows&&this._isHiddenRow(t)||(Object(ie["rangeEach"])(e,o,e=>{!i.exportHiddenColumns&&this._isHiddenColumn(e)||n.push(this.hot.getDataAtCell(t,e))}),r.push(n))}),r}getRowHeaders(){const t=[];if(this.options.rowHeaders){const{startRow:e,endRow:n}=this._getDataRange(),o=this.hot.getRowHeader();Object(ie["rangeEach"])(e,n,e=>{!this.options.exportHiddenRows&&this._isHiddenRow(e)||t.push(o[e])})}return t}getColumnHeaders(){const t=[];if(this.options.columnHeaders){const{startCol:e,endCol:n}=this._getDataRange(),o=this.hot.getColHeader();Object(ie["rangeEach"])(e,n,e=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(e)||t.push(o[e])})}return t}_getDataRange(){const t=this.hot.countCols()-1,e=this.hot.countRows()-1;let[n=0,o=0,i=e,r=t]=this.options.range;return n=Math.max(n,0),o=Math.max(o,0),i=Math.min(i,e),r=Math.min(r,t),{startRow:n,startCol:o,endRow:i,endCol:r}}_isHiddenRow(t){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(t))}_isHiddenColumn(t){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(t))}}var ud=hd;function dd(t,e,n){return(e=fd(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fd(t){var e=gd(t,"string");return"symbol"==typeof e?e:e+""}function gd(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class pd{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(t,e){dd(this,"dataProvider",void 0),dd(this,"options",void 0),this.dataProvider=t,this.options=this._mergeOptions(e),this.dataProvider.setOptions(this.options)}_mergeOptions(t){let e=Object(l["clone"])(this.constructor.DEFAULT_OPTIONS);const n=new Date;return e=Object(l["extend"])(Object(l["clone"])(pd.DEFAULT_OPTIONS),e),e=Object(l["extend"])(e,t),e.filename=Object(p["substitute"])(e.filename,{YYYY:n.getFullYear(),MM:(""+(n.getMonth()+1)).padStart(2,"0"),DD:(""+n.getDate()).padStart(2,"0")}),e}}var md=pd;const bd=String.fromCharCode(13),wd=String.fromCharCode(34),vd=String.fromCharCode(10);class yd extends md{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:"\r\n"}}export(){const t=this.options,e=this.dataProvider.getData();let n=this.dataProvider.getColumnHeaders();const o=n.length>0,i=this.dataProvider.getRowHeaders(),r=i.length>0;let s=t.bom?String.fromCharCode(65279):"";return o&&(n=Object(f["arrayMap"])(n,t=>this._escapeCell(t,!0)),r&&(s+=t.columnDelimiter),s+=n.join(t.columnDelimiter),s+=t.rowDelimiter),Object(f["arrayEach"])(e,(e,n)=>{n>0&&(s+=t.rowDelimiter),r&&(s+=this._escapeCell(i[n])+t.columnDelimiter),s+=e.map(t=>this._escapeCell(t)).join(t.columnDelimiter)}),s}_escapeCell(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Object(g["stringify"])(t);return""!==n&&(e||n.indexOf(bd)>=0||n.indexOf(wd)>=0||n.indexOf(vd)>=0||n.indexOf(this.options.columnDelimiter)>=0)&&(n=n.replace(new RegExp('"',"g"),'""'),n=`"${n}"`),n}}var Cd=yd;const Sd="csv",Od={[Sd]:Cd};function Ed(t,e,n){return"function"===typeof Od[t]?new Od[t](e,n):null}const Rd="exportFile",Td=240;class Md extends bn{static get PLUGIN_KEY(){return Rd}static get PLUGIN_PRIORITY(){return Td}isEnabled(){return!0}exportAsString(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createTypeFormatter(t,e).export()}exportAsBlob(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createBlob(this._createTypeFormatter(t,e))}downloadFile(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{rootDocument:n,rootWindow:o}=this.hot,i=this._createTypeFormatter(t,e),r=this._createBlob(i),s=o.URL||o.webkitURL,a=n.createElement("a"),l=`${i.options.filename}.${i.options.fileExtension}`;if(void 0!==a.download){const t=s.createObjectURL(r);a.style.display="none",a.setAttribute("href",t),a.setAttribute("download",l),n.body.appendChild(a),a.dispatchEvent(new MouseEvent("click")),n.body.removeChild(a),setTimeout(()=>{s.revokeObjectURL(t)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(r,l)}_createTypeFormatter(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Od[t])throw new Error(`Export format type "${t}" is not supported.`);return Ed(t,new ud(this.hot),e)}_createBlob(t){let e=null;return"undefined"!==typeof Blob&&(e=new Blob([t.export()],{type:`${t.options.mimeType};charset=${t.options.encoding}`})),e}}n("24b9");function Id(t,e,n){return(e=xd(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xd(t){var e=Nd(t,"string");return"symbol"==typeof e?e:e+""}function Nd(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Ad{constructor(t,e){let{id:n,stateless:o=!0}=e;Id(this,"hot",void 0),Id(this,"id",void 0),Id(this,"elements",[]),Id(this,"hidden",!1),Id(this,"stateId",""),Id(this,"state",void 0),this.hot=t,this.id=n,this.stateId="Filters.component."+this.id,this.state=o?null:this.hot.columnIndexMapper.registerMap(this.stateId,new Vi["a"])}getElements(){return this.elements}reset(){Object(f["arrayEach"])(this.elements,t=>t.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return null===this.hot||this.hidden}restoreState(t){this.state&&this.setState(this.state.getValueAtIndex(t))}setState(){throw new Error("The state setting logic is not implemented")}saveState(t){this.state&&this.state.setValueAtIndex(t,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),Object(f["arrayEach"])(this.elements,t=>t.destroy()),this.state=null,this.elements=null,this.hot=null}}Object(l["mixin"])(Ad,vs["a"]);const Hd={};function jd(t,e){if(!Hd[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:n,descriptor:o}=Hd[t];let i=e;return o.inputValuesDecorator&&(i=o.inputValuesDecorator(i)),function(t){return n.apply(t.meta.instance,[].concat([t],[i]))}}function _d(t){if(!Hd[t])throw Error(`Filter condition "${t}" does not exist.`);return Hd[t].descriptor}function kd(t,e,n){n.key=t,Hd[t]={condition:e,descriptor:n}}const Pd="none";function Dd(){return!0}kd(Pd,Dd,{name:Ft["FILTERS_CONDITIONS_NONE"],inputsCount:0,showOperators:!1});const Ld="empty";function Fd(t){return Object(g["isEmpty"])(t.value)}kd(Ld,Fd,{name:Ft["FILTERS_CONDITIONS_EMPTY"],inputsCount:0,showOperators:!0});const Vd="not_empty";function Wd(t,e){return!jd(Ld,e)(t)}kd(Vd,Wd,{name:Ft["FILTERS_CONDITIONS_NOT_EMPTY"],inputsCount:0,showOperators:!0});const Bd="eq";function Ud(t,e){let[n]=e;return Object(g["stringify"])(t.value).toLocaleLowerCase(t.meta.locale)===Object(g["stringify"])(n)}kd(Bd,Ud,{name:Ft["FILTERS_CONDITIONS_EQUAL"],inputsCount:1,showOperators:!0});const zd="neq";function Gd(t,e){return!jd(Bd,e)(t)}kd(zd,Gd,{name:Ft["FILTERS_CONDITIONS_NOT_EQUAL"],inputsCount:1,showOperators:!0});const Yd="gt";function Xd(t,e){let[n]=e,o=n;return"numeric"===t.meta.type&&(o=parseFloat(o,10)),t.value>o}kd(Yd,Xd,{name:Ft["FILTERS_CONDITIONS_GREATER_THAN"],inputsCount:1,showOperators:!0});const $d="gte";function Kd(t,e){let[n]=e,o=n;return"numeric"===t.meta.type&&(o=parseFloat(o,10)),t.value>=o}kd($d,Kd,{name:Ft["FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL"],inputsCount:1,showOperators:!0});const qd="lt";function Qd(t,e){let[n]=e,o=n;return"numeric"===t.meta.type&&(o=parseFloat(o,10)),t.value<o}kd(qd,Qd,{name:Ft["FILTERS_CONDITIONS_LESS_THAN"],inputsCount:1,showOperators:!0});const Jd="lte";function Zd(t,e){let[n]=e,o=n;return"numeric"===t.meta.type&&(o=parseFloat(o,10)),t.value<=o}kd(Jd,Zd,{name:Ft["FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL"],inputsCount:1,showOperators:!0});const tf="date_after";function ef(t,e){let[n]=e;const o=j(t.value,t.meta.dateFormat),i=j(n,t.meta.dateFormat);return!(!o.isValid()||!i.isValid())&&o.diff(i)>=0}kd(tf,ef,{name:Ft["FILTERS_CONDITIONS_AFTER"],inputsCount:1,showOperators:!0});const nf="date_before";function of(t,e){let[n]=e;const o=j(t.value,t.meta.dateFormat),i=j(n,t.meta.dateFormat);return!(!o.isValid()||!i.isValid())&&o.diff(i)<=0}kd(nf,of,{name:Ft["FILTERS_CONDITIONS_BEFORE"],inputsCount:1,showOperators:!0});const rf="between";function sf(t,e){let[n,o]=e,i=n,r=o;if("numeric"===t.meta.type){const t=parseFloat(i,10),e=parseFloat(r,10);i=Math.min(t,e),r=Math.max(t,e)}else if("date"===t.meta.type){const e=jd(nf,[r]),n=jd(tf,[i]);return e(t)&&n(t)}return t.value>=i&&t.value<=r}kd(rf,sf,{name:Ft["FILTERS_CONDITIONS_BETWEEN"],inputsCount:2,showOperators:!0});const af="not_between";function lf(t,e){return!jd(rf,e)(t)}kd(af,lf,{name:Ft["FILTERS_CONDITIONS_NOT_BETWEEN"],inputsCount:2,showOperators:!0});const cf="begins_with";function hf(t,e){let[n]=e;return Object(g["stringify"])(t.value).toLocaleLowerCase(t.meta.locale).startsWith(Object(g["stringify"])(n))}kd(cf,hf,{name:Ft["FILTERS_CONDITIONS_BEGINS_WITH"],inputsCount:1,showOperators:!0});const uf="ends_with";function df(t,e){let[n]=e;return Object(g["stringify"])(t.value).toLocaleLowerCase(t.meta.locale).endsWith(Object(g["stringify"])(n))}kd(uf,df,{name:Ft["FILTERS_CONDITIONS_ENDS_WITH"],inputsCount:1,showOperators:!0});const ff="contains";function gf(t,e){let[n]=e;return Object(g["stringify"])(t.value).toLocaleLowerCase(t.meta.locale).indexOf(Object(g["stringify"])(n))>=0}kd(ff,gf,{name:Ft["FILTERS_CONDITIONS_CONTAINS"],inputsCount:1,showOperators:!0});const pf="not_contains";function mf(t,e){return!jd(ff,e)(t)}kd(pf,mf,{name:Ft["FILTERS_CONDITIONS_NOT_CONTAIN"],inputsCount:1,showOperators:!0});const bf="date_tomorrow";function wf(t){const e=j(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame(j().subtract(-1,"days").startOf("day"),"d")}kd(bf,wf,{name:Ft["FILTERS_CONDITIONS_TOMORROW"],inputsCount:0});const vf="date_today";function yf(t){const e=j(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame(j().startOf("day"),"d")}kd(vf,yf,{name:Ft["FILTERS_CONDITIONS_TODAY"],inputsCount:0});const Cf="date_yesterday";function Sf(t){const e=j(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame(j().subtract(1,"days").startOf("day"),"d")}kd(Cf,Sf,{name:Ft["FILTERS_CONDITIONS_YESTERDAY"],inputsCount:0});const Of="numeric",Ef="text",Rf="date",Tf={[Of]:[Pd,Zs,Ld,Vd,Zs,Bd,zd,Zs,Yd,$d,qd,Jd,rf,af],[Ef]:[Pd,Zs,Ld,Vd,Zs,Bd,zd,Zs,cf,uf,Zs,ff,pf],[Rf]:[Pd,Zs,Ld,Vd,Zs,Bd,zd,Zs,nf,tf,rf,Zs,bf,vf,Cf]};function Mf(t){const e=[];let n=t;return Tf[n]||(n=Ef),Object(f["arrayEach"])(Tf[n],t=>{let n;n=t===Zs?{name:Zs}:Object(l["clone"])(_d(t)),e.push(n)}),e}function If(t,e,n){return(e=xf(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xf(t){var e=Nf(t,"string");return"symbol"==typeof e?e:e+""}function Nf(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}const Af="built",Hf="building",jf=["click","input","keydown","keypress","keyup","focus","blur","change"];class _f{static get DEFAULTS(){return Object(l["clone"])({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(t,e){If(this,"hot",void 0),If(this,"eventManager",new _t["a"](this)),If(this,"options",void 0),If(this,"_element",void 0),If(this,"buildState",void 0),this.hot=t,this.options=Object(l["extend"])(_f.DEFAULTS,e),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(t){this.options.value=t,this.update()}getValue(){return this.options.value}get element(){return this.buildState===Hf?this._element:this.buildState===Af?(this.update(),this._element):(this.buildState=Hf,this.build(),this.buildState=Af,this._element)}isBuilt(){return this.buildState===Af}translateIfPossible(t){return"string"===typeof t&&t.startsWith(Ft["FILTERS_NAMESPACE"])?this.hot.getTranslatedPhrase(t):t}build(){const t=(t,e)=>{this.eventManager.addEventListener(t,e,t=>this.runLocalHooks(e,t,this))};if(this.buildState||(this.buildState=Hf),this._element.setAttribute("data-hot-input",!0),void 0!==this.options.tabIndex&&this._element.setAttribute("tabindex",this.options.tabIndex),void 0!==this.options.role&&this._element.setAttribute("role",this.options.role),this.options.className&&Object(s["addClass"])(this._element,this.options.className),this.options.children.length)Object(f["arrayEach"])(this.options.children,t=>this._element.appendChild(t.element));else if(this.options.wrapIt){const e=this.hot.rootDocument.createElement(this.options.tagName);e.setAttribute("data-hot-input",!0),Object(l["objectEach"])(this.options,(t,n)=>{void 0!==e[n]&&"className"!==n&&"tagName"!==n&&"children"!==n&&(e[n]=this.translateIfPossible(t))}),this._element.appendChild(e),Object(f["arrayEach"])(jf,n=>t(e,n))}else Object(f["arrayEach"])(jf,e=>t(this._element,e))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}}function kf(t,e){Df(t,e),e.add(t)}function Pf(t,e,n){Df(t,e),e.set(t,n)}function Df(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Lf(t,e){return t.get(Vf(t,e))}function Ff(t,e,n){return t.set(Vf(t,e),n),n}function Vf(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}Object(l["mixin"])(_f,vs["a"]);var Wf=new WeakMap,Bf=new WeakSet;class Uf extends _f{static get DEFAULTS(){return Object(l["clone"])({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(t,e){super(t,Object(l["extend"])(Uf.DEFAULTS,e)),kf(this,Bf),Pf(this,Wf,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",t=>Vf(Bf,this,zf).call(this,t))}build(){super.build();const t=this.hot.rootDocument.createElement("div");Ff(Wf,this,this._element.firstChild),Object(s["addClass"])(this._element,"htUIInput"),Object(s["addClass"])(t,"htUIInputIcon"),this._element.appendChild(t),this.update()}update(){this.isBuilt()&&(Lf(Wf,this).type=this.options.type,Lf(Wf,this).placeholder=this.translateIfPossible(this.options.placeholder),Lf(Wf,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&Lf(Wf,this).focus()}}function zf(t){this.options.value=t.target.value}function Gf(t,e){Xf(t,e),e.add(t)}function Yf(t,e,n){Xf(t,e),e.set(t,n)}function Xf(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $f(t,e,n){return t.set(qf(t,e),n),n}function Kf(t,e){return t.get(qf(t,e))}function qf(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Qf=new WeakMap,Jf=new WeakMap,Zf=new WeakMap,tg=new WeakMap,eg=new WeakMap,ng=new WeakSet;class og extends _f{static get DEFAULTS(){return Object(l["clone"])({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(t,e){super(t,Object(l["extend"])(og.DEFAULTS,e)),Gf(this,ng),Yf(this,Qf,null),Yf(this,Jf,[]),Yf(this,Zf,void 0),Yf(this,tg,void 0),Yf(this,eg,void 0),this.registerHooks()}getMenu(){return Kf(Qf,this)}registerHooks(){this.addLocalHook("click",()=>qf(ng,this,sg).call(this))}setItems(t){$f(Jf,this,this.translateNames(t)),Kf(Qf,this)&&Kf(Qf,this).setMenuItems(Kf(Jf,this))}translateNames(t){return Object(f["arrayEach"])(t,t=>{t.name=this.translateIfPossible(t.name)}),t}build(){super.build(),$f(Qf,this,new Mc(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),Kf(Qf,this).setMenuItems(Kf(Jf,this));const t=new _f(this.hot,{className:"htUISelectCaption"}),e=new _f(this.hot,{className:"htUISelectDropdown"});$f(Zf,this,t),$f(tg,this,t.element),$f(eg,this,e),this.hot.getSettings().ariaTags&&(Object(s["setAttribute"])(e.element,[Object(v["n"])()]),Object(s["setAttribute"])(this._element,[Object(v["q"])()])),Object(f["arrayEach"])([t,e],t=>this._element.appendChild(t.element)),Kf(Qf,this).addLocalHook("select",t=>qf(ng,this,ig).call(this,t)),Kf(Qf,this).addLocalHook("afterClose",()=>qf(ng,this,rg).call(this)),this.update()}update(){if(!this.isBuilt())return;let t;t=this.options.value?this.options.value.name:Kf(Qf,this).hot.getTranslatedPhrase(Ft["FILTERS_CONDITIONS_NONE"]),Kf(tg,this).textContent=t,super.update()}openOptions(){const t=this.element.getBoundingClientRect();Kf(Qf,this)&&(Kf(Qf,this).open(),Kf(Qf,this).setPosition({left:this.hot.isLtr()?t.left-5:t.left-31,top:t.top-1,width:t.width,height:t.height}),Kf(Qf,this).getNavigator().toFirstItem(),Kf(Qf,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:t=>{this.closeOptions(),this.runLocalHooks("tabKeydown",t)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){Kf(Qf,this)&&Kf(Qf,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){Kf(Qf,this)&&(Kf(Qf,this).destroy(),$f(Qf,this,null)),Kf(Zf,this)&&Kf(Zf,this).destroy(),Kf(eg,this)&&Kf(eg,this).destroy(),super.destroy()}}function ig(t){t.name!==Zs&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function rg(){this.runLocalHooks("afterClose")}function sg(){this.openOptions()}function ag(t,e){lg(t,e),e.add(t)}function lg(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cg(t,e,n){return(e=hg(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hg(t){var e=ug(t,"string");return"symbol"==typeof e?e:e+""}function ug(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function dg(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var fg=new WeakSet;class gg extends Ad{constructor(t,e){super(t,{id:e.id,stateless:!1}),ag(this,fg),cg(this,"name",""),cg(this,"addSeparator",!1),this.name=e.name,this.addSeparator=e.addSeparator,this.elements.push(new og(this.hot,{menuContainer:e.menuContainer})),this.elements.push(new Uf(this.hot,{placeholder:Ft["FILTERS_BUTTONS_PLACEHOLDER_VALUE"]})),this.elements.push(new Uf(this.hot,{placeholder:Ft["FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE"]})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",t=>dg(fg,this,pg).call(this,t)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",t=>this.runLocalHooks("selectTabKeydown",t)),Object(f["arrayEach"])(this.getInputElements(),t=>{t.addLocalHook("keydown",t=>dg(fg,this,mg).call(this,t))})}setState(t){if(this.reset(),!t)return;const e=Object(l["clone"])(t.command);e.name.startsWith(Ft["FILTERS_CONDITIONS_NAMESPACE"])&&(e.name=this.hot.getTranslatedPhrase(e.name)),this.getSelectElement().setValue(e),Object(f["arrayEach"])(t.args,(t,n)=>{if(n>e.inputsCount-1)return!1;const o=this.getInputElement(n);o.setValue(t),o[e.inputsCount>n?"show":"hide"](),n||this.hot._registerTimeout(()=>o.focus(),10)})}getState(){const t=this.getSelectElement().getValue()||_d(Pd),e=[];return Object(f["arrayEach"])(this.getInputElements(),(n,o)=>{t.inputsCount>o&&e.push(n.getValue())}),{command:t,args:e}}updateState(t,e){const n=_d(t?t.name:Pd);this.state.setValueAtIndex(e,{command:n,args:t?t.args:[]}),t||Object(f["arrayEach"])(this.getInputElements(),t=>t.setValue(null))}getSelectElement(){return this.elements.filter(t=>t instanceof og)[0]}getInputElement(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.getInputElements()[t]}getInputElements(){return this.elements.filter(t=>t instanceof Uf)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(t,e,n,o,i,r)=>{Object(s["addClass"])(e.parentNode,"htFiltersMenuCondition"),this.addSeparator&&Object(s["addClass"])(e.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return Object(s["addClass"])(a,"htFiltersMenuLabel"),a.textContent=r,e.appendChild(a),e.parentElement.hasAttribute("ghost-table")||Object(f["arrayEach"])(this.elements,t=>e.appendChild(t.element)),e}}}reset(){const t=this.hot.getPlugin("filters").getSelectedColumn();let e=[_d(Pd)];if(null!==t){const{visualIndex:n}=t;e=Mf(this.hot.getDataType(0,n,this.hot.countRows(),n))}Object(f["arrayEach"])(this.getInputElements(),t=>t.hide()),this.getSelectElement().setItems(e),super.reset(),this.getSelectElement().setValue(e[0])}}function pg(t){Object(f["arrayEach"])(this.getInputElements(),(e,n)=>{e[t.inputsCount>n?"show":"hide"](),0===n&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function mg(t){Object(m["isKey"])(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Object(a["stopImmediatePropagation"])(t))}const bg={};function wg(t){if(!bg[t])throw Error(`Operation with id "${t}" does not exist.`);const e=bg[t].func;return function(t,n){return e(t,n)}}function vg(t){return bg[t].name}function yg(t,e,n){bg[t]={name:e,func:n}}const Cg="conjunction",Sg=Ft["FILTERS_LABELS_CONJUNCTION"];function Og(t,e){return t.every(t=>t.func(e))}yg(Cg,Sg,Og);const Eg="disjunction",Rg=Ft["FILTERS_LABELS_DISJUNCTION"];function Tg(t,e){return t.some(t=>t.func(e))}yg(Eg,Rg,Tg);const Mg="disjunctionWithExtraCondition",Ig=Ft["FILTERS_LABELS_DISJUNCTION"];function xg(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(t=>t.func(e))&&t[t.length-1].func(e)}function Ng(t,e,n){Ag(t,e),e.set(t,n)}function Ag(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hg(t,e){return t.get(_g(t,e))}function jg(t,e,n){return t.set(_g(t,e),n),n}function _g(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}yg(Mg,Ig,xg);var kg=new WeakMap,Pg=new WeakMap;class Dg extends _f{static get DEFAULTS(){return Object(l["clone"])({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(t,e){super(t,Object(l["extend"])(Dg.DEFAULTS,e)),Ng(this,kg,void 0),Ng(this,Pg,void 0)}build(){super.build();const t=this.hot.rootDocument.createElement("label");t.textContent=this.translateIfPossible(this.options.label.textContent),t.htmlFor=this.translateIfPossible(this.options.label.htmlFor),jg(Pg,this,t),jg(kg,this,this._element.firstChild),Hg(kg,this).checked=this.options.checked,this._element.appendChild(t),this.update()}update(){this.isBuilt()&&(Hg(Pg,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return!!this.isBuilt()&&Hg(kg,this).checked}setChecked(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.isBuilt()&&(Hg(kg,this).checked=t)}focus(){this.isBuilt()&&Hg(kg,this).focus()}}function Lg(t,e){Fg(t,e),e.add(t)}function Fg(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vg(t,e,n){return(e=Wg(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wg(t){var e=Bg(t,"string");return"symbol"==typeof e?e:e+""}function Bg(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Ug(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const zg=0;var Gg=new WeakSet;class Yg extends Ad{constructor(t,e){super(t,{id:e.id,stateless:!1}),Lg(this,Gg),Vg(this,"name",""),this.name=e.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(t,e)=>(Object(s["addClass"])(e.parentNode,"htFiltersMenuOperators"),Object(f["arrayEach"])(this.elements,t=>e.appendChild(t.element)),e)}}buildOperatorsElement(){const t=[Cg,Eg];Object(f["arrayEach"])(t,e=>{const n=new Dg(this.hot,{name:"operator",label:{htmlFor:e,textContent:vg(e)},value:e,checked:e===t[zg],id:e});n.addLocalHook("change",t=>Ug(Gg,this,Xg).call(this,t)),this.elements.push(n)})}setChecked(t){if(this.elements.length<t)throw Error(os["a"]`Radio button with index ${t} doesn't exist.`);Object(f["arrayEach"])(this.elements,(e,n)=>{e.setChecked(n===t)})}getActiveOperationId(){const t=this.elements.find(t=>t instanceof Dg&&t.isChecked());return t?t.getValue():Cg}getState(){return this.getActiveOperationId()}setState(t){this.reset(),t&&this.getActiveOperationId()!==t&&Object(f["arrayEach"])(this.elements,e=>{e.setChecked(e.getValue()===t)})}updateState(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Cg,e=arguments.length>1?arguments[1]:void 0,n=t;n===Mg&&(n=Eg),this.state.setValueAtIndex(e,n)}reset(){this.setChecked(zg)}}function Xg(t){this.setState(t.target.value)}Object(vn["getComparisonFunction"])();function $g(t,e){let n=t;return""===n&&(n=`(${e})`),n}const Kg=new Set([1]).has(1),qg=Kg&&"function"===typeof Array.from;function Qg(t){let e=t;return Kg&&(e=new Set(e)),function(t){let n;return n=Kg?e.has(t):!!~e.indexOf(t),n}}function Jg(t){return null===t||void 0===t?"":t}function Zg(t){let e=t;return e=qg?Array.from(new Set(e)):Object(f["arrayUnique"])(e),e=e.sort((t,e)=>"number"===typeof t&&"number"===typeof e?t-e:t===e?0:t>e?1:-1),e}function tp(t,e,n,o){const i=[],r=t===e;let s;return r||(s=Qg(e)),Object(f["arrayEach"])(t,t=>{let e=!1;(r||s(t))&&(e=!0);const a={checked:e,value:t,visualValue:$g(t,n)};o&&o(a),i.push(a)}),i}var ep=n("480c");function np(t,e,n){op(t,e),e.set(t,n)}function op(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ip(t,e){return t.get(sp(t,e))}function rp(t,e,n){return t.set(sp(t,e),n),n}function sp(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ap=new WeakMap;class lp extends _f{static get DEFAULTS(){return Object(l["clone"])({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(t,e){super(t,Object(l["extend"])(lp.DEFAULTS,e)),np(this,ap,void 0)}build(){super.build(),rp(ap,this,this._element.firstChild)}update(){this.isBuilt()&&(ip(ap,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&ip(ap,this).focus()}activate(){ip(ap,this).click()}}function cp(t,e){up(t,e),e.add(t)}function hp(t,e,n){up(t,e),e.set(t,n)}function up(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dp(t,e){return t.get(gp(t,e))}function fp(t,e,n){return t.set(gp(t,e),n),n}function gp(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const pp="multipleSelect.itemBox";var mp=new WeakMap,bp=new WeakMap,wp=new WeakMap,vp=new WeakMap,yp=new WeakMap,Cp=new WeakMap,Sp=new WeakSet;class Op extends _f{static get DEFAULTS(){return Object(l["clone"])({className:"htUIMultipleSelect",value:[]})}constructor(t,e){super(t,Object(l["extend"])(Op.DEFAULTS,e)),cp(this,Sp),hp(this,mp,[]),hp(this,bp,void 0),hp(this,wp,void 0),hp(this,vp,void 0),hp(this,yp,void 0),hp(this,Cp,void 0),fp(vp,this,new Uf(this.hot,{placeholder:Ft["FILTERS_BUTTONS_PLACEHOLDER_SEARCH"],className:"htUIMultipleSelectSearch"})),fp(yp,this,new lp(this.hot,{textContent:Ft["FILTERS_BUTTONS_SELECT_ALL"],className:"htUISelectAll"})),fp(Cp,this,new lp(this.hot,{textContent:Ft["FILTERS_BUTTONS_CLEAR"],className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return dp(bp,this)}registerHooks(){dp(vp,this).addLocalHook("keydown",t=>gp(Sp,this,Rp).call(this,t)),dp(vp,this).addLocalHook("input",t=>gp(Sp,this,Ep).call(this,t)),dp(yp,this).addLocalHook("click",t=>gp(Sp,this,Tp).call(this,t)),dp(Cp,this).addLocalHook("click",t=>gp(Sp,this,Mp).call(this,t))}setItems(t){var e;fp(mp,this,t),null===(e=dp(bp,this))||void 0===e||e.loadData(dp(mp,this))}setLocale(t){fp(wp,this,t)}getLocale(){return dp(wp,this)}getItems(){return[...dp(mp,this)]}getValue(){return xp(dp(mp,this))}getSearchInputElement(){return dp(vp,this)}getSelectAllElement(){return dp(yp,this)}getClearAllElement(){return dp(Cp,this)}isSelectedAllValues(){return dp(mp,this).length===this.getValue().length}build(){super.build();const{rootDocument:t}=this.hot,e=t.createElement("div"),n=new _f(this.hot,{className:"htUISelectionControls",children:[dp(yp,this),dp(Cp,this)]});this._element.appendChild(dp(vp,this).element),this._element.appendChild(n.element),this._element.appendChild(e);const o=e=>{var n;if(!this._element)return;null===(n=dp(bp,this))||void 0===n||n.destroy(),Object(s["addClass"])(e,"htUIMultipleSelectHot"),fp(bp,this,new this.hot.constructor(e,{data:dp(mp,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(t,e,n,o,i,r)=>{t.title=r.instance.getDataAtRowProp(e,r.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{dp(bp,this).listen()},colWidths:()=>dp(bp,this).container.scrollWidth-Object(s["getScrollbarWidth"])(t),maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),dp(bp,this).init();const o=dp(bp,this).getShortcutManager(),i=o.getContext("grid");i.removeShortcutsByKeys(["Tab"]),i.removeShortcutsByKeys(["Shift","Tab"]),i.addShortcut({keys:[["Escape"]],callback:t=>{this.runLocalHooks("keydown",t,this)},group:pp}),i.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:t=>{dp(bp,this).deselectCell(),this.runLocalHooks("keydown",t,this),this.runLocalHooks("listTabKeydown",t,this)},group:pp})};o(e),this.hot._registerTimeout(()=>o(e),100)}focus(){this.isBuilt()&&dp(bp,this).listen()}reset(){dp(vp,this).reset(),dp(yp,this).reset(),dp(Cp,this).reset()}update(){this.isBuilt()&&(dp(bp,this).loadData(Ip(dp(mp,this),this.options.value)),super.update())}destroy(){var t;null===(t=dp(bp,this))||void 0===t||t.destroy(),dp(vp,this).destroy(),dp(Cp,this).destroy(),dp(yp,this).destroy(),fp(vp,this,null),fp(Cp,this,null),fp(yp,this,null),fp(bp,this,null),fp(mp,this,null),super.destroy()}}function Ep(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());let n;n=""===e?[...dp(mp,this)]:dp(mp,this).filter(t=>(""+t.value).toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),dp(bp,this).loadData(n)}function Rp(t){this.runLocalHooks("keydown",t,this);const e=Object(Li["partial"])(m["isKey"],t.keyCode);e("ARROW_DOWN")&&(t.preventDefault(),Object(a["stopImmediatePropagation"])(t),dp(bp,this).listen(),dp(bp,this).selectCell(0,0))}function Tp(t){const e=[];t.preventDefault(),dp(bp,this).getSourceData().forEach((t,n)=>{t.checked=!0,e.push(Object(ep["dataRowToChangesArray"])(t,n)[0])}),dp(bp,this).setSourceDataAtCell(e)}function Mp(t){const e=[];t.preventDefault(),dp(bp,this).getSourceData().forEach((t,n)=>{t.checked=!1,e.push(Object(ep["dataRowToChangesArray"])(t,n)[0])}),dp(bp,this).setSourceDataAtCell(e)}function Ip(t,e){const n=Qg(e);return t.map(t=>(t.checked=n(t.value),t))}function xp(t){const e=[];return t.forEach(t=>{t.checked&&e.push(t.value)}),e}const Np="by_value";function Ap(t,e){let[n]=e;return n(t.value)}function Hp(t,e){jp(t,e),e.add(t)}function jp(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _p(t,e,n){return(e=kp(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kp(t){var e=Pp(t,"string");return"symbol"==typeof e?e:e+""}function Pp(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Dp(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}kd(Np,Ap,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[Qg(e)]},showOperators:!1});var Lp,Fp=new WeakSet;class Vp extends Ad{constructor(t,e){super(t,{id:e.id,stateless:!1}),Hp(this,Fp),_p(this,"name",""),this.name=e.name,this.elements.push(new Op(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",t=>Dp(Fp,this,Wp).call(this,t)).addLocalHook("listTabKeydown",t=>this.runLocalHooks("listTabKeydown",t)),this.hot.addHook("modifyFiltersMultiSelectValue",(t,e)=>Dp(Fp,this,Up).call(this,t,e))}getElements(){const t=this.getMultipleSelectElement();return[t.getSearchInputElement(),t.getSelectAllElement(),t.getClearAllElement(),this.getMultipleSelectElement()]}setState(t){if(this.reset(),t&&t.command.key===Np){const e=this.getMultipleSelectElement();e.setItems(t.itemsSnapshot),e.setValue(t.args[0]),e.setLocale(t.locale)}}getState(){const t=this.getMultipleSelectElement(),e=t.getItems();return{command:{key:t.isSelectedAllValues()||!e.length?Pd:Np},args:[t.getValue()],itemsSnapshot:e}}updateState(t){const e=(e,n,o,i,r)=>{const[s]=Object(f["arrayFilter"])(n,t=>t.name===Np),a={},l=this.hot.getTranslatedPhrase(Ft["FILTERS_VALUES_BLANK_CELLS"]);if(s){const n=i(e,r),c=Object(f["arrayMap"])(n,t=>t.value),h=new Map(n.map(t=>[t.value,this.hot.getCellMeta(t.meta.visualRow,t.meta.visualCol)])),u=Zg(c);o&&(s.args[0]=o);const d=[],g=tp(u,s.args[0],l,t=>{t.checked&&d.push(t.value),Dp(Fp,this,Bp).call(this,t,h)}),p=t.editedConditionStack.column;a.locale=this.hot.getCellMeta(0,p).locale,a.args=[d],a.command=_d(Np),a.itemsSnapshot=g}else a.args=[],a.command=_d(Pd);this.state.setValueAtIndex(e,a)};e(t.editedConditionStack.column,t.editedConditionStack.conditions,t.conditionArgsChange,t.filteredRowsFactory),t.dependentConditionStacks.length&&e(t.dependentConditionStacks[0].column,t.dependentConditionStacks[0].conditions,t.conditionArgsChange,t.filteredRowsFactory,t.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(t=>t instanceof Op)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(t,e,n,o,i,r)=>{Object(s["addClass"])(e.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return Object(s["addClass"])(a,"htFiltersMenuLabel"),a.textContent=r,e.appendChild(a),e.parentElement.hasAttribute("ghost-table")||Object(f["arrayEach"])(this.elements,t=>e.appendChild(t.element)),e}}}reset(){const t=this.hot.getTranslatedPhrase(Ft["FILTERS_VALUES_BLANK_CELLS"]),e=this._getColumnVisibleValues(),n=e.map(t=>t.value),o=new Map(e.map(t=>[t.value,t.meta])),i=Zg(n),r=tp(i,i,t,t=>{Dp(Fp,this,Bp).call(this,t,o)});this.getMultipleSelectElement().setItems(r),super.reset(),this.getMultipleSelectElement().setValue(i);const s=this.hot.getPlugin("filters").getSelectedColumn();null!==s&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,s.visualIndex).locale)}_getColumnVisibleValues(){const t=this.hot.getPlugin("filters").getSelectedColumn();return null===t?[]:Object(f["arrayMap"])(this.hot.getDataAtCol(t.visualIndex),(e,n)=>({value:Jg(e),meta:this.hot.getCellMeta(n,t.visualIndex)}))}}function Wp(t){Object(m["isKey"])(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Object(a["stopImmediatePropagation"])(t))}function Bp(t,e){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(t.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",t.visualValue,e.get(t.value)))}function Up(t,e){switch(e.type){case"numeric":return se(t,e);default:return t}}function zp(t,e){Gp(t,e),e.add(t)}function Gp(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yp(t,e,n){return(e=Xp(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xp(t){var e=$p(t,"string");return"symbol"==typeof e?e:e+""}function $p(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Kp(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var qp=new WeakSet;class Qp extends Ad{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(t,e){super(t,{id:e.id,stateless:!0}),zp(this,qp),Yp(this,"name",""),this.name=e.name,this.elements.push(new Uf(this.hot,{type:"button",value:Ft["FILTERS_BUTTONS_OK"],className:"htUIButton htUIButtonOK",identifier:Qp.BUTTON_OK})),this.elements.push(new Uf(this.hot,{type:"button",value:Ft["FILTERS_BUTTONS_CANCEL"],className:"htUIButton htUIButtonCancel",identifier:Qp.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){Object(f["arrayEach"])(this.elements,t=>{t.addLocalHook("click",(t,e)=>Kp(qp,this,Jp).call(this,t,e))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(t,e)=>(Object(s["addClass"])(e.parentNode,"htFiltersMenuActionBar"),Object(f["arrayEach"])(this.elements,t=>e.appendChild(t.element)),e)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}function Jp(t,e){e.options.identifier===Lp.BUTTON_OK?this.accept():this.cancel()}function Zp(t,e,n){return(e=tm(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tm(t){var e=em(t,"string");return"symbol"==typeof e?e:e+""}function em(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}Lp=Qp;const nm="ConditionCollection.filteringStates";class om{constructor(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];Zp(this,"hot",void 0),Zp(this,"isMapRegistrable",void 0),Zp(this,"filteringStates",new Vi["a"]),Zp(this,"previousConditionStack",null),this.hot=t,this.isMapRegistrable=e,!0===this.isMapRegistrable?this.hot.columnIndexMapper.registerMap(nm,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return 0===this.getFilteredColumns().length}isMatch(t,e){var n;const o=this.filteringStates.getValueAtIndex(e),i=null!==(n=null===o||void 0===o?void 0:o.conditions)&&void 0!==n?n:[],r=null===o||void 0===o?void 0:o.operation;return this.isMatchInConditions(i,t,r)}isMatchInConditions(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Cg;return!t.length||wg(n)(t,e)}addCondition(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Cg,o=arguments.length>3?arguments[3]:void 0;const i=this.hot.getCellMeta(0,t).locale,r=Object(f["arrayMap"])(e.args,t=>"string"===typeof t?t.toLocaleLowerCase(i):t),s=e.name||e.command.key;null===this.previousConditionStack&&this.setPreviousConditionStack(this.exportAllConditions()),this.runLocalHooks("beforeAdd",t);const a=this.getOperation(t);if(a){if(a!==n)throw Error(os["a"]`The column of index ${t} has been already applied with a \`${a}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(Object(g["isUndefined"])(bg[n]))throw new Error(os["a"]`Unexpected operation named \`${n}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const l=this.getConditions(t);0===l.length?this.filteringStates.setValueAtIndex(t,{operation:n,conditions:[{name:s,args:r,func:jd(s,r)}]},o):l.push({name:s,args:r,func:jd(s,r)}),this.runLocalHooks("afterAdd",t)}getConditions(t){var e,n;return null!==(e=null===(n=this.filteringStates.getValueAtIndex(t))||void 0===n?void 0:n.conditions)&&void 0!==e?e:[]}getOperation(t){var e;return null===(e=this.filteringStates.getValueAtIndex(t))||void 0===e?void 0:e.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(t=>{let[e]=t;return e})}getColumnStackPosition(t){return this.getFilteredColumns().indexOf(t)}exportAllConditions(){return Object(f["arrayReduce"])(this.filteringStates.getEntries(),(t,e)=>{let[n,{operation:o,conditions:i}]=e;return t.push({column:n,operation:o,conditions:Object(f["arrayMap"])(i,t=>{let{name:e,args:n}=t;return{name:e,args:n}})}),t},[])}importAllConditions(t){this.clean(),Object(f["arrayEach"])(t,t=>{Object(f["arrayEach"])(t.conditions,e=>this.addCondition(t.column,e))})}removeConditions(t){this.setPreviousConditionStack(this.exportAllConditions()),this.runLocalHooks("beforeRemove",t),this.filteringStates.clearValue(t),this.runLocalHooks("afterRemove",t)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(t,e){const n=this.getConditions(t);return e?n.some(t=>t.name===e):n.length>0}setPreviousConditionStack(t){this.previousConditionStack=t}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(nm),this.filteringStates=null,this.clearLocalHooks()}}Object(l["mixin"])(om,vs["a"]);var im=om;function rm(t,e,n){return(e=sm(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sm(t){var e=am(t,"string");return"symbol"==typeof e?e:e+""}function am(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class lm{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>[];rm(this,"conditionCollection",void 0),rm(this,"columnDataFactory",void 0),this.conditionCollection=t,this.columnDataFactory=e}filter(){let t=[];return Object(f["arrayEach"])(this.conditionCollection.getFilteredColumns(),(e,n)=>{let o=this.columnDataFactory(e);n&&(o=this._getIntersectData(o,t)),t=this.filterByColumn(e,o)}),t}filterByColumn(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const n=[];return Object(f["arrayEach"])(e,e=>{void 0!==e&&this.conditionCollection.isMatch(e,t)&&n.push(e)}),n}_getIntersectData(t,e){const n=[];return Object(f["arrayEach"])(e,e=>{const o=e.meta.visualRow;void 0!==t[o]&&(n[o]=t[o])}),n}}var cm=lm;function hm(t,e){um(t,e),e.add(t)}function um(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dm(t,e,n){return(e=fm(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fm(t){var e=gm(t,"string");return"symbol"==typeof e?e:e+""}function gm(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function pm(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var mm=new WeakSet;class bm{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>[];hm(this,mm),dm(this,"hot",void 0),dm(this,"conditionCollection",void 0),dm(this,"columnDataFactory",void 0),dm(this,"changes",[]),dm(this,"grouping",!1),dm(this,"latestEditedColumnPosition",-1),dm(this,"latestOrderStack",[]),this.hot=t,this.conditionCollection=e,this.columnDataFactory=n,this.conditionCollection.addLocalHook("beforeRemove",t=>pm(mm,this,wm).call(this,t)),this.conditionCollection.addLocalHook("afterRemove",t=>this.updateStatesAtColumn(t)),this.conditionCollection.addLocalHook("afterAdd",t=>this.updateStatesAtColumn(t)),this.conditionCollection.addLocalHook("beforeClean",()=>pm(mm,this,vm).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>pm(mm,this,ym).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,Object(f["arrayEach"])(this.changes,t=>{this.updateStatesAtColumn(t)}),this.changes.length=0}updateStatesAtColumn(t,e){var n=this;if(this.grouping)return void(-1===this.changes.indexOf(t)&&this.changes.push(t));const o=this.conditionCollection.exportAllConditions();let i=this.conditionCollection.getColumnStackPosition(t);-1===i&&(i=this.latestEditedColumnPosition);const r=o.slice(0,i),s=o.slice(i);s.length&&s[0].column===t&&s.shift();const a=Object(Li["curry"])((function(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];const i=new im(n.hot,!1),r=[].concat(t,o);i.importAllConditions(r);const s=n.columnDataFactory(e);let a;a=i.isEmpty()?s:new cm(i,t=>n.columnDataFactory(t)).filter(),a=Object(f["arrayMap"])(a,t=>t.meta.visualRow);const l=Qg(a);return i.destroy(),Object(f["arrayFilter"])(s,t=>l(t.meta.visualRow))}))(r),l=[].concat(this.conditionCollection.getConditions(t));this.runLocalHooks("update",{editedConditionStack:{column:t,conditions:l},dependentConditionStacks:s,filteredRowsFactory:a,conditionArgsChange:e})}destroy(){this.clearLocalHooks(),Object(l["objectEach"])(this,(t,e)=>{this[e]=null})}}function wm(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function vm(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function ym(){Object(f["arrayEach"])(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}Object(l["mixin"])(bm,vs["a"]);var Cm=bm;function Sm(t){const e=Xl({initialPage:0,size:()=>t.length,onItemSelect:(e,n)=>{const o=t[e];return o instanceof Op?n:!(o.element&&!Object(s["isVisible"])(o.element))&&void o.focus()}});return e}const Om="filters";function Em(t,e){let n=-1;const o=Sm(e),i=n=>()=>{t.isOpened()&&t.getKeyboardShortcutsCtrl().listen(Om),o.setCurrentPage(e.indexOf(n))};function r(i){const r=t.getKeyboardShortcutsCtrl(),s=i.getKeyboardShortcutsCtrl();o.clear(),s.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:r.getContext(Om),callback:()=>{i.isSubMenu()&&i.close(),r.listen(Om)}}]),i.isSubMenu()||r.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:e=>{const i=t.getNavigator();i.getCurrentPage()>-1&&(n=i.getCurrentPage()),i.clear(),e.shiftKey?o.toPreviousItem():o.toNextItem()}},{keys:[["Escape"]],callback:()=>{t.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:t=>{const n=e[o.getCurrentPage()];n instanceof og&&(n.openOptions(),t.preventDefault()),n instanceof lp&&(n.activate(),t.preventDefault()),n instanceof _f||t.preventDefault()}}],Om)}function s(){t.focus(),t.getKeyboardShortcutsCtrl().listen(Om)}function a(){return n}return e.forEach(t=>{t instanceof _f&&(t.addLocalHook("click",i(t)),t.addLocalHook("focus",i(t)),t.addLocalHook("afterClose",i(t)))}),t.addLocalHook("afterSelectionChange",t=>{t.key.startsWith("filter_")||o.clear()}),t.addLocalHook("afterSubmenuOpen",r),t.addLocalHook("afterOpen",r),{...o,listen:s,getLastMenuPage:a}}var Rm=n("00fd");function Tm(t,e){Im(t,e),e.add(t)}function Mm(t,e,n){Im(t,e),e.set(t,n)}function Im(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xm(t,e,n){return(e=Nm(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nm(t){var e=Am(t,"string");return"symbol"==typeof e?e:e+""}function Am(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Hm(t,e,n){return t.set(_m(t,e),n),n}function jm(t,e){return t.get(_m(t,e))}function _m(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const km="filters",Pm=250,Dm=km;var Lm=new WeakMap,Fm=new WeakSet;class Vm extends bn{static get PLUGIN_KEY(){return km}static get PLUGIN_PRIORITY(){return Pm}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(t){super(t),Tm(this,Fm),xm(this,"dropdownMenuPlugin",null),xm(this,"conditionCollection",null),xm(this,"conditionUpdateObserver",null),xm(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),xm(this,"filtersRowsMap",null),Mm(this,Lm,void 0),this.hot.addHook("afterGetColHeader",(t,e)=>_m(Fm,this,$m).call(this,t,e))}isEnabled(){return!!this.hot.getSettings()[km]}enablePlugin(){if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new Rm["a"]),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const t=this.hot.getSettings().dropdownMenu,e=t&&t.uiContainer||this.hot.rootDocument.body,n=t=>(t.addLocalHook("accept",()=>_m(Fm,this,Gm).call(this,"accept")),t.addLocalHook("cancel",()=>_m(Fm,this,Gm).call(this,"cancel")),t.addLocalHook("change",e=>_m(Fm,this,Ym).call(this,t,e)),t),o=()=>this.hot.getTranslatedPhrase(Ft["FILTERS_DIVS_FILTER_BY_CONDITION"])+":",i=()=>this.hot.getTranslatedPhrase(Ft["FILTERS_DIVS_FILTER_BY_VALUE"])+":";if(!this.components.get("filter_by_condition")){const t=new gg(this.hot,{id:"filter_by_condition",name:o,addSeparator:!1,menuContainer:e});t.addLocalHook("afterClose",()=>_m(Fm,this,Xm).call(this)),this.components.set("filter_by_condition",n(t))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new Yg(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const t=new gg(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:e});t.addLocalHook("afterClose",()=>_m(Fm,this,Xm).call(this)),this.components.set("filter_by_condition2",n(t))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",n(new Vp(this.hot,{id:"filter_by_value",name:i}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",n(new Qp(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new im(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new Cm(this.hot,this.conditionCollection,t=>this.getDataMapAtColumn(t)),this.conditionUpdateObserver.addLocalHook("update",t=>_m(Fm,this,Km).call(this,t))),this.components.forEach(t=>t.show()),this.addHook("afterDropdownMenuDefaultOptions",t=>_m(Fm,this,zm).call(this,t)),this.addHook("afterDropdownMenuShow",()=>_m(Fm,this,Bm).call(this)),this.addHook("afterDropdownMenuHide",()=>_m(Fm,this,Um).call(this)),this.addHook("afterChange",t=>_m(Fm,this,Wm).call(this,t)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!jm(Lm,this)&&this.dropdownMenuPlugin.enabled){const t=this.dropdownMenuPlugin.menu,e=[{focus:()=>{const e=t.getNavigator(),n=jm(Lm,this).getLastMenuPage();t.focus(),n>0?e.setCurrentPage(n):e.toFirstItem()}},...Array.from(this.components).map(t=>{let[,e]=t;return e.getElements()}).flat()];Hm(Lm,this,Em(t,e));const n=t=>{jm(Lm,this).listen(),t.preventDefault(),Object(m["isKey"])(t.keyCode,"TAB")&&(t.shiftKey?jm(Lm,this).toPreviousItem():jm(Lm,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",n),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",n)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){var t;this.enabled&&(null!==(t=this.dropdownMenuPlugin)&&void 0!==t&&t.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((t,e)=>{t.destroy(),this.components.set(e,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName));this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const t=this.hot.getSelected();this.clearConditions(),this.filter(),t&&this.hot.selectCells(t)},group:Dm})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Dm)}addCondition(t,e,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Cg;const i=this.hot.toPhysicalColumn(t);this.conditionCollection.addCondition(i,{command:{key:e},args:n},o)}removeConditions(t){const e=this.hot.toPhysicalColumn(t);this.conditionCollection.removeConditions(e)}clearConditions(t){if(void 0===t)this.conditionCollection.clean();else{const e=this.hot.toPhysicalColumn(t);this.conditionCollection.removeConditions(e)}}filter(){const{navigableHeaders:t}=this.hot.getSettings(),e=this._createDataFilter(),n=!this.conditionCollection.isEmpty();let o=[];const i=this.conditionCollection.exportAllConditions(),r=this.hot.runHooks("beforeFilter",i,this.conditionCollection.previousConditionStack);if(!1!==r)if(n){const n=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),o=Object(f["arrayMap"])(e.filter(),t=>t.meta.visualRow);const t=Qg(o);Object(ie["rangeEach"])(this.hot.countSourceRows()-1,e=>{t(e)||n.push(e)}),Object(f["arrayEach"])(n,t=>{this.filtersRowsMap.setValueAtIndex(t,!0)})},!0),t||o.length||this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",i),this.conditionCollection.setPreviousConditionStack(null),this.hot.view.adjustElementsSize(),this.hot.render(),this.hot.selection.isSelected()&&this.hot.selectCell(t?-1:0,this.hot.getSelectedRangeLast().highlight.col)}getSelectedColumn(){var t;const e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return e?{visualIndex:e.col,physicalIndex:this.hot.toPhysicalColumn(e.col)}:null}getDataMapAtColumn(t){const e=this.hot.toVisualColumn(t),n=[];return Object(f["arrayEach"])(this.hot.getSourceDataAtCol(e),(t,o)=>{var i;const{row:r,col:s,visualCol:a,visualRow:l,type:c,instance:h,dateFormat:u,locale:d}=this.hot.getCellMeta(o,e),f=null!==(i=this.hot.getDataAtCell(this.hot.toVisualRow(o),e))&&void 0!==i?i:t;n.push({meta:{row:r,col:s,visualCol:a,visualRow:l,type:c,instance:h,dateFormat:u,locale:d},value:Jg(f)})}),n}updateValueComponentCondition(t){const e=this.hot.getDataAtCol(t),n=Zg(e);this.conditionUpdateObserver.updateStatesAtColumn(t,n)}restoreComponents(t){var e;const n=null===(e=this.getSelectedColumn())||void 0===e?void 0:e.physicalIndex;t.forEach(t=>{t.isHidden()||t.restoreState(n)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(t,e,n,o){let i=t;return i===Eg&&e.command.key!==Pd&&n.command.key!==Pd&&o.command.key!==Pd?i=Mg:o.command.key!==Pd&&(e.command.key!==Pd&&n.command.key!==Pd||(i=Cg)),i}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const t=this.components.get("filter_by_condition"),{command:e}=t.getState(),n=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];e.showOperators?this.showComponents(...n):this.hideComponents(...n)}_createDataFilter(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.conditionCollection;return new cm(t,t=>this.getDataMapAtColumn(t))}getIndexesOfComponents(){const t=[];if(!this.dropdownMenuPlugin)return t;const e=this.dropdownMenuPlugin.menu;for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return Object(f["arrayEach"])(o,n=>{Object(f["arrayEach"])(e.menuItems,(e,o)=>{e.key===n.getMenuItemDescriptor().key&&t.push(o)})}),t}changeComponentsVisibility(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.dropdownMenuPlugin)return;const e=this.dropdownMenuPlugin.menu,n=e.hotMenu,o=n.getPlugin("hiddenRows");for(var i=arguments.length,r=new Array(i>1?i-1:0),s=1;s<i;s++)r[s-1]=arguments[s];const a=this.getIndexesOfComponents(...r);t?o.showRows(a):o.hideRows(a),n.render()}hideComponents(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.changeComponentsVisibility(!1,...e)}showComponents(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.changeComponentsVisibility(!0,...e)}destroy(){this.enabled&&(this.components.forEach((t,e)=>{null!==t&&(t.destroy(),this.components.set(e,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function Wm(t){t&&Object(f["arrayEach"])(t,t=>{const[,e]=t,n=this.hot.propToCol(e);this.conditionCollection.hasConditions(n)&&this.updateValueComponentCondition(n)})}function Bm(){const t=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),t.updateMenuDimensions()}function Um(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function zm(t){t.items.push({name:Zs}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function Gm(t){var e;if("accept"===t){const t=this.getSelectedColumn();var n;if(null===t)return void(null===(n=this.dropdownMenuPlugin)||void 0===n||n.close());const{physicalIndex:e}=t,o=this.components.get("filter_by_condition").getState(),i=this.components.get("filter_by_condition2").getState(),r=this.components.get("filter_by_value").getState(),s=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),o,i,r);this.conditionUpdateObserver.groupChanges();let a=this.conditionCollection.getColumnStackPosition(e);-1===a&&(a=void 0),this.conditionCollection.removeConditions(e),o.command.key!==Pd&&(this.conditionCollection.addCondition(e,o,s,a),i.command.key!==Pd&&this.conditionCollection.addCondition(e,i,s,a)),r.command.key!==Pd&&this.conditionCollection.addCondition(e,r,s,a),this.conditionUpdateObserver.flush(),this.components.forEach(t=>t.saveState(e)),this.filtersRowsMap.clear(),this.filter()}null===(e=this.dropdownMenuPlugin)||void 0===e||e.close()}function Ym(t,e){this.updateDependentComponentsVisibility(),t.constructor!==gg||e.inputsCount||this.setListeningDropdownMenu()}function Xm(){this.setListeningDropdownMenu()}function $m(t,e){const n=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(n)?Object(s["addClass"])(e,"htFiltersActive"):Object(s["removeClass"])(e,"htFiltersActive")}function Km(t){var e;if(null===(e=this.dropdownMenuPlugin)||void 0===e||!e.enabled)return;const{editedConditionStack:{conditions:n,column:o}}=t,i=n.filter(t=>t.name===Np),r=n.filter(t=>t.name!==Np);if(i.length>=2||r.length>=3)Object(pi["b"])(os["a"]`The filter conditions have been applied properly, but couldnt be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const e=this.conditionCollection.getOperation(o);this.components.get("filter_by_condition").updateState(r[0],o),this.components.get("filter_by_condition2").updateState(r[1],o),this.components.get("filter_operators").updateState(e,o),this.components.get("filter_by_value").updateState(t)}}n("5b82");const qm="internal-use-in-handsontable",Qm={licenseKey:qm,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function Jm(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:null===(e=t[cw])||void 0===e||null===(e=e.language)||void 0===e?void 0:e.langCode}}function Zm(t){return Object.keys(t).reduce((e,n)=>("hyperformula"!==n&&(e[n]=t[n]),e),{})}function tb(t){var e;const n=t[cw],o=Zm(null!==n&&void 0!==n&&null!==(e=n.engine)&&void 0!==e&&e.hyperformula?n.engine:{}),i=Jm(t);return{...Qm,...o,...i}}function eb(t){var e;const n=t[cw],o=Zm(null!==n&&void 0!==n&&null!==(e=n.engine)&&void 0!==e&&e.hyperformula?n.engine:{}),i=Jm(t);return{...o,...i}}function nb(t,e){return Object.keys(e).some(n=>void 0!==e[n]&&e[n]!==t[n])}function ob(){const t="engine_relationship",e=Object(rr["a"])(cw);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function ib(){const t="shared_engine_usage",e=Object(rr["a"])(cw);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function rb(t){const e=t.getSettings(),n=e[cw],o=null===n||void 0===n?void 0:n.engine;if(!0===n)return null;if(Object(g["isUndefined"])(o))return null;var i;if("function"===typeof o.hyperformula||"function"===typeof o)return sb(null!==(i=o.hyperformula)&&void 0!==i?i:o,e,t);if("object"===typeof o&&Object(g["isUndefined"])(o.hyperformula)){const e=ob(),n=ib().get(o);return e.has(o)||e.set(o,[]),e.get(o).push(t),n&&n.push(t.guid),o.getConfig().licenseKey||o.updateConfig({licenseKey:qm}),o.getConfig().leapYear1900===Qm.leapYear1900&&!1!==Object(l["isObjectEqual"])(o.getConfig().nullDate,Qm.nullDate)||Object(pi["b"])(os["a"]`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),o}return null}function sb(t,e,n){const o=e[cw],i=tb(e),r=ob(),s=ib();cb(t,o.functions),hb(t,o.language);const a=t.buildEmpty(i);return r.set(a,[n]),s.set(a,[n.guid]),ub(a,o.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function ab(t){var e;const n=ob(),o=0===n.size?[]:Array.from(null!==(e=n.get(t))&&void 0!==e?e:[]);return new Map(o.map(t=>[t.getPlugin("formulas").sheetId,t]))}function lb(t,e){if(t){const n=ob(),o=n.get(t),i=ib(),r=i.get(t);o&&o.includes(e)&&(o.splice(o.indexOf(e),1),0===o.length&&n.delete(t)),r&&r.includes(e.guid)&&(r.splice(r.indexOf(e.guid),1),0===r.length&&(i.delete(t),t.destroy()))}}function cb(t,e){e&&e.forEach(e=>{const{name:n,plugin:o,translations:i}=e;try{t.registerFunction(n,o,i)}catch(r){Object(pi["b"])(r.message)}})}function hb(t,e){if(e){const{langCode:o}=e;try{t.registerLanguage(o,e)}catch(n){Object(pi["b"])(n.message)}}}function ub(t,e){e&&(t.suspendEvaluation(),e.forEach(e=>{const{name:n,expression:o,scope:i,options:r}=e;try{t.addNamedExpression(n,o,i,r)}catch(s){Object(pi["b"])(s.message)}}),t.resumeEvaluation())}function db(t,e){return!Object(g["isUndefined"])(e)&&t.doesSheetExist(e)||(e=t.addSheet(e)),e}const fb="DD/MM/YYYY";function gb(t){return"string"===typeof t&&"'"===t.charAt(0)&&"="===t.charAt(1)}function pb(t){return gb(t)?t.substr(1):t}function mb(t){return"string"===typeof t&&t.startsWith("=")}function bb(t,e){return"string"===typeof t&&"date"===e}function wb(t,e){return j(t,e,!0).isValid()}function vb(t,e){return j(t,e,!0).format(fb)}function yb(t,e){return j(t,fb,!0).format(e)}function Cb(t,e){const n=-1,o=new Date(Date.UTC(0,0,t+n));return j(o).format(e)}function Sb(t,e,n){const o=Array.from(Array(n).keys()).filter(e=>!1===t.includes(e));var i;return 0===e?null!==(i=o[e])&&void 0!==i?i:0:o[e-1]+1}function Ob(t,e){const n=[];return t.forEach(t=>{const o={from:t,to:e};n.forEach(t=>{const e=t.from>t.to,n=t.to<=o.from,i=t.from>o.from;i&&n&&e&&(o.from+=1)}),o.from>=e&&(e+=1),n.push(o)}),n}function Eb(t){return t.forEach((e,n)=>{const o=t.slice(n+1);o.forEach(t=>{const n=t.from<t.to;t.from>e.from&&n&&(t.from-=1)})}),t}function Rb(t,e,n){const o=Ob(t,Sb(t,e,n));return Eb(o)}function Tb(t,e,n){Mb(t,e),e.set(t,n)}function Mb(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ib(t,e){return t.get(Nb(t,e))}function xb(t,e,n){return t.set(Nb(t,e),n),n}function Nb(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ab=new WeakMap,Hb=new WeakMap,jb=new WeakMap,_b=new WeakMap,kb=new WeakMap,Pb=new WeakMap,Db=new WeakMap;class Lb{constructor(t,e,n){Tb(this,Ab,void 0),Tb(this,Hb,void 0),Tb(this,jb,void 0),Tb(this,_b,[]),Tb(this,kb,[]),Tb(this,Pb,void 0),Tb(this,Db,[]),xb(Ab,this,t),xb(Hb,this,e),xb(jb,this,n)}setRemovedHfIndexes(t){return xb(Db,this,t.map(t=>{const e=Ib(Hb,this).getVisualFromPhysicalIndex(t);return this.getHfIndexFromVisualIndex(e)})),Ib(Db,this)}getRemovedHfIndexes(){return Ib(Db,this)}getHfIndexFromVisualIndex(t){const e=Ib(Hb,this).getIndexesSequence(),n=Ib(Hb,this).getNotTrimmedIndexes();return e.indexOf(n[t])}syncMoves(t){const e=1,n=`move${Object(p["toUpperCaseFirst"])(Ib(Ab,this))}s`;Ib(jb,this).getEngine().batch(()=>{t.forEach(t=>{const o=t.from!==t.to,i=t.from+1!==t.to;o&&i&&Ib(jb,this).getEngine()[n](Ib(jb,this).getSheetId(),t.from,e,t.to)})})}storeMovesInformation(t,e,n){!1!==n&&(xb(kb,this,t.map(t=>this.getHfIndexFromVisualIndex(t))),xb(Pb,this,this.getHfIndexFromVisualIndex(e)))}calculateAndSyncMoves(t,e){if(Ib(jb,this).isPerformingUndoRedo())return;if(!1===t||!1===e)return;const n=Rb(Ib(kb,this),Ib(Pb,this),Ib(Hb,this).getNumberOfIndexes());null===Ib(jb,this).getSheetId()?Ib(jb,this).getPostponeAction(()=>this.syncMoves(n)):this.syncMoves(n)}getIndexesChangeSyncMethod(){const t=`set${Object(p["toUpperCaseFirst"])(Ib(Ab,this))}Order`;return e=>{if(Ib(jb,this).isPerformingUndoRedo())return;const n=Ib(Hb,this).getIndexesSequence();if("update"===e&&n.length>0){const e=Ib(_b,this).map(t=>n.indexOf(t)),o=Ib(jb,this).getEngine().getSheetDimensions(Ib(jb,this).getSheetId());let i;i="row"===Ib(Ab,this)?o.height:o.width;const r=e.length;for(let t=r;t<i;t+=1)e.push(t);Ib(jb,this).getEngine()[t](Ib(jb,this).getSheetId(),e)}xb(_b,this,n)}}init(){xb(_b,this,Ib(Hb,this).getIndexesSequence())}}var Fb=Lb;function Vb(t,e,n){Wb(t,e),e.set(t,n)}function Wb(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bb(t,e){return t.get(zb(t,e))}function Ub(t,e,n){return t.set(zb(t,e),n),n}function zb(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Gb=new WeakMap,Yb=new WeakMap,Xb=new WeakMap,$b=new WeakMap,Kb=new WeakMap,qb=new WeakMap,Qb=new WeakMap;class Jb{constructor(t,e,n){Vb(this,Gb,void 0),Vb(this,Yb,void 0),Vb(this,Xb,void 0),Vb(this,$b,!1),Vb(this,Kb,!1),Vb(this,qb,null),Vb(this,Qb,null),Ub(Gb,this,new Fb("row",t,this)),Ub(Yb,this,new Fb("column",e,this)),Ub(Xb,this,n)}getForAxis(t){return Bb("row"===t?Gb:Yb,this)}setPerformUndo(t){Ub($b,this,t)}setPerformRedo(t){Ub(Kb,this,t)}isPerformingUndoRedo(){return Bb($b,this)||Bb(Kb,this)}getSheetId(){return Bb(Qb,this)}getEngine(){return Bb(qb,this)}getPostponeAction(){return Bb(Xb,this)}setupSyncEndpoint(t,e){Ub(qb,this,t),Ub(Qb,this,e),Bb(Gb,this).init(),Bb(Yb,this).init()}}var Zb=Jb;function tw(t,e){rw(t,e),e.add(t)}function ew(t,e,n){return(e=nw(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nw(t){var e=ow(t,"string");return"symbol"==typeof e?e:e+""}function ow(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function iw(t,e,n){rw(t,e),e.set(t,n)}function rw(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sw(t,e,n){return t.set(lw(t,e),n),n}function aw(t,e){return t.get(lw(t,e))}function lw(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const cw="formulas",hw=["maxRows","maxColumns","language"],uw=260;mt["a"].getSingleton().register("afterNamedExpressionAdded"),mt["a"].getSingleton().register("afterNamedExpressionRemoved"),mt["a"].getSingleton().register("afterSheetAdded"),mt["a"].getSingleton().register("afterSheetRemoved"),mt["a"].getSingleton().register("afterSheetRenamed"),mt["a"].getSingleton().register("afterFormulasValuesUpdate");const dw=t=>"UndoRedo.undo"===t||"UndoRedo.redo"===t||"auto"===t;var fw=new WeakMap,gw=new WeakMap,pw=new WeakMap,mw=new WeakSet;class bw extends bn{constructor(){var t;super(...arguments),t=this,tw(this,mw),iw(this,fw,!1),iw(this,gw,!1),iw(this,pw,[["valuesUpdated",function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return lw(mw,t,Pw).call(t,...n)}],["namedExpressionAdded",function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return lw(mw,t,Dw).call(t,...n)}],["namedExpressionRemoved",function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return lw(mw,t,Lw).call(t,...n)}],["sheetAdded",function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return lw(mw,t,Fw).call(t,...n)}],["sheetRenamed",function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return lw(mw,t,Vw).call(t,...n)}],["sheetRemoved",function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return lw(mw,t,Ww).call(t,...n)}]]),ew(this,"staticRegister",Object(rr["a"])("formulas")),ew(this,"engine",null),ew(this,"sheetName",null),ew(this,"indexSyncer",null),ew(this,"rowAxisSyncer",null),ew(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return cw}static get PLUGIN_PRIORITY(){return uw}static get SETTING_KEYS(){return[cw,...hw]}get sheetId(){return null===this.sheetName?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[cw]}enablePlugin(){var t,e=this;if(!this.enabled)if(this.engine=null!==(t=rb(this.hot))&&void 0!==t?t:this.engine,this.engine){if(null!==this.sheetName&&!this.engine.doesSheetExist(this.sheetName)){const t=this.addSheet(this.sheetName,this.hot.getSourceDataArray());!1!==t&&(this.sheetName=t)}this.addHook("beforeLoadData",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return lw(mw,e,yw).call(e,...n)})),this.addHook("afterLoadData",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return lw(mw,e,Sw).call(e,...n)})),this.addHook("beforeUpdateData",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return lw(mw,e,yw).call(e,...n)})),this.addHook("afterUpdateData",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return lw(mw,e,Sw).call(e,...n)})),this.addHook("modifyData",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return lw(mw,e,Ow).call(e,...n)})),this.addHook("modifySourceData",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return lw(mw,e,Ew).call(e,...n)})),this.addHook("beforeValidate",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return lw(mw,e,ww).call(e,...n)})),this.addHook("afterSetSourceDataAtCell",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return lw(mw,e,Tw).call(e,...n)})),this.addHook("afterSetDataAtCell",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return lw(mw,e,Rw).call(e,...n)})),this.addHook("afterSetDataAtRowProp",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return lw(mw,e,Rw).call(e,...n)})),this.addHook("beforeCreateRow",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return lw(mw,e,Mw).call(e,...n)})),this.addHook("beforeCreateCol",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return lw(mw,e,Iw).call(e,...n)})),this.addHook("afterCreateRow",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return lw(mw,e,Aw).call(e,...n)})),this.addHook("afterCreateCol",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return lw(mw,e,Hw).call(e,...n)})),this.addHook("beforeRemoveRow",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return lw(mw,e,xw).call(e,...n)})),this.addHook("beforeRemoveCol",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return lw(mw,e,Nw).call(e,...n)})),this.addHook("afterRemoveRow",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return lw(mw,e,jw).call(e,...n)})),this.addHook("afterRemoveCol",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return lw(mw,e,_w).call(e,...n)})),this.indexSyncer=new Zb(this.hot.rowIndexMapper,this.hot.columnIndexMapper,t=>{this.hot.addHookOnce("init",()=>{t()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(t,e,n,o)=>{this.rowAxisSyncer.storeMovesInformation(t,e,o)}),this.hot.addHook("beforeColumnMove",(t,e,n,o)=>{this.columnAxisSyncer.storeMovesInformation(t,e,o)}),this.hot.addHook("afterRowMove",(t,e,n,o,i)=>{this.rowAxisSyncer.calculateAndSyncMoves(o,i)}),this.hot.addHook("afterColumnMove",(t,e,n,o,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(o,i)}),this.hot.addHook("beforeColumnFreeze",(t,e)=>{this.columnAxisSyncer.storeMovesInformation([t],this.hot.getSettings().fixedColumnsStart,e)}),this.hot.addHook("afterColumnFreeze",(t,e)=>{this.columnAxisSyncer.calculateAndSyncMoves(e,e)}),this.hot.addHook("beforeColumnUnfreeze",(t,e)=>{this.columnAxisSyncer.storeMovesInformation([t],this.hot.getSettings().fixedColumnsStart-1,e)}),this.hot.addHook("afterColumnUnfreeze",(t,e)=>{this.columnAxisSyncer.calculateAndSyncMoves(e,e)}),this.addHook("afterCellMetaReset",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return lw(mw,e,Cw).call(e,...n)})),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return lw(mw,e,kw).call(e,...n)})),this.addHook("beforeAutofill",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return lw(mw,e,vw).call(e,...n)})),aw(pw,this).forEach(t=>{let[e,n]=t;return this.engine.on(e,n)}),super.enablePlugin()}else Object(pi["b"])("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.")}disablePlugin(){aw(pw,this).forEach(t=>{let[e,n]=t;return this.engine.off(e,n)}),lb(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(t){const e=eb(this.hot.getSettings());nb(this.engine.getConfig(),e)&&this.engine.updateConfig(e);const n=this.hot.getSettings()[cw];if(Object(g["isDefined"])(n)&&Object(g["isDefined"])(n.sheetName)&&n.sheetName!==this.sheetName&&this.switchSheet(n.sheetName),!t.data&&null===this.sheetName){const t=this.hot.getSettings()[cw].sheetName;t&&this.engine.doesSheetExist(t)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(null!==t&&void 0!==t?t:void 0,this.hot.getSourceDataArray())}super.updatePlugin(t)}destroy(){aw(pw,this).forEach(t=>{var e;let[n,o]=t;return null===(e=this.engine)||void 0===e?void 0:e.off(n,o)}),sw(pw,this,null),lb(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(t,e){if(Object(g["isDefined"])(e)&&!Object(ep["isArrayOfArrays"])(e))return Object(pi["b"])("The provided data should be an array of arrays."),!1;if(void 0!==t&&null!==t&&this.engine.doesSheetExist(t))return Object(pi["b"])("Sheet with the provided name already exists."),!1;try{const n=this.engine.addSheet(null!==t&&void 0!==t?t:void 0);return e&&this.engine.setSheetContent(this.engine.getSheetId(n),e),n}catch(n){return Object(pi["b"])(n.message),!1}}switchSheet(t){if(!this.engine.doesSheetExist(t))return void Object(pi["a"])(`The sheet named \`${t}\` does not exist, switch aborted.`);this.sheetName=t;const e=this.engine.getSheetSerialized(this.sheetId);e.length>0&&this.hot.loadData(e,Object(p["toUpperCaseFirst"])(cw)+".switchSheet")}getCellType(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId;const o=this.hot.toPhysicalRow(t),i=this.hot.toPhysicalColumn(e);return null!==o&&null!==i?this.engine.getCellType({sheet:n,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e)}):"EMPTY"}isFormulaCellType(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:n,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e)})}renderDependentSheets(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=new Set;t.forEach(t=>{var e;const o=null===t||void 0===t||null===(e=t.address)||void 0===e?void 0:e.sheet;void 0!==o&&(n.has(o)||n.add(o))}),ab(this.engine).forEach((t,o)=>{var i;(e||o!==this.sheetId)&&n.has(o)&&(t.render(),null===(i=t.view)||void 0===i||i.adjustElementsSize())})}validateDependentCells(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const n=t=>{var e;const{row:n,col:o,sheet:i}=null!==(e=null===t||void 0===t?void 0:t.address)&&void 0!==e?e:{};return Object(g["isDefined"])(i)?`${i}:${n}x${o}`:""},o=new Set(e.map(t=>n(t)));t.forEach(t=>{var e,i;const{row:r,col:s}=null!==(e=t.address)&&void 0!==e?e:{};if(!1===Object(g["isDefined"])(r)||!1===Object(g["isDefined"])(s)||r>=this.hot.countRows()||s>=this.hot.countCols())return;const a=null===t||void 0===t||null===(i=t.address)||void 0===i?void 0:i.sheet,l=n(t);if(void 0!==a&&!o.has(l)){const t=ab(this.engine).get(a);if(!t)return;t.validateCell(t.getDataAtCell(r,s),t.getCellMeta(r,s),()=>{})}})}syncChangeWithEngine(t,e,n){const o={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(o))return void Object(pi["b"])("Not possible to set cell data at "+JSON.stringify(o));const i=this.hot.getCellMeta(t,e);return bb(n,i.type)&&(wb(n,i.dateFormat)?n=vb(n,i.dateFormat):!1===mb(n)&&(n="'"+n)),this.engine.setCellContents(o,n)}}function ww(t,e,n){const o=this.hot.propToCol(n);if(this.isFormulaCellType(e,o)){const t={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId},n=this.hot.getCellMeta(e,o);let i=this.engine.getCellValue(t);return"date"===n.type&&Object(ie["isNumeric"])(i)&&(i=Cb(i,n.dateFormat)),"object"===typeof i&&null!==i?i.value:i}return t}function vw(t,e,n){const{row:o,col:i}=e.getTopStartCorner(),{row:r,col:s}=e.getBottomEndCorner(),{row:a,col:l}=n.getTopStartCorner(),{row:c,col:h}=n.getBottomEndCorner(),u={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId}},d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(c),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(h),sheet:this.sheetId}};if(!1===this.engine.isItPossibleToSetCellContents(d))return!1;const f=this.engine.getFillRangeData(u,d),{row:g,col:p}=u.start,{row:m,col:b}=u.end,w=m-g+1,v=b-p+1;for(let y=0;y<f.length;y+=1)for(let t=0;t<f[y].length;t+=1){const e=f[y][t],n=g+y%w,o=p+t%v,i=this.hot.getCellMeta(n,o);bb(e,i.type)&&(e.startsWith("'")?f[y][t]=e.slice(1):!1===this.isFormulaCellType(n,o,this.sheetId)&&(f[y][t]=yb(e,i.dateFormat)))}return f}function yw(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";n.includes(Object(p["toUpperCaseFirst"])(cw))||sw(gw,this,Object(g["isUndefined"])(this.hot.getSettings().data))}function Cw(){const t=this.hot.getSourceDataArray();let e=!1;t.forEach((n,o)=>{n.forEach((n,i)=>{const r=this.hot.getCellMeta(o,i),s=r.dateFormat;bb(n,r.type)&&(e=!0,wb(n,s)?t[o][i]=vb(n,s):!1===this.isFormulaCellType(o,i)&&(t[o][i]="'"+n))})}),!0===e&&(sw(fw,this,!0),this.engine.setSheetContent(this.sheetId,t),sw(fw,this,!1))}function Sw(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(!n.includes(Object(p["toUpperCaseFirst"])(cw)))if(this.sheetName=db(this.engine,this.hot.getSettings()[cw].sheetName),aw(gw,this))this.switchSheet(this.sheetName);else{const t=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,t)){sw(fw,this,!0);const e=this.engine.setSheetContent(this.sheetId,t);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(e),sw(fw,this,!1)}}}function Ow(t,e,n,o){if("get"!==o||aw(fw,this)||null===this.sheetName||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t);if(null===i||null===e)return;const r=this.isFormulaCellType(i,e);if(!r){const t=this.getCellType(i,e);if("ARRAY"!==t)return void(gb(n.value)&&(n.value=pb(n.value)))}const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let a=this.engine.getCellValue(s),l=this.hot.getCellsMeta().find(t=>t.visualRow===i&&t.visualCol===e);void 0===l&&(l={}),"date"===l.type&&Object(ie["isNumeric"])(a)&&(a=Cb(a,l.dateFormat));const c="object"===typeof a&&null!==a?a.value:a;n.value=c}function Ew(t,e,n,o){if("get"!==o||aw(fw,this)||null===this.sheetName||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t),r=this.hot.propToCol(e);if(null===i||null===r)return;const s=this.isFormulaCellType(i,r);if(!s){const t=this.getCellType(i,r);if("ARRAY"!==t)return}const a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(0===a.width&&0===a.height)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId};n.value=this.engine.getCellSerialized(l)}function Rw(t,e){if(dw(e))return;const n=[],o=[],i=this.engine.batch(()=>{t.forEach(t=>{let[e,i,,r]=t;const s=this.hot.propToCol(i),a=this.hot.toPhysicalRow(e),l=this.hot.toPhysicalColumn(s),c={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId};null!==a&&null!==l?this.syncChangeWithEngine(e,s,r):n.push([e,s,r]),o.push({address:c})})});n.length&&this.hot.addHookOnce("afterChange",()=>{const t=this.engine.batch(()=>{n.forEach(t=>{let[e,n,o]=t;this.syncChangeWithEngine(e,n,o)})});this.renderDependentSheets(t,!0)}),this.renderDependentSheets(i),this.validateDependentCells(i,o)}function Tw(t,e){if(dw(e))return;const n=[],o=[];t.forEach(t=>{let[e,i,,r]=t;const s=this.hot.propToCol(i);if(!Object(ie["isNumeric"])(s))return;const a={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId};this.engine.isItPossibleToSetCellContents(a)?(o.push({address:a}),n.push(...this.engine.setCellContents(a,r))):Object(pi["b"])("Not possible to set source cell data at "+JSON.stringify(a))}),this.renderDependentSheets(n),this.validateDependentCells(n,o)}function Mw(t,e){let n=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(n=t),null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[n,e]))return!1}function Iw(t,e){let n=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(n=t),null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[n,e]))return!1}function xw(t,e,n){const o=this.rowAxisSyncer.setRemovedHfIndexes(n),i=o.every(t=>this.engine.isItPossibleToRemoveRows(this.sheetId,[t,1]));return!1!==i&&void 0}function Nw(t,e,n){const o=this.columnAxisSyncer.setRemovedHfIndexes(n),i=o.every(t=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[t,1]));return!1!==i&&void 0}function Aw(t,e,n){if(dw(n))return;const o=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(o)}function Hw(t,e,n){if(dw(n))return;const o=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(o)}function jw(t,e,n,o){if(dw(o))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort((t,e)=>e-t),r=this.engine.batch(()=>{i.forEach(t=>{this.engine.removeRows(this.sheetId,[t,1])})});this.renderDependentSheets(r)}function _w(t,e,n,o){if(dw(o))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort((t,e)=>e-t),r=this.engine.batch(()=>{i.forEach(t=>{this.engine.removeColumns(this.sheetId,[t,1])})});this.renderDependentSheets(r)}function kw(t,e,n){var o;sw(fw,this,!0);const i=this.hot.getSourceDataArray(n,0,n+((null===(o=e.__children)||void 0===o?void 0:o.length)||0),this.hot.countSourceCols());sw(fw,this,!1),i.forEach((t,e)=>{t.forEach((t,o)=>{this.engine.setCellContents({col:o,row:n+e,sheet:this.sheetId},[[t]])})})}function Pw(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function Dw(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function Lw(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function Fw(t){this.hot.runHooks("afterSheetAdded",t)}function Vw(t,e){this.sheetName=e,this.hot.runHooks("afterSheetRenamed",t,e)}function Ww(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function Bw(t){return{key:"hidden_columns_hide",name(){const t=this.getSelectedLast();let e=0;if(Array.isArray(t)){const[,n,,o]=t;n-o!==0&&(e=1)}return this.getTranslatedPhrase(Ft["CONTEXTMENU_ITEMS_HIDE_COLUMN"],e)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),o=Math.max(Math.min(e.col,n.col),0),i=Math.max(e.col,n.col),r=[];for(let t=o;t<=i;t+=1)r.push(t);t.hideColumns(r);const s=r[r.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function Uw(t){const e=[];return{key:"hidden_columns_show",name(){const t=e.length>1?1:0;return this.getTranslatedPhrase(Ft["CONTEXTMENU_ITEMS_SHOW_COLUMN"],t)},callback(){var n,o;if(0===e.length)return;let i=e[0],r=e[e.length-1];i=null!==(n=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))&&void 0!==n?n:0,r=null!==(o=this.columnIndexMapper.getNearestNotHiddenIndex(r+1,1))&&void 0!==o?o:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize();const s=r-i+1===this.countCols();s||this.selectColumns(i,r)},disabled:!1,hidden(){const n=Object(f["arrayMap"])(t.getHiddenColumns(),t=>this.toPhysicalColumn(t));if(!this.selection.isSelectedByColumnHeader()&&!this.selection.isSelectedByCorner()||n.length<1)return!0;e.length=0;const o=this.getSelectedRangeLast(),i=o.getTopStartCorner().col,r=o.getBottomEndCorner().col,s=this.columnIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(r),c=s.getNotTrimmedIndexes(),h=[];if(i!==r){const t=r-i+1,e=l-a+1;if(t>e){const t=c.slice(i,r+1);h.push(...t.filter(t=>n.includes(t)))}}else if(0===a&&a<i)h.push(...c.slice(0,i));else if(null===a)h.push(...c.slice(0,this.countCols()));else{const t=this.countCols()-1,e=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(t,-1));l===e&&t>r&&h.push(...c.slice(r+1))}return Object(f["arrayEach"])(h,t=>{e.push(this.toVisualColumn(t))}),0===e.length}}}var zw=n("cef7");function Gw(t,e){Xw(t,e),e.add(t)}function Yw(t,e,n){Xw(t,e),e.set(t,n)}function Xw(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $w(t,e){return t.get(qw(t,e))}function Kw(t,e,n){return t.set(qw(t,e),n),n}function qw(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}mt["a"].getSingleton().register("beforeHideColumns"),mt["a"].getSingleton().register("afterHideColumns"),mt["a"].getSingleton().register("beforeUnhideColumns"),mt["a"].getSingleton().register("afterUnhideColumns");const Qw="hiddenColumns",Jw=310;var Zw=new WeakMap,tv=new WeakMap,ev=new WeakSet;class nv extends bn{constructor(){super(...arguments),Gw(this,ev),Yw(this,Zw,{}),Yw(this,tv,null)}static get PLUGIN_KEY(){return Qw}static get PLUGIN_PRIORITY(){return Jw}isEnabled(){return!!this.hot.getSettings()[Qw]}enablePlugin(){var t=this;if(this.enabled)return;const e=this.hot.getSettings()[Qw];Object(l["isObject"])(e)&&(Kw(Zw,this,e),Object(g["isUndefined"])(e.copyPasteEnabled)&&(e.copyPasteEnabled=!0)),Kw(tv,this,new zw["a"]),$w(tv,this).addLocalHook("init",()=>qw(ev,this,lv).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,$w(tv,this)),this.addHook("afterContextMenuDefaultOptions",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return qw(ev,t,av).call(t,...n)})),this.addHook("afterGetCellMeta",(t,e,n)=>qw(ev,this,iv).call(this,t,e,n)),this.addHook("modifyColWidth",(t,e)=>qw(ev,this,ov).call(this,t,e),2),this.addHook("afterGetColHeader",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return qw(ev,t,sv).call(t,...n)})),this.addHook("modifyCopyableRange",t=>qw(ev,this,rv).call(this,t)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Kw(Zw,this,{}),super.disablePlugin(),this.resetCellsMeta()}showColumns(t){const e=this.getHiddenColumns(),n=this.isValidConfig(t);let o=e;const i=$w(tv,this).getValues().slice(),r=t.length>0;if(n&&r){const e=t.map(t=>this.hot.toPhysicalColumn(t));Object(f["arrayEach"])(e,t=>{i[t]=!1}),o=Object(f["arrayReduce"])(i,(t,e,n)=>(e&&t.push(this.hot.toVisualColumn(n)),t),[])}const s=this.hot.runHooks("beforeUnhideColumns",e,o,n&&r);!1!==s&&(n&&r&&$w(tv,this).setValues(i),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",e,o,n&&r,n&&o.length<e.length))}showColumn(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.showColumns(e)}hideColumns(t){const e=this.getHiddenColumns(),n=this.isValidConfig(t);let o=e;n&&(o=Array.from(new Set(e.concat(t))));const i=this.hot.runHooks("beforeHideColumns",e,o,n);!1!==i&&(n&&this.hot.batchExecution(()=>{Object(f["arrayEach"])(t,t=>{$w(tv,this).setValueAtIndex(this.hot.toPhysicalColumn(t),!0)})},!0),this.hot.runHooks("afterHideColumns",e,o,n,n&&o.length>e.length))}hideColumn(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.hideColumns(e)}getHiddenColumns(){return Object(f["arrayMap"])($w(tv,this).getHiddenIndexes(),t=>this.hot.toVisualColumn(t))}isHidden(t){return $w(tv,this).getValueAtIndex(this.hot.toPhysicalColumn(t))||!1}isValidConfig(t){const e=this.hot.countCols();return!!(Array.isArray(t)&&t.length>0)&&t.every(t=>Number.isInteger(t)&&t>=0&&t<e)}resetCellsMeta(){Object(f["arrayEach"])(this.hot.getCellsMeta(),t=>{t&&(t.skipColumnOnPaste=!1)})}destroy(){Kw(Zw,this,null),Kw(tv,this,null),super.destroy()}}function ov(t,e){return this.isHidden(e)?0:$w(Zw,this).indicators&&(this.isHidden(e+1)||this.isHidden(e-1))&&"number"===typeof t&&this.hot.hasColHeaders()?t+15:void 0}function iv(t,e,n){if(!1===$w(Zw,this).copyPasteEnabled&&this.isHidden(e)&&(n.skipColumnOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",-1===n.className.indexOf("afterHiddenColumn")&&(n.className+=" afterHiddenColumn");else if(n.className){const t=n.className.split(" ");if(t.length>0){const e=t.indexOf("afterHiddenColumn");e>-1&&t.splice(e,1),n.className=t.join(" ")}}}function rv(t){if($w(Zw,this).copyPasteEnabled)return t;const e=[],n=(t,n,o,i)=>{e.push({startRow:t,endRow:n,startCol:o,endCol:i})};return Object(f["arrayEach"])(t,t=>{let e=!0,o=0;Object(ie["rangeEach"])(t.startCol,t.endCol,i=>{this.isHidden(i)?(e||n(t.startRow,t.endRow,o,i-1),e=!0):(e&&(o=i),i===t.endCol&&n(t.startRow,t.endRow,o,i),e=!1)})}),e}function sv(t,e){if(!$w(Zw,this).indicators||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&n.push("beforeHiddenColumn"),Object(s["addClass"])(e,n)}function av(t){t.items.push({name:Zs},Bw(this),Uw(this))}function lv(){Array.isArray($w(Zw,this).columns)&&this.hideColumns($w(Zw,this).columns)}function cv(t){return{key:"hidden_rows_hide",name(){const t=this.getSelectedLast();let e=0;if(Array.isArray(t)){const[n,,o]=t;n-o!==0&&(e=1)}return this.getTranslatedPhrase(Ft["CONTEXTMENU_ITEMS_HIDE_ROW"],e)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),o=Math.max(Math.min(e.row,n.row),0),i=Math.max(e.row,n.row),r=[];for(let t=o;t<=i;t+=1)r.push(t);t.hideRows(r);const s=r[r.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function hv(t){const e=[];return{key:"hidden_rows_show",name(){const t=e.length>1?1:0;return this.getTranslatedPhrase(Ft["CONTEXTMENU_ITEMS_SHOW_ROW"],t)},callback(){var n,o;if(0===e.length)return;let i=e[0],r=e[e.length-1];i=null!==(n=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))&&void 0!==n?n:0,r=null!==(o=this.rowIndexMapper.getNearestNotHiddenIndex(r+1,1))&&void 0!==o?o:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize();const s=r-i+1===this.countRows();s||this.selectRows(i,r)},disabled:!1,hidden(){const n=Object(f["arrayMap"])(t.getHiddenRows(),t=>this.toPhysicalRow(t));if(!this.selection.isSelectedByRowHeader()&&!this.selection.isSelectedByCorner()||n.length<1)return!0;e.length=0;const o=this.getSelectedRangeLast(),i=o.getTopStartCorner().row,r=o.getBottomEndCorner().row,s=this.rowIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(r),c=s.getNotTrimmedIndexes(),h=[];if(i!==r){const t=r-i+1,e=l-a+1;if(t>e){const t=c.slice(i,r+1);h.push(...t.filter(t=>n.includes(t)))}}else if(0===a&&a<i)h.push(...c.slice(0,i));else if(null===a)h.push(...c.slice(0,this.countRows()));else{const t=this.countRows()-1,e=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(t,-1));l===e&&t>r&&h.push(...c.slice(r+1))}return Object(f["arrayEach"])(h,t=>{e.push(this.toVisualRow(t))}),0===e.length}}}function uv(t,e){fv(t,e),e.add(t)}function dv(t,e,n){fv(t,e),e.set(t,n)}function fv(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gv(t,e){return t.get(mv(t,e))}function pv(t,e,n){return t.set(mv(t,e),n),n}function mv(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}mt["a"].getSingleton().register("beforeHideRows"),mt["a"].getSingleton().register("afterHideRows"),mt["a"].getSingleton().register("beforeUnhideRows"),mt["a"].getSingleton().register("afterUnhideRows");const bv="hiddenRows",wv=320;var vv=new WeakMap,yv=new WeakMap,Cv=new WeakSet;class Sv extends bn{constructor(){super(...arguments),uv(this,Cv),dv(this,vv,{}),dv(this,yv,null)}static get PLUGIN_KEY(){return bv}static get PLUGIN_PRIORITY(){return wv}isEnabled(){return!!this.hot.getSettings()[bv]}enablePlugin(){var t=this;if(this.enabled)return;const e=this.hot.getSettings()[bv];Object(l["isObject"])(e)&&(pv(vv,this,e),Object(g["isUndefined"])(e.copyPasteEnabled)&&(e.copyPasteEnabled=!0)),pv(yv,this,new zw["a"]),gv(yv,this).addLocalHook("init",()=>mv(Cv,this,Iv).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,gv(yv,this)),this.addHook("afterContextMenuDefaultOptions",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return mv(Cv,t,Mv).call(t,...n)})),this.addHook("afterGetCellMeta",(t,e,n)=>mv(Cv,this,Ev).call(this,t,e,n)),this.addHook("modifyRowHeight",(t,e)=>mv(Cv,this,Ov).call(this,t,e)),this.addHook("afterGetRowHeader",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return mv(Cv,t,Tv).call(t,...n)})),this.addHook("modifyCopyableRange",t=>mv(Cv,this,Rv).call(this,t)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),pv(vv,this,{}),super.disablePlugin(),this.resetCellsMeta()}showRows(t){const e=this.getHiddenRows(),n=this.isValidConfig(t);let o=e;const i=gv(yv,this).getValues().slice(),r=t.length>0;if(n&&r){const e=t.map(t=>this.hot.toPhysicalRow(t));Object(f["arrayEach"])(e,t=>{i[t]=!1}),o=Object(f["arrayReduce"])(i,(t,e,n)=>(e&&t.push(this.hot.toVisualRow(n)),t),[])}const s=this.hot.runHooks("beforeUnhideRows",e,o,n&&r);!1!==s&&(n&&r&&gv(yv,this).setValues(i),this.hot.runHooks("afterUnhideRows",e,o,n&&r,n&&o.length<e.length))}showRow(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.showRows(e)}hideRows(t){const e=this.getHiddenRows(),n=this.isValidConfig(t);let o=e;n&&(o=Array.from(new Set(e.concat(t))));const i=this.hot.runHooks("beforeHideRows",e,o,n);!1!==i&&(n&&this.hot.batchExecution(()=>{Object(f["arrayEach"])(t,t=>{gv(yv,this).setValueAtIndex(this.hot.toPhysicalRow(t),!0)})},!0),this.hot.runHooks("afterHideRows",e,o,n,n&&o.length>e.length))}hideRow(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.hideRows(e)}getHiddenRows(){return Object(f["arrayMap"])(gv(yv,this).getHiddenIndexes(),t=>this.hot.toVisualRow(t))}isHidden(t){return gv(yv,this).getValueAtIndex(this.hot.toPhysicalRow(t))||!1}isValidConfig(t){const e=this.hot.countRows();return!!(Array.isArray(t)&&t.length>0)&&t.every(t=>Number.isInteger(t)&&t>=0&&t<e)}resetCellsMeta(){Object(f["arrayEach"])(this.hot.getCellsMeta(),t=>{t&&(t.skipRowOnPaste=!1)})}destroy(){pv(vv,this,null),pv(yv,this,null),super.destroy()}}function Ov(t,e){return this.isHidden(e)?0:t}function Ev(t,e,n){if(!1===gv(vv,this).copyPasteEnabled&&this.isHidden(t)&&(n.skipRowOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",-1===n.className.indexOf("afterHiddenRow")&&(n.className+=" afterHiddenRow");else if(n.className){const t=n.className.split(" ");if(t.length>0){const e=t.indexOf("afterHiddenRow");e>-1&&t.splice(e,1),n.className=t.join(" ")}}}function Rv(t){if(gv(vv,this).copyPasteEnabled)return t;const e=[],n=(t,n,o,i)=>{e.push({startRow:t,endRow:n,startCol:o,endCol:i})};return Object(f["arrayEach"])(t,t=>{let e=!0,o=0;Object(ie["rangeEach"])(t.startRow,t.endRow,i=>{this.isHidden(i)?(e||n(o,i-1,t.startCol,t.endCol),e=!0):(e&&(o=i),i===t.endRow&&n(o,i,t.startCol,t.endCol),e=!1)})}),e}function Tv(t,e){if(!gv(vv,this).indicators||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&n.push("beforeHiddenRow"),Object(s["addClass"])(e,n)}function Mv(t){t.items.push({name:Zs},cv(this),hv(this))}function Iv(){Array.isArray(gv(vv,this).rows)&&this.hideRows(gv(vv,this).rows)}function xv(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(Ft["CONTEXTMENU_ITEMS_FREEZE_COLUMN"])},callback(e,n){const[{start:{col:o}}]=n;t.freezeColumn(o),this.render(),this.view.adjustElementsSize()},hidden(){const t=this.getSelectedRange();let e=!1;return(void 0===t||t.length>1||t[0].from.col!==t[0].to.col||t[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(e=!0),e}}}function Nv(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(Ft["CONTEXTMENU_ITEMS_UNFREEZE_COLUMN"])},callback(e,n){const[{start:{col:o}}]=n;t.unfreezeColumn(o),this.render(),this.view.adjustElementsSize()},hidden(){const t=this.getSelectedRange();let e=!1;return(void 0===t||t.length>1||t[0].from.col!==t[0].to.col||t[0].from.col>=this.getSettings().fixedColumnsStart)&&(e=!0),e}}}function Av(t,e){jv(t,e),e.add(t)}function Hv(t,e,n){jv(t,e),e.set(t,n)}function jv(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _v(t,e){return t.get(Pv(t,e))}function kv(t,e,n){return t.set(Pv(t,e),n),n}function Pv(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}mt["a"].getSingleton().register("beforeColumnFreeze"),mt["a"].getSingleton().register("afterColumnFreeze"),mt["a"].getSingleton().register("beforeColumnUnfreeze"),mt["a"].getSingleton().register("afterColumnUnfreeze");const Dv="manualColumnFreeze",Lv=110;var Fv=new WeakMap,Vv=new WeakSet;class Wv extends bn{constructor(){super(...arguments),Av(this,Vv),Hv(this,Fv,!1)}static get PLUGIN_KEY(){return Dv}static get PLUGIN_PRIORITY(){return Lv}isEnabled(){return!!this.hot.getSettings()[Dv]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",t=>Pv(Vv,this,Bv).call(this,t)),this.addHook("beforeColumnMove",(t,e)=>Pv(Vv,this,Uv).call(this,t,e)),super.enablePlugin())}disablePlugin(){kv(Fv,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(t){const e=this.hot.getSettings(),n=e.fixedColumnsStart<this.hot.countCols()&&t>e.fixedColumnsStart-1;_v(Fv,this)||kv(Fv,this,!0);const o=this.hot.runHooks("beforeColumnFreeze",t,n);!1!==o&&(n&&(this.hot.columnIndexMapper.moveIndexes(t,e.fixedColumnsStart),e._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",t,n))}unfreezeColumn(t){const e=this.hot.getSettings(),n=e.fixedColumnsStart>0&&t<=e.fixedColumnsStart-1;_v(Fv,this)||kv(Fv,this,!0);const o=this.hot.runHooks("beforeColumnUnfreeze",t,n);!1!==o&&(n&&(e._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(t,e.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",t,n))}}function Bv(t){t.items.push({name:"---------"},xv(this),Nv(this))}function Uv(t,e){if(_v(Fv,this)){const n=this.hot.getSettings().fixedColumnsStart;if(e<n)return!1;if(t.some(t=>t<n))return!1}}function zv(t,e,n){return(e=Gv(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gv(t){var e=Yv(t,"string");return"symbol"==typeof e?e:e+""}function Yv(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}const Xv=0,$v=1,Kv=2,qv="px";class Qv{constructor(t){zv(this,"hot",void 0),zv(this,"_element",null),zv(this,"state",Xv),zv(this,"inlineProperty",void 0),this.hot=t,this.inlineProperty=t.isRtl()?"right":"left"}appendTo(t){t.appendChild(this._element),this.state=Kv}build(){this.state===Xv&&(this._element=this.hot.rootDocument.createElement("div"),this.state=$v)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=Xv}isAppended(){return this.state===Kv}isBuilt(){return this.state>=$v}setPosition(t,e){Object(ie["isNumeric"])(t)&&(this._element.style.top=t+qv),Object(ie["isNumeric"])(e)&&(this._element.style[this.inlineProperty]=e+qv)}getPosition(){const t=this._element.style;return{top:t.top?parseInt(t.top,10):0,start:t[this.inlineProperty]?parseInt(t[this.inlineProperty],10):0}}setSize(t,e){Object(ie["isNumeric"])(t)&&(this._element.style.width=t+qv),Object(ie["isNumeric"])(e)&&(this._element.style.height=e+qv)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(t,e){Object(ie["isNumeric"])(t)&&(this._element.style.marginTop=t+qv),Object(ie["isNumeric"])(e)&&(this._element.style["margin"+Object(p["toUpperCaseFirst"])(this.inlineProperty)]=e+qv)}getOffset(){const t=this._element.style,e="margin"+Object(p["toUpperCaseFirst"])(this.inlineProperty);return{top:t.marginTop?parseInt(t.marginTop,10):0,start:t[e]?parseInt(t[e],10):0}}}var Jv=Qv;const Zv="ht__manualColumnMove--backlight";class ty extends Jv{build(){super.build(),Object(s["addClass"])(this._element,Zv)}}var ey=ty;const ny="ht__manualColumnMove--guideline";class oy extends Jv{build(){super.build(),Object(s["addClass"])(this._element,ny)}}var iy=oy;function ry(t,e){ay(t,e),e.add(t)}function sy(t,e,n){ay(t,e),e.set(t,n)}function ay(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ly(t,e,n){return t.set(hy(t,e),n),n}function cy(t,e){return t.get(hy(t,e))}function hy(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}mt["a"].getSingleton().register("beforeColumnMove"),mt["a"].getSingleton().register("afterColumnMove");const uy="manualColumnMove",dy=120,fy="ht__manualColumnMove",gy="show-ui",py="on-moving--columns",my="after-selection--columns";var by=new WeakMap,wy=new WeakMap,vy=new WeakMap,yy=new WeakMap,Cy=new WeakMap,Sy=new WeakMap,Oy=new WeakMap,Ey=new WeakMap,Ry=new WeakMap,Ty=new WeakMap,My=new WeakMap,Iy=new WeakSet;class xy extends bn{constructor(){super(...arguments),ry(this,Iy),sy(this,by,new ey(this.hot)),sy(this,wy,new iy(this.hot)),sy(this,vy,[]),sy(this,yy,0),sy(this,Cy,!1),sy(this,Sy,{}),sy(this,Oy,void 0),sy(this,Ey,void 0),sy(this,Ry,void 0),sy(this,Ty,void 0),sy(this,My,void 0)}static get PLUGIN_KEY(){return uy}static get PLUGIN_PRIORITY(){return dy}isEnabled(){return!!this.hot.getSettings()[uy]}enablePlugin(){var t=this;this.enabled||(this.addHook("beforeOnCellMouseDown",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return hy(Iy,t,Ny).call(t,...n)})),this.addHook("beforeOnCellMouseOver",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return hy(Iy,t,Hy).call(t,...n)})),this.addHook("afterScrollVertically",()=>hy(Iy,this,_y).call(this)),this.addHook("afterLoadData",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return hy(Iy,t,ky).call(t,...n)})),this.buildPluginUI(),this.registerEvents(),Object(s["addClass"])(this.hot.rootElement,fy),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){Object(s["removeClass"])(this.hot.rootElement,fy),this.unregisterEvents(),cy(by,this).destroy(),cy(wy,this).destroy(),super.disablePlugin()}moveColumn(t,e){return this.moveColumns([t],e)}moveColumns(t,e){const n=cy(Oy,this),o=this.isMovePossible(t,e),i=this.hot.runHooks("beforeColumnMove",t,e,n,o);if(ly(Oy,this,void 0),!1===i)return;o&&this.hot.columnIndexMapper.moveIndexes(t,e);const r=o&&this.isColumnOrderChanged(t,e);return this.hot.runHooks("afterColumnMove",t,e,n,o,r),r}dragColumn(t,e){return this.dragColumns([t],e)}dragColumns(t,e){const n=this.countFinalIndex(t,e);return ly(Oy,this,e),this.moveColumns(t,n)}isMovePossible(t,e){const n=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),o=t.length+e>n,i=e<0,r=t.some(t=>t<0),s=t.some(t=>t>=n);return!(o||i||r||s)}isColumnOrderChanged(t,e){return t.some((t,n)=>t-n!==e)}countFinalIndex(t,e){const n=Object(f["arrayReduce"])(t,(t,n)=>(n<e&&(t+=1),t),0);return e-n}getColumnsWidth(t,e){const n=this.hot.columnIndexMapper;let o=0;for(let i=t;i<=e;i+=1){const t=n.getRenderableFromVisualIndex(i);i<0?o+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:null!==t&&(o+=this.hot.view._wt.wtTable.getStretchedColumnWidth(t)||0)}return o}moveBySettingsOrLoad(){const t=this.hot.getSettings()[uy];if(Array.isArray(t))this.moveColumns(t,0);else if(void 0!==t){const t=this.persistentStateLoad();t.length&&this.moveColumns(t,0)}}isFixedColumnsStart(t){return t<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const t={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",t),t.value?t.value:[]}prepareColumnsToMoving(t,e){const n=[];return Object(ie["rangeEach"])(t,e,t=>{n.push(t)}),n}refreshPositions(){const t=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(cy(Ey,this))&&t>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(t-1,-1)});const e=this.hot.view._wt.wtTable,n=this.hot.view._wt.wtOverlays.scrollableElement,o="number"===typeof n.scrollX?n.scrollX:n.scrollLeft;let i=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,cy(Ey,this)-1);const r=e.hider.offsetWidth,a=e.TBODY.offsetLeft,l=cy(by,this).getOffset().start,c=cy(by,this).getSize().width;let h=0,u=0;if(this.hot.isRtl()){const t=this.hot.rootWindow,e=Object(s["outerWidth"])(this.hot.rootElement),i=t.innerWidth-cy(Ry,this)-e;u=t.innerWidth-cy(Sy,this).eventPageX-i-(void 0===n.scrollX?o:0)}else u=cy(Sy,this).eventPageX-(cy(Ry,this)-(void 0===n.scrollX?o:0));if(cy(Ty,this)&&(h=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(cy(Ey,this))&&(i+=o),i+=h,cy(Ey,this)<0)cy(My,this)>0?cy(Sy,this).col=0:cy(Sy,this).col=t>0?t-1:t;else if(cy(Sy,this).TD.offsetWidth/2+i<=u){const t=cy(Ey,this)>=cy(yy,this)?cy(yy,this)-1:cy(Ey,this);cy(Sy,this).col=t+1,i+=cy(Sy,this).TD.offsetWidth}else cy(Sy,this).col=cy(Ey,this);let d=u,f=i;u+c+l>=r?d=r-c-l:u+l<a+h&&(d=a+h+Math.abs(l)),i>=r-1?f=r-1:0===f?f=1:void 0!==n.scrollX&&cy(Ey,this)<cy(My,this)&&(f-=cy(Ry,this)<=n.scrollX?cy(Ry,this):0),cy(by,this).setPosition(null,d),cy(wy,this).setPosition(null,f)}registerEvents(){const{documentElement:t}=this.hot.rootDocument;this.eventManager.addEventListener(t,"mousemove",t=>hy(Iy,this,Ay).call(this,t)),this.eventManager.addEventListener(t,"mouseup",()=>hy(Iy,this,jy).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){cy(by,this).build(),cy(wy,this).build()}destroy(){cy(by,this).destroy(),cy(wy,this).destroy(),super.destroy()}}function Ny(t,e,n,o){const i=this.hot.view._wt.wtTable,r=this.hot.selection.isSelectedByColumnHeader(),l=this.hot.getSelectedRangeLast(),c=Object(s["hasClass"])(t.target,"sortAction");if(!l||!r||cy(Cy,this)||0!==t.button||c)return ly(Cy,this,!1),cy(vy,this).length=0,void Object(s["removeClass"])(this.hot.rootElement,[py,gy]);const h=cy(wy,this).isBuilt()&&!cy(wy,this).isAppended(),u=cy(by,this).isBuilt()&&!cy(by,this).isAppended();h&&u&&(cy(wy,this).appendTo(i.hider),cy(by,this).appendTo(i.hider));const{from:d,to:f}=l,g=Math.min(d.col,f.col),p=Math.max(d.col,f.col);if(e.row<0&&e.col>=g&&e.col<=p){o.column=!0,ly(Cy,this,!0);const r=n.firstChild?Object(a["offsetRelativeTo"])(t,n.firstChild).x:t.offsetX;cy(Sy,this).eventPageX=t.pageX,ly(Ey,this,e.col),cy(Sy,this).TD=n,cy(Sy,this).col=e.col,ly(vy,this,this.prepareColumnsToMoving(g,p)),ly(Ty,this,!!this.hot.getSettings().rowHeaders),ly(yy,this,this.hot.countCols()),ly(My,this,this.hot.getSettings().fixedColumnsStart),ly(Ry,this,Object(s["offset"])(this.hot.rootElement).left);const l=cy(Ty,this)?-1:0,c=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,h=e.col<cy(My,this),u=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),d=Math.abs(r-(this.hot.isRtl()?n.offsetWidth:0)),f=this.getColumnsWidth(g,e.col-1)+d,m=this.getColumnsWidth(l,g-1)+(h?u:0)+f;cy(by,this).setPosition(c,m),cy(by,this).setSize(this.getColumnsWidth(g,p),i.hider.offsetHeight-c),cy(by,this).setOffset(null,-f),Object(s["addClass"])(this.hot.rootElement,py)}else Object(s["removeClass"])(this.hot.rootElement,my),ly(Cy,this,!1),cy(vy,this).length=0}function Ay(t){cy(Cy,this)&&(cy(Sy,this).eventPageX=t.pageX,this.refreshPositions())}function Hy(t,e,n,o){const i=this.hot.getSelectedRangeLast();i&&cy(Cy,this)&&(cy(vy,this).indexOf(e.col)>-1?Object(s["removeClass"])(this.hot.rootElement,gy):Object(s["addClass"])(this.hot.rootElement,gy),o.row=!0,o.column=!0,o.cell=!0,ly(Ey,this,e.col),cy(Sy,this).TD=n)}function jy(){const t=cy(Sy,this).col,e=cy(vy,this).length;if(ly(Ey,this,void 0),ly(Cy,this,!1),Object(s["removeClass"])(this.hot.rootElement,[py,gy,my]),this.hot.selection.isSelectedByColumnHeader()&&Object(s["addClass"])(this.hot.rootElement,my),e<1||void 0===t)return;const n=cy(vy,this)[0],o=this.hot.toPhysicalColumn(n),i=this.dragColumns(cy(vy,this),t);if(cy(vy,this).length=0,!0===i){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const t=this.hot.toVisualColumn(o),n=t+e-1;this.hot.selectColumns(t,n)}}function _y(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,n=t.holder.scrollTop,o=e+n;cy(by,this).setPosition(o),cy(by,this).setSize(null,t.hider.offsetHeight-o)}function ky(){this.moveBySettingsOrLoad()}function Py(t,e){Ly(t,e),e.add(t)}function Dy(t,e,n){Ly(t,e),e.set(t,n)}function Ly(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fy(t,e,n){return t.set(Wy(t,e),n),n}function Vy(t,e){return t.get(Wy(t,e))}function Wy(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const By="manualColumnResize",Uy=130,zy="manualColumnWidths";var Gy=new WeakMap,Yy=new WeakMap,Xy=new WeakMap,$y=new WeakMap,Ky=new WeakMap,qy=new WeakMap,Qy=new WeakMap,Jy=new WeakMap,Zy=new WeakMap,tC=new WeakMap,eC=new WeakMap,nC=new WeakMap,oC=new WeakMap,iC=new WeakMap,rC=new WeakMap,sC=new WeakMap,aC=new WeakSet;class lC extends bn{static get PLUGIN_KEY(){return By}static get PLUGIN_PRIORITY(){return Uy}constructor(t){super(t),Py(this,aC),Dy(this,Gy,null),Dy(this,Yy,null),Dy(this,Xy,[]),Dy(this,$y,null),Dy(this,Ky,null),Dy(this,qy,null),Dy(this,Qy,null),Dy(this,Jy,null),Dy(this,Zy,this.hot.rootDocument.createElement("DIV")),Dy(this,tC,this.hot.rootDocument.createElement("DIV")),Dy(this,eC,null),Dy(this,nC,!1),Dy(this,oC,0),Dy(this,iC,null),Dy(this,rC,void 0),Dy(this,sC,void 0),Object(s["addClass"])(Vy(Zy,this),"manualColumnResizer"),Object(s["addClass"])(Vy(tC,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[By]}enablePlugin(){this.enabled||(Fy(rC,this,new An["a"]),Vy(rC,this).addLocalHook("init",()=>Wy(aC,this,cC).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,Vy(rC,this)),this.addHook("modifyColWidth",(t,e)=>Wy(aC,this,pC).call(this,t,e),1),this.addHook("beforeStretchingColumnWidth",(t,e)=>Wy(aC,this,mC).call(this,t,e)),this.addHook("beforeColumnResize",(t,e,n)=>Wy(aC,this,bC).call(this,t,e,n)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Fy(sC,this,Vy(rC,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",zy,Vy(rC,this).getValues())}loadManualColumnWidths(){const t={};return this.hot.runHooks("persistentStateLoad",zy,t),t.value}setManualSize(t,e){const n=Math.max(e,20),o=this.hot.toPhysicalColumn(t);return Vy(rC,this).setValueAtIndex(o,n),n}clearManualSize(t){const e=this.hot.toPhysicalColumn(t);Vy(rC,this).setValueAtIndex(e,null)}setupHandlePosition(t){if(!t.parentNode)return;Fy(Gy,this,t);const{_wt:e}=this.hot.view,n=e.wtTable.getCoords(Vy(Gy,this)),o=n.col;if(o<0)return;const i=Object(s["outerHeight"])(Vy(Gy,this)),r=Vy(Gy,this).getBoundingClientRect(),a=o<e.getSetting("fixedColumnsStart");let l;a&&(l=e.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(Vy(Gy,this),n.row,n.col)),l||(l=e.wtOverlays.topOverlay.getRelativeCellPosition(Vy(Gy,this),n.row,n.col)),Fy(Yy,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(o)),Fy(Xy,this,[]);const c=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&c){const t=this.hot.getSelectedRange();Object(f["arrayEach"])(t,t=>{const e=t.getTopStartCorner().col,n=t.getBottomEndCorner().col;Object(ie["rangeEach"])(e,n,t=>{Vy(Xy,this).includes(t)||Vy(Xy,this).push(t)})})}Vy(Xy,this).includes(Vy(Yy,this))||Fy(Xy,this,[Vy(Yy,this)]),Fy(Jy,this,l.start-6),Fy(Qy,this,parseInt(r.width,10)),Vy(Zy,this).style.top=l.top+"px",Vy(Zy,this).style[this.inlineDir]=Vy(Jy,this)+Vy(Qy,this)+"px",Vy(Zy,this).style.height=i+"px",this.hot.rootElement.appendChild(Vy(Zy,this))}refreshHandlePosition(){Vy(Zy,this).style[this.inlineDir]=Vy(Jy,this)+Vy($y,this)+"px"}setupGuidePosition(){const t=parseInt(Object(s["outerHeight"])(Vy(Zy,this)),10),e=parseInt(Vy(Zy,this).style.top,10)+t,n=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);Object(s["addClass"])(Vy(Zy,this),"active"),Object(s["addClass"])(Vy(tC,this),"active"),Vy(tC,this).style.top=e+"px",this.refreshGuidePosition(),Vy(tC,this).style.height=n-t+"px",this.hot.rootElement.appendChild(Vy(tC,this))}refreshGuidePosition(){Vy(tC,this).style[this.inlineDir]=Vy(Zy,this).style[this.inlineDir]}hideHandleAndGuide(){Object(s["removeClass"])(Vy(Zy,this),"active"),Object(s["removeClass"])(Vy(tC,this),"active")}checkIfColumnHeader(t){const e=Object(s["closest"])(t,["THEAD"],this.hot.rootElement),{topOverlay:n,topInlineStartCornerOverlay:o}=this.hot.view._wt.wtOverlays;return[n.clone.wtTable.THEAD,o.clone.wtTable.THEAD].includes(e)}getClosestTHParent(t){return"TABLE"!==t.tagName?"TH"===t.tagName?t:this.getClosestTHParent(t.parentNode):null}afterMouseDownTimeout(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},e=(e,n)=>{const o=this.hot.runHooks("beforeColumnResize",Vy(Ky,this),e,!0);void 0!==o&&Fy(Ky,this,o),"all"===this.hot.getSettings().stretchH?this.clearManualSize(e):this.setManualSize(e,Vy(Ky,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",Vy(Ky,this),e,!0),n&&t()};if(Vy(oC,this)>=2){const n=Vy(Xy,this).length;n>1?(Object(f["arrayEach"])(Vy(Xy,this),t=>{e(t)}),t()):Object(f["arrayEach"])(Vy(Xy,this),t=>{e(t,!0)})}Fy(oC,this,0),Fy(iC,this,null)}bindEvents(){const{rootWindow:t,rootElement:e}=this.hot;this.eventManager.addEventListener(e,"mouseover",t=>Wy(aC,this,hC).call(this,t)),this.eventManager.addEventListener(e,"mousedown",t=>Wy(aC,this,uC).call(this,t)),this.eventManager.addEventListener(t,"mousemove",t=>Wy(aC,this,dC).call(this,t)),this.eventManager.addEventListener(t,"mouseup",()=>Wy(aC,this,fC).call(this)),this.eventManager.addEventListener(Vy(Zy,this),"contextmenu",()=>Wy(aC,this,gC).call(this))}destroy(){super.destroy()}}function cC(){const t=this.hot.getSettings()[By],e=this.loadManualColumnWidths();"undefined"!==typeof e?this.hot.batchExecution(()=>{e.forEach((t,e)=>{Vy(rC,this).setValueAtIndex(e,t)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((t,e)=>{Vy(rC,this).setValueAtIndex(e,t)})},!0),Fy(sC,this,t)):!0===t&&Array.isArray(Vy(sC,this))&&this.hot.batchExecution(()=>{Vy(sC,this).forEach((t,e)=>{Vy(rC,this).setValueAtIndex(e,t)})},!0)}function hC(t){if(!Object(s["isDetached"])(t.target)&&!0!==Vy(nC,this)&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const n=e.getAttribute("colspan");!e||null!==n&&"1"!==n||Vy(eC,this)||this.setupHandlePosition(e)}}function uC(t){t.target.parentNode===this.hot.rootElement&&Object(s["hasClass"])(t.target,"manualColumnResizer")&&(this.setupHandlePosition(Vy(Gy,this)),this.setupGuidePosition(),Fy(eC,this,!0),null===Vy(iC,this)&&(Fy(iC,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(Vy(iC,this))),Fy(oC,this,Vy(oC,this)+1),this.startX=t.pageX,Fy(Ky,this,Vy(Qy,this)))}function dC(t){if(Vy(eC,this)){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();Fy($y,this,Vy(Qy,this)+e),Object(f["arrayEach"])(Vy(Xy,this),t=>{Fy(Ky,this,this.setManualSize(t,Vy($y,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function fC(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},e=(e,n)=>{this.hot.runHooks("beforeColumnResize",Vy(Ky,this),e,!1),n&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",Vy(Ky,this),e,!1)};if(Vy(eC,this)){if(this.hideHandleAndGuide(),Fy(eC,this,!1),Vy(Ky,this)!==Vy(Qy,this)){const n=Vy(Xy,this).length;n>1?(Object(f["arrayEach"])(Vy(Xy,this),t=>{e(t)}),t()):Object(f["arrayEach"])(Vy(Xy,this),t=>{e(t,!0)})}this.setupHandlePosition(Vy(Gy,this))}}function gC(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(Vy(Zy,this)),this.hot.rootElement.removeChild(Vy(tC,this)),Fy(eC,this,!1),Fy(nC,this,!0),this.hot._registerImmediate(()=>{Fy(nC,this,!1)})}function pC(t,e){let n=t;if(this.enabled){const t=this.hot.toPhysicalColumn(e),o=Vy(rC,this).getValueAtIndex(t);this.hot.getSettings()[By]&&o&&(n=o)}return n}function mC(t,e){let n=Vy(rC,this).getValueAtIndex(e);return null===n&&(n=t),n}function bC(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function wC(t,e,n){return(e=vC(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vC(t){var e=yC(t,"string");return"symbol"==typeof e?e:e+""}function yC(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}const CC=0,SC=1,OC=2,EC="px";class RC{constructor(t){wC(this,"hot",void 0),wC(this,"_element",null),wC(this,"state",CC),this.hot=t}appendTo(t){t.appendChild(this._element),this.state=OC}build(){this.state===CC&&(this._element=this.hot.rootDocument.createElement("div"),this.state=SC)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=CC}isAppended(){return this.state===OC}isBuilt(){return this.state>=SC}setPosition(t,e){void 0!==t&&(this._element.style.top=t+EC),void 0!==e&&(this._element.style.left=e+EC)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(t,e){t&&(this._element.style.width=t+EC),e&&(this._element.style.height=e+EC)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(t,e){t&&(this._element.style.marginTop=t+EC),e&&(this._element.style.marginLeft=e+EC)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}var TC=RC;const MC="ht__manualRowMove--backlight";class IC extends TC{build(){super.build(),Object(s["addClass"])(this._element,MC)}}var xC=IC;const NC="ht__manualRowMove--guideline";class AC extends TC{build(){super.build(),Object(s["addClass"])(this._element,NC)}}var HC=AC;function jC(t,e){kC(t,e),e.add(t)}function _C(t,e,n){kC(t,e),e.set(t,n)}function kC(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function PC(t,e,n){return t.set(LC(t,e),n),n}function DC(t,e){return t.get(LC(t,e))}function LC(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}mt["a"].getSingleton().register("beforeRowMove"),mt["a"].getSingleton().register("afterRowMove");const FC="manualRowMove",VC=140,WC="ht__manualRowMove",BC="show-ui",UC="on-moving--rows",zC="after-selection--rows";var GC=new WeakMap,YC=new WeakMap,XC=new WeakMap,$C=new WeakMap,KC=new WeakMap,qC=new WeakMap,QC=new WeakSet;class JC extends bn{constructor(){super(...arguments),jC(this,QC),_C(this,GC,new xC(this.hot)),_C(this,YC,new HC(this.hot)),_C(this,XC,[]),_C(this,$C,void 0),_C(this,KC,{}),_C(this,qC,void 0)}static get PLUGIN_KEY(){return FC}static get PLUGIN_PRIORITY(){return VC}isEnabled(){return!!this.hot.getSettings()[FC]}enablePlugin(){var t=this;this.enabled||(this.addHook("beforeOnCellMouseDown",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return LC(QC,t,ZC).call(t,...n)})),this.addHook("beforeOnCellMouseOver",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return LC(QC,t,eS).call(t,...n)})),this.addHook("afterScrollHorizontally",()=>LC(QC,this,oS).call(this)),this.addHook("afterLoadData",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return LC(QC,t,iS).call(t,...n)})),this.buildPluginUI(),this.registerEvents(),Object(s["addClass"])(this.hot.rootElement,WC),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){Object(s["removeClass"])(this.hot.rootElement,WC),this.unregisterEvents(),DC(GC,this).destroy(),DC(YC,this).destroy(),super.disablePlugin()}moveRow(t,e){return this.moveRows([t],e)}moveRows(t,e){const n=DC(qC,this),o=this.isMovePossible(t,e),i=this.hot.runHooks("beforeRowMove",t,e,n,o);if(PC(qC,this,void 0),!1===i)return;o&&this.hot.rowIndexMapper.moveIndexes(t,e);const r=o&&this.isRowOrderChanged(t,e);return this.hot.runHooks("afterRowMove",t,e,n,o,r),r}dragRow(t,e){return this.dragRows([t],e)}dragRows(t,e){const n=this.countFinalIndex(t,e);return PC(qC,this,e),this.moveRows(t,n)}isMovePossible(t,e){const n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),o=t.length+e>n,i=e<0,r=t.some(t=>t<0),s=t.some(t=>t>=n);return!(o||i||r||s)}isRowOrderChanged(t,e){return t.some((t,n)=>t-n!==e)}countFinalIndex(t,e){const n=Object(f["arrayReduce"])(t,(t,n)=>(n<e&&(t+=1),t),0);return e-n}getRowsHeight(t,e){const n=this.hot.rowIndexMapper;let o=0;for(let i=t;i<=e;i++){const t=n.getRenderableFromVisualIndex(i);null!==t&&(o+=this.hot.view._wt.wtTable.getRowHeight(t)||23)}return o}moveBySettingsOrLoad(){const t=this.hot.getSettings()[FC];if(Array.isArray(t))this.moveRows(t,0);else if(void 0!==t){const t=this.persistentStateLoad();t.length&&this.moveRows(t,0)}}isFixedRowTop(t){return t<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(t){return t>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const t={};return this.hot.runHooks("persistentStateLoad","manualRowMove",t),t.value?t.value:[]}prepareRowsToMoving(){const t=this.hot.getSelectedRangeLast(),e=[];if(!t)return e;const{from:n,to:o}=t,i=Math.min(n.row,o.row),r=Math.max(n.row,o.row);return Object(ie["rangeEach"])(i,r,t=>{e.push(t)}),e}refreshPositions(){const t=DC(KC,this).coords,e=this.hot.view.getFirstFullyVisibleRow(),n=this.hot.view.getLastFullyVisibleRow(),o=this.hot.countRows();this.isFixedRowTop(t.row)&&e>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(e-1,-1)),this.isFixedRowBottom(t.row)&&n<o&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n+1,1),void 0,!0);const i=this.hot.view._wt.wtTable,r=DC(KC,this).TD,a=this.hot.rootElement,l=Object(s["offset"])(a),c=Object(s["getTrimmingContainer"])(a),h=i.holder.scrollTop,u=this.hot.rootWindow!==c?c.scrollTop:0,d=l.top-u,f=DC(KC,this).eventPageY-d+h,g=i.hider.offsetHeight,p=i.TBODY.offsetTop,m=DC(GC,this).getOffset().top,b=DC(GC,this).getSize().height,w=r.offsetHeight/2,v=r.offsetHeight;let y=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,t.row-1);const C=f>=y+w;this.isFixedRowTop(t.row)&&(y+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),t.row<0?DC(KC,this).row=e>0?e-1:e:C?(DC(KC,this).row=t.row+1,y+=0===t.row?v-1:v):DC(KC,this).row=t.row;let S=f,O=y;f+b+m>=g?S=g-b-m:f+m<p&&(S=p+Math.abs(m)),y>=g-1&&(O=g-1),DC(GC,this).setPosition(S),DC(YC,this).setPosition(O)}registerEvents(){const{documentElement:t}=this.hot.rootDocument;this.eventManager.addEventListener(t,"mousemove",t=>LC(QC,this,tS).call(this,t)),this.eventManager.addEventListener(t,"mouseup",()=>LC(QC,this,nS).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){DC(GC,this).build(),DC(YC,this).build()}destroy(){DC(GC,this).destroy(),DC(YC,this).destroy(),super.destroy()}}function ZC(t,e,n,o){const{wtTable:i,wtViewport:r}=this.hot.view._wt,a=this.hot.selection.isSelectedByRowHeader(),l=this.hot.getSelectedRangeLast();if(!l||!a||DC($C,this)||0!==t.button)return PC($C,this,!1),DC(XC,this).length=0,void Object(s["removeClass"])(this.hot.rootElement,[UC,BC]);const c=DC(YC,this).isBuilt()&&!DC(YC,this).isAppended(),h=DC(GC,this).isBuilt()&&!DC(GC,this).isAppended();c&&h&&(DC(YC,this).appendTo(i.hider),DC(GC,this).appendTo(i.hider));const{from:u,to:d}=l,f=Math.min(u.row,d.row),g=Math.max(u.row,d.row);if(e.col<0&&e.row>=f&&e.row<=g){o.row=!0,PC($C,this,!0),DC(KC,this).eventPageY=t.pageY,DC(KC,this).coords=e,DC(KC,this).TD=n,PC(XC,this,this.prepareRowsToMoving());const a=i.holder.scrollLeft+r.getRowHeaderWidth(),l=this.getRowsHeight(f,e.row-1)+t.offsetY;DC(GC,this).setPosition(null,a),DC(GC,this).setSize(i.hider.offsetWidth-a,this.getRowsHeight(f,g)),DC(GC,this).setOffset(-l,null),Object(s["addClass"])(this.hot.rootElement,UC),this.refreshPositions()}else Object(s["removeClass"])(this.hot.rootElement,zC),PC($C,this,!1),DC(XC,this).length=0}function tS(t){DC($C,this)&&(DC(KC,this).eventPageY=t.pageY,this.refreshPositions())}function eS(t,e,n,o){const i=this.hot.getSelectedRangeLast();i&&DC($C,this)&&(DC(XC,this).indexOf(e.row)>-1?Object(s["removeClass"])(this.hot.rootElement,BC):Object(s["addClass"])(this.hot.rootElement,BC),o.row=!0,o.column=!0,o.cell=!0,DC(KC,this).coords=e,DC(KC,this).TD=n)}function nS(){const t=DC(KC,this).row,e=DC(XC,this).length;if(PC($C,this,!1),Object(s["removeClass"])(this.hot.rootElement,[UC,BC,zC]),this.hot.selection.isSelectedByRowHeader()&&Object(s["addClass"])(this.hot.rootElement,zC),e<1||void 0===t)return;const n=DC(XC,this)[0],o=this.hot.toPhysicalRow(n),i=this.dragRows(DC(XC,this),t);if(DC(XC,this).length=0,!0===i){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const t=this.hot.toVisualRow(o),n=t+e-1;this.hot.selectRows(t,n)}}function oS(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),n=t.holder.scrollLeft,o=e+n;DC(GC,this).setPosition(null,o),DC(GC,this).setSize(t.hider.offsetWidth-o)}function iS(){this.moveBySettingsOrLoad()}var rS=n("eb36");function sS(t,e){lS(t,e),e.add(t)}function aS(t,e,n){lS(t,e),e.set(t,n)}function lS(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cS(t,e,n){return t.set(uS(t,e),n),n}function hS(t,e){return t.get(uS(t,e))}function uS(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const dS="manualRowResize",fS=30,gS="manualRowHeights";var pS=new WeakMap,mS=new WeakMap,bS=new WeakMap,wS=new WeakMap,vS=new WeakMap,yS=new WeakMap,CS=new WeakMap,SS=new WeakMap,OS=new WeakMap,ES=new WeakMap,RS=new WeakMap,TS=new WeakMap,MS=new WeakMap,IS=new WeakMap,xS=new WeakMap,NS=new WeakMap,AS=new WeakSet;class HS extends bn{static get PLUGIN_KEY(){return dS}static get PLUGIN_PRIORITY(){return fS}constructor(t){super(t),sS(this,AS),aS(this,pS,null),aS(this,mS,null),aS(this,bS,[]),aS(this,wS,null),aS(this,vS,null),aS(this,yS,null),aS(this,CS,null),aS(this,SS,null),aS(this,OS,this.hot.rootDocument.createElement("DIV")),aS(this,ES,this.hot.rootDocument.createElement("DIV")),aS(this,RS,!1),aS(this,TS,!1),aS(this,MS,0),aS(this,IS,null),aS(this,xS,void 0),aS(this,NS,void 0),Object(s["addClass"])(hS(OS,this),"manualRowResizer"),Object(s["addClass"])(hS(ES,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[dS]}enablePlugin(){this.enabled||(cS(xS,this,new An["a"]),hS(xS,this).addLocalHook("init",()=>uS(AS,this,FS).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,hS(xS,this)),this.addHook("modifyRowHeight",(t,e)=>uS(AS,this,LS).call(this,t,e)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){cS(NS,this,hS(xS,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",gS,hS(xS,this).getValues())}loadManualRowHeights(){const t={};return this.hot.runHooks("persistentStateLoad",gS,t),t.value}setManualSize(t,e){const n=this.hot.toPhysicalRow(t),o=Math.max(e,rS["a"]);return hS(xS,this).setValueAtIndex(n,o),o}getLastDesiredRowHeight(){return hS(wS,this)}setupHandlePosition(t){cS(pS,this,t);const{view:e}=this.hot,{_wt:n}=e,o=n.wtTable.getCoords(hS(pS,this)),i=o.row;if(i<0)return;const r=Object(s["outerWidth"])(hS(pS,this)),a=hS(pS,this).getBoundingClientRect(),l=i<n.getSetting("fixedRowsTop"),c=i>=e.countNotHiddenRowIndexes(0,1)-n.getSetting("fixedRowsBottom");let h;l?h=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(hS(pS,this),o.row,o.col):c&&(h=n.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(hS(pS,this),o.row,o.col)),h||(h=n.wtOverlays.inlineStartOverlay.getRelativeCellPosition(hS(pS,this),o.row,o.col)),cS(mS,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(i)),cS(bS,this,[]);const u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&u){const t=this.hot.getSelectedRange();Object(f["arrayEach"])(t,t=>{const e=t.getTopStartCorner().row,n=t.getBottomStartCorner().row;Object(ie["rangeEach"])(e,n,t=>{hS(bS,this).includes(t)||hS(bS,this).push(t)})})}hS(bS,this).includes(hS(mS,this))||cS(bS,this,[hS(mS,this)]),cS(SS,this,h.top-6),cS(CS,this,parseInt(a.height,10)),hS(OS,this).style.top=hS(SS,this)+hS(CS,this)+"px",hS(OS,this).style[this.inlineDir]=h.start+"px",hS(OS,this).style.width=r+"px",this.hot.rootElement.appendChild(hS(OS,this))}refreshHandlePosition(){hS(OS,this).style.top=hS(SS,this)+hS(wS,this)+"px"}setupGuidePosition(){const t=parseInt(Object(s["outerWidth"])(hS(OS,this)),10),e=parseInt(hS(OS,this).style[this.inlineDir],10)+t,n=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);Object(s["addClass"])(hS(OS,this),"active"),Object(s["addClass"])(hS(ES,this),"active"),hS(ES,this).style.top=hS(OS,this).style.top,hS(ES,this).style[this.inlineDir]=e+"px",hS(ES,this).style.width=n-t+"px",this.hot.rootElement.appendChild(hS(ES,this))}refreshGuidePosition(){hS(ES,this).style.top=hS(OS,this).style.top}hideHandleAndGuide(){Object(s["removeClass"])(hS(OS,this),"active"),Object(s["removeClass"])(hS(ES,this),"active")}checkIfRowHeader(t){const e=Object(s["closest"])(t,["TBODY"],this.hot.rootElement),{inlineStartOverlay:n,topInlineStartCornerOverlay:o,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;return[n.clone.wtTable.TBODY,o.clone.wtTable.TBODY,i.clone.wtTable.TBODY].includes(e)}getClosestTHParent(t){return"TABLE"!==t.tagName?"TH"===t.tagName?t:this.getClosestTHParent(t.parentNode):null}getActualRowHeight(t){const e=this.hot.view._wt.wtTable.getRowHeight(t);return void 0!==e&&hS(vS,this)<e?e:hS(vS,this)}afterMouseDownTimeout(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},e=(e,n)=>{const o=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(e),e,!0);void 0!==o&&cS(vS,this,o),this.setManualSize(e,hS(vS,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(e),e,!0),n&&t()};if(hS(MS,this)>=2){const n=hS(bS,this).length;n>1?(Object(f["arrayEach"])(hS(bS,this),t=>{e(t)}),t()):Object(f["arrayEach"])(hS(bS,this),t=>{e(t,!0)})}cS(MS,this,0),cS(IS,this,null)}bindEvents(){const{rootElement:t,rootWindow:e}=this.hot;this.eventManager.addEventListener(t,"mouseover",t=>uS(AS,this,jS).call(this,t)),this.eventManager.addEventListener(t,"mousedown",t=>uS(AS,this,_S).call(this,t)),this.eventManager.addEventListener(e,"mousemove",t=>uS(AS,this,kS).call(this,t)),this.eventManager.addEventListener(e,"mouseup",()=>uS(AS,this,PS).call(this)),this.eventManager.addEventListener(hS(OS,this),"contextmenu",()=>uS(AS,this,DS).call(this))}destroy(){super.destroy()}}function jS(t){if(!Object(s["isDetached"])(t.target)&&!0!==hS(TS,this)&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(hS(RS,this)||this.setupHandlePosition(e))}}function _S(t){Object(s["hasClass"])(t.target,"manualRowResizer")&&(this.setupHandlePosition(hS(pS,this)),this.setupGuidePosition(),cS(RS,this,!0),null===hS(IS,this)&&(cS(IS,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(hS(IS,this))),cS(MS,this,hS(MS,this)+1),cS(yS,this,t.pageY),cS(vS,this,hS(CS,this)))}function kS(t){hS(RS,this)&&(cS(wS,this,hS(CS,this)+(t.pageY-hS(yS,this))),Object(f["arrayEach"])(hS(bS,this),t=>{cS(vS,this,this.setManualSize(t,hS(wS,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function PS(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},e=(e,n)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(e),e,!1),n&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(e),e,!1)};if(hS(RS,this)){if(this.hideHandleAndGuide(),cS(RS,this,!1),hS(vS,this)!==hS(CS,this)){const n=hS(bS,this).length;n>1?(Object(f["arrayEach"])(hS(bS,this),t=>{e(t)}),t()):Object(f["arrayEach"])(hS(bS,this),t=>{e(t,!0)})}this.setupHandlePosition(hS(pS,this))}}function DS(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(hS(OS,this)),this.hot.rootElement.removeChild(hS(ES,this)),cS(RS,this,!1),cS(TS,this,!0),this.hot._registerImmediate(()=>{cS(TS,this,!1)})}function LS(t,e){let n=t;if(this.enabled){const t=this.hot.toPhysicalRow(e),o=hS(xS,this).getValueAtIndex(t);this.hot.getSettings()[dS]&&o&&(n=o)}return n}function FS(){const t=this.hot.getSettings()[dS],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{"undefined"!==typeof e?e.forEach((t,e)=>{hS(xS,this).setValueAtIndex(e,t)}):Array.isArray(t)?(t.forEach((t,e)=>{hS(xS,this).setValueAtIndex(e,t)}),cS(NS,this,t)):!0===t&&Array.isArray(hS(NS,this))&&hS(NS,this).forEach((t,e)=>{hS(xS,this).setValueAtIndex(e,t)})},!0)}n("4cd6");function VS(t,e,n){WS(t,e),e.set(t,n)}function WS(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function BS(t,e,n){return(e=US(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function US(t){var e=zS(t,"string");return"symbol"==typeof e?e:e+""}function zS(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function GS(t,e){return t.get(XS(t,e))}function YS(t,e,n){return t.set(XS(t,e),n),n}function XS(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var $S=new WeakMap;class KS{constructor(t,e,n,o,i,r){BS(this,"row",void 0),BS(this,"col",void 0),BS(this,"rowspan",void 0),BS(this,"colspan",void 0),BS(this,"removed",!1),BS(this,"cellCoordsFactory",void 0),BS(this,"cellRangeFactory",void 0),VS(this,$S,null),this.row=t,this.col=e,this.rowspan=n,this.colspan=o,this.cellCoordsFactory=i,this.cellRangeFactory=r}static NEGATIVE_VALUES_WARNING(t){let{row:e,col:n,rowspan:o,colspan:i}=t;return os["a"]`The merged cell declared with {row: ${e}, col: ${n},\x20
      rowspan: ${o}, colspan: ${i}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(t){let{row:e,col:n}=t;return os["a"]`The merged cell declared at [${e}, ${n}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(t){let{row:e,col:n}=t;return os["a"]`The merged cell declared at [${e}, ${n}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(t){let{row:e,col:n}=t;return os["a"]`The merged cell declared at [${e}, ${n}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(t){let{row:e,col:n,rowspan:o,colspan:i}=t;return e<0||n<0||o<0||i<0}static isSingleCell(t){let{rowspan:e,colspan:n}=t;return 1===n&&1===e}static containsZeroSpan(t){let{rowspan:e,colspan:n}=t;return 0===n||0===e}static isOutOfBounds(t,e,n){return t.row<0||t.col<0||t.row>=e||t.row+t.rowspan-1>=e||t.col>=n||t.col+t.colspan-1>=n}normalize(t){const e=t.countRows(),n=t.countCols();this.row<0?this.row=0:this.row>e-1&&(this.row=e-1),this.col<0?this.col=0:this.col>n-1&&(this.col=n-1),this.row+this.rowspan>e-1&&(this.rowspan=e-this.row),this.col+this.colspan>n-1&&(this.colspan=n-this.col),YS($S,this,null)}includes(t,e){return this.row<=t&&this.col<=e&&this.row+this.rowspan-1>=t&&this.col+this.colspan-1>=e}includesHorizontally(t){return this.col<=t&&this.col+this.colspan-1>=t}includesVertically(t){return this.row<=t&&this.row+this.rowspan-1>=t}shift(t,e){const n=t[0]||t[1],o=e+Math.abs(t[0]||t[1])-1,i=t[0]?"colspan":"rowspan",r=t[0]?"col":"row",s=Math.min(e,o),a=Math.max(e,o),l=this[r],c=this[r]+this[i]-1;if(l>=e&&(this[r]+=n),n>0)e<=c&&e>l&&(this[i]+=n);else if(n<0){if(s<=l&&a>=c)return this.removed=!0,YS($S,this,null),!1;if(l>=s&&l<=a){const t=a-l+1,e=Math.abs(n)-t;this[r]-=e+n,this[i]-=t}else if(l<=s&&c>=a)this[i]+=n;else if(l<=s&&c>=s&&c<a){const t=c-s+1;this[i]-=t}}return YS($S,this,null),!0}isFarther(t,e){return!t||("down"===e?t.row+t.rowspan-1<this.row+this.rowspan-1:"up"===e?t.row>this.row:"right"===e?t.col+t.colspan-1<this.col+this.colspan-1:"left"===e?t.col>this.col:null)}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return GS($S,this)||YS($S,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),GS($S,this)}}var qS=KS;function QS(t,e){JS(t,e),e.add(t)}function JS(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ZS(t,e,n){return(e=tO(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tO(t){var e=eO(t,"string");return"symbol"==typeof e?e:e+""}function eO(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function nO(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var oO=new WeakSet;class iO{constructor(t){QS(this,oO),ZS(this,"plugin",void 0),ZS(this,"mergedCells",[]),ZS(this,"mergedCellsMatrix",new Map),ZS(this,"hot",void 0),this.plugin=t,this.hot=t.hot}static IS_OVERLAPPING_WARNING(t){let{row:e,col:n}=t;return os["a"]`The merged cell declared at [${e}, ${n}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(t,e){var n;return!!this.mergedCellsMatrix.has(t)&&(null!==(n=this.mergedCellsMatrix.get(t).get(e))&&void 0!==n&&n)}getByRange(t){let e=!1;return Object(f["arrayEach"])(this.mergedCells,n=>!(n.row<=t.from.row&&n.row+n.rowspan-1>=t.to.row&&n.col<=t.from.col&&n.col+n.colspan-1>=t.to.col)||(e=n,e)),e}filterOverlappingMergeCells(t){const e=new Set;this.mergedCells.forEach(t=>{const{row:n,col:o,colspan:i,rowspan:r}=t;for(let s=n;s<n+r;s++)for(let t=o;t<o+i;t++)e.add(`r${s},c${t}`)});const n=t.filter(t=>{const{row:n,col:o,colspan:i,rowspan:r}=t,s=new Set;let a=!1;for(let l=n;l<n+r;l++){for(let n=o;n<o+i;n++){const o=`r${l},c${n}`;if(e.has(o)){Object(pi["b"])(iO.IS_OVERLAPPING_WARNING(t)),a=!0;break}s.add(o)}if(a)break}return a||e.add(...s),!a});return n}getWithinRange(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{row:n,col:o}=t.getTopStartCorner(),{row:i,col:r}=t.getBottomEndCorner(),s=[];for(let a=n;a<=i;a++)for(let t=o;t<=r;t++){const n=this.get(a,t);n&&(e||!e&&n.row===a&&n.col===t)&&s.push(n)}return s}add(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=t.row,o=t.col,i=t.rowspan,r=t.colspan,s=new qS(n,o,i,r,this.hot._createCellCoords,this.hot._createCellRange),a=this.get(n,o),l=!e&&this.isOverlapping(s);return a||l?(Object(pi["b"])(iO.IS_OVERLAPPING_WARNING(s)),!1):(this.hot&&s.normalize(this.hot),this.mergedCells.push(s),nO(oO,this,sO).call(this,s),s)}remove(t,e){const n=this.get(t,e),o=n?this.mergedCells.indexOf(n):-1;return!(!n||-1===o)&&(this.mergedCells.splice(o,1),nO(oO,this,aO).call(this,n),n)}clear(){Object(f["arrayEach"])(this.mergedCells,t=>{let{row:e,col:n,rowspan:o,colspan:i}=t;Object(ie["rangeEach"])(e,e+o,t=>{Object(ie["rangeEach"])(n,n+i,e=>{const n=this.hot.getCell(t,e);n&&(n.removeAttribute("rowspan"),n.removeAttribute("colspan"),n.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(t){const e=t.getRange();for(let n=0;n<this.mergedCells.length;n++){const t=this.mergedCells[n],o=t.getRange();if(o.overlaps(e))return!0}return!1}isFirstRenderableMergedCell(t,e){const n=this.get(t,e);return n&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(n.row,1)===t&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(n.col,1)===e}getFirstRenderableCoords(t,e){const n=this.get(t,e);if(!n||this.isFirstRenderableMergedCell(t,e))return this.hot._createCellCoords(t,e);const o=this.hot.rowIndexMapper.getNearestNotHiddenIndex(n.row,1),i=this.hot.columnIndexMapper.getNearestNotHiddenIndex(n.col,1);return this.hot._createCellCoords(o,i)}getStartMostColumnIndex(t,e){const n=nO(oO,this,rO).call(this,t,"col",-1);let o=e;for(let i=0;i<n.length;i++)if(n[i]<=e){o=n[i];break}return o}getEndMostColumnIndex(t,e){const n=nO(oO,this,rO).call(this,t,"col",1);let o=e;for(let i=0;i<n.length;i++)if(n[i]>=e){o=n[i];break}return o}getTopMostRowIndex(t,e){const n=nO(oO,this,rO).call(this,t,"row",-1);let o=e;for(let i=0;i<n.length;i++)if(n[i]<=e){o=n[i];break}return o}getBottomMostRowIndex(t,e){const n=nO(oO,this,rO).call(this,t,"row",1);let o=e;for(let i=0;i<n.length;i++)if(n[i]>=e){o=n[i];break}return o}shiftCollections(t,e,n){const o=[0,0];switch(t){case"right":o[0]+=n;break;case"left":o[0]-=n;break;case"down":o[1]+=n;break;case"up":o[1]-=n;break;default:}const i=[];this.mergedCells.forEach(t=>{t.shift(o,e),t.removed&&i.push(t)}),i.forEach(t=>{this.mergedCells.splice(this.mergedCells.indexOf(t),1)}),this.mergedCellsMatrix.clear(),this.mergedCells.forEach(t=>{nO(oO,this,sO).call(this,t)})}}function rO(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const o=new Map,i=1===n?t.getTopStartCorner():t.getBottomEndCorner(),r=1===n?t.getBottomEndCorner():t.getTopStartCorner();for(let s=i.row;1===n?s<=r.row:s>=r.row;s+=n)for(let t=i.col;1===n?t<=r.col:t>=r.col;t+=n){const i="row"===e?s:t,r=this.get(s,t);let a=i;r&&(a=1===n?r[e]+r[e+"span"]-1:r[e]),o.has(i)||o.set(i,new Set),o.get(i).add(a)}return Array.from(new Set(Array.from(o.entries()).filter(t=>{let[,e]=t;return 1===e.size}).flatMap(t=>{let[,e]=t;return Array.from(e)})))}function sO(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.has(e)||this.mergedCellsMatrix.set(e,new Map),this.mergedCellsMatrix.get(e).set(n,t)}function aO(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.get(e).delete(n)}var lO=iO;function cO(t,e,n){return(e=hO(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hO(t){var e=uO(t,"string");return"symbol"==typeof e?e:e+""}function uO(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class dO{constructor(t){cO(this,"plugin",void 0),cO(this,"mergedCellsCollection",void 0),cO(this,"currentFillData",null),this.plugin=t,this.mergedCellsCollection=this.plugin.mergedCellsCollection}correctSelectionAreaSize(t){if(t[0]===t[2]&&t[1]===t[3]){const e=this.mergedCellsCollection.get(t[0],t[1]);e&&(t[2]=t[0]+e.rowspan-1,t[3]=t[1]+e.colspan-1)}}getDirection(t,e){let n=null;return n=e[0]===t[0]&&e[1]===t[1]&&e[3]===t[3]?"down":e[2]===t[2]&&e[1]===t[1]&&e[3]===t[3]?"up":e[1]===t[1]&&e[2]===t[2]?"right":"left",n}snapDragArea(t,e,n,o){const i=e.slice(0),r=this.getAutofillSize(t,e,n),[s,a,l,c]=t,h=["up","down"].indexOf(n)>-1,u=h?l-s+1:c-a+1,d=Math.floor(r/u)*u,f=r-d,g=this.getFarthestCollection(t,e,n,o);if(g)if("down"===n){const t=g.row+g.rowspan-s-f,e=i[2]+t;e>=this.plugin.hot.countRows()?i[2]-=f:i[2]+=f?t:0}else if("right"===n){const t=g.col+g.colspan-a-f,e=i[3]+t;e>=this.plugin.hot.countCols()?i[3]-=f:i[3]+=f?t:0}else if("up"===n){const t=l-f-g.row+1,e=i[0]+t;e<0?i[0]+=f:i[0]-=f?t:0}else if("left"===n){const t=c-f-g.col+1,e=i[1]+t;e<0?i[1]+=f:i[1]-=f?t:0}return this.updateCurrentFillCache({baseArea:t,dragDirection:n,foundMergedCells:o,fillSize:r,dragArea:i,cycleLength:u}),i}updateCurrentFillCache(t){this.currentFillData||(this.currentFillData={}),Object(l["extend"])(this.currentFillData,t)}getAutofillSize(t,e,n){const[o,i,r,s]=t,[a,l,c,h]=e;switch(n){case"up":return o-a;case"down":return c-r;case"left":return i-l;case"right":return h-s;default:return null}}getDragArea(t,e,n){const[o,i,r,s]=t,[a,l,c,h]=e;switch(n){case"up":return[a,l,o-1,s];case"down":return[r+1,i,c,s];case"left":return[a,l,r,i-1];case"right":return[o,s+1,c,h];default:return null}}getFarthestCollection(t,e,n,o){const[i,r,s,a]=t,l=["up","down"].indexOf(n)>-1,c=l?s:a,h=l?i:r,u=this.getAutofillSize(t,e,n),d=l?s-i+1:a-r+1,g=Math.floor(u/d)*d,p=u-g;let m=null,b=null,w=null;switch(n){case"up":m="includesVertically",w=c-p+1;break;case"left":m="includesHorizontally",w=c-p+1;break;case"down":m="includesVertically",w=h+p-1;break;case"right":m="includesHorizontally",w=h+p-1;break;default:}return Object(f["arrayEach"])(o,t=>{t[m](w)&&t.isFarther(b,n)&&(b=t)}),b}recreateAfterDataPopulation(t){if(!this.currentFillData)return;const e=this.getRangeFromChanges(t),n=this.currentFillData.foundMergedCells,o=this.currentFillData.dragDirection,i=(t,n)=>{switch(o){case"up":return t.row-n>=e.from.row;case"down":return t.row+t.rowspan-1+n<=e.to.row;case"left":return t.col-n>=e.from.column;case"right":return t.col+t.colspan-1+n<=e.to.column;default:return null}};let r=0,s=null,a=1;do{for(let t=0;t<n.length;t+=1){if(s=n[t],r=a*this.currentFillData.cycleLength,i(s,r))switch(o){case"up":this.plugin.mergedCellsCollection.add({row:s.row-r,rowspan:s.rowspan,col:s.col,colspan:s.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:s.row+r,rowspan:s.rowspan,col:s.col,colspan:s.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:s.row,rowspan:s.rowspan,col:s.col-r,colspan:s.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:s.row,rowspan:s.rowspan,col:s.col+r,colspan:s.colspan});break;default:}t===n.length-1&&(a+=1)}}while(i(s,r));this.currentFillData=null,this.plugin.hot.render(),n.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(t){const e={min:null,max:null},n={min:null,max:null};return Object(f["arrayEach"])(t,t=>{const o=t[0],i=this.plugin.hot.propToCol(t[1]);(null===e.min||o<e.min)&&(e.min=o),(null===e.max||o>e.max)&&(e.max=o),(null===n.min||i<n.min)&&(n.min=i),(null===n.max||i>n.max)&&(n.max=i)}),{from:{row:e.min,column:n.min},to:{row:e.max,column:n.max}}}dragAreaOverlapsCollections(t,e,n){const o=this.getDragArea(t,e,n),[i,r,s,a]=o,l=this.plugin.hot._createCellCoords(i,r),c=this.plugin.hot._createCellCoords(s,a),h=this.plugin.hot._createCellRange(l,l,c);return this.mergedCellsCollection.getWithinRange(h,!0).length>0}}var fO=dO;function gO(t,e,n){return(e=pO(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pO(t){var e=mO(t,"string");return"symbol"==typeof e?e:e+""}function mO(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class bO{constructor(t){gO(this,"plugin",void 0),gO(this,"hot",void 0),gO(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=t,this.hot=t.hot}getSelectedMergedCellClassName(t,e,n,o){const i=Math.min(n[0],n[2]),r=Math.min(n[1],n[3]),s=Math.max(n[0],n[2]),a=Math.max(n[1],n[3]);if(void 0===o)return;const l=this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(t,e);if(!l)return;const c=this.plugin.mergedCellsCollection.get(t,e);if(!c)return;const h=c.getLastRow(),u=c.getLastColumn(),d=i<=c.row&&r<=c.col&&s>=h&&a>=u;return d?`${this.fullySelectedMergedCellClassName}-${o}`:this.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange())?this.fullySelectedMergedCellClassName+"-multiple":void 0}isMergeCellFullySelected(t,e){const n=[];if(!e||!t)return!1;for(let o=0;o<t.rowspan;o+=1)for(let e=0;e<t.colspan;e+=1)n.push(this.hot._createCellCoords(t.row+o,t.col+e));for(let o=0;o<n.length;o+=1){const t=[];for(let i=0;i<e.length;i+=1)t[i]=e[i].includes(n[o]);if(!t.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const t=[];for(let e=0;e<=7;e+=1)t.push(`${this.fullySelectedMergedCellClassName}-${e}`);return t.push(this.fullySelectedMergedCellClassName+"-multiple"),t}}var wO=bO;function vO(t){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase(Ft["CONTEXTMENU_ITEMS_UNMERGE_CELLS"])}return this.getTranslatedPhrase(Ft["CONTEXTMENU_ITEMS_MERGE_CELLS"])},callback(){const e=this.getSelectedRangeLast();if(!e)return;e.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:n,to:o}=e;t.toggleMerge(e),this.selectCell(n.row,n.col,o.row,o.col,!1)},disabled(){const t=this.getSelectedLast();if(!t)return!0;const e=qS.isSingleCell({row:t[0],col:t[1],rowspan:t[2]-t[0]+1,colspan:t[3]-t[1]+1});return e||this.selection.isSelectedByCorner()},hidden:!1}}function yO(t,e,n){return(e=CO(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function CO(t){var e=SO(t,"string");return"symbol"==typeof e?e:e+""}function SO(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class OO{constructor(t){yO(this,"data",void 0),yO(this,"next",null),yO(this,"prev",null),this.data=t}}class EO{constructor(){yO(this,"first",null),yO(this,"last",null)}push(t){const e=new OO(t);if(null===this.first)this.first=e,this.last=e;else{const t=this.last;this.last=e,e.prev=t,t.next=e}return e}unshift(t){const e=new OO(t);if(null===this.first)this.first=e,this.last=e;else{const t=this.first;this.first=e,e.next=t,t.prev=e}}inorder(t){let e=this.first;while(e){const n=t(e);if(e===this.last||!0===n)break;e=e.next}}remove(t){if(null===this.first)return!1;let e,n,o=this.first;while(o){if(o.data===t)return e=o.next,n=o.prev,e&&(e.prev=n),n&&(n.next=e),o===this.first&&(this.first=e),o===this.last&&(this.last=n),!0;o=o.next}return!1}hasCycle(){let t=this.first,e=this.first;while(1){if(null===t)return!1;if(t=t.next,null===t)return!1;if(t=t.next,e=e.next,t===e)return!0}}pop(){if(null===this.last)return null;const t=this.last;return this.last=this.last.prev,t}shift(){if(null===this.first)return null;const t=this.first;return this.first=this.first.next,t}recursiveReverse(){function t(e,n){n&&(t(n,n.next),n.next=e)}if(!this.first)return;t(this.first,this.first.next),this.first.next=null;const e=this.first;this.first=this.last,this.last=e}reverse(){if(!this.first||!this.first.next)return;let t,e=this.first.next,n=this.first;while(e)t=e.next,e.next=n,n.prev=e,n=e,e=t;this.first.next=null,this.last.prev=null,t=this.first,this.first=n,this.last=t}}var RO=EO;function TO(t,e){IO(t,e),e.add(t)}function MO(t,e,n){IO(t,e),e.set(t,n)}function IO(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xO(t,e){return t.get(AO(t,e))}function NO(t,e,n){return t.set(AO(t,e),n),n}function AO(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var HO=new WeakMap,jO=new WeakMap,_O=new WeakMap,kO=new WeakMap,PO=new WeakMap,DO=new WeakMap,LO=new WeakMap,FO=new WeakSet;class VO{constructor(t){let{mergedCellsGetter:e,rowIndexMapper:n,columnIndexMapper:o}=t;TO(this,FO),MO(this,HO,new RO),MO(this,jO,new RO),MO(this,_O,null),MO(this,kO,null),MO(this,PO,null),MO(this,DO,null),MO(this,LO,null),NO(PO,this,e),NO(DO,this,n),NO(LO,this,o)}getCurrentVerticalNode(){return xO(kO,this).data}getFirstVerticalNode(){return xO(jO,this).first.data}getNextVerticalNode(){return xO(kO,this).next.data}getPrevVerticalNode(){return xO(kO,this).prev.data}getCurrentHorizontalNode(){return xO(_O,this).data}getFirstHorizontalNode(){return xO(HO,this).first.data}getNextHorizontalNode(){return xO(_O,this).next.data}getPrevHorizontalNode(){return xO(_O,this).prev.data}setPrevNodeAsActive(){NO(kO,this,xO(kO,this).prev),NO(_O,this,xO(_O,this).prev)}setNextNodeAsActive(){NO(kO,this,xO(kO,this).next),NO(_O,this,xO(_O,this).next)}buildFocusOrder(t){const e=t.getTopStartCorner(),n=t.getBottomEndCorner(),o=new WeakSet;NO(HO,this,new RO);for(let r=e.row;r<=n.row;r++)if(!xO(DO,this).isHidden(r))for(let i=e.col;i<=n.col;i++){if(xO(LO,this).isHidden(i))continue;const e=AO(FO,this,WO).call(this,t,xO(HO,this),o,r,i);e&&NO(_O,this,e)}xO(HO,this).first&&(xO(HO,this).first.prev=xO(HO,this).last,xO(HO,this).last.next=xO(HO,this).first);const i=new WeakSet;NO(jO,this,new RO);for(let r=e.col;r<=n.col;r++)if(!xO(LO,this).isHidden(r))for(let o=e.row;o<=n.row;o++){if(xO(DO,this).isHidden(o))continue;const e=AO(FO,this,WO).call(this,t,xO(jO,this),i,o,r);e&&NO(kO,this,e)}xO(jO,this).first&&(xO(jO,this).first.prev=xO(jO,this).last,xO(jO,this).last.next=xO(jO,this).first)}setActiveNode(t,e){return xO(HO,this).inorder(n=>{const{rowStart:o,rowEnd:i,colStart:r,colEnd:s}=n.data;if(t>=o&&t<=i&&e>=r&&e<=s)return NO(_O,this,n),!1}),xO(jO,this).inorder(n=>{const{rowStart:o,rowEnd:i,colStart:r,colEnd:s}=n.data;if(t>=o&&t<=i&&e>=r&&e<=s)return NO(kO,this,n),!1}),this}}function WO(t,e,n,o,i){const r=t.getTopStartCorner(),s=t.getBottomEndCorner(),a=t.highlight.clone().normalize(),l=xO(PO,this).call(this,o,i);if(l&&n.has(l))return null;const c={colStart:i,colEnd:i,rowStart:o,rowEnd:o};if(l){if(n.add(l),l.row<r.row||l.row+l.rowspan-1>s.row||l.col<r.col||l.col+l.colspan-1>s.col)return null;c.colStart=l.col,c.colEnd=l.col+l.colspan-1,c.rowStart=l.row,c.rowEnd=l.row+l.rowspan-1}const h=e.push(c);return o===a.row&&i===a.col||l&&a.row>=l.row&&a.row<=l.row+l.rowspan-1&&a.col>=l.col&&a.col<=l.col+l.colspan-1?h:null}function BO(t){const{hot:e}=t,{rowIndexMapper:n,columnIndexMapper:o}=e;function i(){}function r(e,i,r){const s=t.mergedCellsCollection.get(i,r);if(!Object(l["isObject"])(s))return e.removeAttribute("rowspan"),e.removeAttribute("colspan"),void(e.style.display="");const{row:a,col:c,colspan:h,rowspan:u}=s,[d,f]=t.translateMergedCellToRenderable(a,u,c,h),g=n.getRenderableFromVisualIndex(i),p=o.getRenderableFromVisualIndex(r),m=d-g+1,b=f-p+1,w=n.getNearestNotHiddenIndex(a,1),v=o.getNearestNotHiddenIndex(c,1),y=Math.min(u,m),C=Math.min(h,b);w===i&&v===r?(e.setAttribute("rowspan",y),e.setAttribute("colspan",C)):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="none")}return{before:i,after:r}}function UO(t,e){GO(t,e),e.add(t)}function zO(t,e,n){GO(t,e),e.set(t,n)}function GO(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function YO(t,e,n){return(e=XO(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function XO(t){var e=$O(t,"string");return"symbol"==typeof e?e:e+""}function $O(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function KO(t,e,n){return t.set(QO(t,e),n),n}function qO(t,e){return t.get(QO(t,e))}function QO(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}mt["a"].getSingleton().register("beforeMergeCells"),mt["a"].getSingleton().register("afterMergeCells"),mt["a"].getSingleton().register("beforeUnmergeCells"),mt["a"].getSingleton().register("afterUnmergeCells");const JO="mergeCells",ZO=150,tE=JO;var eE=new WeakMap,nE=new WeakMap,oE=new WeakMap,iE=new WeakMap,rE=new WeakSet;class sE extends bn{constructor(){super(...arguments),UO(this,rE),YO(this,"mergedCellsCollection",null),YO(this,"autofillCalculations",null),YO(this,"selectionCalculations",null),zO(this,eE,null),zO(this,nE,{row:0,col:0}),zO(this,oE,new VO({mergedCellsGetter:(t,e)=>this.mergedCellsCollection.get(t,e),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),zO(this,iE,BO(this))}static get PLUGIN_KEY(){return JO}static get PLUGIN_PRIORITY(){return ZO}isEnabled(){return!!this.hot.getSettings()[JO]}enablePlugin(){var t=this;this.enabled||(this.mergedCellsCollection=new lO(this),this.autofillCalculations=new fO(this),this.selectionCalculations=new wO(this),this.addHook("afterInit",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return QO(rE,t,aE).call(t,...n)})),this.addHook("modifyTransformFocus",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return QO(rE,t,cE).call(t,...n)})),this.addHook("modifyTransformStart",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return QO(rE,t,hE).call(t,...n)})),this.addHook("modifyTransformEnd",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return QO(rE,t,uE).call(t,...n)})),this.addHook("beforeSelectionHighlightSet",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return QO(rE,t,dE).call(t,...n)})),this.addHook("beforeSetRangeStart",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return QO(rE,t,pE).call(t,...n)})),this.addHook("beforeSetRangeStartOnly",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return QO(rE,t,pE).call(t,...n)})),this.addHook("beforeSelectionFocusSet",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return QO(rE,t,mE).call(t,...n)})),this.addHook("afterSelectionFocusSet",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return QO(rE,t,bE).call(t,...n)})),this.addHook("afterSelectionEnd",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return QO(rE,t,wE).call(t,...n)})),this.addHook("modifyGetCellCoords",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return QO(rE,t,fE).call(t,...n)})),this.addHook("afterIsMultipleSelection",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return QO(rE,t,lE).call(t,...n)})),this.addHook("afterRenderer",(function(){return qO(iE,t).after(...arguments)})),this.addHook("afterContextMenuDefaultOptions",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return QO(rE,t,gE).call(t,...n)})),this.addHook("afterGetCellMeta",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return QO(rE,t,vE).call(t,...n)})),this.addHook("afterViewportRowCalculatorOverride",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return QO(rE,t,yE).call(t,...n)})),this.addHook("afterViewportColumnCalculatorOverride",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return QO(rE,t,CE).call(t,...n)})),this.addHook("modifyAutofillRange",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return QO(rE,t,SE).call(t,...n)})),this.addHook("afterCreateCol",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return QO(rE,t,OE).call(t,...n)})),this.addHook("afterRemoveCol",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return QO(rE,t,EE).call(t,...n)})),this.addHook("afterCreateRow",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return QO(rE,t,RE).call(t,...n)})),this.addHook("afterRemoveRow",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return QO(rE,t,TE).call(t,...n)})),this.addHook("afterChange",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return QO(rE,t,ME).call(t,...n)})),this.addHook("beforeDrawBorders",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return QO(rE,t,IE).call(t,...n)})),this.addHook("afterDrawSelection",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return QO(rE,t,xE).call(t,...n)})),this.addHook("beforeRemoveCellClassNames",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return QO(rE,t,NE).call(t,...n)})),this.addHook("beforeBeginEditing",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return QO(rE,t,AE).call(t,...n)})),this.addHook("modifyRowHeightByOverlayName",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return QO(rE,t,HE).call(t,...n)})),this.addHook("beforeUndoStackChange",(t,e)=>{if("MergeCells"===e)return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){const t=this.hot.getSettings()[JO];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(t),super.updatePlugin()}ifChromeForceRepaint(){if(!Object(b["isChrome"])())return;const t=[];let e=[];this.mergedCellsCollection.mergedCells.forEach(t=>{const{row:n,rowspan:o}=t;for(let i=n+1;i<n+o;i++)e.push(i)}),e=[...new Set(e)],e.forEach(e=>{const n=this.hot.rowIndexMapper.getRenderableFromVisualIndex(e);this.hot.view._wt.wtOverlays.getOverlays(!0).map(t=>"master"===(null===t||void 0===t?void 0:t.name)?t:t.clone.wtTable).forEach(e=>{const o=e.getRow(n);o&&(o.style.background=Object(s["getStyle"])(o,"backgroundColor").replace(")",", 0.99)"),t.push(o))})}),this.hot._registerTimeout(()=>{t.forEach(t=>{t.style.background=Object(s["getStyle"])(t,"backgroundColor").replace(", 0.99)",")")})},1)}validateSetting(t){return!!t&&(qS.containsNegativeValues(t)?(Object(pi["b"])(qS.NEGATIVE_VALUES_WARNING(t)),!1):qS.isOutOfBounds(t,this.hot.countRows(),this.hot.countCols())?(Object(pi["b"])(qS.IS_OUT_OF_BOUNDS_WARNING(t)),!1):qS.isSingleCell(t)?(Object(pi["b"])(qS.IS_SINGLE_CELL(t)),!1):!qS.containsZeroSpan(t)||(Object(pi["b"])(qS.ZERO_SPAN_WARNING(t)),!1))}generateFromSettings(t){if(!Array.isArray(t))return;const e=t.filter(t=>this.validateSetting(t)),n=this.mergedCellsCollection.filterOverlappingMergeCells(e),o=[];n.forEach(t=>{const{row:e,col:n,rowspan:i,colspan:r}=t,s=this.hot._createCellCoords(e,n),a=this.hot._createCellCoords(e+i-1,n+r-1),l=this.hot._createCellRange(s,s,a);this.mergeRange(l,!0,!0);for(let c=e;c<e+i;c++)for(let t=n;t<n+r;t++)c===e&&t===n||o.push([c,t,null])}),0!==o.length&&this.hot.setDataAtCell(o,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!!e||this.validateSetting(t)}mergeSelection(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(!t)return;t.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:e,to:n}=t;this.unmergeRange(t,!0),this.mergeRange(t),this.hot.selectCell(e.row,e.col,n.row,n.col,!1)}unmergeSelection(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(!t)return;const{from:e,to:n}=t;this.unmergeRange(t,!0),this.hot.selectCell(e.row,e.col,n.row,n.col,!1)}mergeRange(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o=t.getTopStartCorner(),i=t.getBottomEndCorner(),r={row:o.row,col:o.col,rowspan:i.row-o.row+1,colspan:i.col-o.col+1},s=[];let a=null;if(!this.canMergeRange(r,e))return!1;this.hot.runHooks("beforeMergeCells",t,e),Object(ie["rangeEach"])(0,r.rowspan-1,t=>{Object(ie["rangeEach"])(0,r.colspan-1,e=>{let n=null;s[t]||(s[t]=[]),0===t&&0===e?n=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(r.row),this.hot.toPhysicalColumn(r.col)):this.hot.setCellMeta(r.row+t,r.col+e,"hidden",!0),s[t][e]=n})}),this.hot.setCellMeta(r.row,r.col,"spanned",!0);const l=this.mergedCellsCollection.add(r,e);return!l||(n?a=[r.row,r.col,s]:this.hot.populateFromArray(r.row,r.col,s,void 0,void 0,this.pluginName),e||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",t,r,e),a)}unmergeRange(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=this.mergedCellsCollection.getWithinRange(t);0!==n.length&&(this.hot.runHooks("beforeUnmergeCells",t,e),Object(f["arrayEach"])(n,t=>{this.mergedCellsCollection.remove(t.row,t.col),Object(ie["rangeEach"])(0,t.rowspan-1,e=>{Object(ie["rangeEach"])(0,t.colspan-1,n=>{this.hot.removeCellMeta(t.row+e,t.col+n,"hidden"),this.hot.removeCellMeta(t.row+e,t.col+n,"copyable")})}),this.hot.removeCellMeta(t.row,t.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",t,e),this.hot.render())}toggleMerge(t){const e=this.mergedCellsCollection.get(t.from.row,t.from.col),n=e.row===t.from.row&&e.col===t.from.col&&e.row+e.rowspan-1===t.to.row&&e.col+e.colspan-1===t.to.col;n?this.unmergeRange(t):this.mergeSelection(t)}merge(t,e,n,o){const i=this.hot._createCellCoords(t,e),r=this.hot._createCellCoords(n,o);this.mergeRange(this.hot._createCellRange(i,i,r))}unmerge(t,e,n,o){const i=this.hot._createCellCoords(t,e),r=this.hot._createCellCoords(n,o);this.unmergeRange(this.hot._createCellRange(i,i,r))}registerShortcuts(){const t=this.hot.getShortcutManager(),e=t.getContext("grid");e.addShortcut({keys:[["Control","m"]],callback:()=>{const t=this.hot.getSelectedRangeLast();t&&!t.isSingleHeader()&&(this.toggleMerge(t),this.hot.render())},runOnlyIf:t=>!t.altKey,group:tE})}unregisterShortcuts(){const t=this.hot.getShortcutManager(),e=t.getContext("grid");e.removeShortcutsByGroup(tE)}modifyViewportRowStart(t,e){const n=this.hot.rowIndexMapper,o=n.getVisualFromRenderableIndex(t.startRow);for(let i=0;i<e;i+=1){const r=this.mergedCellsCollection.get(o,i);if(Object(l["isObject"])(r)){const o=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(r.row,1));if(o<t.startRow)return t.startRow=o,void this.modifyViewportRowStart(t,e)}}}modifyViewportRowEnd(t,e){const n=this.hot.rowIndexMapper,o=n.getVisualFromRenderableIndex(t.endRow);for(let i=0;i<e;i+=1){const r=this.mergedCellsCollection.get(o,i);if(Object(l["isObject"])(r)){const o=r.row+r.rowspan-1,i=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(o,-1));if(i>t.endRow)return t.endRow=i,void this.modifyViewportRowEnd(t,e)}}}modifyViewportColumnStart(t,e){const n=this.hot.columnIndexMapper,o=n.getVisualFromRenderableIndex(t.startColumn);for(let i=0;i<e;i+=1){const r=this.mergedCellsCollection.get(i,o);if(Object(l["isObject"])(r)){const o=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(r.col,1));if(o<t.startColumn)return t.startColumn=o,void this.modifyViewportColumnStart(t,e)}}}modifyViewportColumnEnd(t,e){const n=this.hot.columnIndexMapper,o=n.getVisualFromRenderableIndex(t.endColumn);for(let i=0;i<e;i+=1){const r=this.mergedCellsCollection.get(i,o);if(Object(l["isObject"])(r)){const o=r.col+r.colspan-1,i=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(o,-1));if(i>t.endColumn)return t.endColumn=i,void this.modifyViewportColumnEnd(t,e)}}}translateMergedCellToRenderable(t,e,n,o){const{rowIndexMapper:i,columnIndexMapper:r}=this.hot;let s,a;s=0===e?i.getNearestNotHiddenIndex(t,1):i.getNearestNotHiddenIndex(t+e-1,-1),a=0===o?r.getNearestNotHiddenIndex(n,1):r.getNearestNotHiddenIndex(n+o-1,-1);const l=t>=0?i.getRenderableFromVisualIndex(s):t,c=n>=0?r.getRenderableFromVisualIndex(a):n;return[l,c]}}function aE(){this.generateFromSettings(this.hot.getSettings()[JO]),this.hot.render()}function lE(t){if(t){const t=this.mergedCellsCollection.mergedCells,e=this.hot.getSelectedRangeLast(),n=e.getTopStartCorner(),o=e.getBottomEndCorner();for(let i=0;i<t.length;i+=1)if(n.row===t[i].row&&n.col===t[i].col&&o.row===t[i].row+t[i].rowspan-1&&o.col===t[i].col+t[i].colspan-1)return!1}return t}function cE(t){qO(nE,this).row=t.row,qO(nE,this).col=t.col}function hE(t){const e=this.hot.getSelectedRangeLast(),{highlight:n}=e,{columnIndexMapper:o,rowIndexMapper:i}=this.hot;qO(eE,this)&&(null!==i.getRenderableFromVisualIndex(qO(eE,this).row)&&(n.row=qO(eE,this).row),null!==o.getRenderableFromVisualIndex(qO(eE,this).col)&&(n.col=qO(eE,this).col),KO(eE,this,null));const r=this.mergedCellsCollection.get(n.row,n.col);if(!r)return;const s=r.col,a=r.col+r.colspan-1;if(t.col<0){const e=n.col>=s&&n.col<=a?s-1:a,i=o.getNearestNotHiddenIndex(e,-1);t.col=null===i?-this.hot.view.countRenderableColumnsInRange(0,n.col):-Math.max(this.hot.view.countRenderableColumnsInRange(i,n.col)-1,1)}else if(t.col>0){const e=n.col>=s&&n.col<=a?a+1:s,i=o.getNearestNotHiddenIndex(e,1);t.col=null===i?this.hot.view.countRenderableColumnsInRange(n.col,this.hot.countCols()):Math.max(this.hot.view.countRenderableColumnsInRange(n.col,i)-1,1)}const l=r.row,c=r.row+r.rowspan-1;if(t.row<0){const e=n.row>=l&&n.row<=c?l-1:c,o=i.getNearestNotHiddenIndex(e,-1);t.row=null===o?-this.hot.view.countRenderableRowsInRange(0,n.row):-Math.max(this.hot.view.countRenderableRowsInRange(o,n.row)-1,1)}else if(t.row>0){const e=n.row>=l&&n.row<=c?c+1:l,o=i.getNearestNotHiddenIndex(e,1);t.row=null===o?this.hot.view.countRenderableRowsInRange(n.row,this.hot.countRows()):Math.max(this.hot.view.countRenderableRowsInRange(n.row,o)-1,1)}}function uE(t){const e=this.hot.getSelectedRangeLast(),n=e.clone(),{to:o}=e,{columnIndexMapper:i,rowIndexMapper:r}=this.hot,s=(t,e)=>{n.expand(this.hot._createCellCoords(t,e));for(let o=0;o<this.mergedCellsCollection.mergedCells.length;o+=1)n.expandByRange(this.mergedCellsCollection.mergedCells[o].getRange())};if(t.col<0){let r=this.mergedCellsCollection.getStartMostColumnIndex(e,o.col)+t.col;s(o.row,r),"E-W"===e.getHorizontalDirection()&&"E-W"===n.getHorizontalDirection()&&(r=n.getTopStartCorner().col);const a=i.getNearestNotHiddenIndex(r,1);null!==a&&(t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,o.col)-1,1))}else if(t.col>0){let r=this.mergedCellsCollection.getEndMostColumnIndex(e,o.col)+t.col;s(o.row,r),"W-E"===e.getHorizontalDirection()&&"W-E"===n.getHorizontalDirection()&&(r=n.getBottomEndCorner().col);const a=i.getNearestNotHiddenIndex(r,-1);null!==a&&(t.col=Math.max(this.hot.view.countRenderableColumnsInRange(o.col,a)-1,1))}if(t.row<0){let i=this.mergedCellsCollection.getTopMostRowIndex(e,o.row)+t.row;s(i,o.col),"S-N"===e.getVerticalDirection()&&"S-N"===n.getVerticalDirection()&&(i=n.getTopStartCorner().row);const a=r.getNearestNotHiddenIndex(i,1);null!==a&&(t.row=-Math.max(this.hot.view.countRenderableRowsInRange(a,o.row)-1,1))}else if(t.row>0){let i=this.mergedCellsCollection.getBottomMostRowIndex(e,o.row)+t.row;s(i,o.col),"N-S"===e.getVerticalDirection()&&"N-S"===n.getVerticalDirection()&&(i=n.getBottomStartCorner().row);const a=r.getNearestNotHiddenIndex(i,-1);null!==a&&(t.row=Math.max(this.hot.view.countRenderableRowsInRange(o.row,a)-1,1))}}function dE(){const t=this.hot.getSelectedRangeLast(),{highlight:e}=t;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader())return void KO(eE,this,e.clone());for(let o=0;o<this.mergedCellsCollection.mergedCells.length;o+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[o].getRange(),!1);for(let o=0;o<this.mergedCellsCollection.mergedCells.length;o+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[o].getRange(),!1);const n=this.mergedCellsCollection.get(e.row,e.col);KO(eE,this,e.clone()),n&&e.assign(n)}function fE(t,e){if(t<0||e<0)return;const n=this.mergedCellsCollection.get(t,e);if(!n)return;const{row:o,col:i,colspan:r,rowspan:s}=n;return[o,i,o+s-1,i+r-1]}function gE(t){t.items.push({name:"---------"},vO(this))}function pE(){KO(eE,this,null)}function mE(){if(qO(eE,this).isCell())return;const t=this.hot.getSelectedRangeLast(),e=t.getVerticalDirection(),n=t.getHorizontalDirection(),o=qO(eE,this).clone().normalize();qO(oE,this).setActiveNode(o.row,o.col),qO(nE,this).row>0||qO(nE,this).col>0?qO(oE,this).setPrevNodeAsActive():("E-W"===n&&qO(nE,this).col<0||"S-N"===e&&qO(nE,this).row<0)&&qO(oE,this).setNextNodeAsActive()}function bE(t,e){const n=this.hot.getSelectedRangeLast(),{columnIndexMapper:o,rowIndexMapper:i}=this.hot;let r=null,s=null;if(qO(nE,this).col<0){const{rowEnd:t,colEnd:e}=qO(oE,this).getPrevHorizontalNode();s=o.getNearestNotHiddenIndex(e,-1),r=i.getNearestNotHiddenIndex(t,-1)}else if(qO(nE,this).col>0){const{rowStart:t,colStart:e}=qO(oE,this).getNextHorizontalNode();s=o.getNearestNotHiddenIndex(e,1),r=i.getNearestNotHiddenIndex(t,1)}else if(qO(nE,this).row<0){const{rowEnd:t,colEnd:e}=qO(oE,this).getPrevVerticalNode();s=o.getNearestNotHiddenIndex(e,-1),r=i.getNearestNotHiddenIndex(t,-1)}else if(qO(nE,this).row>0){const{rowStart:t,colStart:e}=qO(oE,this).getNextVerticalNode();s=o.getNearestNotHiddenIndex(e,1),r=i.getNearestNotHiddenIndex(t,1)}if(null!==r||null!==s){const o=this.hot._createCellCoords(r,s),i=this.mergedCellsCollection.get(o.row,o.col),a=this.hot.selection.highlight.getFocus();t=o.row,e=o.col,i?n.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(i.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(i.col,1)}):n.highlight.assign(o),a.clear(),a.add(o).commit()}qO(oE,this).setActiveNode(t,e),KO(nE,this,{row:0,col:0})}function wE(){const t=this.hot.getSelectedRangeLast();t.isHeader()||qO(oE,this).buildFocusOrder(this.hot.getSelectedRangeLast())}function vE(t,e,n){const o=this.mergedCellsCollection.get(t,e);o&&(o.row!==t||o.col!==e?n.copyable=!1:(n.rowspan=o.rowspan,n.colspan=o.colspan))}function yE(t){const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function CE(t){const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function SE(t,e){this.autofillCalculations.correctSelectionAreaSize(e);const n=this.autofillCalculations.getDirection(e,t);let o=t;if(this.autofillCalculations.dragAreaOverlapsCollections(e,o,n))return o=e,o;const i=this.hot._createCellCoords(e[0],e[1]),r=this.hot._createCellCoords(e[2],e[3]),s=this.hot._createCellRange(i,i,r),a=this.mergedCellsCollection.getWithinRange(s);return 0===a.length||(o=this.autofillCalculations.snapDragArea(e,o,n,a)),o}function OE(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function EE(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function RE(t,e,n){"auto"!==n&&this.mergedCellsCollection.shiftCollections("down",t,e)}function TE(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function ME(t,e){"Autofill.fill"===e&&this.autofillCalculations.recreateAfterDataPopulation(t)}function IE(t,e){if(e&&"area"===e){const e=this.hot.getSelectedRangeLast(),n=this.mergedCellsCollection.getWithinRange(e);Object(f["arrayEach"])(n,n=>{e.getBottomEndCorner().row===n.getLastRow()&&e.getBottomEndCorner().col===n.getLastColumn()&&(t[2]=n.row,t[3]=n.col)})}}function xE(t,e,n,o){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,n,o)}function NE(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function AE(t,e,n,o){if(!(o instanceof MouseEvent))return;const i=this.hot.getSelectedRangeLast(),r=this.mergedCellsCollection.getByRange(i);if(!r)return;const s=this.hot._createCellCoords(r.row,r.col),a=this.hot._createCellCoords(r.row+r.rowspan-1,r.col+r.colspan-1);return 0===this.hot.selection.getLayerLevel()&&i.isEqual(this.hot._createCellRange(s,s,a))}function HE(t,e,n){if(this.hot.getSettings().rowHeaders||"bottom"===n||"bottom_inline_start_corner"===n)return t;let o,i;if("master"===n)o=this.hot.view.getFirstRenderedVisibleColumn(),i=this.hot.view.getLastRenderedVisibleColumn();else{const t=this.hot.view.getOverlayByName(n);o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(t.clone.wtTable.getFirstRenderedColumn()),i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(t.clone.wtTable.getLastRenderedColumn())}const r=this.mergedCellsCollection.get(e,o);if(!r)return t;const s=this.hot._createCellCoords(e,o),a=this.hot._createCellCoords(e,i),l=this.hot._createCellRange(s,s,a),c=this.mergedCellsCollection.getWithinRange(l),h=c.reduce((t,e)=>{let{rowspan:n}=e;return Math.max(t,n)},1);let u=0;return c.length>1&&c[0].rowspan<h&&(u=h-c[0].rowspan),c.forEach(o=>{var i;let{rowspan:r}=o,s=0;s="top"===n||"top_inline_start_corner"===n?Math.min(h,this.hot.view.countNotHiddenFixedRowsTop()-e):r-u,t=Math.max(null!==(i=t)&&void 0!==i?i:0,QO(rE,this,jE).call(this,e,s))}),t}function jE(t,e){const n=this.hot.view._wt.wtSettings.getSettingPure("defaultRowHeight"),o=this.hot.getPlugin("autoRowSize");let i=0;for(let s=t;s<t+e;s++){var r;if(!this.hot.rowIndexMapper.isHidden(s))i+=null!==(r=null===o||void 0===o?void 0:o.getRowHeight(s))&&void 0!==r?r:n}return i}function _E(t,e){return function(n,o){const[,...i]=n,[,...r]=o;return function n(o){const s=t[o],a=e[o],l=i[o],c=r[o],h=a.multiColumnSorting,u=h.compareFunctionFactory?h.compareFunctionFactory:ur(a.type),d=u(s,a,h)(l,c);if(d===dr){const t=o+1;if("undefined"!==typeof e[t])return n(t)}return d}(0)}}function kE(){Object(pi["b"])(os["a"]`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously. 
    Only \`multiColumnSorting\` will work. The \`columnSorting\` plugin will be disabled.`)}const PE="sort";function DE(t,e,n){const o=[];return!1===n||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&o.push(`${PE}-${t.getIndexOfColumnInSortQueue(e)+1}`),o}function LE(t){const e=t.className.split(" "),n=new RegExp(`^${PE}-[0-9]{1,2}$`);return e.filter(t=>n.test(t))}function FE(t,e,n){return(e=VE(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function VE(t){var e=WE(t,"string");return"symbol"==typeof e?e:e+""}function WE(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}const BE="multiColumnSorting",UE=170,zE="columnSorting",GE=BE;cr(BE,_E);class YE extends Xr{constructor(){super(...arguments),FE(this,"pluginKey",BE)}static get PLUGIN_KEY(){return BE}static get PLUGIN_PRIORITY(){return UE}isEnabled(){return super.isEnabled()}enablePlugin(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[zE]&&(kE(),this.hot.getPlugin(zE).disablePlugin()),super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:t}=this.hot.getSelectedRangeLast();return-1===t.row&&t.col>=0&&this.sort(this.getNextSortConfig(t.col,Ur)),!1},runOnlyIf:()=>{var t,e;const n=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return n&&(null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.isSingle())&&this.hot.selection.isCellVisible(n)&&n.isHeader()},relativeToGroup:c["a"],position:"before",group:GE})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(GE)}sort(t){super.sort(t)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(t){return super.getSortConfig(t)}setSortConfig(t){super.setSortConfig(t)}getNormalizedSortConfigs(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(t)?t:[t]}updateHeaderClasses(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];super.updateHeaderClasses(t,...n),Object(s["removeClass"])(t,LE(t)),!1!==this.enabled&&Object(s["addClass"])(t,DE(...n))}onUpdateSettings(t){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[zE]&&kE(),super.onUpdateSettings(t)}onAfterOnCellMouseDown(t,e){!1!==Er(e.row,e.col,t)&&this.wasClickableHeaderClicked(t,e.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(e.col),this.sort(this.getNextSortConfig(e.col,Ur))):this.sort(this.getColumnNextConfig(e.col)))}}function XE(t,e,n){return(e=$E(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $E(t){var e=KE(t,"string");return"symbol"==typeof e?e:e+""}function KE(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}const qE="multipleSelectionHandles",QE=160;class JE extends bn{constructor(){super(...arguments),XE(this,"dragged",[]),XE(this,"lastSetCell",null)}static get PLUGIN_KEY(){return qE}static get PLUGIN_PRIORITY(){return QE}isEnabled(){return Object(b["isMobileBrowser"])()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const t=this,{rootElement:e}=this.hot;function n(e){if(1===t.dragged.length)return t.dragged.splice(0,t.dragged.length),!0;const n=t.dragged.indexOf(e);if(-1===n)return!1;0===n?t.dragged=t.dragged.slice(0,1):1===n&&(t.dragged=t.dragged.slice(-1))}this.eventManager.addEventListener(e,"touchstart",e=>{let n;return Object(s["hasClass"])(e.target,"topSelectionHandle-HitArea")?(n=t.hot.getSelectedRangeLast(),t.dragged.push("top"),t.touchStartRange={width:n.getWidth(),height:n.getHeight(),direction:n.getDirection()},e.preventDefault(),!1):Object(s["hasClass"])(e.target,"bottomSelectionHandle-HitArea")?(n=t.hot.getSelectedRangeLast(),t.dragged.push("bottom"),t.touchStartRange={width:n.getWidth(),height:n.getHeight(),direction:n.getDirection()},e.preventDefault(),!1):void 0}),this.eventManager.addEventListener(e,"touchend",e=>Object(s["hasClass"])(e.target,"topSelectionHandle-HitArea")?(n.call(t,"top"),t.touchStartRange=void 0,e.preventDefault(),!1):Object(s["hasClass"])(e.target,"bottomSelectionHandle-HitArea")?(n.call(t,"bottom"),t.touchStartRange=void 0,e.preventDefault(),!1):void 0),this.eventManager.addEventListener(e,"touchmove",e=>{const{rootDocument:n}=this.hot;let o,i,r,s,a,l;if(0===t.dragged.length)return;const c=n.elementFromPoint(e.touches[0].clientX,e.touches[0].clientY);c&&c!==t.lastSetCell&&("TD"!==c.nodeName&&"TH"!==c.nodeName||(o=t.hot.getCoords(c),-1===o.col&&(o.col=0),i=t.hot.getSelectedRangeLast(),r=i.getWidth(),s=i.getHeight(),a=i.getDirection(),1===r&&1===s&&t.hot.selection.setRangeEnd(o),l=t.getCurrentRangeCoords(i,o,t.touchStartRange.direction,a,t.dragged[0]),null!==l.start&&t.hot.selection.setRangeStart(l.start),t.hot.selection.setRangeEnd(l.end),t.lastSetCell=c),e.preventDefault())})}getCurrentRangeCoords(t,e,n,o,i){const r=t.getTopStartCorner(),s=t.getBottomEndCorner(),a=t.getBottomStartCorner(),l=t.getTopEndCorner();let c={start:null,end:null};switch(n){case"NE-SW":switch(o){case"NE-SW":case"NW-SE":c="top"===i?{start:this.hot._createCellCoords(e.row,t.highlight.col),end:this.hot._createCellCoords(a.row,e.col)}:{start:this.hot._createCellCoords(t.highlight.row,e.col),end:this.hot._createCellCoords(e.row,r.col)};break;case"SE-NW":"bottom"===i&&(c={start:this.hot._createCellCoords(s.row,e.col),end:this.hot._createCellCoords(e.row,r.col)});break;default:break}break;case"NW-SE":switch(o){case"NE-SW":"top"===i?c={start:e,end:a}:c.end=e;break;case"NW-SE":"top"===i?c={start:e,end:s}:c.end=e;break;case"SE-NW":"top"===i?c={start:e,end:r}:c.end=e;break;case"SW-NE":"top"===i?c={start:e,end:l}:c.end=e;break;default:break}break;case"SW-NE":switch(o){case"NW-SE":c="bottom"===i?{start:this.hot._createCellCoords(e.row,r.col),end:this.hot._createCellCoords(a.row,e.col)}:{start:this.hot._createCellCoords(r.row,e.col),end:this.hot._createCellCoords(e.row,s.col)};break;case"SW-NE":c="top"===i?{start:this.hot._createCellCoords(t.highlight.row,e.col),end:this.hot._createCellCoords(e.row,s.col)}:{start:this.hot._createCellCoords(e.row,r.col),end:this.hot._createCellCoords(r.row,e.col)};break;case"SE-NW":"bottom"===i?c={start:this.hot._createCellCoords(e.row,l.col),end:this.hot._createCellCoords(r.row,e.col)}:"top"===i&&(c={start:a,end:e});break;default:break}break;case"SE-NW":switch(o){case"NW-SE":case"NE-SW":case"SW-NE":"top"===i&&(c.end=e);break;case"SE-NW":"top"===i?c.end=e:c={start:e,end:r};break;default:break}break;default:break}return c}isDragged(){return this.dragged.length>0}}var ZE=n("a309");function tR(){let{label:t="",colspan:e=1,origColspan:n=1,collapsible:o=!1,crossHiddenColumns:i=[],isCollapsed:r=!1,isHidden:s=!1,isRoot:a=!1,isPlaceholder:l=!1,headerClassNames:c=[]}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{label:t,colspan:e,origColspan:n,collapsible:o,isCollapsed:r,crossHiddenColumns:i,isHidden:s,isRoot:a,isPlaceholder:l,headerClassNames:c}}function eR(){return{label:"",isPlaceholder:!0}}function nR(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;const n=[];if(0===e)return n;Object(f["arrayEach"])(t,t=>{const o=[];let i=0;n.push(o),Object(f["arrayEach"])(t,t=>{const n=tR();if(Object(l["isObject"])(t)){const{label:e,colspan:o,headerClassName:i}=t;n.label=Object(g["stringify"])(e),"number"===typeof o&&o>1&&(n.colspan=o,n.origColspan=o),"string"===typeof i&&(n.headerClassNames=[...i.split(" ")])}else n.label=Object(g["stringify"])(t);i+=n.origColspan;let r=!1;if(i>=e&&(n.colspan=n.origColspan-(i-e),n.origColspan=n.colspan,r=!0),o.push(n),n.colspan>1)for(let e=0;e<n.colspan-1;e++)o.push(eR());return!r})});const o=Math.max(...Object(f["arrayMap"])(n,t=>t.length));return Object(f["arrayEach"])(n,t=>{if(t.length<o){const e=Object(f["arrayMap"])(new Array(o-t.length),()=>tR());t.splice(t.length,0,...e)}}),n}function oR(t,e,n){iR(t,e),e.set(t,n)}function iR(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rR(t,e){return t.get(aR(t,e))}function sR(t,e,n){return t.set(aR(t,e),n),n}function aR(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const lR=["label","collapsible"];var cR=new WeakMap,hR=new WeakMap,uR=new WeakMap;class dR{constructor(){oR(this,cR,[]),oR(this,hR,0),oR(this,uR,1/0)}setColumnsLimit(t){sR(uR,this,t)}setData(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];sR(cR,this,nR(t,rR(uR,this))),sR(hR,this,rR(cR,this).length)}getData(){return rR(cR,this)}mergeWith(t){Object(f["arrayEach"])(t,t=>{let{row:e,col:n,...o}=t;const i=this.getHeaderSettings(e,n);null!==i&&Object(l["extend"])(i,o,lR)})}map(t){Object(f["arrayEach"])(rR(cR,this),e=>{Object(f["arrayEach"])(e,e=>{const n=t({...e});Object(l["isObject"])(n)&&Object(l["extend"])(e,n,lR)})})}getHeaderSettings(t,e){var n;if(t>=rR(hR,this)||t<0)return null;const o=rR(cR,this)[t];return!1===Array.isArray(o)||e>=o.length?null:null!==(n=o[e])&&void 0!==n?n:null}getHeadersSettings(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const o=[];if(t>=rR(hR,this)||t<0)return o;const i=rR(cR,this)[t];let r=0;for(let s=e;s<i.length;s++){const t=i[s];if(t.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(r+=t.colspan,o.push(t),t.colspan>1&&(s+=t.colspan-1),r===n)break;if(r>n)throw new Error("The last column settings cannot overlap the other header layers")}return o}getLayersCount(){return rR(hR,this)}getColumnsCount(){return rR(hR,this)>0?rR(cR,this)[0].length:0}clear(){sR(cR,this,[]),sR(hR,this,0)}}function fR(t,e,n){return(e=gR(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gR(t){var e=pR(t,"string");return"symbol"==typeof e?e:e+""}function pR(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}const mR="DF-pre-order";function bR(t,e){let n=t.call(e,this);for(let o=0;o<this.childs.length;o++){if(!1===n)return!1;n=bR.call(this.childs[o],t,e)}return n}const wR="DF-post-order";function vR(t,e){for(let n=0;n<this.childs.length;n++){const o=vR.call(this.childs[n],t,e);if(!1===o)return!1}return t.call(e,this)}const yR="BF";function CR(t,e){const n=[this];function o(){if(0===n.length)return;const i=n.shift();n.push(...i.childs),!1!==t.call(e,i)&&o()}o()}const SR=yR,OR=new Map([[mR,bR],[wR,vR],[yR,CR]]);class ER{constructor(t){fR(this,"data",{}),fR(this,"parent",null),fR(this,"childs",[]),this.data=t}addChild(t){t.parent=this,this.childs.push(t)}cloneTree(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this;const e=new ER({...t.data});for(let n=0;n<t.childs.length;n++)e.addChild(this.cloneTree(t.childs[n]));return e}replaceTreeWith(t){this.data={...t.data},this.childs=[];for(let e=0;e<t.childs.length;e++)this.addChild(t.childs[e])}walkDown(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:SR;if(!OR.has(e))throw new Error(`Traversal strategy "${e}" does not exist`);OR.get(e).call(this,t,this)}walkUp(t){const e=this,n=o=>{const i=t.call(e,o);!1!==i&&null!==o.parent&&n(o.parent)};n(this)}}function RR(t,e,n){TR(t,e),e.set(t,n)}function TR(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function MR(t,e){return t.get(xR(t,e))}function IR(t,e,n){return t.set(xR(t,e),n),n}function xR(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var NR=new WeakMap,AR=new WeakMap,HR=new WeakMap;class jR{constructor(t){RR(this,NR,new Map),RR(this,AR,new Map),RR(this,HR,null),IR(HR,this,t)}getRoots(){return Array.from(MR(NR,this).values())}getRootByColumn(t){let e;return MR(AR,this).has(t)&&(e=MR(NR,this).get(MR(AR,this).get(t))),e}getNode(t,e){const n=this.getRootByColumn(e);if(!n)return;const o=e-MR(AR,this).get(e);let i,r=0;return n.walkDown(n=>{const{data:{origColspan:s,headerLevel:a}}=n;if(t===a){if(o>=r&&o<=r+s-1)return i=n,i.data.isRoot=e===i.data.columnIndex,!1;r+=s}}),i}rebuildTreeIndex(){let t=0;MR(AR,this).clear(),Object(f["arrayEach"])(MR(NR,this),e=>{let[,{data:{colspan:n}}]=e;for(let o=t;o<t+n;o++)MR(AR,this).set(o,t);t+=n})}buildTree(){this.clear();const t=MR(HR,this).getColumnsCount();let e=0;while(e<t){const t=MR(HR,this).getHeaderSettings(0,e),n=new ER;MR(NR,this).set(e,n),this.buildLeaves(n,e,0,t.origColspan),e+=t.origColspan}this.rebuildTreeIndex()}buildLeaves(t,e,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;const i=MR(HR,this).getHeadersSettings(n,e,o);n+=1,Object(f["arrayEach"])(i,o=>{const i={...o,headerLevel:n-1,columnIndex:e};let r;1===n?(t.data=i,r=t):(r=new ER(i),t.addChild(r)),n<MR(HR,this).getLayersCount()&&this.buildLeaves(r,e,n,o.origColspan),e+=o.origColspan})}clear(){MR(NR,this).clear(),MR(AR,this).clear()}}function _R(t,e){t.walkDown(t=>{let{data:n,childs:o}=t;if(!n.isHidden&&(e(n.columnIndex),0===o.length))for(let i=1;i<n.colspan;i++)e(n.columnIndex+i)})}function kR(t,e){let{childs:n}=t;if(0!==n.length)return n[0].data[e]}function PR(t){return kR(t,"origColspan")===t.data.origColspan}function DR(t){const{data:e,childs:n}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};const o=PR(t);if(o)return DR(n[0]);e.isCollapsed=!1;const i=n.slice(1),r=new Set;let s=0;if(i.length>0)Object(f["arrayEach"])(i,t=>{t.replaceTreeWith(t.data.clonedTree),t.data.clonedTree=null;const e=t.data;s+=e.colspan,_R(t,t=>{r.add(t)})});else{const{colspan:t,origColspan:n,columnIndex:o}=e;s=n-t;for(let e=1;e<n;e++)r.add(o+e)}return t.walkUp(t=>{const{data:e}=t;e.colspan+=s,e.colspan>=e.origColspan?(e.colspan=e.origColspan,e.isCollapsed=!1):PR(t)&&(e.isCollapsed=kR(t,"isCollapsed"))}),{rollbackModification:()=>LR(t),affectedColumns:Array.from(r),colspanCompensation:s}}function LR(t){var e;const{data:n,childs:o}=t;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};const i=PR(t);if(i)return LR(o[0]);n.isCollapsed=!0;const r=o.slice(1),s=new Set;if(r.length>0)Object(f["arrayEach"])(r,t=>{_R(t,t=>{s.add(t)}),t.data.clonedTree=t.cloneTree(),t.walkDown(t=>{let{data:e}=t;e.isHidden=!0})});else{const{origColspan:t,columnIndex:e}=n;for(let n=1;n<t;n++){const t=e+n;s.add(t)}}const a=n.colspan-(null!==(e=kR(t,"colspan"))&&void 0!==e?e:1);return t.walkUp(t=>{const{data:e}=t;e.colspan-=a,e.colspan<=1?(e.colspan=1,e.isCollapsed=!0):PR(t)&&(e.isCollapsed=kR(t,"isCollapsed"))}),{rollbackModification:()=>DR(t),affectedColumns:Array.from(s),colspanCompensation:a}}function FR(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(os["a"]`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(n.includes(e))return;let o=!1;t.walkUp(t=>{const{data:{collapsible:e}}=t;if(e)return o=!0,!1}),o||t.walkUp(t=>{const{data:n}=t;n.crossHiddenColumns.push(e),n.colspan>1?n.colspan-=1:n.isHidden=!0})}function VR(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(os["a"]`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(!n.includes(e))return;let o=!1;t.walkUp(t=>{const{data:{collapsible:e}}=t;if(e)return o=!0,!1}),o||t.walkUp(t=>{const{data:n}=t;n.crossHiddenColumns.splice(n.crossHiddenColumns.indexOf(e),1),!n.isHidden&&n.colspan<n.origColspan&&(n.colspan+=1),n.isHidden=!1})}const WR=new Map([["collapse",LR],["expand",DR],["hide-column",FR],["show-column",VR]]);function BR(t,e,n){if(!WR.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return WR.get(t)(e,n)}function UR(t){const e=[];return Object(f["arrayEach"])(t,t=>{t.walkDown(t=>{const n=t.data,{origColspan:o,columnIndex:i,headerLevel:r,crossHiddenColumns:s}=n,a=GR(e,r);let l=!1;for(let e=i;e<i+o;e++){const t=s.includes(e);if(t||l)a.push(eR(n));else{const t=zR(n);t.isRoot=!0,a.push(t),l=!0}}})}),e}function zR(t){const{crossHiddenColumns:e,...n}=tR(t);return n}function GR(t,e){let n;return Array.isArray(t[e])?n=t[e]:(n=[],t[e]=n),n}function YR(t,e,n){XR(t,e),e.set(t,n)}function XR(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $R(t,e,n){return t.set(qR(t,e),n),n}function KR(t,e){return t.get(qR(t,e))}function qR(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var QR=new WeakMap,JR=new WeakMap,ZR=new WeakMap;class tT{constructor(){YR(this,QR,new dR),YR(this,JR,new jR(KR(QR,this))),YR(this,ZR,[[]])}setState(t){KR(QR,this).setData(t);let e=!1;try{KR(JR,this).buildTree()}catch(n){KR(JR,this).clear(),KR(QR,this).clear(),e=!0}return $R(ZR,this,UR(KR(JR,this).getRoots())),e}setColumnsLimit(t){KR(QR,this).setColumnsLimit(t)}mergeStateWith(t){const e=Object(f["arrayMap"])(t,t=>{let{row:e,...n}=t;return{row:e<0?this.rowCoordsToLevel(e):e,...n}});KR(QR,this).mergeWith(e),KR(JR,this).buildTree(),$R(ZR,this,UR(KR(JR,this).getRoots()))}mapState(t){KR(QR,this).map(t),KR(JR,this).buildTree(),$R(ZR,this,UR(KR(JR,this).getRoots()))}mapNodes(t){return Object(f["arrayReduce"])(KR(JR,this).getRoots(),(e,n)=>(n.walkDown(n=>{const o=t(n.data);void 0!==o&&e.push(o)}),e),[])}triggerNodeModification(t,e,n){e<0&&(e=this.rowCoordsToLevel(e));const o=KR(JR,this).getNode(e,n);let i;return o&&(i=BR(t,o,n),$R(ZR,this,UR(KR(JR,this).getRoots()))),i}triggerColumnModification(t,e){return this.triggerNodeModification(t,-1,e)}rowCoordsToLevel(t){if(t>=0)return null;const e=t+Math.max(this.getLayersCount(),1);return e<0?null:e}levelToRowCoords(t){if(t<0)return null;const e=t-Math.max(this.getLayersCount(),1);return e>=0?null:e}getHeaderSettings(t,e){var n,o;return t<0&&(t=this.rowCoordsToLevel(t)),null===t||t>=this.getLayersCount()?null:null!==(n=null===(o=KR(ZR,this)[t])||void 0===o?void 0:o[e])&&void 0!==n?n:null}getHeaderTreeNodeData(t,e){const n=this.getHeaderTreeNode(t,e);return n?{...n.data}:null}getHeaderTreeNode(t,e){if(t<0&&(t=this.rowCoordsToLevel(t)),null===t||t>=this.getLayersCount())return null;const n=KR(JR,this).getNode(t,e);return n||null}findTopMostEntireHeaderLevel(t){var e;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;const o=n-t+1;let i=!1,r=null;for(let s=t;s<=n;s++){const e=KR(JR,this).getRootByColumn(s);if(!e)break;i=!0,e.walkDown(e=>{const{columnIndex:i,headerLevel:s,origColspan:a,isHidden:l}=e.data;l||a<=o&&i>=t&&i+a-1<=n&&(null===r||s<r)&&(r=s)},mR)}return i&&null===r?-1:this.levelToRowCoords(null!==(e=r)&&void 0!==e?e:0)}findLeftMostColumnIndex(t,e){var n;const{isRoot:o}=null!==(n=this.getHeaderSettings(t,e))&&void 0!==n?n:{isRoot:!0};if(o)return e;let i=e-1;while(i>=0){var r;const{isRoot:e}=null!==(r=this.getHeaderSettings(t,i))&&void 0!==r?r:{isRoot:!0};if(e)break;i-=1}return i}findRightMostColumnIndex(t,e){var n;const{isRoot:o,origColspan:i}=null!==(n=this.getHeaderSettings(t,e))&&void 0!==n?n:{isRoot:!0,origColspan:1};if(o)return e+i-1;let r=e+1;while(r<this.getColumnsCount()){var s;const{isRoot:e}=null!==(s=this.getHeaderSettings(t,r))&&void 0!==s?s:{isRoot:!0};if(e)break;r+=1}return r-1}getLayersCount(){return KR(QR,this).getLayersCount()}getColumnsCount(){return KR(QR,this).getColumnsCount()}clear(){$R(ZR,this,[]),KR(QR,this).clear(),KR(JR,this).clear()}}function eT(t,e,n){return(e=nT(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nT(t){var e=oT(t,"string");return"symbol"==typeof e?e:e+""}function oT(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class iT{constructor(t,e){eT(this,"hot",void 0),eT(this,"nestedHeaderSettingsGetter",void 0),eT(this,"layersCount",0),eT(this,"container",void 0),eT(this,"widthsMap",void 0),this.hot=t,this.nestedHeaderSettingsGetter=e,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(t){return this.layersCount=t,this}getWidth(t){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(t))}buildWidthsMap(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const t=this.container.querySelectorAll("tr:last-of-type th"),e=t.length;this.widthsMap.clear();for(let n=0;n<e;n++){const e=this.hot.columnIndexMapper.getVisualFromRenderableIndex(n),o=this.hot.toPhysicalColumn(e);this.widthsMap.setValueAtIndex(o,t[n].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(t){const{rootDocument:e,columnIndexMapper:n}=this.hot,o=e.createDocumentFragment(),i=e.createElement("table"),r=!!this.hot.getSettings().dropdownMenu,a=n.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const t=e.createElement("tr");for(let o=0;o<a;o++){let i=n.getVisualFromRenderableIndex(o);null===i&&(i=o);const a=e.createElement("th"),c=this.nestedHeaderSettingsGetter(l,i);if(c&&(!c.isPlaceholder||c.isHidden)){let e=c.label;r&&(e+='<button class="changeType"></button>'),Object(s["fastInnerHTML"])(a,e),a.colSpan=c.colspan,t.appendChild(a)}}i.appendChild(t)}o.appendChild(i),t.appendChild(o)}clear(){this.widthsMap.clear(),this.container=null}}var rT=iT;function sT(t,e){uT(t,e),e.add(t)}function aT(t,e,n){return(e=lT(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lT(t){var e=cT(t,"string");return"symbol"==typeof e?e:e+""}function cT(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function hT(t,e,n){uT(t,e),e.set(t,n)}function uT(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dT(t,e,n){return t.set(gT(t,e),n),n}function fT(t,e){return t.get(gT(t,e))}function gT(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const pT="nestedHeaders",mT=280;var bT=new WeakMap,wT=new WeakMap,vT=new WeakMap,yT=new WeakMap,CT=new WeakSet;class ST extends bn{constructor(){super(...arguments),sT(this,CT),hT(this,bT,new tT),hT(this,wT,null),hT(this,vT,null),hT(this,yT,!1),aT(this,"ghostTable",new rT(this.hot,(t,e)=>this.getHeaderSettings(t,e))),aT(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return pT}static get PLUGIN_PRIORITY(){return mT}isEnabled(){return!!this.hot.getSettings()[pT]}enablePlugin(){var t=this;if(this.enabled)return;const{nestedHeaders:e}=this.hot.getSettings();Array.isArray(e)&&Array.isArray(e[0])||Object(pi["b"])(os["a"]`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>gT(CT,this,FT).call(this)),this.addHook("afterLoadData",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return gT(CT,t,VT).call(t,...n)})),this.addHook("beforeOnCellMouseDown",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return gT(CT,t,MT).call(t,...n)})),this.addHook("afterOnCellMouseDown",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return gT(CT,t,IT).call(t,...n)})),this.addHook("beforeOnCellMouseOver",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return gT(CT,t,xT).call(t,...n)})),this.addHook("beforeOnCellMouseUp",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return gT(CT,t,NT).call(t,...n)})),this.addHook("beforeSelectionHighlightSet",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return gT(CT,t,AT).call(t,...n)})),this.addHook("modifyTransformStart",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return gT(CT,t,HT).call(t,...n)})),this.addHook("afterSelection",()=>gT(CT,this,OT).call(this)),this.addHook("afterSelectionFocusSet",()=>gT(CT,this,OT).call(this)),this.addHook("beforeViewportScrollHorizontally",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return gT(CT,t,ET).call(t,...n)})),this.addHook("afterGetColumnHeaderRenderers",t=>gT(CT,this,_T).call(this,t)),this.addHook("modifyColWidth",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return gT(CT,t,PT).call(t,...n)})),this.addHook("modifyColumnHeaderValue",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return gT(CT,t,DT).call(t,...n)})),this.addHook("beforeHighlightingColumnHeader",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return gT(CT,t,RT).call(t,...n)})),this.addHook("beforeCopy",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return gT(CT,t,TT).call(t,...n)})),this.addHook("beforeSelectColumns",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return gT(CT,t,jT).call(t,...n)})),this.addHook("afterViewportColumnCalculatorOverride",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return gT(CT,t,kT).call(t,...n)})),this.addHook("modifyFocusedElement",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return gT(CT,t,LT).call(t,...n)})),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>gT(CT,this,OT).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>gT(CT,this,OT).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:t}=this.hot.getSettings();fT(bT,this).setColumnsLimit(this.hot.countCols()),Array.isArray(t)&&(this.detectedOverlappedHeaders=fT(bT,this).setState(t)),this.detectedOverlappedHeaders&&Object(pi["b"])(os["a"]`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((t,e)=>{const n=!0===t?"hide-column":"show-column";fT(bT,this).triggerColumnModification(n,e)}),!fT(wT,this)&&this.enabled&&dT(wT,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(t=>{t.forEach(t=>{let{op:e,index:n,newValue:o}=t;if("replace"===e){const t=!0===o?"hide-column":"show-column";fT(bT,this).triggerColumnModification(t,n)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),fT(bT,this).clear(),fT(wT,this).unsubscribe(),dT(wT,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return fT(bT,this)}getLayersCount(){return fT(bT,this).getLayersCount()}getHeaderSettings(t,e){return fT(bT,this).getHeaderSettings(t,e)}clearColspans(){if(!this.hot.view)return;const{_wt:t}=this.hot.view,e=t.getSetting("columnHeaders").length,n=t.wtTable.THEAD,o=t.wtOverlays.topOverlay.clone.wtTable.THEAD,i=t.wtOverlays.topInlineStartCornerOverlay?t.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let r=0;r<e;r++){const t=n.childNodes[r];if(!t)break;const e=o.childNodes[r],a=i?i.childNodes[r]:null;for(let n=0,o=t.childNodes.length;n<o;n++)t.childNodes[n].removeAttribute("colspan"),Object(s["removeClass"])(t.childNodes[n],"hiddenHeader"),e&&e.childNodes[n]&&(e.childNodes[n].removeAttribute("colspan"),Object(s["removeClass"])(e.childNodes[n],"hiddenHeader")),i&&a&&a.childNodes[n]&&(a.childNodes[n].removeAttribute("colspan"),Object(s["removeClass"])(a.childNodes[n],"hiddenHeader"))}}headerRendererFactory(t){var e=this;const n=this.hot.view._wt.getSetting("fixedColumnsStart");return(o,i)=>{var r;const{columnIndexMapper:a,view:l}=this.hot;let c=a.getVisualFromRenderableIndex(o);null===c&&(c=o),i.removeAttribute("colspan"),Object(s["removeClass"])(i,"hiddenHeader");const{colspan:h,isHidden:u,isPlaceholder:d,headerClassNames:f}=null!==(r=fT(bT,this).getHeaderSettings(t,c))&&void 0!==r?r:{label:""};if(d||u)Object(s["addClass"])(i,"hiddenHeader");else if(h>1){var g,p;const{wtOverlays:t}=l._wt,e=null===(g=t.topInlineStartCornerOverlay)||void 0===g?void 0:g.clone.wtTable.THEAD.contains(i),r=null===(p=t.inlineStartOverlay)||void 0===p?void 0:p.clone.wtTable.THEAD.contains(i),s=e||r?Math.min(h,n-o):h;s>1&&i.setAttribute("colspan",s)}if(this.hot.view.appendColHeader(c,i,(function(){return e.getColumnHeaderValue(...arguments)}),t),!d&&!u){const t=i.querySelector("div.relative");t&&f&&f.length>0&&(Object(s["removeClass"])(t,this.hot.getColumnMeta(c).headerClassName),Object(s["addClass"])(t,f))}}}getColumnHeaderValue(t,e){var n;const{isHidden:o,isPlaceholder:i}=null!==(n=fT(bT,this).getHeaderSettings(e,t))&&void 0!==n?n:{};return i||o?"":this.hot.getColHeader(t,e)}destroy(){dT(bT,this,null),null!==fT(wT,this)&&(fT(wT,this).unsubscribe(),dT(wT,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(t){if(!(t.row>=0||t.col<0))return fT(bT,this).getHeaderTreeNodeData(t.row,t.col)}}function OT(){var t;const e=null===(t=this.hot)||void 0===t?void 0:t.getSelectedRangeLast();if(!e)return;const{highlight:n}=e,o=n.isHeader()&&n.col>=0;if(o){const t=fT(bT,this).findLeftMostColumnIndex(n.row,n.col),e=this.hot.selection.highlight.getFocus();e.visualCellRange.highlight.col=t,e.visualCellRange.from.col=t,e.visualCellRange.to.col=t,e.commit()}}function ET(t){const e=this.hot.getSelectedRangeLast();if(!e)return t;const{highlight:n}=e,o=n.isHeader()&&n.col>=0;if(!o)return t;const i=this.hot.view.getFirstFullyVisibleColumn(),r=this.hot.view.getLastFullyVisibleColumn(),s=fT(bT,this).findLeftMostColumnIndex(n.row,n.col),a=fT(bT,this).findRightMostColumnIndex(n.row,n.col);return s<i&&a>r?t:s<i?s:a}function RT(t,e,n){const o=fT(bT,this).getHeaderTreeNodeData(e,t);if(!o)return t;const{columnCursor:i,selectionType:r,selectionWidth:s}=n,{isRoot:a,colspan:l}=fT(bT,this).getHeaderSettings(e,t);if(r===ZE["g"]){if(!a)return o.columnIndex}else if(r===ZE["a"]&&(l>s-i||!a))return null;return t}function TT(t,e,n){let{columnHeadersCount:o}=n;if(0!==o)for(let r=0;r<e.length;r++){const{startRow:n,startCol:o,endRow:s,endCol:a}=e[r],l=s-n+1,c=o-a+1;if(n>=0||1===c)break;for(let e=o;e<=a;e++)for(let r=n;r<=s;r++){var i;const n=l+r,s=e-o;if(0===s)continue;const a=null===(i=fT(bT,this).getHeaderTreeNodeData(r,e))||void 0===i?void 0:i.isRoot;!1===a&&(t[n][s]="")}}}function MT(t,e,n,o){const i=this._getHeaderTreeNodeDataByCoords(e);i&&(o.column=!0)}function IT(t,e){const n=this._getHeaderTreeNodeDataByCoords(e);if(!n)return;dT(vT,this,e.clone()),dT(yT,this,!0);const{selection:o}=this.hot,i=o.isSelected()?o.getSelectedRange().current():null,r=[],{columnIndex:s,origColspan:l}=n,c=!o.inInSelection(e);t.shiftKey&&i?e.col<i.from.col?r.push(i.getTopEndCorner().col,s,e.row):e.col>i.from.col?r.push(i.getTopStartCorner().col,s+l-1,e.row):r.push(s,s+l-1,e.row):(Object(a["isLeftClick"])(t)||Object(a["isRightClick"])(t)&&c||Object(a["isTouchEvent"])(t))&&r.push(s,s+l-1,e.row),o.selectColumns(...r)}function xT(t,e,n,o){if(!this.hot.view.isMouseDown())return;const i=this._getHeaderTreeNodeDataByCoords(e);if(!i)return;const{columnIndex:r,origColspan:s}=i,a=this.hot.getSelectedRangeLast(),l=a.getTopStartCorner(),c=a.getBottomEndCorner(),{from:h}=a;o.column=!0,o.cell=!0;const u=[],d=Object(ie["clamp"])(e.row,-1/0,-1);e.col<h.col?u.push(c.col,r,d):e.col>h.col?u.push(l.col,r+s-1,d):u.push(r,r+s-1,d),this.hot.selection.selectColumns(...u)}function NT(){dT(yT,this,!1)}function AT(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!fT(yT,this)||!t)return;const e=this.hot.getSelectedRangeLast(),n=e.getTopStartCorner().col,o=e.getBottomEndCorner().col,{columnIndex:i,origColspan:r}=fT(bT,this).getHeaderTreeNodeData(fT(vT,this).row,fT(vT,this).col);if(e.setHighlight(fT(vT,this)),r>e.getWidth()||i<n||i+r-1>o){const t=fT(bT,this).findTopMostEntireHeaderLevel(Object(ie["clamp"])(n,i,i+r-1),Object(ie["clamp"])(o,i,i+r-1));e.highlight.row=t,e.highlight.col=e.from.col}}function HT(t){const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.hot._createCellCoords(e.row+t.row,e.col+t.col),o=n.isHeader()&&n.col>=0;if(!o)return;const i=fT(bT,this).findLeftMostColumnIndex(n.row,n.col),r=fT(bT,this).findRightMostColumnIndex(n.row,n.col);if(t.col<0){const n=e.col>=i&&e.col<=r?i-1:r,o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(n,-1);t.col=null===o?-this.hot.view.countRenderableColumnsInRange(0,e.col):-Math.max(this.hot.view.countRenderableColumnsInRange(o,e.col)-1,1)}else if(t.col>0){const n=e.col>=i&&e.col<=r?r+1:i,o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(n,1);t.col=null===o?this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):Math.max(this.hot.view.countRenderableColumnsInRange(e.col,o)-1,1)}}function jT(t,e){const n=t.row,o=this._getHeaderTreeNodeDataByCoords({row:n,col:t.col}),i=this._getHeaderTreeNodeDataByCoords({row:n,col:e.col});e.col<t.col?(o&&(t.col=o.columnIndex+o.origColspan-1),i&&(e.col=i.columnIndex)):e.col>=t.col&&(o&&(t.col=o.columnIndex),i&&(e.col=i.columnIndex+i.origColspan-1))}function _T(t){t.length=0;for(let e=0;e<fT(bT,this).getLayersCount();e++)t.push(this.headerRendererFactory(e))}function kT(t){const e=fT(bT,this).getLayersCount();let n=t.startColumn,o=!!e;for(let i=0;i<e;i++){const e=fT(bT,this).findLeftMostColumnIndex(i,t.startColumn),r=this.hot.columnIndexMapper.getRenderableFromVisualIndex(e);if(e>=0&&(o=!1),Object(ie["isNumeric"])(r)&&r<t.startColumn){n=r;break}}t.startColumn=o?fT(bT,this).getHeaderTreeNodeData(0,n).columnIndex:n}function PT(t,e){const n=this.ghostTable.getWidth(e);return t>n?t:n}function DT(t,e,n){var o;const{label:i}=null!==(o=fT(bT,this).getHeaderTreeNodeData(n,e))&&void 0!==o?o:{label:""};return i}function LT(t,e){if(t<0)return this.hot.getCell(t,fT(bT,this).findLeftMostColumnIndex(t,e),!0)}function FT(){this.updatePlugin()}function VT(t,e){e||this.updatePlugin()}function WT(t,e,n){return(e=BT(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function BT(t){var e=UT(t,"string");return"symbol"==typeof e?e:e+""}function UT(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class zT{constructor(t,e){WT(this,"hot",void 0),WT(this,"data",null),WT(this,"plugin",void 0),WT(this,"parentReference",new WeakMap),WT(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=e,this.plugin=t}setData(t){this.data=t}getData(){return this.data}getRawSourceData(){let t=null;return this.plugin.disableCoreAPIModifiers(),t=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),t}updateWithData(t){this.setData(t),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},Object(ie["rangeEach"])(0,this.data.length-1,t=>{this.cacheNode(this.data[t],0,null)})}cacheNode(t,e,n){this.cache.levels[e]||(this.cache.levels[e]=[],this.cache.levelCount+=1),this.cache.levels[e].push(t),this.cache.rows.push(t),this.cache.nodeInfo.set(t,{parent:n,row:this.cache.rows.length-1,level:e}),this.hasChildren(t)&&Object(f["arrayEach"])(t.__children,n=>{this.cacheNode(n,e+1,t)})}getDataObject(t){return null===t||void 0===t?null:this.cache.rows[t]}readTreeNodes(t,e,n,o){let i=!1,r=e;if(isNaN(r)&&r.end)return r;let s=t;return s||(s={__children:this.data},i=!0,r-=1),null!==n&&void 0!==n&&r===n?{result:s,end:!0}:null!==o&&void 0!==o&&s===o?{result:r,end:!0}:(r+=1,s.__children&&Object(f["arrayEach"])(s.__children,t=>{if(this.parentReference.set(t,i?null:s),r=this.readTreeNodes(t,r,n,o),isNaN(r)&&r.end)return!1}),r)}mockParent(){const t=this.mockNode();return t.__children=this.data,t}mockNode(){const t={};return Object(l["objectEach"])(this.data[0],(e,n)=>{t[n]=null}),t}getRowIndex(t){return null===t||void 0===t?null:this.cache.nodeInfo.get(t).row}getRowIndexWithinParent(t){let e=null;e=isNaN(t)?t:this.getDataObject(t);const n=this.getRowParent(t);return null===n||void 0===n?this.data.indexOf(e):n.__children.indexOf(e)}countAllRows(){const t={__children:this.data};return this.countChildren(t)}countChildren(t){let e=0,n=t;return isNaN(n)||(n=this.getDataObject(n)),n&&n.__children?(Object(f["arrayEach"])(n.__children,t=>{e+=1,t.__children&&(e+=this.countChildren(t))}),e):0}getRowParent(t){let e;return e=isNaN(t)?t:this.getDataObject(t),this.getRowObjectParent(e)}getRowObjectParent(t){return t&&"object"===typeof t?this.cache.nodeInfo.get(t).parent:null}getRowLevel(t){let e=null;return e=isNaN(t)?t:this.getDataObject(t),e?this.getRowObjectLevel(e):null}getRowObjectLevel(t){return null===t||void 0===t?null:this.cache.nodeInfo.get(t).level}hasChildren(t){let e=t;return isNaN(e)||(e=this.getDataObject(e)),!(!e.__children||!e.__children.length)}isChild(t){return null!==this.getRowParent(t)}getChild(t,e){var n;return(null===(n=t.__children)||void 0===n?void 0:n[e])||null}isRowHighestLevel(t){return!this.isChild(t)}isParent(t){var e;let n=t;return isNaN(n)||(n=this.getDataObject(n)),n&&!!n.__children&&0!==(null===(e=n.__children)||void 0===e?void 0:e.length)}addChild(t,e){let n=e;this.hot.runHooks("beforeAddChild",t,n);let o=null;t&&(o=this.getRowIndex(t)),this.hot.runHooks("beforeCreateRow",o+this.countChildren(t)+1,1);let i=t;t||(i=this.mockParent()),i.__children||(i.__children=[]),n||(n=this.mockNode()),i.__children.push(n),this.rewriteCache();const r=this.getRowIndex(n);this.hot.rowIndexMapper.insertIndexes(r,1),this.hot.runHooks("afterCreateRow",r,1),this.hot.runHooks("afterAddChild",t,n)}addChildAtIndex(t,e,n){let o,i=n;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",t,i,e),t){const n=this.getRowIndex(t),r=n+e+1;this.hot.runHooks("beforeCreateRow",r,1),t.__children.splice(e,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(t),"__children",t.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(r,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",r,1),o=r}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",e,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),o=this.getRowIndex(this.data[e]);i=this.getDataObject(o),this.hot.runHooks("afterAddChild",t,i,e)}addSibling(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"below";const n=this.translateTrimmedRow(t),o=this.getRowParent(n),i=this.getRowIndexWithinParent(n);switch(e){case"below":this.addChildAtIndex(o,i+1,null);break;case"above":this.addChildAtIndex(o,i,null);break;default:break}}detachFromParent(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=null;const o=[];Array.isArray(t)?(Object(ie["rangeEach"])(t[0],t[2],t=>{const e=this.translateTrimmedRow(t);o.push(this.getDataObject(e))}),Object(ie["rangeEach"])(0,o.length-2,t=>{this.detachFromParent(o[t],!1)}),n=o[o.length-1]):n=t;const i=this.getRowIndex(n),r=this.countChildren(n),s=this.getRowIndexWithinParent(n),a=this.getRowParent(n),l=this.getRowParent(a),c=this.getRowIndex(l);let h=null;if(this.hot.runHooks("beforeDetachChild",a,n),null!==s&&void 0!==s){const t=Array.from(new Array(i+r+1).keys()).splice(-1*(r+1));if(this.hot.runHooks("beforeRemoveRow",i,r+1,t,this.plugin.pluginName),a.__children.splice(s,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",i,r+1,t,this.plugin.pluginName),l){h=c+this.countChildren(l);const t=this.getChild(l,this.countChildren(l)-1),e=this.getRowIndex(t);this.hot.runHooks("beforeCreateRow",e+1,r+1,this.plugin.pluginName),l.__children.push(n)}else h=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",h-2,r+1,this.plugin.pluginName),this.data.push(n)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",h-2,r+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",a,n,this.getRowIndex(n)),e&&this.hot.render()}filterData(t,e,n){const o=[];Object(f["arrayEach"])(n,t=>{o.push(this.getDataObject(t))}),Object(f["arrayEach"])(o,t=>{const e=this.getRowIndexWithinParent(t),n=this.getRowParent(t);null===n?this.data.splice(e,1):n.__children.splice(e,1)}),this.rewriteCache()}spliceData(t,e,n){const o=this.getDataObject(t-1);let i=null,r=t;o&&o.__children&&0===o.__children.length?(i=o,r=0):t<this.countAllRows()&&(i=this.getRowParent(t),r=this.getRowIndexWithinParent(t)),i?n?i.__children.splice(r,e,...n):i.__children.splice(r,e):n?this.data.splice(r,e,...n):this.data.splice(r,e),this.rewriteCache()}syncRowWithRawSource(t){let e=t,n=null;do{n=this.getRowParent(n),null!==n&&(e=n)}while(null!==n);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(e),"__children",e.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(t,e,n,o){const i=e===this.hot.countRows(),r=this.getRowParent(t),s=this.getRowIndexWithinParent(t),a=r.__children.slice(s,s+1),l=t>e;let c=i?this.getRowParent(e-1):this.getRowParent(e);null!==c&&void 0!==c||(c=this.getRowParent(e-1)),null!==c&&void 0!==c||(c=this.getDataObject(e-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(e),c.__children=[]);const h=i||n||o?c.__children.length:this.getRowIndexWithinParent(e),u=r===c;c.__children.splice(h,0,a[0]),r.__children.splice(s+(l&&u?1:0),1),this.syncRowWithRawSource(r),u||this.syncRowWithRawSource(c)}translateTrimmedRow(t){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(t):t}untranslateTrimmedRow(t){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(t):t}}var GT=zT;function YT(t,e,n){return(e=XT(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function XT(t){var e=$T(t,"string");return"symbol"==typeof e?e:e+""}function $T(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class KT{constructor(t,e){YT(this,"hot",void 0),YT(this,"plugin",void 0),this.hot=e,this.plugin=t}}var qT=KT;class QT extends qT{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(t,e){super(t,e),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(t,e){const n=this.hot.toPhysicalRow(t),o=this.dataManager.getRowLevel(n),i=this.dataManager.getDataObject(n),r=e.getElementsByTagName("DIV")[0],a=r.querySelector("span.rowHeader"),l=r.querySelectorAll('[class^="ht_nesting"]'),c=this.hot.getSettings().ariaTags;if(Object(f["arrayEach"])(l,t=>{t&&r.removeChild(t)}),Object(s["addClass"])(e,QT.CSS_CLASSES.indicatorContainer),o){const{rootDocument:t}=this.hot,e=a.cloneNode(!0);r.innerHTML="",Object(ie["rangeEach"])(0,o-1,()=>{const e=t.createElement("SPAN");Object(s["addClass"])(e,QT.CSS_CLASSES.emptyIndicator),r.appendChild(e)}),r.appendChild(e)}if(this.dataManager.hasChildren(i)){const t=this.hot.rootDocument.createElement("DIV");c&&Object(s["setAttribute"])(t,[Object(v["n"])()]),Object(s["addClass"])(e,QT.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(n)?(Object(s["addClass"])(t,`${QT.CSS_CLASSES.button} ${QT.CSS_CLASSES.expandButton}`),c&&Object(s["setAttribute"])(e,[Object(v["k"])(!1)])):(Object(s["addClass"])(t,`${QT.CSS_CLASSES.button} ${QT.CSS_CLASSES.collapseButton}`),c&&Object(s["setAttribute"])(e,[Object(v["k"])(!0)])),r.appendChild(t)}}updateRowHeaderWidth(t){let e=t;e||(e=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*e+25),this.hot.render()}}var JT=QT;class ZT extends qT{constructor(t,e){var n;super(t,e),n=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];n.lastCollapsedRows=n.collapsedRows.slice(0),n.expandMultipleChildren(n.lastCollapsedRows,t)},shiftStash:function(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;null!==e&&void 0!==e||(e=1/0),Object(f["arrayEach"])(n.lastCollapsedRows,(i,r)=>{i>=t&&i<e&&(n.lastCollapsedRows[r]=i+o)})},applyStash:function(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];n.collapseMultipleChildren(n.lastCollapsedRows,t),n.lastCollapsedRows=void 0},trimStash:(t,e)=>{Object(ie["rangeEach"])(t,t+e-1,t=>{const e=this.lastCollapsedRows.indexOf(t);e>-1&&this.lastCollapsedRows.splice(e,1)})}}}collapseChildren(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const o=[];let i=null,r=null,s=null;return isNaN(t)?(i=t,r=this.dataManager.getRowIndex(i)):(i=this.dataManager.getDataObject(t),r=t),this.dataManager.hasChildren(i)&&Object(f["arrayEach"])(i.__children,t=>{o.push(this.dataManager.getRowIndex(t))}),s=this.collapseRows(o,!0,!1),n&&this.trimRows(s),e&&this.renderAndAdjust(),-1===this.collapsedRows.indexOf(r)&&this.collapsedRows.push(r),s}collapseMultipleChildren(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const o=[];Object(f["arrayEach"])(t,t=>{o.push(...this.collapseChildren(t,!1,!1))}),n&&this.trimRows(o),e&&this.renderAndAdjust()}collapseRow(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.collapseRows([t],e)}collapseRows(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o=[];return Object(f["arrayEach"])(t,t=>{o.push(t),e&&this.collapseChildRows(t,o)}),n&&this.trimRows(o),o}collapseChildRows(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(t)){const n=this.dataManager.getDataObject(t);Object(f["arrayEach"])(n.__children,t=>{const n=this.dataManager.getRowIndex(t);e.push(n),this.collapseChildRows(n,e)})}n&&this.trimRows(e)}expandRow(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.expandRows([t],e)}expandRows(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o=[];return Object(f["arrayEach"])(t,t=>{o.push(t),e&&this.expandChildRows(t,o)}),n&&this.untrimRows(o),o}expandChildRows(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(t)){const n=this.dataManager.getDataObject(t);Object(f["arrayEach"])(n.__children,t=>{if(!this.isAnyParentCollapsed(t)){const n=this.dataManager.getRowIndex(t);e.push(n),this.expandChildRows(n,e)}})}n&&this.untrimRows(e)}expandChildren(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const o=[];let i=null,r=null,s=null;return isNaN(t)?(i=t,r=this.dataManager.getRowIndex(t)):(i=this.dataManager.getDataObject(t),r=t),this.collapsedRows.splice(this.collapsedRows.indexOf(r),1),this.dataManager.hasChildren(i)&&Object(f["arrayEach"])(i.__children,t=>{const e=this.dataManager.getRowIndex(t);o.push(e)}),s=this.expandRows(o,!0,!1),n&&this.untrimRows(s),e&&this.renderAndAdjust(),s}expandMultipleChildren(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const o=[];Object(f["arrayEach"])(t,t=>{o.push(...this.expandChildren(t,!1,!1))}),n&&this.untrimRows(o),e&&this.renderAndAdjust()}collapseAll(){const t=this.dataManager.getData(),e=[];Object(f["arrayEach"])(t,t=>{this.dataManager.hasChildren(t)&&e.push(t)}),this.collapseMultipleChildren(e),this.renderAndAdjust()}expandAll(){const t=this.dataManager.getData(),e=[];Object(f["arrayEach"])(t,t=>{this.dataManager.hasChildren(t)&&e.push(t)}),this.expandMultipleChildren(e),this.renderAndAdjust()}trimRows(t){this.hot.batchExecution(()=>{Object(f["arrayEach"])(t,t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!0)})},!0)}untrimRows(t){this.hot.batchExecution(()=>{Object(f["arrayEach"])(t,t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!1)})},!0)}areChildrenCollapsed(t){let e=isNaN(t)?t:this.dataManager.getDataObject(t),n=!0;return null===e&&(e={__children:this.dataManager.data}),this.dataManager.hasChildren(e)&&Object(f["arrayEach"])(e.__children,t=>{const e=this.dataManager.getRowIndex(t);if(!this.plugin.collapsedRowsMap.getValueAtIndex(e))return n=!1,!1}),n}isAnyParentCollapsed(t){let e=t;while(null!==e){e=this.dataManager.getRowParent(e);const t=this.dataManager.getRowIndex(e);if(this.collapsedRows.indexOf(t)>-1)return!0}return!1}toggleState(t,e){if(e.col>=0)return;const n=this.translateTrimmedRow(e.row);Object(s["hasClass"])(t.target,JT.CSS_CLASSES.button)&&(this.areChildrenCollapsed(n)?this.expandChildren(n):this.collapseChildren(n),Object(a["stopImmediatePropagation"])(t))}translateTrimmedRow(t){return this.hot.toPhysicalRow(t)}untranslateTrimmedRow(t){return this.hot.toVisualRow(t)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}var tM=ZT;function eM(t,e,n){nM(t,e),e.set(t,n)}function nM(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function oM(t,e,n){return(e=iM(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function iM(t){var e=rM(t,"string");return"symbol"==typeof e?e:e+""}function rM(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function sM(t,e){return t.get(aM(t,e))}function aM(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var lM=new WeakMap;class cM extends qT{constructor(){super(...arguments),oM(this,"dataManager",this.plugin.dataManager),eM(this,lM,{row_above:(t,e)=>{const n=e[e.length-1];this.dataManager.addSibling(n.start.row,"above")},row_below:(t,e)=>{const n=e[e.length-1];this.dataManager.addSibling(n.start.row,"below")}})}appendOptions(t){const e=[{key:"add_child",name(){return this.getTranslatedPhrase(Ft["CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD"])},callback:()=>{const t=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),e=this.dataManager.getDataObject(t);this.dataManager.addChild(e)},disabled:()=>{const t=this.hot.getSelectedLast();return!t||t[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(Ft["CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD"])},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const t=this.hot.getSelectedLast(),e=this.dataManager.translateTrimmedRow(t[0]),n=this.dataManager.getRowParent(e);return!n||!t||t[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return Object(ie["rangeEach"])(0,t.items.length-1,n=>{if(0===n)return Object(f["arrayEach"])(e,(e,o)=>{t.items.splice(n+o,0,e)}),!1}),this.modifyRowInsertingOptions(t)}modifyRowInsertingOptions(t){return Object(ie["rangeEach"])(0,t.items.length-1,e=>{const n=sM(lM,this)[t.items[e].key];null!==n&&void 0!==n&&(t.items[e].callback=n)}),t}}var hM=cM;function uM(t,e,n){return(e=dM(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dM(t){var e=fM(t,"string");return"symbol"==typeof e?e:e+""}function fM(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class gM{constructor(t){uM(this,"plugin",void 0),uM(this,"hot",void 0),uM(this,"dataManager",void 0),uM(this,"collapsingUI",void 0),this.plugin=t,this.hot=t.hot,this.dataManager=t.dataManager,this.collapsingUI=t.collapsingUI}onBeforeRowMove(t,e,n,o){const i=this.displayAPICompatibilityWarning({rows:t,finalIndex:e,dropIndex:n,movePossible:o});if(i)return!1;this.movedToCollapsed=!1;const r=n===this.hot.countRows(),s=r?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(n);let a=!0;const l=t.map(t=>{if(!a)return!1;const e=this.dataManager.translateTrimmedRow(t);return a=this.shouldAllowMoving(e,s),e}),c=-1===l.indexOf(s);if(!a||!c)return!1;const h=this.getBaseParent(l),u=this.getTargetParent(r,s),d=h===u;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(u),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(l,s,d),this.moveRows(l,s,u),this.dataManager.rewriteCache(),this.moveCellsMeta(l,s),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",t,e,n,o,o&&this.isRowOrderChanged(t,e)),this.hot.render(),this.selectCells(t,n),!1}displayAPICompatibilityWarning(t){const{rows:e,finalIndex:n,dropIndex:o,movePossible:i}=t;let r=!1;return Object(g["isUndefined"])(o)&&(Object(pi["b"])(os["a"]`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",e,n,o,i,!1),r=!0),r}shouldAllowMoving(t,e){return!(this.dataManager.isParent(t)||this.dataManager.isRowHighestLevel(t)||t===e||0===e)}getBaseParent(t){return this.dataManager.getRowParent(t[0])}getTargetParent(t,e){let n=this.dataManager.getRowParent(t?e-1:e);return null!==n&&void 0!==n||(n=this.dataManager.getRowParent(e-1)),n}shiftCollapsibleParentsLocations(t,e,n){n||(Math.max(...t)<=e?this.collapsingUI.collapsedRowsStash.shiftStash(t[0],e,-1*t.length):this.collapsingUI.collapsedRowsStash.shiftStash(e,t[0],t.length))}moveRows(t,e,n){const o=e===this.dataManager.getRowIndex(n)+this.dataManager.countChildren(n)+1;this.hot.batchRender(()=>{t.forEach(t=>{this.dataManager.moveRow(t,e,this.movedToCollapsed,o)})})}moveCellsMeta(t,e){const n=[],o=Math.max(...t)<e;t.forEach(t=>{n.push(this.hot.getCellMetaAtRow(t))}),this.hot.spliceCellsMeta(t[0],t.length),this.hot.spliceCellsMeta(e-(o?n.length:0),0,...n)}selectCells(t,e){const n=t.length;let o=0,i=0,r=null,s=null;if(this.movedToCollapsed){let r=null;r=t[n-1]<e?this.dataManager.translateTrimmedRow(e-n):this.dataManager.translateTrimmedRow(e);const s=this.dataManager.getRowParent(null===r?this.hot.countSourceRows()-1:r-1),a=this.dataManager.getRowIndex(s);o=this.dataManager.untranslateTrimmedRow(a),i=o}else t[n-1]<e?(i=e-1,o=i-n+1):(o=e,i=o+n-1);r=this.hot.selection,s=this.hot.countCols()-1,r.setRangeStart(this.hot._createCellCoords(o,0)),r.setRangeEnd(this.hot._createCellCoords(i,s),!0)}isRowOrderChanged(t,e){return t.some((t,n)=>t-n!==e)}}function pM(t,e){bM(t,e),e.add(t)}function mM(t,e,n){bM(t,e),e.set(t,n)}function bM(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wM(t,e,n){return(e=vM(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vM(t){var e=yM(t,"string");return"symbol"==typeof e?e:e+""}function yM(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function CM(t,e){return t.get(OM(t,e))}function SM(t,e,n){return t.set(OM(t,e),n),n}function OM(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const EM="nestedRows",RM=300,TM=EM,MM="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var IM=new WeakMap,xM=new WeakMap,NM=new WeakSet;class AM extends bn{constructor(){super(...arguments),pM(this,NM),wM(this,"dataManager",null),wM(this,"headersUI",null),wM(this,"collapsedRowsMap",null),mM(this,IM,!1),mM(this,xM,!1)}static get PLUGIN_KEY(){return EM}static get PLUGIN_PRIORITY(){return RM}isEnabled(){return!!this.hot.getSettings()[EM]}enablePlugin(){var t=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new Rm["a"]),this.dataManager=new GT(this,this.hot),this.collapsingUI=new tM(this,this.hot),this.headersUI=new JT(this,this.hot),this.contextMenuUI=new hM(this,this.hot),this.rowMoveController=new gM(this),this.addHook("afterInit",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return OM(NM,t,GM).call(t,...n)})),this.addHook("beforeViewRender",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return OM(NM,t,YM).call(t,...n)})),this.addHook("modifyRowData",(function(){return t.onModifyRowData(...arguments)})),this.addHook("modifySourceLength",(function(){return t.onModifySourceLength(...arguments)})),this.addHook("beforeDataSplice",(function(){return t.onBeforeDataSplice(...arguments)})),this.addHook("filterData",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return OM(NM,t,_M).call(t,...n)})),this.addHook("afterContextMenuDefaultOptions",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return OM(NM,t,kM).call(t,...n)})),this.addHook("afterGetRowHeader",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return OM(NM,t,PM).call(t,...n)})),this.addHook("beforeOnCellMouseDown",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return OM(NM,t,jM).call(t,...n)})),this.addHook("beforeRemoveRow",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return OM(NM,t,FM).call(t,...n)})),this.addHook("afterRemoveRow",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return OM(NM,t,LM).call(t,...n)})),this.addHook("beforeAddChild",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return OM(NM,t,VM).call(t,...n)})),this.addHook("afterAddChild",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return OM(NM,t,WM).call(t,...n)})),this.addHook("beforeDetachChild",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return OM(NM,t,BM).call(t,...n)})),this.addHook("afterDetachChild",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return OM(NM,t,UM).call(t,...n)})),this.addHook("modifyRowHeaderWidth",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return OM(NM,t,DM).call(t,...n)})),this.addHook("afterCreateRow",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return OM(NM,t,zM).call(t,...n)})),this.addHook("beforeRowMove",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return OM(NM,t,HM).call(t,...n)})),this.addHook("beforeLoadData",t=>OM(NM,this,XM).call(this,t)),this.addHook("beforeUpdateData",t=>OM(NM,this,XM).call(this,t)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const t=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(t),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:t}=this.hot.getSelectedRangeLast(),e=this.collapsingUI.translateTrimmedRow(t.row);return this.collapsingUI.areChildrenCollapsed(e)?this.collapsingUI.expandChildren(e):this.collapsingUI.collapseChildren(e),!1},runOnlyIf:()=>{var t,e;const n=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return n&&(null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.isSingle())&&this.hot.selection.isCellVisible(n)&&-1===n.col&&n.row>=0},group:TM,relativeToGroup:c["a"],position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(TM)}disableCoreAPIModifiers(){SM(xM,this,!0)}enableCoreAPIModifiers(){SM(xM,this,!1)}onModifyRowData(t){if(!CM(xM,this))return this.dataManager.getDataObject(t)}onModifySourceLength(){if(!CM(xM,this))return this.dataManager.countAllRows()}onBeforeDataSplice(t,e,n){return!(!CM(xM,this)&&!this.dataManager.isRowHighestLevel(t))||(this.dataManager.spliceData(t,e,n),!1)}destroy(){super.destroy()}}function HM(t,e,n,o){return this.rowMoveController.onBeforeRowMove(t,e,n,o)}function jM(t,e,n){this.collapsingUI.toggleState(t,e,n)}function _M(t,e,n){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*e),this.dataManager.filterData(t,e,n),SM(IM,this,!0),this.dataManager.getData().slice()}function kM(t){return this.contextMenuUI.appendOptions(t)}function PM(t,e){this.headersUI.appendLevelIndicators(t,e)}function DM(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function LM(t,e,n,o){o!==this.pluginName&&this.hot._registerTimeout(()=>{SM(IM,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function FM(t,e,n){const o=Array.from(n.reduce((t,e)=>{if(this.dataManager.isParent(e)){const n=this.dataManager.getDataObject(e).__children;return t.add(e),Array.isArray(n)&&n.forEach(e=>t.add(this.dataManager.getRowIndex(e))),t}return t.add(e)},new Set));n.length=0,n.push(...o)}function VM(){this.collapsingUI.collapsedRowsStash.stash()}function WM(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function BM(){this.collapsingUI.collapsedRowsStash.stash()}function UM(t,e,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function zM(){this.dataManager.rewriteCache()}function GM(){this.headersUI.updateRowHeaderWidth()}function YM(t,e){CM(IM,this)&&(e.skipRender=!0)}function XM(t){if(!Object(ep["isArrayOfObjects"])(t))return Object(pi["a"])(MM),this.hot.getSettings()[EM]=!1,void this.disablePlugin();this.dataManager.setData(t),this.dataManager.rewriteCache()}function $M(t,e,n){return(e=KM(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function KM(t){var e=qM(t,"string");return"symbol"==typeof e?e:e+""}function qM(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class QM{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;$M(this,"rootWindow",void 0),$M(this,"prefix",void 0),$M(this,"savedKeys",[]),this.rootWindow=e,this.prefix=t,this.loadSavedKeys()}saveValue(t,e){this.rootWindow.localStorage.setItem(`${this.prefix}_${t}`,JSON.stringify(e)),-1===this.savedKeys.indexOf(t)&&(this.savedKeys.push(t),this.saveSavedKeys())}loadValue(t,e){const n="undefined"===typeof t?e:t,o=this.rootWindow.localStorage.getItem(`${this.prefix}_${n}`);return null===o?void 0:JSON.parse(o)}reset(t){this.rootWindow.localStorage.removeItem(`${this.prefix}_${t}`)}resetAll(){Object(f["arrayEach"])(this.savedKeys,(t,e)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[e]}`)}),this.clearSavedKeys()}loadSavedKeys(){const t=this.rootWindow.localStorage.getItem(this.prefix+"__persistentStateKeys"),e="string"===typeof t?JSON.parse(t):void 0;this.savedKeys=e||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(this.prefix+"__persistentStateKeys",JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}var JM=QM;function ZM(t,e,n){return(e=tI(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tI(t){var e=eI(t,"string");return"symbol"==typeof e?e:e+""}function eI(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}mt["a"].getSingleton().register("persistentStateSave"),mt["a"].getSingleton().register("persistentStateLoad"),mt["a"].getSingleton().register("persistentStateReset");const nI="persistentState",oI=0;class iI extends bn{constructor(){super(...arguments),ZM(this,"storage",void 0)}static get PLUGIN_KEY(){return nI}static get PLUGIN_PRIORITY(){return oI}isEnabled(){return!!this.hot.getSettings()[nI]}enablePlugin(){this.enabled||(this.storage||(this.storage=new JM(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(t,e)=>this.saveValue(t,e)),this.addHook("persistentStateLoad",(t,e)=>this.loadValue(t,e)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(t,e){e.value=this.storage.loadValue(t)}saveValue(t,e){this.storage.saveValue(t,e)}resetValue(t){"undefined"===typeof t?this.storage.resetAll():this.storage.reset(t)}destroy(){super.destroy()}}function rI(t,e){sI(t,e),e.add(t)}function sI(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function aI(t,e,n){return(e=lI(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lI(t){var e=cI(t,"string");return"symbol"==typeof e?e:e+""}function cI(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function hI(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const uI="search",dI=190,fI="htSearchResult",gI=function(t,e,n,o,i){t.getCellMeta(e,n).isSearchResult=i},pI=function(t,e,n){return!(Object(g["isUndefined"])(t)||null===t||!t.toLocaleLowerCase||0===t.length)&&(!Object(g["isUndefined"])(e)&&null!==e&&-1!==e.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale)))};var mI=new WeakSet;class bI extends bn{constructor(){super(...arguments),rI(this,mI),aI(this,"callback",gI),aI(this,"queryMethod",pI),aI(this,"searchResultClass",fI)}static get PLUGIN_KEY(){return uI}static get PLUGIN_PRIORITY(){return dI}isEnabled(){return this.hot.getSettings()[uI]}enablePlugin(){var t=this;if(this.enabled)return;const e=this.hot.getSettings()[uI];this.updatePluginSettings(e),this.addHook("beforeRenderer",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return hI(mI,t,wI).call(t,...n)})),super.enablePlugin()}disablePlugin(){var t=this;const e=function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return hI(mI,t,wI).call(t,...n)};this.hot.addHook("beforeRenderer",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",e)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getCallback(),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.getQueryMethod();const o=this.hot.countRows(),i=this.hot.countCols(),r=[],s=this.hot;return Object(ie["rangeEach"])(0,o-1,o=>{Object(ie["rangeEach"])(0,i-1,i=>{const a=this.hot.getDataAtCell(o,i),l=this.hot.getCellMeta(o,i),c=l.search.callback||e,h=l.search.queryMethod||n,u=h(t,a,l);if(u){const t={row:o,col:i,data:a};r.push(t)}c&&c(s,o,i,a,u)})}),r}getCallback(){return this.callback}setCallback(t){this.callback=t}getQueryMethod(){return this.queryMethod}setQueryMethod(t){this.queryMethod=t}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(t){this.searchResultClass=t}updatePluginSettings(t){Object(l["isObject"])(t)&&(t.searchResultClass&&this.setSearchResultClass(t.searchResultClass),t.queryMethod&&this.setQueryMethod(t.queryMethod),t.callback&&this.setCallback(t.callback))}destroy(){super.destroy()}}function wI(t,e,n,o,i,r){const s=r.className||[];let a=[];"string"===typeof s?a=s.split(" "):a.push(...s),this.isEnabled()&&r.isSearchResult?a.includes(this.searchResultClass)||a.push(""+this.searchResultClass):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),r.className=a.join(" ")}function vI(t,e){yI(t,e),e.add(t)}function yI(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function CI(t,e,n){return(e=SI(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function SI(t){var e=OI(t,"string");return"symbol"==typeof e?e:e+""}function OI(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function EI(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const RI="touchScroll",TI=200;var MI=new WeakSet;class II extends bn{constructor(){super(...arguments),vI(this,MI),CI(this,"scrollbars",[]),CI(this,"clones",[]),CI(this,"lockedCollection",!1),CI(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return RI}static get PLUGIN_PRIORITY(){return TI}static get SETTING_KEYS(){return!0}isEnabled(){return Object(vn["isTouchSupported"])()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>EI(MI,this,xI).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>EI(MI,this,NI).call(this)),this.addHook("afterMomentumScroll",()=>EI(MI,this,AI).call(this))}}function xI(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:n,topInlineStartCornerOverlay:o,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(n),o&&this.scrollbars.push(o),i&&i.clone&&this.scrollbars.push(i),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),o&&this.clones.push(o.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}function NI(){this.freezeOverlays=!0,Object(f["arrayEach"])(this.clones,t=>{Object(s["addClass"])(t,"hide-tween")})}function AI(){this.freezeOverlays=!1,Object(f["arrayEach"])(this.clones,t=>{Object(s["removeClass"])(t,"hide-tween"),Object(s["addClass"])(t,"show-tween")}),this.hot._registerTimeout(()=>{Object(f["arrayEach"])(this.clones,t=>{Object(s["removeClass"])(t,"show-tween")})},400),Object(f["arrayEach"])(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function HI(t,e){jI(t,e),e.add(t)}function jI(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _I(t,e,n){return(e=kI(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kI(t){var e=PI(t,"string");return"symbol"==typeof e?e:e+""}function PI(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function DI(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const LI="trimRows",FI=330;var VI=new WeakSet;class WI extends bn{constructor(){super(...arguments),HI(this,VI),_I(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return LI}static get PLUGIN_PRIORITY(){return FI}isEnabled(){return!!this.hot.getSettings()[LI]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new Rm["a"]),this.trimmedRowsMap.addLocalHook("init",()=>DI(VI,this,BI).call(this)),super.enablePlugin())}updatePlugin(){const t=this.hot.getSettings()[LI];Array.isArray(t)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),Object(f["arrayEach"])(t,t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(t){const e=this.getTrimmedRows(),n=this.isValidConfig(t);let o=e;n&&(o=Array.from(new Set(e.concat(t))));const i=this.hot.runHooks("beforeTrimRow",e,o,n);!1!==i&&(n&&this.hot.batchExecution(()=>{Object(f["arrayEach"])(t,t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)})},!0),this.hot.runHooks("afterTrimRow",e,o,n,n&&o.length>e.length))}trimRow(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.trimRows(e)}untrimRows(t){const e=this.getTrimmedRows(),n=this.isValidConfig(t);let o=e;const i=this.trimmedRowsMap.getValues().slice(),r=t.length>0;n&&r&&(Object(f["arrayEach"])(t,t=>{i[t]=!1}),o=Object(f["arrayReduce"])(i,(t,e,n)=>(e&&t.push(n),t),[]));const s=this.hot.runHooks("beforeUntrimRow",e,o,n&&r);!1!==s&&(n&&r&&this.trimmedRowsMap.setValues(i),this.hot.runHooks("afterUntrimRow",e,o,n&&r,n&&o.length<e.length))}untrimRow(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.untrimRows(e)}isTrimmed(t){return this.trimmedRowsMap.getValueAtIndex(t)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(t){const e=this.hot.countSourceRows();return t.every(t=>Number.isInteger(t)&&t>=0&&t<e)}destroy(){super.destroy()}}function BI(){const t=this.hot.getSettings()[LI];Array.isArray(t)&&this.hot.batchExecution(()=>{Object(f["arrayEach"])(t,t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)})},!0)}n("8e39");const UI="undoRedo",zI="undoRedo";function GI(t){const e=this;this.instance=t,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,t.addHook("afterChange",(function(n,o){const i=n&&n.length;if(!i)return;const r=n.find(t=>{const[,,e,n]=t;return e!==n});if(!r)return;const s=()=>{const e=n.reduce((t,e)=>(t.push([...e]),t),[]);Object(f["arrayEach"])(e,e=>{e[1]=t.propToCol(e[1])});const o=i>1?this.getSelected():[[e[0][0],e[0][1]]];return new GI.ChangeAction(e,o)};e.done(s,o)})),t.addHook("afterCreateRow",(t,n,o)=>{e.done(()=>new GI.CreateRowAction(t,n),o)});const n=(e,n,o,i)=>{const r=["visualRow","visualCol","row","col","prop"],s=r.length,a=[];return Object(ie["rangeEach"])(o,i,o=>{Object(ie["rangeEach"])(e,n,e=>{const n=t.getCellMeta(e,o);if(Object.keys(n).length!==s){const t=Object.fromEntries(Object.entries(n).filter(t=>{let[e]=t;return!1===r.includes(e)}));a.push([n.visualRow,n.visualCol,t])}})}),a};t.addHook("beforeRemoveRow",(o,i,r,s)=>{const a=()=>{const r=t.toPhysicalRow(o),s=r+i-1,a=Object(l["deepClone"])(e.instance.getSourceData(r,0,r+i-1,e.instance.countSourceCols()-1));return new GI.RemoveRowAction(r,a,t.getSettings().fixedRowsBottom,t.getSettings().fixedRowsTop,t.rowIndexMapper.getIndexesSequence(),n(r,s,0,t.countCols()-1))};e.done(a,s)}),t.addHook("afterCreateCol",(t,n,o)=>{e.done(()=>new GI.CreateColumnAction(t,n),o)}),t.addHook("beforeRemoveCol",(o,i,r,s)=>{const a=()=>{const r=e.instance.getSourceDataArray(),s=(e.instance.countCols()+o)%e.instance.countCols(),a=s+i-1,l=[],c=[],h=[];Object(ie["rangeEach"])(r.length-1,e=>{const n=[],o=r[e];Object(ie["rangeEach"])(s,a,e=>{n.push(o[t.toPhysicalColumn(e)])}),l.push(n)}),Object(ie["rangeEach"])(i-1,e=>{h.push(t.toPhysicalColumn(s+e))}),Array.isArray(t.getSettings().colHeaders)&&Object(ie["rangeEach"])(i-1,e=>{c.push(t.getSettings().colHeaders[t.toPhysicalColumn(s+e)]||null)});const u=t.columnIndexMapper.getIndexesSequence(),d=t.rowIndexMapper.getIndexesSequence();return new GI.RemoveColumnAction(s,h,l,c,u,d,t.getSettings().fixedColumnsStart,n(0,t.countRows(),s,a))};e.done(a,s)}),t.addHook("beforeCellAlignment",(t,n,o,i)=>{e.done(()=>new GI.CellAlignmentAction(t,n,o,i))}),t.addHook("beforeFilter",(t,n)=>{e.done(()=>new GI.FiltersAction(t,n))}),t.addHook("beforeRowMove",(t,n)=>{!1!==t&&e.done(()=>new GI.RowMoveAction(t,n))}),t.addHook("beforeColumnMove",(t,n)=>{!1!==t&&e.done(()=>new GI.ColumnMoveAction(t,n))}),t.addHook("beforeMergeCells",(n,o)=>{o||e.done(()=>new GI.MergeCellsAction(t,n))}),t.addHook("afterUnmergeCells",(n,o)=>{o||e.done(()=>new GI.UnmergeCellsAction(t,n))}),t.addHook("beforeColumnSort",(t,n,o)=>{o&&e.done(()=>new GI.ColumnSortAction(t,n))}),t.addHook("afterInit",()=>{e.init()})}GI.prototype.done=function(t,e){if(this.ignoreNewActions)return;const n="UndoRedo.undo"===e||"UndoRedo.redo"===e||"auto"===e;if(n)return;const o=this.doneActions.slice(),i=this.instance.runHooks("beforeUndoStackChange",o,e);if(!1===i)return;const r=t(),s=this.undoneActions.slice();this.doneActions.push(r),this.instance.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",s),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",s,this.undoneActions.slice())},GI.prototype.undo=function(){if(this.isUndoAvailable()){const t=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",t);const e=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",t,this.doneActions.slice());const n=Object(l["deepClone"])(e),o=this.instance.runHooks("beforeUndo",n);if(!1===o)return;this.ignoreNewActions=!0;const i=this,r=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",r),e.undo(this.instance,()=>{i.ignoreNewActions=!1,i.undoneActions.push(e)}),this.instance.runHooks("afterRedoStackChange",r,this.undoneActions.slice()),this.instance.runHooks("afterUndo",n)}},GI.prototype.redo=function(){if(this.isRedoAvailable()){const t=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",t);const e=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",t,this.undoneActions.slice());const n=Object(l["deepClone"])(e),o=this.instance.runHooks("beforeRedo",n);if(!1===o)return;this.ignoreNewActions=!0;const i=this,r=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",r),e.redo(this.instance,()=>{i.ignoreNewActions=!1,i.doneActions.push(e)}),this.instance.runHooks("afterUndoStackChange",r,this.doneActions.slice()),this.instance.runHooks("afterRedo",n)}},GI.prototype.isUndoAvailable=function(){return this.doneActions.length>0},GI.prototype.isRedoAvailable=function(){return this.undoneActions.length>0},GI.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0},GI.prototype.isEnabled=function(){return this.enabled},GI.prototype.enable=function(){if(this.isEnabled())return;const t=this.instance;this.enabled=!0,KI(t),this.registerShortcuts(),t.addHook("afterChange",$I)},GI.prototype.disable=function(){if(!this.isEnabled())return;const t=this.instance;this.enabled=!1,qI(t),this.unregisterShortcuts(),t.removeHook("afterChange",$I)},GI.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null},GI.Action=function(){},GI.Action.prototype.undo=function(){},GI.Action.prototype.redo=function(){},GI.ChangeAction=function(t,e){this.changes=t,this.selected=e,this.actionType="change"},Object(l["inherit"])(GI.ChangeAction,GI.Action),GI.ChangeAction.prototype.undo=function(t,e){const n=Object(l["deepClone"])(this.changes),o=t.countEmptyRows(!0),i=t.countEmptyCols(!0);for(let s=0,a=n.length;s<a;s++)n[s].splice(3,1);t.addHookOnce("afterChange",e),t.setDataAtCell(n,null,null,"UndoRedo.undo");for(let s=0,a=n.length;s<a;s++){const[e,r]=n[s];t.getSettings().minSpareRows&&e+1+t.getSettings().minSpareRows===t.countRows()&&o===t.getSettings().minSpareRows&&(t.alter("remove_row",parseInt(e+1,10),t.getSettings().minSpareRows),t.undoRedo.doneActions.pop()),t.getSettings().minSpareCols&&r+1+t.getSettings().minSpareCols===t.countCols()&&i===t.getSettings().minSpareCols&&(t.alter("remove_col",parseInt(r+1,10),t.getSettings().minSpareCols),t.undoRedo.doneActions.pop())}const r=t.getSelectedLast();if(void 0!==r){const[e,o]=n[0],[i,s]=r,a=t.view.getFirstFullyVisibleRow(),l=t.view.getFirstFullyVisibleColumn(),c=e>=a,h=o>=l,u=c&&h,d=i!==e||s!==o;if(!1===u&&!0===d){const n={row:e,col:o};!1===c&&(n.verticalSnap="top"),!1===h&&(n.horizontalSnap="start"),t.scrollViewportTo(n)}}t.selectCells(this.selected,!1,!1)},GI.ChangeAction.prototype.redo=function(t,e){const n=Object(l["deepClone"])(this.changes);for(let o=0,i=n.length;o<i;o++)n[o].splice(2,1);t.addHookOnce("afterChange",e),t.setDataAtCell(n,null,null,"UndoRedo.redo"),this.selected&&t.selectCells(this.selected,!1,!1)},GI.CreateRowAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_row"},Object(l["inherit"])(GI.CreateRowAction,GI.Action),GI.CreateRowAction.prototype.undo=function(t,e){const n=t.countRows(),o=t.getSettings().minSpareRows;this.index>=n&&this.index-o<n&&(this.index-=o),t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.amount,"UndoRedo.undo")},GI.CreateRowAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateRow",e),t.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")},GI.RemoveRowAction=function(t,e,n,o,i,r){this.index=t,this.data=e,this.actionType="remove_row",this.fixedRowsBottom=n,this.fixedRowsTop=o,this.rowIndexesSequence=i,this.removedCellMetas=r},Object(l["inherit"])(GI.RemoveRowAction,GI.Action),GI.RemoveRowAction.prototype.undo=function(t,e){const n=t.getSettings(),o=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach((t,e)=>{Object.keys(t).forEach(n=>{const i=parseInt(n,10);o.push([this.index+e,isNaN(i)?n:i,t[n]])})}),t.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),this.removedCellMetas.forEach(e=>{let[n,o,i]=e;t.setCellMetaObject(n,o,i)}),t.addHookOnce("afterViewRender",e),t.setSourceDataAtCell(o,null,null,"UndoRedo.undo"),t.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)},GI.RemoveRowAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")},GI.CreateColumnAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_col"},Object(l["inherit"])(GI.CreateColumnAction,GI.Action),GI.CreateColumnAction.prototype.undo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.undo")},GI.CreateColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateCol",e),t.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")},GI.RemoveColumnAction=function(t,e,n,o,i,r,s,a){this.index=t,this.indexes=e,this.data=n,this.amount=this.data[0].length,this.headers=o,this.columnPositions=i.slice(0),this.rowPositions=r.slice(0),this.actionType="remove_col",this.fixedColumnsStart=s,this.removedCellMetas=a},Object(l["inherit"])(GI.RemoveColumnAction,GI.Action),GI.RemoveColumnAction.prototype.undo=function(t,e){const n=t.getSettings();n.fixedColumnsStart=this.fixedColumnsStart;const o=this.indexes.slice(0).sort(),i=(t,e,n)=>n[this.indexes.indexOf(o[e])],r=this.data.length,s=[];for(let c=0;c<r;c++)s.push(Object(f["arrayMap"])(this.data[c],i));const a=Object(f["arrayMap"])(this.headers,i),l=[];t.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),Object(f["arrayEach"])(t.getSourceDataArray(),(t,e)=>{Object(f["arrayEach"])(o,(n,o)=>{t[n]=s[e][o],l.push([e,n,t[n]])})}),t.setSourceDataAtCell(l,void 0,void 0,"UndoRedo.undo"),"undefined"!==typeof this.headers&&Object(f["arrayEach"])(a,(e,n)=>{t.getSettings().colHeaders[o[n]]=e}),this.removedCellMetas.forEach(e=>{let[n,o,i]=e;t.setCellMetaObject(n,o,i)}),t.batchExecution(()=>{t.rowIndexMapper.setIndexesSequence(this.rowPositions),t.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),t.addHookOnce("afterViewRender",e),t.render()},GI.RemoveColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.redo")},GI.CellAlignmentAction=function(t,e,n,o){this.stateBefore=t,this.range=e,this.type=n,this.alignment=o},GI.CellAlignmentAction.prototype.undo=function(t,e){Object(f["arrayEach"])(this.range,e=>{e.forAll((e,n)=>{e>=0&&n>=0&&t.setCellMeta(e,n,"className",this.stateBefore[e][n]||" htLeft")})}),t.addHookOnce("afterViewRender",e),t.render()},GI.CellAlignmentAction.prototype.redo=function(t,e){sa(this.range,this.type,this.alignment,(e,n)=>t.getCellMeta(e,n),(e,n,o,i)=>t.setCellMeta(e,n,o,i)),t.addHookOnce("afterViewRender",e),t.render()},GI.FiltersAction=function(t,e){this.previousConditionsStack=e,this.conditionsStack=t,this.actionType="filter"},Object(l["inherit"])(GI.FiltersAction,GI.Action),GI.FiltersAction.prototype.undo=function(t,e){const n=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),this.previousConditionsStack&&n.conditionCollection.importAllConditions(this.previousConditionsStack),n.filter()},GI.FiltersAction.prototype.redo=function(t,e){const n=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),n.conditionCollection.importAllConditions(this.conditionsStack),n.filter()};class YI extends GI.Action{constructor(t,e){super(),this.cellRange=e;const n=this.cellRange.getTopStartCorner(),o=this.cellRange.getBottomEndCorner();this.rangeData=t.getData(n.row,n.col,o.row,o.col)}undo(t,e){const n=t.getPlugin("mergeCells");t.addHookOnce("afterViewRender",e),n.unmergeRange(this.cellRange,!0);const o=this.cellRange.getTopStartCorner();t.populateFromArray(o.row,o.col,this.rangeData,void 0,void 0,"MergeCells")}redo(t,e){const n=t.getPlugin("mergeCells");t.addHookOnce("afterViewRender",e),n.mergeRange(this.cellRange)}}GI.MergeCellsAction=YI;class XI extends GI.Action{constructor(t,e){super(),this.cellRange=e}undo(t,e){const n=t.getPlugin("mergeCells");t.addHookOnce("afterViewRender",e),n.mergeRange(this.cellRange,!0)}redo(t,e){const n=t.getPlugin("mergeCells");t.addHookOnce("afterViewRender",e),n.unmergeRange(this.cellRange,!0),t.render()}}function $I(t,e){const n=this;if("loadData"===e)return n.undoRedo.clear()}function KI(t){t.undo=function(){return t.undoRedo.undo()},t.redo=function(){return t.undoRedo.redo()},t.isUndoAvailable=function(){return t.undoRedo.isUndoAvailable()},t.isRedoAvailable=function(){return t.undoRedo.isRedoAvailable()},t.clearUndo=function(){return t.undoRedo.clear()}}function qI(t){delete t.undo,delete t.redo,delete t.isUndoAvailable,delete t.isRedoAvailable,delete t.clearUndo}GI.UnmergeCellsAction=XI,GI.RowMoveAction=function(t,e){this.rows=t.slice(),this.finalRowIndex=e,this.actionType="row_move"},Object(l["inherit"])(GI.RowMoveAction,GI.Action),GI.RowMoveAction.prototype.undo=function(t,e){const n=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e);const o=Rb(this.rows,this.finalRowIndex,t.rowIndexMapper.getNumberOfIndexes());o.reverse().forEach(t=>{let{from:e,to:o}=t;e<o&&(o-=1),n.moveRow(o,e)}),t.render(),t.deselectCell(),t.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)},GI.RowMoveAction.prototype.redo=function(t,e){const n=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e),n.moveRows(this.rows.slice(),this.finalRowIndex),t.render(),t.deselectCell(),t.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)},GI.ColumnMoveAction=function(t,e){this.columns=t.slice(),this.finalColumnIndex=e,this.actionType="col_move"},Object(l["inherit"])(GI.ColumnMoveAction,GI.Action),GI.ColumnMoveAction.prototype.undo=function(t,e){const n=t.getPlugin("manualColumnMove");t.addHookOnce("afterViewRender",e);const o=Rb(this.columns,this.finalColumnIndex,t.columnIndexMapper.getNumberOfIndexes());o.reverse().forEach(t=>{let{from:e,to:o}=t;e<o&&(o-=1),n.moveColumn(o,e)}),t.render(),t.deselectCell(),t.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)},GI.ColumnMoveAction.prototype.redo=function(t,e){const n=t.getPlugin("manualColumnMove");t.addHookOnce("afterViewRender",e),n.moveColumns(this.columns.slice(),this.finalColumnIndex),t.render(),t.deselectCell(),t.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)},GI.ColumnSortAction=function(t,e){this.previousSortState=t,this.nextSortState=e},Object(l["inherit"])(GI.ColumnSortAction,GI.Action),GI.ColumnSortAction.prototype.undo=function(t,e){const n=t.getPlugin("columnSorting"),o=t.getPlugin("multiColumnSorting"),i=o.isEnabled()?o:n;this.previousSortState.length?i.sort(this.previousSortState):i.clearSort(),e()},GI.ColumnSortAction.prototype.redo=function(t,e){const n=t.getPlugin("columnSorting"),o=t.getPlugin("multiColumnSorting"),i=o.isEnabled()?o:n;i.sort(this.nextSortState),e()},GI.prototype.init=function(){const t=this.instance.getSettings().undo,e="undefined"===typeof t||t;this.instance.undoRedo||(this.instance.undoRedo=this),e?this.instance.undoRedo.enable():this.instance.undoRedo.disable()},GI.prototype.registerShortcuts=function(){const t=this.instance.getShortcutManager(),e=t.getContext("grid"),n=t=>!t.altKey,o={runOnlyIf:n,group:UI};e.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],o)},GI.prototype.unregisterShortcuts=function(){const t=this.instance.getShortcutManager(),e=t.getContext("grid");e.removeShortcutsByGroup(UI)};const QI=mt["a"].getSingleton();QI.add("afterUpdateSettings",(function(){var t;null===(t=this.getPlugin("undoRedo"))||void 0===t||t.init()})),QI.register("beforeUndo"),QI.register("afterUndo"),QI.register("beforeRedo"),QI.register("afterRedo"),GI.PLUGIN_KEY=zI,GI.SETTING_KEYS=!0;var JI=GI;function ZI(){Object(en["d"])(Xn),Object(en["d"])(bo),Object(en["d"])(Do),Object(en["d"])(fi),Object(en["d"])(ji),Object(en["d"])(Xr),Object(en["d"])(gs),Object(en["d"])(La),Object(en["d"])(Lc),Object(en["d"])(Dh),Object(en["d"])(Su),Object(en["d"])(_u),Object(en["d"])(Qu),Object(en["d"])(Md),Object(en["d"])(Vm),Object(en["d"])(bw),Object(en["d"])(nv),Object(en["d"])(Sv),Object(en["d"])(Wv),Object(en["d"])(xy),Object(en["d"])(lC),Object(en["d"])(JC),Object(en["d"])(HS),Object(en["d"])(sE),Object(en["d"])(YE),Object(en["d"])(JE),Object(en["d"])(ST),Object(en["d"])(AM),Object(en["d"])(iI),Object(en["d"])(bI),Object(en["d"])(II),Object(en["d"])(WI),Object(en["d"])(JI)}function tx(){Nt(),pe(),Ae(),tn(),ZI()}var ex,nx,ox,ix,rx,sx=n("c5cd");function ax(t){const e="undefined"!==typeof window&&window.jQuery;e&&(e.fn.handsontable=function(e){const n=this.first();let o,i=n.data("handsontable");if("string"!==typeof e){const o=e||{};return i?i.updateSettings(o):(i=new t.Core(n[0],o),n.data("handsontable",i),i.init()),n}if(i){if("undefined"===typeof i[e])throw new Error("Handsontable do not provide action: "+e);for(var r=arguments.length,s=new Array(r>1?r-1:0),a=1;a<r;a++)s[a-1]=arguments[a];o=i[e].call(i,...s),"destroy"===e&&n.removeData()}return o})}tx(),ax(i["a"]),i["a"].__GhostTable=En,i["a"]._getListenersCounter=_t["b"],i["a"]._getRegisteredMapsCounter=sx["b"],i["a"].EventManager=_t["a"];const lx=[f,b,ep,o,vn,Li,g,ie,l,p,m,gh],cx=[s,a];i["a"].helper={},i["a"].dom={},f["arrayEach"](lx,t=>{f["arrayEach"](Object.getOwnPropertyNames(t),e=>{"_"!==e.charAt(0)&&(i["a"].helper[e]=t[e])})}),f["arrayEach"](cx,t=>{f["arrayEach"](Object.getOwnPropertyNames(t),e=>{"_"!==e.charAt(0)&&(i["a"].dom[e]=t[e])})}),i["a"].cellTypes=null!==(ex=i["a"].cellTypes)&&void 0!==ex?ex:{},f["arrayEach"](Object(Ze["b"])(),t=>{i["a"].cellTypes[t]=Object(Ze["a"])(t)}),i["a"].cellTypes.registerCellType=Ze["d"],i["a"].cellTypes.getCellType=Ze["a"],i["a"].editors=null!==(nx=i["a"].editors)&&void 0!==nx?nx:{},f["arrayEach"](Object(xt["c"])(),t=>{i["a"].editors[p["toUpperCaseFirst"](t)+"Editor"]=Object(xt["a"])(t)}),i["a"].editors.registerEditor=xt["e"],i["a"].editors.getEditor=xt["a"],i["a"].renderers=null!==(ox=i["a"].renderers)&&void 0!==ox?ox:{},f["arrayEach"](Object(ge["a"])(),t=>{const e=Object(ge["b"])(t);"base"===t&&(i["a"].renderers.cellDecorator=e),i["a"].renderers[p["toUpperCaseFirst"](t)+"Renderer"]=e}),i["a"].renderers.registerRenderer=ge["d"],i["a"].renderers.getRenderer=ge["b"],i["a"].validators=null!==(ix=i["a"].validators)&&void 0!==ix?ix:{},f["arrayEach"](Object(Ne["a"])(),t=>{i["a"].validators[p["toUpperCaseFirst"](t)+"Validator"]=Object(Ne["b"])(t)}),i["a"].validators.registerValidator=Ne["d"],i["a"].validators.getValidator=Ne["b"],i["a"].plugins=null!==(rx=i["a"].plugins)&&void 0!==rx?rx:{},f["arrayEach"](Object(en["b"])(),t=>{i["a"].plugins[t]=Object(en["a"])(t)}),i["a"].plugins[p["toUpperCaseFirst"](bn.PLUGIN_KEY)+"Plugin"]=bn,i["a"].plugins.registerPlugin=en["d"],i["a"].plugins.getPlugin=en["a"];e["a"]=i["a"]},e90f:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return s}));var o=n("97b9"),i=n("81ea");function r(t,e,n,i){const r=n.length?n[0]:void 0;return[...t.slice(0,r),...n.map((t,e)=>Object(o["isFunction"])(i)?i(t,e):i),...void 0===r?[]:t.slice(r)]}function s(t,e){return Object(i["arrayFilter"])(t,(t,n)=>!1===e.includes(n))}},eb36:function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return l}));n("7a89"),n("d06e");var o=n("5714");function i(t,e,n){return(e=r(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r(t){var e=s(t,"string");return"symbol"==typeof e?e:e+""}function s(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}const a=23;class l extends o["a"]{constructor(t){let{calculationTypes:e,viewportHeight:n,scrollOffset:o,totalRows:r,rowHeightFn:s,overrideFn:a,horizontalScrollbarHeight:l}=t;super(e),i(this,"viewportHeight",0),i(this,"scrollOffset",0),i(this,"zeroBasedScrollOffset",0),i(this,"totalRows",0),i(this,"rowHeightFn",null),i(this,"rowHeight",0),i(this,"overrideFn",null),i(this,"horizontalScrollbarHeight",0),i(this,"innerViewportHeight",0),i(this,"totalCalculatedHeight",0),i(this,"startPositions",[]),i(this,"needReverse",!0),this.viewportHeight=n,this.scrollOffset=o,this.zeroBasedScrollOffset=Math.max(o,0),this.totalRows=r,this.rowHeightFn=s,this.overrideFn=a,this.horizontalScrollbarHeight=null!==l&&void 0!==l?l:0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let t=0;t<this.totalRows;t++)if(this.rowHeight=this.getRowHeight(t),this._process(t,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(t){const e=this.rowHeightFn(t);return isNaN(e)?a:e}}},ef07:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var o=n("03529"),i=n("dd49");const r="text",s={CELL_TYPE:r,editor:o["a"],renderer:i["a"]}},f00c:function(t,e,n){var o=n("23e7"),i=n("e285");o({target:"Number",stat:!0},{isFinite:i})},f072:function(t,e,n){"use strict";var o=n("fd18"),i=n("73fa"),r=n("54d7"),s=o(Function.toString);i(r.inspectSource)||(r.inspectSource=function(t){return s(t)}),t.exports=r.inspectSource},f41c:function(t,e,n){"use strict";var o=n("80dd"),i=n("0ad8"),r=n("a60d").f,s=o("unscopables"),a=Array.prototype;void 0===a[s]&&r(a,s,{configurable:!0,value:i(null)}),t.exports=function(t){a[s][t]=!0}},f448:function(t,e,n){"use strict";var o=n("ac4f"),i=n("b343"),r=n("1fc8"),s=n("88c5"),a=!s("intersection")||i((function(){return"3,2"!==String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))}));o({target:"Set",proto:!0,real:!0,forced:a},{intersection:r})},f4db:function(t,e,n){"use strict";n("0eec"),n("59a2")},f6cb:function(t,e,n){"use strict";var o=n("54ad"),i=n("0204"),r=n("73fa"),s=n("6269"),a=n("c9a1"),l=n("9674"),c=n("6038"),h=o.Function,u=/MSIE .\./.test(a)||"BUN"===s&&function(){var t=o.Bun.version.split(".");return t.length<3||"0"===t[0]&&(t[1]<3||"3"===t[1]&&"0"===t[2])}();t.exports=function(t,e){var n=e?2:1;return u?function(o,s){var a=c(arguments.length,1)>n,u=r(o)?o:h(o),d=a?l(arguments,n):[],f=a?function(){i(u,this,d)}:u;return e?t(f,s):t(f)}:t}},f808:function(t,e,n){"use strict";var o=n("0227");t.exports=o("document","documentElement")},f86b:function(t,e,n){"use strict";var o=n("ac4f"),i=n("09d4"),r=n("88c5");o({target:"Set",proto:!0,real:!0,forced:!r("isSupersetOf")},{isSupersetOf:i})},f938:function(t,e,n){"use strict";n.r(e),n.d(e,"KEY_CODES",(function(){return r})),n.d(e,"isPrintableChar",(function(){return a})),n.d(e,"isFunctionKey",(function(){return l})),n.d(e,"isCtrlKey",(function(){return c})),n.d(e,"isCtrlMetaKey",(function(){return h})),n.d(e,"isKey",(function(){return u}));n("d06e");var o=n("81ea"),i=n("63d8");const r={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Object(i["isFirefox"])()?182:174,AUDIO_MUTE:Object(i["isFirefox"])()?181:173,AUDIO_UP:Object(i["isFirefox"])()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},s=[r.ALT,r.ARROW_DOWN,r.ARROW_LEFT,r.ARROW_RIGHT,r.ARROW_UP,r.AUDIO_DOWN,r.AUDIO_MUTE,r.AUDIO_UP,r.BACKSPACE,r.CAPS_LOCK,r.DELETE,r.END,r.ENTER,r.ESCAPE,r.F1,r.F2,r.F3,r.F4,r.F5,r.F6,r.F7,r.F8,r.F9,r.F10,r.F11,r.F12,r.F13,r.F14,r.F15,r.F16,r.F17,r.F18,r.F19,r.HOME,r.INSERT,r.MEDIA_NEXT,r.MEDIA_PLAY_PAUSE,r.MEDIA_PREV,r.MEDIA_STOP,r.NULL,r.NUM_LOCK,r.PAGE_DOWN,r.PAGE_UP,r.PAUSE,r.SCROLL_LOCK,r.SHIFT,r.TAB];function a(t){return 32===t||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function l(t){return s.includes(t)}function c(t){const e=[];return Object(i["isMacOS"])()?e.push(r.COMMAND_LEFT,r.COMMAND_RIGHT,r.COMMAND_FIREFOX):e.push(r.CONTROL),e.includes(t)}function h(t){return[r.CONTROL,r.COMMAND_LEFT,r.COMMAND_RIGHT,r.COMMAND_FIREFOX].includes(t)}function u(t,e){const n=e.split("|");let i=!1;return Object(o["arrayEach"])(n,e=>{if(t===r[e])return i=!0,!1}),i}},fb46:function(t,e,n){"use strict";var o=n("0227"),i=n("fd18"),r=n("bef1"),s=n("4aa5"),a=n("088f"),l=i([].concat);t.exports=o("Reflect","ownKeys")||function(t){var e=r.f(a(t)),n=s.f;return n?l(e,n(t)):e}},fc2d:function(t,e,n){"use strict";var o=n("bf78"),i=Object;t.exports=function(t){return i(o(t))}},fd18:function(t,e,n){"use strict";var o=n("48ab"),i=Function.prototype,r=i.call,s=o&&i.bind.bind(r,r);t.exports=o?s:function(t){return function(){return r.apply(t,arguments)}}},fdba:function(t,e,n){"use strict";var o=n("d128"),i=n("2b75"),r=n("a60d"),s=n("088f"),a=n("9394"),l=n("c041");e.f=o&&!i?Object.defineProperties:function(t,e){s(t);var n,o=a(e),i=l(e),c=i.length,h=0;while(c>h)r.f(t,n=i[h++],o[n]);return t}},ff56:function(t,e,n){"use strict";var o=n("624b"),i=n("87ed");t.exports=o(i.proto,"size","get")||function(t){return t.size}},ffec:function(t,e,n){"use strict";n.r(e),n.d(e,"isNumeric",(function(){return o})),n.d(e,"isNumericLike",(function(){return i})),n.d(e,"rangeEach",(function(){return r})),n.d(e,"rangeEachReverse",(function(){return s})),n.d(e,"valueAccordingPercent",(function(){return a})),n.d(e,"clamp",(function(){return l}));n("38b3"),n("f448"),n("66e1"),n("2582"),n("f86b"),n("1587"),n("c5d7");function o(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const n=typeof t;if("number"===n)return!isNaN(t)&&isFinite(t);if("string"===n){if(0===t.length)return!1;if(1===t.length)return/\d/.test(t);const n=Array.from(new Set([".",...e])).map(t=>"\\"+t).join("|");return new RegExp(`^[+-]?(((${n})?\\d+((${n})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}return"object"===n&&(!!t&&"number"===typeof t.valueOf()&&!(t instanceof Date))}function i(t){return o(t,[","])}function r(t,e,n){let o=-1;"function"===typeof e?(n=e,e=t):o=t-1;while(++o<=e)if(!1===n(o))break}function s(t,e,n){let o=t+1;"function"===typeof e&&(n=e,e=0);while(--o>=e)if(!1===n(o))break}function a(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function l(t,e,n){return Math.min(t,e)===t?e:Math.max(t,n)===t?n:t}}}]);