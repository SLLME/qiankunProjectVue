(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-56bd4d34"],{"45f1":function(e,t,a){"use strict";a("aa7e")},"5c21":function(e,t,a){"use strict";var l=a("5530");a("b64b");t["a"]={sheetModel:{EDIT:"edit",SUBMIT:"submit",VIEW:"view"},sheetInfo:function(e){return{sheetName:e.sheetName,sheetIndex:e.sheetIndex,sheetKey:e.sheetKey,sheetType:e.sheetType,sheetRow:e.sheetRow,sheetCol:e.sheetCol,sheetSave:e.sheetSave}},sheetMerges:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=t;if(e)for(var l=e.getPlugin("mergeCells").mergedCellsCollection.mergedCells,o=0;o<l.length;o++){var r=l[o];a.push({col:r.col,colspan:r.colspan,row:r.row,rowspan:r.rowspan})}return a},sheetWH:function(e){for(var t=e.countRows(),a=e.countCols(),l=[],o=[],r=0;r<t;r++)l[r]=e.getRowHeight(r)||25;for(var n=0;n<a;n++)o[n]=e.getColWidth(n)||50;return{heights:l,widths:o}},sheetDatas:function(e,t,a){var l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=l;if(t){for(var r=t.countRows(),n=t.countCols(),i=[],s=0;s<r;s++)this.isEmptyRow(t,s)||(i[i.length]=s);for(var c=[],d=0;d<n;d++)this.isEmptyCol(t,d)||(c[c.length]=d);for(var h={},u=0;u<i.length;u++){h={};for(var p=i[u],m={},f=0;f<c.length;f++)m=this.cellPropData(e,t,p,c[f],a),0!=Object.keys(m).length&&(h[c[f]]=m);o[p]=h}return o}},cellPropData:function(e,t,a,o,r){var n=t.getCellMeta(a,o),i=t.getSourceData()[a][o],s=n.type||"text",c=this.cellActiveData(s,n),d={};return d.text=i,e.isExpression(n.formula)&&(d.formula=n.formula),r===this.sheetModel.EDIT&&(d.formula="",n.formula="",e.isExpression(d.text)&&(d.formula=d.text,n.formula=d.text)),"number"===typeof i&&(d.text=String(i)),!1===e.targetIsNull(n.style)&&(d.style=Object(l["a"])({},n.style),n.border&&(d.style.border=n.border),n.indent&&0!==n.indent&&(d.style.indent=n.indent)),n.className&&(d.style||(d.style={}),d.style.className=n.className),"text"!==s&&(d.type=s),!1===e.targetIsNull(n.mapp)&&(d.mapp=n.mapp),!1===e.targetIsNull(c)&&(d.active=c),!1===e.targetIsNull(n.meta)&&(d.meta=n.meta),d},cellActiveData:function(e,t){var a={};return"checkbox"===e?a={checkedTemplate:t.checkedTemplate,uncheckedTemplate:t.uncheckedTemplate,label:{position:t.label.position,value:t.label.value}}:"dropdown"===e?a={source:"function"===typeof t.source?[]:t.source,request:t.request}:"numeric"===e?a={numericFormat:t.numericFormat}:"date"===e&&(a={dateFormat:t.dateFormat}),a},isEmptyRow:function(e,t){var a,l,o,r;for(a=0,l=e.countCols();a<l;a++)if(r=e.getCellMeta(t,a),o=e.getDataAtCell(t,a),o||this.isNULL(r))return!1;return!0},isEmptyCol:function(e,t){var a,l,o,r;for(a=0,l=e.countRows();a<l;a++)if(o=e.getDataAtCell(a,t),r=e.getCellMeta(a,t),o||this.isNULL(r))return!1;return!0},isNULL:function(e){return e.style||"text"!=e.type||e.mapp}}},"63f2":function(e,t,a){},75582:function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",{directives:[{name:"loading",rawName:"v-loading",value:e.mainLoading,expression:"mainLoading"}]},[a("el-header",{attrs:{height:"41px"}},[a("div",{staticStyle:{display:"flex","border-right":"1px solid #ccc"}},[a("span",{staticStyle:{display:"inline-block",width:"49px","text-align":"center","line-height":"40px",background:"#fff","border-top":"1px solid #ccc","border-left":"1px solid #ccc"}},[e._v(e._s(e.coordLable))]),a("div",{staticStyle:{flex:"1"}},[a("el-input",{attrs:{placeholder:"请输入内容",disabled:e.input.enabled,disabled:""},on:{change:e.cellInput,focus:e.cellFocus},model:{value:e.input.text,callback:function(t){e.$set(e.input,"text",t)},expression:"input.text"}},[a("template",{slot:"prepend"},[a("i",{staticClass:"icon font_family icon-formula",attrs:{alt:"公式"}})])],2)],1)])]),a("el-container",[a("el-main",[a("div",{staticClass:"sheet"},[a("hot-table",{ref:"wrapper",attrs:{settings:e.sheet.hotSettings,licenseKey:"dce68-5c723-aade1-cac51-db0f7"}})],1)]),a("el-aside",{staticStyle:{width:"290px"}},[a("setting-view",{ref:"setting",on:{handleSheetOptions:e.affectSheetOptions,handleMappOptions:e.affectMappOptions,handleCellOptions:e.affectCellOptions,handleVaildOptions:e.affectVaildOptions}})],1)],1),a("el-footer",{staticStyle:{height:"30px",padding:"0"}},[a("div",{staticClass:"footer"},[a("div",{staticClass:"left"},[a("span",[e._v("地区："),a("i",[e._v(e._s(e.footer.taxAreaName)+" ")])]),e._v(" "),a("span",[e._v(" 税种："),a("i",[e._v(e._s(e.footer.taxName))])])]),a("div",{staticClass:"center"},[a("span",[e._v("求和 = "+e._s(e.footer.taxSum))]),e._v(" "),a("span",[e._v("平均值 = "+e._s(e.footer.taxAvg))]),e._v(" "),a("span",[e._v("计数 = "+e._s(e.footer.taxCount))])]),a("div",{staticClass:"right"},[a("span",[e._v("坐标："+e._s(e.rowLable)+" ")]),e._v(","),a("span",[e._v(" "+e._s(e.colLable)+" 区域："+e._s(e.footer.taxRows)+"R ")]),e._v(" X "),a("span",[e._v(" "+e._s(e.footer.taxCols)+"C")])])])])],1)},o=[],r=(a("e9c4"),a("a9e3"),a("b64b"),a("d3b7"),a("ac1f"),a("5319"),a("159b"),a("e437")),n=a("c24d"),i=(a("c1cf"),a("8033"),a("e89a")),s=a("dfed"),c={name:"sheetView",props:{sheet:{type:Object,required:!0}},data:function(){return{mainLoading:!1,hot:null,router:{},footer:{taxName:"",taxAreaName:"",taxSum:0,taxAvg:0,taxCount:0,taxRows:0,taxCols:0},input:{text:"",enabled:!0},keyCode:-1,coordIndex:{row:0,col:0},coordLable:"A1",rowLable:1,colLable:1}},components:{HotTable:n["a"],settingView:i["default"]},methods:{hotRangs:function(){return this.hot.getSelectedRange()||[]},setCellOptBorder:function(e){var t=this,a="outline: 1px solid #;border-right-width:0;border-bottom-width:0;".replace(/#/g,e),l=this;this.common.targetRang(this.hotRangs(),(function(o,r,n){var i=t.hot.getCellMeta(o,r);if(!0!==i.hidden){var c=t.common.targetClass(t.common.targetDelClass(i.className,"htColor"),"htColor");t.hot.setCellMetaObject(o,r,{renderer:function(e,t,o,r,n,i,c){t.style=l.common.targetStyle(c,"border",a),t.className=c.className||"",s["a"].isNumText(c.type)&&(t.innerHTML=i)},border:e}),t.hot.setCellMeta(o,r,"className",c)}})),this.hot.render()},setCellIndent:function(e,t){var a=this,l=this;this.common.targetRang(this.hotRangs(),(function(o,r,n){var i=a.hot.getCellMeta(o,r);if(!0!==i.hidden){var c=Number(i["indent"]||0)+t,d="text-indent:"+c*e+"px";a.hot.setCellMetaObject(o,r,{renderer:function(e,t,a,o,r,n,i){t.style=l.common.targetStyle(i,"text-indent",d),t.className=i.className||"",s["a"].isNumText(i.type)&&(t.innerHTML=n)}}),a.hot.setCellMeta(o,r,"indent",c)}})),this.hot.render()},setCellOptColor:function(e){var t=this,a=this,l="background:#".replace(/#/g,e);this.common.targetRang(this.hotRangs(),(function(e,o,r){var n=t.hot.getCellMeta(e,o);if(!0!==n.hidden){var i=t.common.targetDelStyle(n,"background");t.hot.setCellMetaObject(e,o,{renderer:function(e,t,o,r,n,i,c){t.style=a.common.targetStyle(c,"background",l),t.className=c.className||"",s["a"].isNumText(c.type)&&(t.innerHTML=i)}}),t.hot.setCellMeta(e,o,"style",i)}})),this.hot.render()},setCellOptFont:function(e){var t=this,a=this;this.common.targetRang(this.hotRangs(),(function(l,o,r){var n=t.hot.getCellMeta(l,o);if(!0!==n.hidden){var i=t.common.toggleClassName(n.className,e);t.hot.setCellMetaObject(l,o,{renderer:function(e,t,l,o,r,n,i){t.style=a.common.targetExpansionStyle(i.style),t.className=i.className||"",s["a"].isNumText(i.type)&&(t.innerHTML=n)}}),t.hot.setCellMeta(l,o,"className",i)}})),this.hot.render()},setCellOptAlign:function(e){var t=this,a=this;this.common.targetRang(this.hotRangs(),(function(l,o,r){var n=t.hot.getCellMeta(l,o);if(!0!==n.hidden){var i=(n.className||"").replace("htCenter","").replace("htLeft","").replace("htRight","");i=t.common.targetClass(i,e),t.hot.setCellMetaObject(l,o,{renderer:function(e,t,l,o,r,n,i){t.style=a.common.targetExpansionStyle(i.style),t.className=i.className||"",s["a"].isNumText(i.type)&&(t.innerHTML=n)}}),t.hot.setCellMeta(l,o,"className",i)}})),this.hot.render()},setCellOptMenu:function(e){this.hot.getPlugin("contextMenu").executeCommand(e)},deCellOptBorder:function(){var e=this,t=this;this.common.targetRang(this.hotRangs(),(function(a,l,o){var r=e.hot.getCellMeta(a,l),n=e.common.targetDelClass(r.className,"htColor"),i=e.common.targetDelStyle(r,"border");e.hot.setCellMetaObject(a,l,{renderer:function(e,a,l,o,r,n,i){a.style=t.common.targetExpansionStyle(i.style),a.className=i.className||"",s["a"].isNumText(i.type)&&(a.innerHTML=n)}}),e.hot.setCellMeta(a,l,"className",n),e.hot.setCellMeta(a,l,"style",i)})),this.hot.render()},deCellOptColor:function(){var e=this,t=this;this.common.targetRang(this.hotRangs(),(function(a,l,o){var r=e.hot.getCellMeta(a,l),n=e.common.targetDelStyle(r,"background");e.hot.setCellMetaObject(a,l,{renderer:function(e,a,l,o,r,n,i){a.style=t.common.targetExpansionStyle(i.style),a.className=i.className||"",s["a"].isNumText(i.type)&&(a.innerHTML=n)}}),e.hot.setCellMeta(a,l,"style",n)})),this.hot.render()},affectSheetOptions:function(e,t){"row"===t?this.hot.updateSettings({maxRows:e.sheetRow,minRows:e.sheetRow}):"col"===t&&this.hot.updateSettings({maxCols:e.sheetCol,minCols:e.sheetCol}),Object.assign(this.sheet.sheetInfo,e)},affectCellOptions:function(e,t,a){var l=this,o=this;this.common.targetRang(this.hotRangs(),(function(n,i,c){if("datatype"===a){var d=!s["a"].isNumText(t.type);d&&(l.hot.emptySelectedCells(),l.input.text=""),l.input.enabled=d,e.forEach((function(e){l.hot.removeCellMeta(n,i,e)})),l.hot.setCellMetaObject(n,i,{renderer:function(e,t,a,l,n,i,s){t.innerHTML=i,t.className=s.className,t.style=o.common.targetExpansionStyle(s.style),"checkbox"===s.type?r["a"].renderers.CheckboxRenderer.apply(this,arguments):"dropdown"===s.type?r["a"].renderers.DropdownRenderer.apply(this,arguments):"numeric"===s.type?r["a"].renderers.NumericRenderer.apply(this,arguments):"date"===s.type&&r["a"].renderers.DateRenderer.apply(this,arguments)}}),"dropdown"===t.type&&(l.hot.getSourceData()[n][i]="");var h=JSON.parse(JSON.stringify(t));l.hot.setCellMetaObject(n,i,h)}else{var u=l.hot.getCellMeta(n,i).meta||{},p=JSON.parse(JSON.stringify(u)),m=JSON.parse(JSON.stringify(t)),f=Object.assign(p,m);"edit"===a&&(l.input.enabled="N"===f.edit,l.setCellOptMenu("make_read_only")),l.hot.setCellMeta(n,i,"meta",l.common.targetClearNull(f))}})),"datatype"===a&&this.hot.render()},affectMappOptions:function(e,t){"rangs"===e?t(this.hot,this.hotRangs()):("save"===e||"mapp"===e)&&t(this.hot,this.sheet)},affectVaildOptions:function(e,t){t(this.sheet)},cellClick:function(e,t,a){var l=this.hot.getSelectedLast();if(this.coordIndex=t={row:l[0],col:l[1]},-1==this.keyCode){this.input.text=this.hot.getSourceData()[t.row][t.col],this.coordLable=this.common.targetCellName(t.row,t.col),this.rowLable=Number(t.row)+1,this.colLable=Number(t.col)+1;var o=this.hot.getCellMeta(t.row,t.col),r=o.meta||{},n={cellType:o.type||"text",cellRule:r.rule||"",cellCascade:r.cascade||"",cellEdit:r.edit||"Y",cellAdjust:r.adjust||"N",cellPrevious:r.previous||"N",cellExpand:r.expand||"N",cellExpress:r.express||"",isYear:r.year||"N"};this.input.enabled=!s["a"].isNumText(o.type),this.$refs.setting.setCellOptions(n,o)}this.keyCode=-1},cellInput:function(){this.hot.getSourceData()[this.coordIndex.row][this.coordIndex.col]=this.input.text;var e=this.input.text;!0===this.common.isExpression(this.input.text)&&(e="公式"),this.hot.getCell(this.coordIndex.row,this.coordIndex.col).innerHTML=e,this.hot.getData()[this.coordIndex.row][this.coordIndex.col]=e},cellFocus:function(){18==this.keyCode&&(this.input.text=this.input.text+this.common.targetCellName(coords.row,coords.col))},afterRenderer:function(e,t,a,l,o,r){var n=this.hot.getSourceData()[t][a];!0===this.common.isExpression(n)&&(this.hot.getCell(t,a).innerHTML="公式")},afterCreateRow:function(e,t,a){"auto"!=a&&(s["a"].createRow(this.hot,this.common,e,t,a),this.$refs.setting.sheetForm.sheetRow+=1,this.sheet.sheetInfo.sheetRow+=1)},afterCreateCol:function(e,t,a){"auto"!=a&&(s["a"].createColumn(this.hot,this.common,e,t,a),this.$refs.setting.sheetForm.sheetCol+=1,this.sheet.sheetInfo.sheetCol+=1)},afterRemoveRow:function(e,t,a,l){"auto"!=l&&(this.$refs.setting.sheetForm.sheetRow-=t,this.sheet.sheetInfo.sheetRow-=t)},afterRemoveCol:function(e,t,a,l){"auto"!=l&&(this.$refs.setting.sheetForm.sheetCol-=t,this.sheet.sheetInfo.sheetCol-=t)},afterChange:function(e,t){},afterLoadData:function(){},afterSelectionEnd:function(e,t,a,l){s["a"].footer(this.hot,this.footer,e,a,t,l)},beforeChange:function(e,t){s["a"].cascade(this.hot,this.common,e,t)},beforeAutofill:function(e,t,a){s["a"].autoAllfill(this.common,e,t,a)},beforeKeyDown:function(e){this.keyCode=e.keyCode},afterValidate:function(e,t,a,l){return!0}},created:function(){this.footer.taxAreaName=this.common.targetGetStorage("taxInfo").taxAreaName,this.footer.taxName=this.common.targetGetStorage("taxInfo").taxName},mounted:function(){var e=this;this.mainLoading=!0;new Date;this.sheet.sheetHot=this.hot=this.$refs.wrapper.hotInstance,this.sheet.sheetUpdate=!0;var t=s["a"].dataAnalysis(this.sheet);this.hot.addHook("beforeChange",this.beforeChange),this.hot.addHook("beforeAutofill",this.beforeAutofill),this.hot.addHook("afterOnCellMouseDown",this.cellClick,this.hot),this.hot.addHook("afterCreateRow",this.afterCreateRow),this.hot.addHook("afterCreateCol",this.afterCreateCol),this.hot.addHook("afterRemoveRow",this.afterRemoveRow),this.hot.addHook("afterRemoveCol",this.afterRemoveCol),this.hot.addHook("afterRenderer",this.afterRenderer),this.hot.addHook("afterChange",this.afterChange),this.hot.addHook("afterSelectionEnd",this.afterSelectionEnd),this.hot.addHook("afterValidate",this.afterValidate),this.hot.addHook("beforeKeyDown",this.beforeKeyDown),this.hot.loadData(t.datas),setTimeout((function(){s["a"].customLoadData(r["a"],e.common,e.hot,e.sheet,t.cells),e.mainLoading=!1})),this.common.asyncMethod(this.$refs.setting.setSheetOptions,this.sheet)}},d=c,h=(a("45f1"),a("2877")),u=Object(h["a"])(d,l,o,!1,null,null,null);t["default"]=u.exports},aa7e:function(e,t,a){},acb9:function(e,t,a){},ba8d:function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.mainLoading,expression:"mainLoading"}],staticClass:"report-box"},[a("div",{staticClass:"report-top"},[a("el-tabs",{staticStyle:{flex:"1",width:"90%"},on:{"tab-click":e.handleClick},model:{value:e.active,callback:function(t){e.active=t},expression:"active"}},e._l(e.sheets,(function(e){return a("el-tab-pane",{key:e.sheetInfo.sheetKey,attrs:{label:e.sheetInfo.sheetName,name:e.sheetInfo.sheetKey}})})),1)],1),e._l(e.sheets,(function(t,l){return a("div",{key:l,staticClass:"report-content"},[e.active==t.sheetInfo.sheetKey?a("sheet-view",{attrs:{sheet:t}}):e._e()],1)}))],2)},o=[],r=a("c7eb"),n=a("1da1"),i=(a("b0c0"),a("d3b7"),a("4d63"),a("ac1f"),a("2c3e"),a("00b4"),a("25f0"),a("159b"),a("75582")),s=a("148f"),c=(a("5c21"),{name:"report",components:{sheetView:i["default"]},directives:{drag:{bind:function(e){var t=e;t.onmousedown=function(e){var a=e.clientX-t.parentNode.offsetLeft,l=e.clientY-t.parentNode.offsetTop;document.onmousemove=function(e){var o=e.clientX-a,r=e.clientY-l;r<0&&(r=0),t.parentNode.style.left=o+"px",t.parentNode.style.top=r+"px"},document.onmouseup=function(e){document.onmousemove=null,document.onmouseup=null}}}}},data:function(){return{mainLoading:!1,active:"",dialogpllrVisible:!1,settings:{colHeaders:!0,rowHeaders:!0,height:window.innerHeight-190,stretchH:"all",language:"zh-CN",mergeCells:!0,dropdownMenu:!1,contextMenu:!1,autoWrapRow:!0,outsideClickDeselects:!1,autoColumnSize:!0,readOnlyCellClassName:"htDimmed",comments:{displayDelay:500},trimWhitespace:!0,maxCols:225,maxRows:500,manualColumnResize:!0,manualRowResize:!0,readOnly:!1},sheets:[],router:{},nameOptions:[],codeOptions:[]}},methods:{handleClick:function(e,t){this.active=e.name}},created:function(){var e=this;return Object(n["a"])(Object(r["a"])().mark((function t(){var a,l;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.router=e.common.targetGetStorage("taxInfo"),a={uuid:e.router.uuid},t.next=4,Object(s["T"])(a);case 4:l=t.sent,e.$vLoading.hide(),l&&(e.sheets=l||[],e.sheets.length>0&&(e.sheets.forEach((function(t,a){t.hotSettings=e.settings,t.sheetUpdate=!1})),e.active=e.sheets[0].sheetInfo.sheetKey)),setTimeout((function(){e.mainLoading=!1}),1e3);case 8:case"end":return t.stop()}}),t)})))()},mounted:function(){var e=this;return Object(n["a"])(Object(r["a"])().mark((function t(){var a;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.$vLoading.show(),e.mainLoading=!0,t.next=4,Object(s["c"])("table_declare",{code:e.router.taxCode});case 4:a=t.sent,a&&(e.nameOptions=a);case 6:case"end":return t.stop()}}),t)})))()}}),d=c,h=(a("d057"),a("2877")),u=Object(h["a"])(d,l,o,!1,null,"e4719b58",null);t["default"]=u.exports},d057:function(e,t,a){"use strict";a("63f2")},dfed:function(e,t,a){"use strict";var l=a("5530");a("cb29"),a("4de4"),a("13d5"),a("a434"),a("a9e3"),a("f00c"),a("b64b"),a("d3b7"),a("4d63"),a("ac1f"),a("2c3e"),a("25f0"),a("466d"),a("5319"),a("498a");t["a"]={cache:{},localhost:"https://"+window.location.host+"/",regexp:{EXP_RANGE_REGEX:/[A-Z]+\d+:[A-Z]+\d+/g,EXP_CELL_REGEX:/[A-Z]+\d+/g,EXP_REF_REGEX:/[\u4e00-\u9fa5]+![A-Z]+\d+/g},expression:{lable:"xxxx!E4",token:"引用表达式",type:"ref",quote:"!",prefix:"xxxx",coordinate:[{row:4,column:4}]},dataAnalysis:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=[[]],a=[],o=[],r=0;r<e.sheetInfo.sheetRow;r++)if(t[r]=new Array(e.sheetInfo.sheetCol).fill(null),e.sheetDatas[r])for(var n=0;n<e.sheetInfo.sheetCol;n++){var i=e.sheetDatas[r][n];i&&(t[r][n]=i.text||null,a[a.length]={row:r,col:n,cell:i},i.active&&(o[o.length]={row:r,col:n,active:Object(l["a"])({type:i.type},i.active)}))}return{datas:t,cells:{cellInfos:a,actives:o}}},customLoadData:function(e){for(var t,a,o,r,n,i,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},h=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],u=h.cellInfos,p=0;p<u.length;p++){var m;t=u[p],a=t.cell,o=this.handleStyle(a),n=s.targetCellMeta(["type","border","mapp","meta","formula"],a),i=this.handleMeta(a.meta||{}),Object.keys(o).length>0&&c.setCellMetaObject(t.row,t.col,{renderer:function(t,a,l,o,r,n,i){var c;a.innerHTML=n,a.className=i.className+("Y"==(null===i||void 0===i||null===(c=i.meta)||void 0===c?void 0:c.required)?" required-class":""),a.style=s.targetExpansionStyle(i.style),"checkbox"===i.type?e.renderers.CheckboxRenderer.apply(this,arguments):"dropdown"===i.type?e.renderers.DropdownRenderer.apply(this,arguments):"numeric"===i.type?e.renderers.NumericRenderer.apply(this,arguments):"date"===i.type&&e.renderers.DateRenderer.apply(this,arguments),i.readOnly&&(i.readOnly?a.className=s.targetClass(i.className,"htDimmed"):a.className=s.targetDelClass(i.className,"htDimmed"))}}),r=Object(l["a"])(Object(l["a"])(Object(l["a"])({},o),n),i),"Y"==(null===(m=a)||void 0===m||null===(m=m.meta)||void 0===m?void 0:m.required)&&(r.validator=function(e,t){0==e||e&&""!==e.toString().trim()?t(!0):t(!1)}),c.setCellMetaObject(t.row,t.col,r)}for(var f=h.actives,g=0;g<f.length;g++){var v=Object.assign({},f[g]),b=s.targetClearNull(v.active);this.handleActive(s,c,v),c.setCellMetaObject(v.row,v.col,b)}var x={};d.sheetMerges&&(x.mergeCells=d.sheetMerges),d.sheetSize&&(x.colWidths=d.sheetSize.widths,x.rowHeights=d.sheetSize.heights),Object.keys(x).length>0&&c.updateSettings(x)},handleActive:function(e,t,a){if("dropdown"===a.active.type){var l=a.active.source;if(l instanceof Array&&l.length>0)return;if(!a.active.request||!a.active.request.url)return;var o=this;a.active.source=function(t,a){if(o.cache[this.request.url])a(o.cache[this.request.url]);else{var l=this;this.request.tmp||(this.request.tmp=this.request.url,this.request.url=e.targetStringFormat(this.request.url,["-1"])),fetch(o.localhost+this.request.url).then((function(e){return e.json()})).then((function(e){var t=e.data||[];t.unshift("--/--"),o.cache[l.request.url]=t,a(t)}))}}}},handleStyle:function(e){var t={};return e.style&&(t.style=Object(l["a"])({},e.style),e.style.border&&(t.border=e.style.border,t.style.border="outline: 1px solid #;border-right-width:0;border-bottom-width:0;".replace(/#/g,e.style.border)),e.style.indent&&(t.indent=e.style.indent,t.style.indent="text-indent:"+5*Number(e.style.indent)+"px"),e.style.className&&(t.className=e.style.className,delete t.style.className)),t},handleMeta:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={};return e.edit&&(t.readOnly="N"===e.edit),t},autoAllfill:function(e,t,a){var l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];if(1==l.length&&(0!=t.row||0!=a.row)){var o=l[0].filter((function(e){return e.indexOf(":")>=0||e.indexOf("!")>=0}));if(!(o.length>0)){for(var r=l[0].splice(0),n=[],i=0;i<r.length;i++)if(e.isExpression(r[i])){var s=[],c=this.expRef(e,r[i],s);c=this.expRang(e,c,s),c=this.expCell(e,c,s),n[i]={input:c,coordinates:s}}for(var d=0;d<=a.row-t.row;d++){for(var h=[],u=0;u<r.length;u++){var p=n[u];p?(this.expModifyFill(p.coordinates,1),h[u]=this.expLable(p.input,p.coordinates)):h[u]=r[u]}l[d]=h}}}},footer:function(e,t,a,l,o,r){var n=[];if(a>l){var i=[l,a];a=i[0],l=i[1]}if(o>r){var s=[r,o];o=s[0],r=s[1]}for(var c=a;c<=l;c++)for(var d=o;d<=r;d++){var h=1*e.getSourceData()[c][d];Number.isFinite(h)&&(n[n.length]=h)}t.taxRows=l-a+1,t.taxCols=r-o+1,t.taxCount=n.length,t.taxSum=n.reduce((function(e,t){return e+t}),0),t.taxAvg=n.length>0?t.taxSum/n.length:0},autofill:function(e,t,a,l,o){},sheetMerges:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=t;if(e)for(var l=e.getPlugin("mergeCells").mergedCellsCollection.mergedCells,o=0;o<l.length;o++){var r=l[o];a.push({col:r.col,colspan:r.colspan,row:r.row,rowspan:r.rowspan})}return a},createColumn:function(e,t,a,l,o){if("auto"!==o)for(var r=e.countCols(),n=e.countRows(),i=0;i<n;i++)for(var s=0;s<r;s++){var c=e.getSourceData()[i][s];if(t.isExpression(c)){var d=[],h=this.expRef(t,c,d);h=this.expRang(t,h,d),h=this.expCell(t,h,d),this.expModifyCol(d,a,l),d.length>0&&(e.getSourceData()[i][s]=this.expLable(h,d))}}},createRow:function(e,t,a,l,o){if("auto"!==o)for(var r=e.countCols(),n=e.countRows(),i=0;i<n;i++)for(var s=0;s<r;s++){var c=e.getSourceData()[i][s];if(t.isExpression(c)){var d=[],h=this.expRef(t,c,d);h=this.expRang(t,h,d),h=this.expCell(t,h,d),this.expModifyRow(d,a,l),d.length>0&&(e.getSourceData()[i][s]=this.expLable(h,d))}}},cascade:function(e,t,a,l){if(!("loadData"===l||"internal"===l||a.length>1)){var o=a[0][0],r=a[0][1],n=e.getCellMeta(o,r);if("dropdown"===n.type&&n.request.action){var i=a[0][3],s=t.targetCoordinate(n.request.action);if(s){var c=s.row,d=s.column,h=e.getCellMeta(c,d);"dropdown"===h.type?(i=i.split("|")[0],h.request.url=t.targetStringFormat(h.request.tmp,[i]),e.getSourceData()[c][d]=null):e.getSourceData()[c][d]=i}}}},expRef:function(e,t,a){var l=t.match(this.regexp.EXP_REF_REGEX);if(!l)return t;l.length>1&&(l=e.targetSameArray(l));for(var o=0;o<l.length;o++){var r=l[o].split("!"),n=e.targetCoordinate(r[1]),i={lable:l[o],token:"引用表达式"+o,type:"ref",quote:"!",prefix:r[0],coordinate:[n],toLable:function(){return this.prefix+this.quote+e.targetCellName(this.coordinate[0].row,this.coordinate[0].column)}};a[a.length]=i,t=t.replace(new RegExp(l[o],"g"),i.token)}return t},expRang:function(e,t,a){var l=t.match(this.regexp.EXP_RANGE_REGEX);if(!l)return t;l.length>1&&(l=e.targetSameArray(l));for(var o=0;o<l.length;o++){var r=l[o].split(":"),n=e.targetCoordinate(r[0]),i=e.targetCoordinate(r[1]),s={lable:l[o],token:"范围表达式"+o,type:"rang",quote:":",coordinate:[n,i],toLable:function(){var t=e.targetCellName(this.coordinate[0].row,this.coordinate[0].column),a=e.targetCellName(this.coordinate[1].row,this.coordinate[1].column);return t+this.quote+a}};a[a.length]=s,t=t.replace(new RegExp(l[o],"g"),s.token)}return t},expCell:function(e,t,a){var l=t.match(this.regexp.EXP_CELL_REGEX);if(!l)return t;l.length>1&&(l=e.targetSameArray(l));for(var o=0;o<l.length;o++){var r=e.targetCoordinate(l[o]),n={lable:l[o],token:"单项表达式"+o,type:"cell",quote:"",coordinate:[r],toLable:function(){return e.targetCellName(this.coordinate[0].row,this.coordinate[0].column)}};a[a.length]=n,t=t.replace(new RegExp(l[o],"g"),n.token)}return t},expLable:function(e,t){for(var a=0;a<t.length;a++)e=e.replace(new RegExp(t[a].token,"g"),t[a].toLable());return e},expModifyCol:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,l=!1,o=0;o<e.length;o++)for(var r=e[o].coordinate,n=0;n<r.length;n++)r[n].column>=t&&(r[n].column=r[n].column+a,l=!0);!1===l&&(e.length=0)},expModifyRow:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,l=!1,o=0;o<e.length;o++)for(var r=e[o].coordinate,n=0;n<r.length;n++)r[n].row>=t&&(r[n].row=r[n].row+a,l=!0);!1===l&&(e.length=0)},expModifyFill:function(e,t){for(var a=0;a<e.length;a++)for(var l=e[a].coordinate,o=0;o<l.length;o++)l[o].row=l[o].row+t},isCheckDropDate:function(e){return this.isCheck(e)||this.isDrop(e)||this.isDate()},isNumText:function(e){return this.isText(e)||this.isNum(e)},isCheck:function(e){return"checkbox"===e},isText:function(e){return"text"===e},isNum:function(e){return"numeric"===e},isDrop:function(e){return"dropdown"===e},isDate:function(e){return"date"===e}}},e2ad:function(e,t,a){"use strict";a("acb9")},e89a:function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"my-class"},[a("el-tabs",{attrs:{type:"border-card"},on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"单元格",name:"second"}}),a("el-tab-pane",{attrs:{label:"表格",name:"first"}}),a("el-tab-pane",{attrs:{label:"数据校验",name:"third"}})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:"first"==e.activeName,expression:"activeName=='first'"}],staticStyle:{"padding-right":"20px"}},[a("el-form",{ref:"sheetForm",attrs:{model:e.sheetForm,"label-width":"100px",size:"mini"}},[a("el-form-item",{attrs:{label:"报表编码："}},[e._v(" "+e._s(e.sheetForm.sheetKey)+" ")]),a("el-form-item",{attrs:{label:"报表名称："}},[e._v(" "+e._s(e.sheetForm.sheetName)+" ")]),a("el-form-item",{attrs:{label:"报表类型："}},[e._v(" "+e._s(e.report[e.sheetForm.sheetType])+" ")]),a("el-form-item",{attrs:{label:"行数调整："}},[a("el-input-number",{staticStyle:{width:"100%"},attrs:{"controls-position":"right",min:0,max:500,disabled:""},on:{change:function(t){return e.handleSheet("row")}},model:{value:e.sheetForm.sheetRow,callback:function(t){e.$set(e.sheetForm,"sheetRow",t)},expression:"sheetForm.sheetRow"}})],1),a("el-form-item",{attrs:{label:"列数调整："}},[a("el-input-number",{staticStyle:{width:"100%"},attrs:{"controls-position":"right",min:0,max:255,disabled:""},on:{change:function(t){return e.handleSheet("col")}},model:{value:e.sheetForm.sheetCol,callback:function(t){e.$set(e.sheetForm,"sheetCol",t)},expression:"sheetForm.sheetCol"}})],1),a("el-form-item",{attrs:{label:"是否存储："}},[a("el-radio-group",{attrs:{disabled:""},on:{change:function(t){return e.handleSheet("save")}},model:{value:e.sheetForm.sheetSave,callback:function(t){e.$set(e.sheetForm,"sheetSave",t)},expression:"sheetForm.sheetSave"}},[a("el-radio",{attrs:{label:"Y"}},[e._v("是")]),a("el-radio",{attrs:{label:"N"}},[e._v("否")])],1)],1),a("el-form-item",{attrs:{label:"映射存储："}},[a("span",{staticStyle:{color:"#f56c6c","text-decoration":"underline",cursor:"pointer"},on:{click:e.setMappConfig}},[e._v("映射配置")])]),a("el-form-item",{attrs:{label:"数据加载："}},[a("span",{staticStyle:{color:"#f56c6c","text-decoration":"underline",cursor:"pointer"},on:{click:function(t){e.popLoadShow=!0}}},[e._v("数据加载")])])],1)],1),a("div",{directives:[{name:"show",rawName:"v-show",value:"second"==e.activeName,expression:"activeName=='second'"}],staticStyle:{"padding-right":"20px"}},[a("el-form",{ref:"cellForm",attrs:{model:e.cellForm,"label-width":"100px",size:"mini"}},[a("el-form-item",{attrs:{label:"数据类型："}},[a("el-select",{attrs:{placeholder:"请选择",disabled:""},on:{change:function(t){return e.handleDataType("datatype")}},model:{value:e.cellForm.cellType,callback:function(t){e.$set(e.cellForm,"cellType",t)},expression:"cellForm.cellType"}},e._l(e.cellOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"取数来源："}},[a("el-select",{attrs:{placeholder:"请选择",filterable:"",clearable:"",disabled:""},on:{change:function(t){return e.handleFetch()}},model:{value:e.cellForm.cellRule,callback:function(t){e.$set(e.cellForm,"cellRule",t)},expression:"cellForm.cellRule"}},e._l(e.sourceOptions,(function(t){return a("el-option",{key:t.ruleCode,attrs:{label:e.router.taxArea==t.taxArea?t.ruleName:"( "+t.taxAreaName+" )"+t.ruleName,value:t.ruleCode}},[a("span",{class:{gray:"N"==t.expire},staticStyle:{float:"left"}},[e._v(e._s(e.router.taxArea==t.taxArea?t.ruleName:"( "+t.taxAreaName+" )"+t.ruleName))]),a("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v(e._s("Y"==t.expire?"正常":"禁用"))])])})),1)],1),a("el-form-item",{attrs:{label:"规则编码："}},[e._v(" "+e._s(e.cellForm.cellRule)+" ")]),"numeric"==e.cellForm.cellType?a("el-form-item",{attrs:{label:"小数位数："}},[a("el-select",{attrs:{placeholder:"请选择",disabled:""},on:{change:function(t){return e.handleDataType()}},model:{value:e.dataTypeForm.numericFormat.pattern,callback:function(t){e.$set(e.dataTypeForm.numericFormat,"pattern",t)},expression:"dataTypeForm.numericFormat.pattern"}},e._l(e.formatOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1):e._e(),"dropdown"==e.cellForm.cellType?a("el-form-item",{attrs:{label:"级联坐标："}},[a("el-input",{attrs:{disabled:""},on:{change:function(t){return e.handleDataType()}},model:{value:e.dataTypeForm.request.action,callback:function(t){e.$set(e.dataTypeForm.request,"action",t)},expression:"dataTypeForm.request.action"}})],1):e._e(),"checkbox"==e.cellForm.cellType?a("el-form-item",{attrs:{label:"文字："}},[a("el-input",{attrs:{disabled:""},on:{change:function(t){return e.handleDataType()}},model:{value:e.dataTypeForm.label.value,callback:function(t){e.$set(e.dataTypeForm.label,"value",t)},expression:"dataTypeForm.label.value"}})],1):e._e(),"checkbox"==e.cellForm.cellType?a("el-form-item",{attrs:{label:"文字位置："}},[a("el-select",{attrs:{placeholder:"请选择",disabled:""},on:{change:function(t){return e.handleDataType()}},model:{value:e.dataTypeForm.label.position,callback:function(t){e.$set(e.dataTypeForm.label,"position",t)},expression:"dataTypeForm.label.position"}},[a("el-option",{attrs:{label:"无",value:"-/-"}}),a("el-option",{attrs:{label:"前",value:"before"}}),a("el-option",{attrs:{label:"后",value:"after"}})],1)],1):e._e(),"date"==e.cellForm.cellType?a("el-form-item",{attrs:{label:"日期格式："}},[a("el-select",{attrs:{placeholder:"请选择",disabled:""},on:{change:function(t){return e.handleDataType()}},model:{value:e.dataTypeForm.dateFormat,callback:function(t){e.$set(e.dataTypeForm,"dateFormat",t)},expression:"dataTypeForm.dateFormat"}},[a("el-option",{attrs:{label:"无",value:"-/-"}}),a("el-option",{attrs:{label:"年-月-日",value:"YYYY-MM-DD"}}),a("el-option",{attrs:{label:"年/月/日",value:"YYYY/MM/DD"}})],1)],1):e._e(),"text"!=e.cellForm.cellType?a("div",{staticStyle:{height:"1px","border-bottom":"1px dashed #606266",margin:"0 0 28px 20px"}}):e._e(),a("el-form-item",{attrs:{label:"是否编辑："}},[a("el-radio-group",{attrs:{disabled:""},on:{change:function(t){return e.handleCell(e.cellForm.cellEdit,"edit")}},model:{value:e.cellForm.cellEdit,callback:function(t){e.$set(e.cellForm,"cellEdit",t)},expression:"cellForm.cellEdit"}},[a("el-radio",{attrs:{label:"Y"}},[e._v("是")]),a("el-radio",{attrs:{label:"N"}},[e._v("否")])],1)],1),a("el-form-item",{attrs:{label:"是否调整："}},[a("el-radio-group",{attrs:{disabled:""},on:{change:function(t){return e.handleCell(e.cellForm.cellAdjust,"adjust")}},model:{value:e.cellForm.cellAdjust,callback:function(t){e.$set(e.cellForm,"cellAdjust",t)},expression:"cellForm.cellAdjust"}},[a("el-radio",{attrs:{label:"Y",disabled:"N"==e.cellForm.cellEdit}},[e._v("是")]),a("el-radio",{attrs:{label:"N"}},[e._v("否")])],1)],1),a("el-form-item",{attrs:{label:"加载上期："}},[a("el-select",{attrs:{filterable:"","allow-create":"","default-first-option":"",disabled:""},on:{change:function(t){return e.handleCell(e.cellForm.cellPrevious,"previous")}},model:{value:e.cellForm.cellPrevious,callback:function(t){e.$set(e.cellForm,"cellPrevious",t)},expression:"cellForm.cellPrevious"}},[a("el-option",{attrs:{label:"否",value:"N"}}),a("el-option",{attrs:{label:"是",value:"Y"}})],1)],1),a("el-form-item",{attrs:{label:"是否扩展："}},[a("el-radio-group",{attrs:{disabled:""},on:{change:function(t){return e.handleCell(e.cellForm.cellExpand,"expand")}},model:{value:e.cellForm.cellExpand,callback:function(t){e.$set(e.cellForm,"cellExpand",t)},expression:"cellForm.cellExpand"}},[a("el-radio",{attrs:{label:"Y"}},[e._v("是")]),a("el-radio",{attrs:{label:"N"}},[e._v("否")])],1)],1),"Y"==e.cellForm.cellExpand?a("el-form-item",{attrs:{label:"扩展公式："}},[a("el-input",{attrs:{disabled:""},on:{change:function(t){return e.handleCell(e.cellForm.cellExpress,"express")}},model:{value:e.cellForm.cellExpress,callback:function(t){e.$set(e.cellForm,"cellExpress",t)},expression:"cellForm.cellExpress"}})],1):e._e(),a("el-form-item",{attrs:{label:"是否年内："}},[a("el-radio-group",{attrs:{disabled:""},on:{change:function(t){return e.handleCell(e.cellForm.isYear,"isYear")}},model:{value:e.cellForm.isYear,callback:function(t){e.$set(e.cellForm,"isYear",t)},expression:"cellForm.isYear"}},[a("el-radio",{attrs:{label:"Y"}},[e._v("是")]),a("el-radio",{attrs:{label:"N"}},[e._v("否")])],1)],1)],1)],1),a("div",{directives:[{name:"show",rawName:"v-show",value:"third"==e.activeName,expression:"activeName=='third'"}]},[a("el-form",{ref:"validForm",staticClass:"validForm",staticStyle:{"border-bottom":"1px solid #ccc","padding-right":"15px"},attrs:{model:e.validForm,"label-width":"90px",size:"mini"}},[a("el-form-item",{attrs:{label:"校验名称:"}},[a("el-input",{attrs:{disabled:""},model:{value:e.validForm.validName,callback:function(t){e.$set(e.validForm,"validName",t)},expression:"validForm.validName"}})],1),a("el-form-item",{attrs:{label:"校验类型:"}},[a("el-select",{attrs:{placeholder:"请选择",disabled:""},model:{value:e.validForm.validType,callback:function(t){e.$set(e.validForm,"validType",t)},expression:"validForm.validType"}},[a("el-option",{attrs:{label:"表内校验",value:"InTable"}}),a("el-option",{attrs:{label:"表间校验",value:"BTables"}})],1)],1),a("el-form-item",{attrs:{label:"表达式:"}},[a("el-input",{attrs:{type:"textarea",rows:4,disabled:""},model:{value:e.validForm.validExp,callback:function(t){e.$set(e.validForm,"validExp",t)},expression:"validForm.validExp"}})],1),a("el-form-item",{attrs:{label:"提示信息:"}},[a("el-input",{attrs:{type:"textarea",rows:2,disabled:""},model:{value:e.validForm.validInfo,callback:function(t){e.$set(e.validForm,"validInfo",t)},expression:"validForm.validInfo"}})],1)],1),a("div",{staticStyle:{"margin-top":"10px"}},[a("el-table",{ref:"sheetValids",staticStyle:{width:"90%",margin:"0 auto"},attrs:{data:e.sheetValids,"highlight-current-row":"",border:"",stripe:"",height:"250px"},on:{"row-click":e.otherTableClick}},[a("el-table-column",{attrs:{type:"index",label:"序号",width:"50"}}),a("el-table-column",{attrs:{prop:"validName",label:"校验名称"}})],1)],1)],1),e.popMappShow?a("div",{staticClass:"dialog-pramy"},[a("div",{directives:[{name:"drag",rawName:"v-drag"}],staticClass:"pop-title dragHead"},[e._v("映射配置 "),a("button",{staticClass:"dragHeadClose el-dialog__headerbtn",attrs:{type:"button"},on:{click:function(t){e.popMappShow=!1}}},[a("i",{staticClass:"el-icon el-icon-circle-close",staticStyle:{"font-size":"20px"}})])]),a("div",{staticClass:"pop-content"},[a("el-form",{ref:"mappConfig",attrs:{model:e.mappConfig,"label-width":"96px",size:"mini"}},[a("el-form-item",{staticStyle:{"margin-bottom":"10px"},attrs:{label:"映射类型："}},[a("el-radio-group",{model:{value:e.mappConfig.taxTableType,callback:function(t){e.$set(e.mappConfig,"taxTableType",t)},expression:"mappConfig.taxTableType"}},[a("el-radio",{staticStyle:{width:"90px"},attrs:{label:e.router.tmpType}},[e._v("业务数据")])],1)],1),a("el-form-item",{staticStyle:{"margin-bottom":"10px"},attrs:{label:"物理表名："}},[a("el-select",{staticStyle:{width:"340px"},attrs:{placeholder:"请选择"},on:{change:e.handleMappTable},model:{value:e.mappConfig.taxTableCode,callback:function(t){e.$set(e.mappConfig,"taxTableCode",t)},expression:"mappConfig.taxTableCode"}},e._l(e.mappOptions,(function(t){return a("el-option",{key:t.taxTableCode,attrs:{label:t.taxTableName,value:t.taxTableCode}},[a("span",{staticStyle:{float:"left"}},[e._v(e._s(t.taxTableName))]),a("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v(e._s(e.model[t.taxTableModel]))])])})),1)],1),a("el-form-item",{staticStyle:{"margin-bottom":"10px"},attrs:{label:"解析行数："}},[a("el-input-number",{staticStyle:{width:"340px"},attrs:{"controls-position":"right",min:0,max:e.sheetForm.sheetRow,disabled:"hash"==e.mappConfig.taxTableModel,disabled:""},model:{value:e.mappConfig.taxTableRows,callback:function(t){e.$set(e.mappConfig,"taxTableRows",t)},expression:"mappConfig.taxTableRows"}})],1),a("el-form-item",{staticStyle:{"margin-bottom":"10px"},attrs:{label:"结束标志："}},[a("el-input",{staticStyle:{width:"340px"},attrs:{placeholder:"请输入结束标志",disabled:"hash"==e.mappConfig.taxTableModel,disabled:""},model:{value:e.mappConfig.taxTablePattern,callback:function(t){e.$set(e.mappConfig,"taxTablePattern",t)},expression:"mappConfig.taxTablePattern"}})],1)],1),a("div",{staticStyle:{padding:"0px 14px 10px"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.mappConfigData,"highlight-current-row":"",border:"",stripe:"",height:"300px"}},[a("el-table-column",{attrs:{prop:"fieldNo",label:"序号",width:"50"}}),a("el-table-column",{attrs:{prop:"fieldDesc",label:"描述",align:"left","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{prop:"fieldCode",label:"字段",align:"left",width:"150"}}),a("el-table-column",{attrs:{prop:"coordinate",label:"坐标",width:"90"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{size:"mini",disabled:""},on:{focus:function(a){return e.handleFocus(t.$index,t.row)}},model:{value:t.row.coordinate,callback:function(a){e.$set(t.row,"coordinate",a)},expression:"scope.row.coordinate"}})]}}],null,!1,3690551066)})],1)],1)],1)]):e._e(),e.popLoadShow?a("div",{staticClass:"dialog-pramy"},[a("div",{directives:[{name:"drag",rawName:"v-drag"}],staticClass:"pop-title dragHead"},[e._v("数据加载 "),a("button",{staticClass:"dragHeadClose el-dialog__headerbtn",attrs:{type:"button"},on:{click:function(t){e.popLoadShow=!1}}},[a("i",{staticClass:"el-icon el-icon-circle-close",staticStyle:{"font-size":"20px"}})])]),a("div",{staticClass:"pop-content"},[a("el-form",{ref:"loadConfig",attrs:{model:e.loadConfig,"label-width":"96px",size:"mini"}},[a("el-form-item",{staticStyle:{"margin-bottom":"10px"},attrs:{label:"加载类型："}},[a("el-radio-group",{model:{value:e.loadConfig.ruleType,callback:function(t){e.$set(e.loadConfig,"ruleType",t)},expression:"loadConfig.ruleType"}},[a("el-radio",{staticStyle:{width:"90px"},attrs:{label:"s"}},[e._v("规则数据")])],1)],1),a("el-form-item",{staticStyle:{"margin-bottom":"10px"},attrs:{label:"规则名称："}},[a("el-select",{staticStyle:{width:"340px"},attrs:{placeholder:"请选择规则名称"},on:{change:e.handleLoadTable},model:{value:e.loadConfig.ruleCode,callback:function(t){e.$set(e.loadConfig,"ruleCode",t)},expression:"loadConfig.ruleCode"}},e._l(e.loadMultipleOptions,(function(t){return a("el-option",{key:t.ruleCode,attrs:{label:e.router.taxArea==t.taxArea?t.ruleName:"( "+t.taxAreaName+" )"+t.ruleName,value:t.ruleCode}})})),1)],1),a("el-form-item",{staticStyle:{"margin-bottom":"10px"},attrs:{label:"结束标志："}},[a("el-input",{staticStyle:{width:"340px"},attrs:{placeholder:"请填写结束标志",disabled:""},model:{value:e.loadConfig.rulePattern,callback:function(t){e.$set(e.loadConfig,"rulePattern",t)},expression:"loadConfig.rulePattern"}})],1)],1),a("div",{staticStyle:{padding:"0px 14px 10px"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.loadConfigData,"highlight-current-row":"",border:"",stripe:"",height:"300px"}},[a("el-table-column",{attrs:{type:"index",label:"序号",width:"50"}}),a("el-table-column",{attrs:{prop:"fieldDesc",label:"描述",align:"left","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{prop:"fieldCode",label:"字段",align:"left",width:"150"}}),a("el-table-column",{attrs:{prop:"coordinate",label:"坐标",width:"90"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{size:"mini",disabled:""},on:{focus:function(a){return e.handleFocus(t.$index,t.row)}},model:{value:t.row.coordinate,callback:function(a){e.$set(t.row,"coordinate",a)},expression:"scope.row.coordinate"}})]}}],null,!1,3690551066)})],1)],1)],1)]):e._e(),e.popMatchShow?a("div",{staticClass:"dialog-match"},[a("div",{directives:[{name:"drag",rawName:"v-drag"}],staticClass:"pop-title dragHead"},[e._v("匹配模式 "),a("button",{staticClass:"dragHeadClose el-dialog__headerbtn",attrs:{type:"button"},on:{click:function(t){e.popMatchShow=!1}}},[a("i",{staticClass:"el-icon el-icon-circle-close",staticStyle:{"font-size":"20px"}})])]),a("div",[a("el-radio-group",{model:{value:e.matchModel,callback:function(t){e.matchModel=t},expression:"matchModel"}},[a("el-radio",{attrs:{label:"r"}},[e._v("按行匹配")]),a("el-radio",{attrs:{label:"c"}},[e._v("按列匹配")]),a("el-radio",{attrs:{label:"h"}},[e._v("选择匹配")])],1)],1),a("div",{staticStyle:{"margin-top":"14px","text-align":"center"}},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.handleMatch(e.mappConfigData)}}},[e._v("确定")])],1)]):e._e()],1)},o=[],r=a("ade3"),n=a("b85c"),i=a("c7eb"),s=a("1da1"),c=a("5530"),d=(a("4de4"),a("7db0"),a("c740"),a("caad"),a("a15b"),a("d81d"),a("4e82"),a("b0c0"),a("e9c4"),a("b64b"),a("d3b7"),a("2532"),a("148f")),h=Object(r["a"])(Object(r["a"])(Object(r["a"])(Object(r["a"])(Object(r["a"])(Object(r["a"])(Object(r["a"])({name:"sheet",components:{},data:function(){return{mappIndex:0,activeName:"second",sheetForm:{sheetName:"",sheetIndex:"",sheetKey:"",sheetType:"declare",sheetRow:0,sheetCol:0,sheetSave:"Y"},cellForm:{cellType:"text",cellRule:"",cellEdit:"Y",cellAdjust:"N",cellPrevious:"N",cellExpand:"N",cellExpress:"",isYear:"N"},dataTypeForm:{numericFormat:{pattern:"0,00.00",culture:"zh-CN"},request:{url:"",action:""},label:{position:"before",value:"复选框"},dateFormat:"YYYY-MM-DD"},report:{declare:"申报表",draft:"底稿表",fetch:"取数表"},model:{hash:"散列",row:"行",column:"列"},cellOptions:[{label:"文本",value:"text"},{label:"数字",value:"numeric"},{label:"下拉框",value:"dropdown"},{label:"复选框",value:"checkbox"},{label:"日期",value:"date"}],formatOptions:[{label:"无",value:""},{label:"保留整数",value:"0,00"},{label:"保留1位小数",value:"0,00.0"},{label:"保留2位小数",value:"0,00.00"},{label:"保留3位小数",value:"0,00.000"},{label:"保留4位小数",value:"0,00.0000"},{label:"保留5位小数",value:"0,00.00000"},{label:"保留6位小数",value:"0,00.000000"},{label:"保留7位小数",value:"0,00.0000000"},{label:"保留8位小数",value:"0,00.00000000"}],contentOptions:[],sourceOptions:[],popMappShow:!1,popLoadShow:!1,popMatchShow:!1,mappOptions:[],mappAllOptions:[],mappConfigData:[],mappConfig:{taxDeclareCode:"",taxTableCode:"",taxTablePattern:"",taxTableModel:"",taxTableType:"",taxTableRows:1},loadAllOptions:[],loadMultipleOptions:[],loadSingleOptions:[],loadConfigData:[],loadConfig:{taxDeclareCode:"",ruleCode:"",rulePattern:"",ruleModel:"",ruleType:"s"},router:{},matchModel:"h",validForm:{validName:"",validType:"",validExp:"",validRelations:"",validInfo:""},sheetValids:[]}}},"components",{}),"directives",{drag:{bind:function(e){var t=e;t.onmousedown=function(e){var a=e.clientX-t.parentNode.offsetLeft,l=e.clientY-t.parentNode.offsetTop;document.onmousemove=function(e){var o=e.clientX-a,r=e.clientY-l;r<0&&(r=0),t.parentNode.style.left=o+"px",t.parentNode.style.top=r+"px"},document.onmouseup=function(e){document.onmousemove=null,document.onmouseup=null}}}}}),"methods",{saveValidForm:function(){var e=this,t=this.sheetValids.findIndex((function(t){return t.validName==e.validForm.validName}));t<0?this.sheetValids.push(JSON.parse(JSON.stringify(this.validForm))):this.$message({type:"info",message:"规则名称不能重复！"}),this.$emit("handleVaildOptions","vaild",(function(t){t.sheetValids=e.sheetValids}))},otherTableClick:function(e,t){this.validForm=e},resetValidForm:function(){this.$refs.sheetValids.setCurrentRow(),this.validForm=Object(c["a"])({},this.validForm)},handleClick:function(e,t){this.activeName=e.name},handleSheet:function(e){this.$emit("handleSheetOptions",this.sheetForm,e)},handleDataType:function(e){var t={},a=["editor","renderer","checkedTemplate","uncheckedTemplate","label","source","visibleRows","validator","type","dateFormat","numericFormat","request"],l=this.cellForm.cellType;"numeric"===l?t={type:l,numericFormat:this.dataTypeForm.numericFormat,validator:function(e,t){t(!0)}}:"dropdown"===l?t={type:l,source:[],request:this.dataTypeForm.request,visibleRows:15}:"checkbox"===l?t={type:l,checkedTemplate:"Y",uncheckedTemplate:"N",label:this.dataTypeForm.label}:"date"===l?t={type:l,dateFormat:this.dataTypeForm.dateFormat}:"text"===l&&(t={type:l}),"datatype"===e&&(this.sourceOptions=this.loadSingleOptions.filter((function(e){return e.ruleType===l})),"dropdown"===l&&(this.dataTypeForm.request.action=""),"checkbox"===l&&(this.dataTypeForm.label.value="复选框",this.dataTypeForm.label.position="before"),this.cellForm.cellRule="",this.handleCell(this.cellForm.cellRule,"rule")),this.$emit("handleCellOptions",a,t,"datatype")},handleFetch:function(){var e=this,t=this.cellForm.cellType;if("dropdown"===t&&this.cellForm.cellRule){var a=this.sourceOptions.find((function(t){return t.ruleCode===e.cellForm.cellRule}));this.dataTypeForm.request.url=a.inface.infaceAddress,this.handleDataType()}this.handleCell(this.cellForm.cellRule,"rule")},handleCell:function(e,t){"edit"==t&&"N"==e&&(this.cellForm.cellAdjust="N");var a={};a[t]=e,this.$emit("handleCellOptions",{},a,t)},handleFocus:function(e,t){this.mappIndex=e},handleMappLoad:function(e){var t=this;return Object(s["a"])(Object(i["a"])().mark((function a(){var l,o;return Object(i["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return l={taxArea:t.router.taxArea,taxCode:t.router.taxCode,taxDeclareCode:t.mappConfig.taxDeclareCode,taxStructure:t.router.tmpType},a.next=3,Object(d["W"])(l);case 3:o=a.sent,o&&e(o||{});case 5:case"end":return a.stop()}}),a)})))()},handleMappTable:function(e){var t=this;if(e){var a=this.mappOptions.find((function(t){return t.taxTableCode===e}));this.mappConfig.taxTableModel=a.taxTableModel,this.mappConfig.taxDeclareCode=a.taxDeclareCode;var l=this.handleMappKey(),o=this.sheetForm.sheetRow,r=this.sheetForm.sheetCol,i={},s=this;this.$emit("handleMappOptions","mapp",(function(e,a){for(var n=0;n<o;n++)for(var c=0;c<r;c++){var d=e.getCellMeta(n,c).mapp;d&&d[l]&&(i[d[l]]=s.common.targetCellName(n,c))}a.sheetMapp&&(t.mappConfig.taxTableRows=a.sheetMapp[l].taxTableRows,t.mappConfig.taxTablePattern=a.sheetMapp[l].taxTablePattern)})),this.handleMappLoad((function(a){var l=a[e]||[];0==l.length&&t.$message({type:"warn",message:"当前没有可用的映射信息,如果需要配置映射信息，请构建相关节点字段!请手动【坐标重置】清除无效的配置信息！"});var o,r=Object(n["a"])(l);try{for(r.s();!(o=r.n()).done;){var s=o.value;s.coordinate=i[s.fieldCode]||""}}catch(c){r.e(c)}finally{r.f()}t.mappConfigData=l}))}},handleLoadTable:function(e){if(e){var t=this.handleLoadKey(),a=this.sheetForm.sheetRow,l=this.sheetForm.sheetCol,o={},r=this;this.$emit("handleMappOptions","mapp",(function(e){for(var n=0;n<a;n++)for(var i=0;i<l;i++){var s=e.getCellMeta(n,i).mapp;s&&s[t]&&(o[s[t]]=r.common.targetCellName(n,i))}})),this.loadConfigData=[],this.handleLoadFields();var i,s=this.loadMultipleOptions.filter((function(t){return t.ruleCode===e})).map((function(e){return e.fields}))[0],c=Object(n["a"])(s);try{for(c.s();!(i=c.n()).done;){var d=i.value;this.loadConfigData.push({fieldCode:d.fieldCode,fieldDesc:d.fieldDesc,coordinate:o[d.fieldCode]||""})}}catch(h){c.e(h)}finally{c.f()}}},handleMatch:function(e){var t=this,a=[];if(this.$emit("handleMappOptions","rangs",(function(e,l){0!=l.length?(t.common.targetRang(l,(function(t,l,o){var r=e.getCellMeta(t,l);!0!==r.hidden&&(a[a.length]={row:t,col:l})})),"r"===t.matchModel?a.sort((function(e,t){return e.row-t.row})):"c"===t.matchModel&&a.sort((function(e,t){return e.col-t.col})),a=a.map((function(e){return t.common.targetCellName(e.row,e.col)}))):t.$message({type:"warn",message:"请选择要匹配的单元格，至少一个!"})})),a.length>0)for(var l=this.mappIndex;l<e.length;l++){var o=e[l],r=l-this.mappIndex;r<a.length&&this.$set(o,"coordinate",a[r])}},handleSave:function(e,t,a){var l=this,o=e.filter((function(e){return l.common.targetTrim(e.coordinate).length>0}));0!=o.length?this.$emit("handleMappOptions","save",(function(e,r){if(l.handleClear(e,r,t,a),o.length>0){for(var n=0;n<o.length;n++){var i=o[n],s=l.common.targetCoordinate(i.coordinate),c=e.getCellMeta(s.row,s.column).mapp||{};c[a]=i.fieldCode,e.setCellMeta(s.row,s.column,"mapp",c)}l.handleRowColModel(o,t),l.handleConfig(r,t,a)}l.$message({type:"info",message:"设置保存成功!"})})):this.$message({type:"warn",message:"请填写映射坐标，至少一个!"})},handleReset:function(e,t,a){for(var l=this,o=0;o<e.length;o++){var r=e[o];this.$set(r,"coordinate","")}this.$emit("handleMappOptions","save",(function(e,o){l.handleClear(e,o,t,a)}))},handleEmpty:function(){var e=this;this.$emit("handleMappOptions","save",(function(t,a){var l=e.sheetForm.sheetRow,o=e.sheetForm.sheetCol,r=Object.keys(a.sheetLoad||{});delete a.sheetLoad;for(var i=0;i<l;i++)for(var s=0;s<o;s++){var c=t.getCellMeta(i,s).mapp||{};if(0!=Object.keys(c).length){var d,h=Object(n["a"])(r);try{for(h.s();!(d=h.n()).done;){var u=d.value;delete c[u],0==Object.keys(c).length&&t.removeCellMeta(i,s,"mapp")}}catch(p){h.e(p)}finally{h.f()}}}e.$message({type:"info",message:"清除信息成功!"})}))},handleClear:function(e,t,a,l){for(var o=this.sheetForm.sheetRow,r=this.sheetForm.sheetCol,n=0;n<o;n++)for(var i=0;i<r;i++){var s=e.getCellMeta(n,i).mapp||{};delete s[l],0==Object.keys(s).length&&e.removeCellMeta(n,i,"mapp")}"mapp"===a?(t.sheetMapp&&delete t.sheetMapp[l],this.common.targetIsNull(t.sheetMapp)&&delete t["sheetMapp"]):"load"===a&&(t.sheetLoad&&delete t.sheetLoad[l],this.common.targetIsNull(t.sheetLoad)&&delete t["sheetLoad"]),this.$message({type:"info",message:"重置映射成功!"})},handleConfig:function(e,t,a){"mapp"===t?(e.sheetMapp||(e.sheetMapp={}),e.sheetMapp[a]=Object(c["a"])({},this.mappConfig)):"load"===t&&(e.sheetLoad||(e.sheetLoad={}),e.sheetLoad[a]=Object(c["a"])({},this.loadConfig))},handleRowColModel:function(e,t){if("load"===t){for(var a=[],l=[],o=0;o<e.length;o++){var r=this.common.targetCoordinate(e[o].coordinate);a[a.length]=r.row,l[l.length]=r.column}var n="";n=1==this.common.targetSameArray(a).length?"row":1==this.common.targetSameArray(l).length?"colmun":"hash",this.loadConfig.ruleModel=n}},handleMappKey:function(){return[this.mappConfig.taxTableCode,this.mappConfig.taxTableType].join("_")},handleLoadKey:function(){return[this.loadConfig.ruleCode,this.loadConfig.ruleType].join("_")},handleFindMappTable:function(){var e=this;return Object(s["a"])(Object(i["a"])().mark((function t(){var a,l;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={taxDeclareCode:e.sheetForm.sheetKey,taxCode:e.router.taxCode},t.next=3,Object(d["V"])(a);case 3:l=t.sent,l&&(e.mappAllOptions=l,e.mappOptions=e.mappAllOptions.filter((function(t){return t.taxTableTypes.includes(e.mappConfig.taxTableType)})));case 5:case"end":return t.stop()}}),t)})))()},handleLoadFields:function(){var e=this;return Object(s["a"])(Object(i["a"])().mark((function t(){var a,l,o,r,n,s,c;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={taxArea:e.router.taxArea,taxCode:e.router.taxCode,bool:!0},t.next=3,Object(d["H"])(a);case 3:if(l=t.sent,l){for(e.loadAllOptions=l,e.loadMultipleOptions=[],e.loadSingleOptions=[],o=0;o<e.loadAllOptions.length;o++)r=e.loadAllOptions[o],n=r.ruleInfo||{},"multipleRowCol"===r.ruleFetch||"singleRowMultipleCol"===r.ruleFetch?(s={expire:r.expire,ruleCode:r.ruleCode,ruleName:r.ruleName,taxArea:r.taxArea,taxAreaName:r.taxAreaName,fields:[]},"interface"===r.ruleType?s.fields=n.inface?n.inface.fields:[]:"complex"===r.ruleType&&(s.fields=n.complex?n.complex.fields:[]),e.loadMultipleOptions.push(s)):(c={expire:r.expire,ruleCode:r.ruleCode,ruleName:r.ruleName,taxArea:r.taxArea,taxAreaName:r.taxAreaName,ruleType:r.ruleDataType},"interface"===r.ruleType&&(c["inface"]=n.inface||{}),e.loadSingleOptions.push(c));e.sourceOptions=e.loadSingleOptions.filter((function(e){return"text"===e.ruleType}))}case 5:case"end":return t.stop()}}),t)})))()},setCellOptions:function(e,t){var a=this;this.cellForm=Object.assign(this.cellForm,e),"numeric"===e.cellType?this.dataTypeForm.numericFormat=this.common.targetIsNull(t.numericFormat)?{pattern:"",culture:"zh-CN"}:t.numericFormat:"dropdown"===e.cellType?this.dataTypeForm.request=this.common.targetIsNull(t.request)?{url:"",action:""}:t.request:"checkbox"===e.cellType?this.dataTypeForm.label=this.common.targetIsNull(t.label)?{position:"-/-",value:"复选框"}:t.label:"date"===e.cellType&&(this.dataTypeForm.dateFormat=this.common.targetIsNull(t.dateFormat)?"-/-":t.dateFormat),this.sourceOptions=this.loadSingleOptions.filter((function(e){return e.ruleType===a.cellForm.cellType}))},setSheetOptions:function(e){this.sheetForm=Object.assign(this.sheetForm,e.sheetInfo),this.sheetValids=e.sheetValids||[]},setMappConfig:function(){this.popMappShow="Y"===this.sheetForm.sheetSave}}),"watch",{sheetKey:function(e,t){var a=this;this.router=this.common.targetGetStorage("taxInfo"),this.mappConfig.taxTableType=this.router.tmpType,this.loadConfig.taxDeclareCode=e,this.mappConfig.taxDeclareCode=e,setTimeout((function(){a.handleFindMappTable()}),0),setTimeout((function(){a.handleLoadFields()}),0)}}),"computed",{sheetKey:function(){return this.sheetForm.sheetKey}}),"created",(function(){})),"mounted",(function(){})),u=h,p=(a("e2ad"),a("2877")),m=Object(p["a"])(u,l,o,!1,null,"11baed5b",null);t["default"]=m.exports}}]);